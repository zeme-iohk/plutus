<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module     : Algebra.Graph.NonEmpty</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright  : (c) Andrey Mokhov 2016-2022</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License    : MIT (see the file LICENSE)</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer : andrey.mokhov@gmail.com</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability  : experimental</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- __Alga__ is a library for algebraic construction and manipulation of graphs</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- in Haskell. See &lt;https://github.com/snowleopard/alga-paper this paper&gt; for the</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- motivation behind the library, the underlying theory, and implementation details.</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- This module defines the data type 'Graph' for algebraic graphs that are known</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- to be non-empty at compile time. To avoid name clashes with &quot;Algebra.Graph&quot;,</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- this module can be imported qualified:</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- import qualified Algebra.Graph.NonEmpty as NonEmpty</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- The naming convention generally follows that of &quot;Data.List.NonEmpty&quot;: we use</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- suffix @1@ to indicate the functions whose interface must be changed compared</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- to &quot;Algebra.Graph&quot;, e.g. 'vertices1'.</span><span>
</span><span id="line-24"></span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algebra.Graph.NonEmpty</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Non-empty algebraic graphs</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier">Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#toNonEmpty"><span class="hs-identifier">toNonEmpty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Basic graph construction primitives</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier">vertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edge"><span class="hs-identifier">edge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier">overlay</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#overlay1"><span class="hs-identifier">overlay1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#connect"><span class="hs-identifier">connect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertices1"><span class="hs-identifier">vertices1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edges1"><span class="hs-identifier">edges1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#overlays1"><span class="hs-identifier">overlays1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#connects1"><span class="hs-identifier">connects1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph folding</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier">foldg1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Relations on graphs</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#isSubgraphOf"><span class="hs-identifier">isSubgraphOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#%3D%3D%3D"><span class="hs-operator">(===)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph properties</span></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#size"><span class="hs-identifier">size</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#hasVertex"><span class="hs-identifier">hasVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#hasEdge"><span class="hs-identifier">hasEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexCount"><span class="hs-identifier">vertexCount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeCount"><span class="hs-identifier">edgeCount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexList1"><span class="hs-identifier">vertexList1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeList"><span class="hs-identifier">edgeList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexSet"><span class="hs-identifier">vertexSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeSet"><span class="hs-identifier">edgeSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Standard families of graphs</span></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#path1"><span class="hs-identifier">path1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#circuit1"><span class="hs-identifier">circuit1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#clique1"><span class="hs-identifier">clique1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#biclique1"><span class="hs-identifier">biclique1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#star"><span class="hs-identifier">star</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#stars1"><span class="hs-identifier">stars1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#tree"><span class="hs-identifier">tree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#mesh1"><span class="hs-identifier">mesh1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#torus1"><span class="hs-identifier">torus1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph transformation</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#removeVertex1"><span class="hs-identifier">removeVertex1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#removeEdge"><span class="hs-identifier">removeEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#replaceVertex"><span class="hs-identifier">replaceVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#mergeVertices"><span class="hs-identifier">mergeVertices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#splitVertex1"><span class="hs-identifier">splitVertex1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-identifier">transpose</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#induce1"><span class="hs-identifier">induce1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#induceJust1"><span class="hs-identifier">induceJust1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#simplify"><span class="hs-identifier">simplify</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#sparsify"><span class="hs-identifier">sparsify</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#sparsifyKL"><span class="hs-identifier">sparsifyKL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph composition</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#box"><span class="hs-identifier">box</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.State</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.String</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Algebra.Graph.Internal.html"><span class="hs-identifier">Algebra.Graph.Internal</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Algebra.Graph.html"><span class="hs-identifier">Algebra.Graph</span></a></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Algebra.Graph.ToGraph.html"><span class="hs-identifier">Algebra.Graph.ToGraph</span></a></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Algebra.Graph.AdjacencyMap.html"><span class="hs-identifier">Algebra.Graph.AdjacencyMap</span></a></span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AM</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Algebra.Graph.AdjacencyIntMap.html"><span class="hs-identifier">Algebra.Graph.AdjacencyIntMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AIM</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Graph</span></a></span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">KL</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.IntSet</span></a></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IntSet</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span>                      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Tree</span></a></span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tree</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Exts</span></a></span><span>                      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Exts</span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">{-| Non-empty algebraic graphs, which are constructed using three primitives:
'vertex', 'overlay' and 'connect'. See module &quot;Algebra.Graph&quot; for algebraic
graphs that can be empty.

We define a 'Num' instance as a convenient notation for working with graphs:

@
0           == 'vertex' 0
1 + 2       == 'overlay' ('vertex' 1) ('vertex' 2)
1 * 2       == 'connect' ('vertex' 1) ('vertex' 2)
1 + 2 * 3   == 'overlay' ('vertex' 1) ('connect' ('vertex' 2) ('vertex' 3))
1 * (2 + 3) == 'connect' ('vertex' 1) ('overlay' ('vertex' 2) ('vertex' 3))
@

__Note:__ the 'signum' method of the type class 'Num' cannot be implemented and
will throw an error. Furthermore, the 'Num' instance does not satisfy several
&quot;customary laws&quot; of 'Num', which dictate that 'fromInteger' @0@ and
'fromInteger' @1@ should act as additive and multiplicative identities, and
'negate' as additive inverse. Nevertheless, overloading 'fromInteger', '+' and
'*' is very convenient when working with algebraic graphs; we hope that in
future Haskell's Prelude will provide a more fine-grained class hierarchy for
algebraic structures, which we would be able to utilise without violating any
laws.

The 'Eq' instance satisfies the following laws of non-empty algebraic graphs.

    * 'overlay' is commutative, associative and idempotent:

        &gt;       x + y == y + x
        &gt; x + (y + z) == (x + y) + z
        &gt;       x + x == x

    * 'connect' is associative:

        &gt; x * (y * z) == (x * y) * z

    * 'connect' distributes over 'overlay':

        &gt; x * (y + z) == x * y + x * z
        &gt; (x + y) * z == x * z + y * z

    * 'connect' can be decomposed:

        &gt; x * y * z == x * y + x * z + y * z

    * 'connect' satisfies absorption and saturation:

        &gt; x * y + x + y == x * y
        &gt;     x * x * x == x * x

When specifying the time and memory complexity of graph algorithms, /n/ will
denote the number of vertices in the graph, /m/ will denote the number of
edges in the graph, and /s/ will denote the /size/ of the corresponding 'Graph'
expression, defined as the number of vertex leaves (note that /n/ &lt;= /s/). If
@g@ is a 'Graph', the corresponding /n/, /m/ and /s/ can be computed as follows:

@n == 'vertexCount' g
m == 'edgeCount' g
s == 'size' g@

Converting a 'Graph' to the corresponding
'Algebra.Graph.NonEmpty.AdjacencyMap.AdjacencyMap' takes /O(s + m * log(m))/ time and /O(s + m)/ memory. This is also the
complexity of the graph equality test, because it is currently implemented by
converting graph expressions to canonical representations based on adjacency
maps.

The total order 'Ord' on graphs is defined using /size-lexicographic/ comparison:

* Compare the number of vertices. In case of a tie, continue.
* Compare the sets of vertices. In case of a tie, continue.
* Compare the number of edges. In case of a tie, continue.
* Compare the sets of edges.

Here are a few examples:

@'vertex' 1 &lt; 'vertex' 2
'vertex' 3 &lt; 'edge' 1 2
'vertex' 1 &lt; 'edge' 1 1
'edge' 1 1 &lt; 'edge' 1 2
'edge' 1 2 &lt; 'edge' 1 1 + 'edge' 2 2
'edge' 1 2 &lt; 'edge' 1 3@

Note that the resulting order refines the 'isSubgraphOf' relation and is
compatible with 'overlay' and 'connect' operations:

@'isSubgraphOf' x y ==&gt; x &lt;= y@

@x     &lt;= x + y
x + y &lt;= x * y@
-}</span><span>
</span><span id="line-164"></span><span class="hs-keyword">data</span><span> </span><span id="Graph"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-var">Graph</span></a></span></span><span> </span><span id="local-6989586621679126813"><span class="annot"><a href="#local-6989586621679126813"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Vertex"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679126813"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-165"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="Overlay"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126813"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126813"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="Connect"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Connect"><span class="hs-identifier hs-var">Connect</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126813"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126813"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>             </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126309"><span id="local-6989586621679126316"><span class="annot"><span class="annottext">forall a b. a -&gt; Graph b -&gt; Graph a
forall a b. (a -&gt; b) -&gt; Graph a -&gt; Graph b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: forall a b. a -&gt; Graph b -&gt; Graph a
$c&lt;$ :: forall a b. a -&gt; Graph b -&gt; Graph a
fmap :: forall a b. (a -&gt; b) -&gt; Graph a -&gt; Graph b
$cfmap :: forall a b. (a -&gt; b) -&gt; Graph a -&gt; Graph b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679126290"><span id="local-6989586621679126292"><span id="local-6989586621679126302"><span class="annot"><span class="annottext">Int -&gt; Graph a -&gt; ShowS
forall a. Show a =&gt; Int -&gt; Graph a -&gt; ShowS
forall a. Show a =&gt; [Graph a] -&gt; ShowS
forall a. Show a =&gt; Graph a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Graph a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [Graph a] -&gt; ShowS
show :: Graph a -&gt; String
$cshow :: forall a. Show a =&gt; Graph a -&gt; String
showsPrec :: Int -&gt; Graph a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Graph a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679126809"><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126809"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126809"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621679126279"><span class="annot"><span class="annottext">rnf :: Graph a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span>  </span><span id="local-6989586621679126277"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126277"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126277"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span> </span><span id="local-6989586621679126276"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126276"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126275"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126275"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126276"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">seq :: forall a b. a -&gt; b -&gt; b
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">`seq`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126275"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Connect"><span class="hs-identifier hs-type">Connect</span></a></span><span> </span><span id="local-6989586621679126274"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126274"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126273"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126273"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126274"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">seq :: forall a b. a -&gt; b -&gt; b
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">`seq`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126273"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679126217"><span id="local-6989586621679126219"><span id="local-6989586621679126221"><span id="local-6989586621679126223"><span id="local-6989586621679126225"><span id="local-6989586621679126227"><span id="local-6989586621679126229"><span id="local-6989586621679126231"><span id="local-6989586621679126233"><span id="local-6989586621679126235"><span id="local-6989586621679126237"><span id="local-6989586621679126239"><span id="local-6989586621679126241"><span id="local-6989586621679126243"><span id="local-6989586621679126245"><span id="local-6989586621679126247"><span id="local-6989586621679126249"><span id="local-6989586621679126251"><span id="local-6989586621679126253"><span id="local-6989586621679126255"><span id="local-6989586621679126257"><span id="local-6989586621679126259"><span id="local-6989586621679126261"><span id="local-6989586621679126263"><span id="local-6989586621679126266"><span id="local-6989586621679126268"><span id="local-6989586621679126271"><span id="local-6989586621679126821"><span class="annot"><a href="Algebra.Graph.ToGraph.html#ToGraph"><span class="hs-identifier hs-type">T.ToGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126821"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ToVertex"><span class="annot"><a href="Algebra.Graph.ToGraph.html#ToVertex"><span class="hs-identifier hs-var">ToVertex</span></a></span></span><span> </span><span id="local-6989586621679126821"><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126821"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679126821"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621679126215"><span class="annot"><span class="annottext">foldg :: forall r.
r
-&gt; (ToVertex (Graph a) -&gt; r)
-&gt; (r -&gt; r -&gt; r)
-&gt; (r -&gt; r -&gt; r)
-&gt; Graph a
-&gt; r
</span><a href="Algebra.Graph.ToGraph.html#foldg"><span class="hs-identifier hs-var hs-var hs-var hs-var">foldg</span></a></span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-var">foldg1</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621679126210"><span class="annot"><span class="annottext">hasEdge :: Eq (ToVertex (Graph a)) =&gt;
ToVertex (Graph a) -&gt; ToVertex (Graph a) -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.ToGraph.html#hasEdge"><span class="hs-identifier hs-var hs-var hs-var hs-var">hasEdge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.NonEmpty.html#hasEdge"><span class="hs-identifier hs-var">hasEdge</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | __Note:__ this does not satisfy the usual ring laws; see 'Graph' for more</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- details.</span><span>
</span><span id="line-181"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679126206"><span id="local-6989586621679126792"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126792"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126792"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679126198"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; Integer -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromInteger</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679126196"><span class="annot"><span class="annottext">+ :: Graph a -&gt; Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(+)</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679126194"><span class="annot"><span class="annottext">* :: Graph a -&gt; Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(*)</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Connect"><span class="hs-identifier hs-var">Connect</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621679126190"><span class="annot"><span class="annottext">signum :: Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NonEmpty.Graph.signum cannot be implemented.&quot;</span></span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621679126187"><span class="annot"><span class="annottext">abs :: Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679126184"><span class="annot"><span class="annottext">negate :: Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679126782"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">IsString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126782"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">IsString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126782"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679126178"><span class="annot"><span class="annottext">fromString :: String -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsString a =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromString</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679126175"><span id="local-6989586621679126822"><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126822"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126822"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679126172"><span class="annot"><span class="annottext">== :: Graph a -&gt; Graph a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(==)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.NonEmpty.html#eq"><span class="hs-identifier hs-var">eq</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679126156"><span id="local-6989586621679126158"><span id="local-6989586621679126160"><span id="local-6989586621679126162"><span id="local-6989586621679126164"><span id="local-6989586621679126166"><span id="local-6989586621679126779"><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126779"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126779"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621679126153"><span class="annot"><span class="annottext">compare :: Graph a -&gt; Graph a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Ordering
</span><a href="Algebra.Graph.NonEmpty.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | Defined via 'overlay'.</span><span>
</span><span id="line-199"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679126146"><span id="local-6989586621679126148"><span id="local-6989586621679126776"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126776"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679126144"><span class="annot"><span class="annottext">&lt;&gt; :: Graph a -&gt; Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- TODO: Find a more efficient equality check.</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- | Check if two graphs are equal by converting them to their adjacency maps.</span><span>
</span><span id="line-204"></span><span id="local-6989586621679126143"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#eq"><span class="hs-identifier hs-type">eq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126143"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126143"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126143"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-205"></span><span id="eq"><span class="annot"><span class="annottext">eq :: forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.NonEmpty.html#eq"><span class="hs-identifier hs-var hs-var">eq</span></a></span></span><span> </span><span id="local-6989586621679126133"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126133"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126132"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126132"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t.
(ToGraph t, Ord (ToVertex t)) =&gt;
t -&gt; AdjacencyMap (ToVertex t)
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyMap"><span class="hs-identifier hs-var">T.toAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126133"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall t.
(ToGraph t, Ord (ToVertex t)) =&gt;
t -&gt; AdjacencyMap (ToVertex t)
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyMap"><span class="hs-identifier hs-var">T.toAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126132"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-206"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#eq"><span class="hs-pragma hs-type">eq</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-207"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;eqInt&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#eq"><span class="hs-pragma hs-type">eq</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#eqInt"><span class="hs-pragma hs-type">eqInt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- Like @eq@ but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-210"></span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#eqInt"><span class="hs-identifier hs-type">eqInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-211"></span><span id="eqInt"><span class="annot"><span class="annottext">eqInt :: Graph Int -&gt; Graph Int -&gt; Bool
</span><a href="Algebra.Graph.NonEmpty.html#eqInt"><span class="hs-identifier hs-var hs-var">eqInt</span></a></span></span><span> </span><span id="local-6989586621679126129"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679126129"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126128"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679126128"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (ToGraph t, ToVertex t ~ Int) =&gt; t -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">T.toAdjacencyIntMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679126129"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. (ToGraph t, ToVertex t ~ Int) =&gt; t -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">T.toAdjacencyIntMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679126128"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- TODO: Find a more efficient comparison.</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- Compare two graphs by converting them to their adjacency maps.</span><span>
</span><span id="line-215"></span><span id="local-6989586621679126126"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#ord"><span class="hs-identifier hs-type">ord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126126"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126126"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126126"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ordering</span></a></span></span><span>
</span><span id="line-216"></span><span id="ord"><span class="annot"><span class="annottext">ord :: forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Ordering
</span><a href="Algebra.Graph.NonEmpty.html#ord"><span class="hs-identifier hs-var hs-var">ord</span></a></span></span><span> </span><span id="local-6989586621679126118"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126118"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126117"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126117"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t.
(ToGraph t, Ord (ToVertex t)) =&gt;
t -&gt; AdjacencyMap (ToVertex t)
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyMap"><span class="hs-identifier hs-var">T.toAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126118"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t.
(ToGraph t, Ord (ToVertex t)) =&gt;
t -&gt; AdjacencyMap (ToVertex t)
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyMap"><span class="hs-identifier hs-var">T.toAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126117"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#ord"><span class="hs-pragma hs-type">ord</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-218"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;ordInt&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#ord"><span class="hs-pragma hs-type">ord</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#ordInt"><span class="hs-pragma hs-type">ordInt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- Like @ord@ but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-221"></span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#ordInt"><span class="hs-identifier hs-type">ordInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ordering</span></a></span><span>
</span><span id="line-222"></span><span id="ordInt"><span class="annot"><span class="annottext">ordInt :: Graph Int -&gt; Graph Int -&gt; Ordering
</span><a href="Algebra.Graph.NonEmpty.html#ordInt"><span class="hs-identifier hs-var hs-var">ordInt</span></a></span></span><span> </span><span id="local-6989586621679126115"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679126115"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126114"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679126114"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. (ToGraph t, ToVertex t ~ Int) =&gt; t -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">T.toAdjacencyIntMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679126115"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. (ToGraph t, ToVertex t ~ Int) =&gt; t -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">T.toAdjacencyIntMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679126114"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679126104"><span id="local-6989586621679126106"><span id="local-6989586621679126108"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621679126102"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621679126099"><span class="annot"><span class="annottext">Graph (a -&gt; b)
</span><a href="#local-6989586621679126099"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679126098"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. Graph (a -&gt; b) -&gt; Graph a -&gt; Graph b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></a></span></span><span> </span><span id="local-6989586621679126097"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126097"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph (a -&gt; b)
</span><a href="#local-6989586621679126099"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126097"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679126091"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621679126087"><span class="annot"><span class="annottext">return :: forall a. a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span id="local-6989586621679126086"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126086"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679126085"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. Graph a -&gt; (a -&gt; Graph b) -&gt; Graph b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></a></span></span><span> </span><span id="local-6989586621679126084"><span class="annot"><span class="annottext">a -&gt; Graph b
</span><a href="#local-6989586621679126084"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-var">foldg1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Graph b
</span><a href="#local-6989586621679126084"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Connect"><span class="hs-identifier hs-var">Connect</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126086"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | Convert an algebraic graph (from &quot;Algebra.Graph&quot;) into a non-empty</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- algebraic graph. Returns 'Nothing' if the argument is 'G.empty'.</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-235"></span><span class="hs-comment">--</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- toNonEmpty 'G.empty'       == Nothing</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- toNonEmpty ('T.toGraph' x) == Just (x :: 'Graph' a)</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-240"></span><span id="local-6989586621679126747"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#toNonEmpty"><span class="hs-identifier hs-type">toNonEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">G.Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126747"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126747"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-241"></span><span id="toNonEmpty"><span class="annot"><span class="annottext">toNonEmpty :: forall a. Graph a -&gt; Maybe (Graph a)
</span><a href="Algebra.Graph.NonEmpty.html#toNonEmpty"><span class="hs-identifier hs-var hs-var">toNonEmpty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">G.foldg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {t}. (t -&gt; t -&gt; t) -&gt; Maybe t -&gt; Maybe t -&gt; Maybe t
</span><a href="#local-6989586621679126082"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {t}. (t -&gt; t -&gt; t) -&gt; Maybe t -&gt; Maybe t -&gt; Maybe t
</span><a href="#local-6989586621679126082"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Connect"><span class="hs-identifier hs-var">Connect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621679126082"><span class="annot"><span class="annottext">go :: (t -&gt; t -&gt; t) -&gt; Maybe t -&gt; Maybe t -&gt; Maybe t
</span><a href="#local-6989586621679126082"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe t
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span id="local-6989586621679126081"><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679126081"><span class="hs-identifier hs-var">y</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679126081"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><a href="#local-6989586621679126082"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679126080"><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679126080"><span class="hs-identifier hs-var">x</span></a></span></span><span>        </span><span class="annot"><span class="annottext">Maybe t
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679126080"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><a href="#local-6989586621679126082"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679126079"><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><a href="#local-6989586621679126079"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679126078"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679126078"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679126077"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679126077"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><a href="#local-6989586621679126079"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679126078"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679126077"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- | Construct the graph comprising /a single isolated vertex/. An alias for the</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- constructor 'Vertex'.</span><span>
</span><span id="line-249"></span><span class="hs-comment">--</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- 'hasVertex' x (vertex y) == (x == y)</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- 'vertexCount' (vertex x) == 1</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- 'edgeCount'   (vertex x) == 0</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- 'size'        (vertex x) == 1</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-256"></span><span id="local-6989586621679126076"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679126076"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126076"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-257"></span><span id="vertex"><span class="annot"><span class="annottext">vertex :: forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var hs-var">vertex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span>
</span><span id="line-258"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-pragma hs-type">vertex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- | Construct the graph comprising /a single edge/.</span><span>
</span><span id="line-261"></span><span class="hs-comment">--</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- edge x y               == 'connect' ('vertex' x) ('vertex' y)</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- 'hasEdge' x y (edge x y) == True</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- 'edgeCount'   (edge x y) == 1</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- 'vertexCount' (edge 1 1) == 1</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- 'vertexCount' (edge 1 2) == 2</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-269"></span><span id="local-6989586621679126742"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edge"><span class="hs-identifier hs-type">edge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679126742"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126742"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126742"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-270"></span><span id="edge"><span class="annot"><span class="annottext">edge :: forall a. a -&gt; a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#edge"><span class="hs-identifier hs-var hs-var">edge</span></a></span></span><span> </span><span id="local-6989586621679126075"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126075"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679126074"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126074"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#connect"><span class="hs-identifier hs-var">connect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126075"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126074"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | /Overlay/ two graphs. An alias for the constructor 'Overlay'. This is a</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- commutative, associative and idempotent operation.</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- Complexity: /O(1)/ time and memory, /O(s1 + s2)/ size.</span><span>
</span><span id="line-275"></span><span class="hs-comment">--</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- 'hasVertex' z (overlay x y) == 'hasVertex' z x || 'hasVertex' z y</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- 'vertexCount' (overlay x y) &gt;= 'vertexCount' x</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- 'vertexCount' (overlay x y) &lt;= 'vertexCount' x + 'vertexCount' y</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- 'edgeCount'   (overlay x y) &gt;= 'edgeCount' x</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- 'edgeCount'   (overlay x y) &lt;= 'edgeCount' x   + 'edgeCount' y</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- 'size'        (overlay x y) == 'size' x        + 'size' y</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- 'vertexCount' (overlay 1 2) == 2</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- 'edgeCount'   (overlay 1 2) == 0</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-286"></span><span id="local-6989586621679126073"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier hs-type">overlay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126073"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126073"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126073"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-287"></span><span id="overlay"><span class="annot"><span class="annottext">overlay :: forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier hs-var hs-var">overlay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span><span>
</span><span id="line-288"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-pragma hs-type">overlay</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- | Overlay a possibly empty graph (from &quot;Algebra.Graph&quot;) with a non-empty</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- graph. If the first argument is 'G.empty', the function returns the second</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- argument; otherwise it is semantically the same as 'overlay'.</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- Complexity: /O(s1)/ time and memory, and /O(s1 + s2)/ size.</span><span>
</span><span id="line-294"></span><span class="hs-comment">--</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-296"></span><span class="hs-comment">--                overlay1 'G.empty' x == x</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- x /= 'G.empty' ==&gt; overlay1 x     y == overlay (fromJust $ toNonEmpty x) y</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-299"></span><span id="local-6989586621679126740"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#overlay1"><span class="hs-identifier hs-type">overlay1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">G.Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126740"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126740"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126740"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-300"></span><span id="overlay1"><span class="annot"><span class="annottext">overlay1 :: forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay1"><span class="hs-identifier hs-var hs-var">overlay1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Maybe (Graph a)
</span><a href="Algebra.Graph.NonEmpty.html#toNonEmpty"><span class="hs-identifier hs-var">toNonEmpty</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- | /Connect/ two graphs. An alias for the constructor 'Connect'. This is an</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- associative operation, which distributes over 'overlay' and obeys the</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- decomposition axiom.</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- Complexity: /O(1)/ time and memory, /O(s1 + s2)/ size. Note that the number</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- of edges in the resulting graph is quadratic with respect to the number of</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- vertices of the arguments: /m = O(m1 + m2 + n1 * n2)/.</span><span>
</span><span id="line-308"></span><span class="hs-comment">--</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- 'hasVertex' z (connect x y) == 'hasVertex' z x || 'hasVertex' z y</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- 'vertexCount' (connect x y) &gt;= 'vertexCount' x</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- 'vertexCount' (connect x y) &lt;= 'vertexCount' x + 'vertexCount' y</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- 'edgeCount'   (connect x y) &gt;= 'edgeCount' x</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- 'edgeCount'   (connect x y) &gt;= 'edgeCount' y</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- 'edgeCount'   (connect x y) &gt;= 'vertexCount' x * 'vertexCount' y</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- 'edgeCount'   (connect x y) &lt;= 'vertexCount' x * 'vertexCount' y + 'edgeCount' x + 'edgeCount' y</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- 'size'        (connect x y) == 'size' x        + 'size' y</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- 'vertexCount' (connect 1 2) == 2</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- 'edgeCount'   (connect 1 2) == 1</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-321"></span><span id="local-6989586621679126071"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#connect"><span class="hs-identifier hs-type">connect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126071"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126071"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126071"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-322"></span><span id="connect"><span class="annot"><span class="annottext">connect :: forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#connect"><span class="hs-identifier hs-var hs-var">connect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Connect"><span class="hs-identifier hs-var">Connect</span></a></span><span>
</span><span id="line-323"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#connect"><span class="hs-pragma hs-type">connect</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- | Construct the graph comprising a given list of isolated vertices.</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-328"></span><span class="hs-comment">--</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- vertices1 [x]           == 'vertex' x</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- 'hasVertex' x . vertices1 == 'elem' x</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- 'vertexCount' . vertices1 == 'length' . 'Data.List.NonEmpty.nub'</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- 'vertexSet'   . vertices1 == Set.'Set.fromList' . 'Data.List.NonEmpty.toList'</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-335"></span><span id="local-6989586621679126736"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertices1"><span class="hs-identifier hs-type">vertices1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126736"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-336"></span><span id="vertices1"><span class="annot"><span class="annottext">vertices1 :: forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertices1"><span class="hs-identifier hs-var hs-var">vertices1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty (Graph a) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlays1"><span class="hs-identifier hs-var">overlays1</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span>
</span><span id="line-337"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertices1"><span class="hs-pragma hs-type">vertices1</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-comment">-- | Construct the graph from a list of edges.</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-342"></span><span class="hs-comment">--</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- edges1 [(x,y)]     == 'edge' x y</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- edges1             == 'overlays1' . 'fmap' ('uncurry' 'edge')</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- 'edgeCount' . edges1 == 'Data.List.NonEmpty.length' . 'Data.List.NonEmpty.nub'</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-348"></span><span id="local-6989586621679126734"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edges1"><span class="hs-identifier hs-type">edges1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126734"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679126734"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126734"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-349"></span><span id="edges1"><span class="annot"><span class="annottext">edges1 :: forall a. NonEmpty (a, a) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#edges1"><span class="hs-identifier hs-var hs-var">edges1</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty (Graph a) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlays1"><span class="hs-identifier hs-var">overlays1</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#edge"><span class="hs-identifier hs-var">edge</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">-- | Overlay a given list of graphs.</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- Complexity: /O(L)/ time and memory, and /O(S)/ size, where /L/ is the length</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- of the given list, and /S/ is the sum of sizes of the graphs in the list.</span><span>
</span><span id="line-354"></span><span class="hs-comment">--</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- overlays1 [x]   == x</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- overlays1 [x,y] == 'overlay' x y</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-359"></span><span id="local-6989586621679126066"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#overlays1"><span class="hs-identifier hs-type">overlays1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126066"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126066"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-360"></span><span id="overlays1"><span class="annot"><span class="annottext">overlays1 :: forall a. NonEmpty (Graph a) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlays1"><span class="hs-identifier hs-var hs-var">overlays1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(Graph a -&gt; Graph a -&gt; Graph a) -&gt; NonEmpty (Graph a) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#concatg1"><span class="hs-identifier hs-var">concatg1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span>
</span><span id="line-361"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#overlays1"><span class="hs-pragma hs-type">overlays1</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- | Connect a given list of graphs.</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- Complexity: /O(L)/ time and memory, and /O(S)/ size, where /L/ is the length</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- of the given list, and /S/ is the sum of sizes of the graphs in the list.</span><span>
</span><span id="line-366"></span><span class="hs-comment">--</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- connects1 [x]   == x</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- connects1 [x,y] == 'connect' x y</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-371"></span><span id="local-6989586621679126064"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#connects1"><span class="hs-identifier hs-type">connects1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126064"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126064"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-372"></span><span id="connects1"><span class="annot"><span class="annottext">connects1 :: forall a. NonEmpty (Graph a) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#connects1"><span class="hs-identifier hs-var hs-var">connects1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(Graph a -&gt; Graph a -&gt; Graph a) -&gt; NonEmpty (Graph a) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#concatg1"><span class="hs-identifier hs-var">concatg1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#connect"><span class="hs-identifier hs-var">connect</span></a></span><span>
</span><span id="line-373"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#connects1"><span class="hs-pragma hs-type">connects1</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-comment">-- Auxiliary function, similar to 'sconcat'.</span><span>
</span><span id="line-376"></span><span id="local-6989586621679126729"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#concatg1"><span class="hs-identifier hs-type">concatg1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126729"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126729"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126729"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126729"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126729"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-377"></span><span id="concatg1"><span class="annot"><span class="annottext">concatg1 :: forall a.
(Graph a -&gt; Graph a -&gt; Graph a) -&gt; NonEmpty (Graph a) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#concatg1"><span class="hs-identifier hs-var hs-var">concatg1</span></a></span></span><span> </span><span id="local-6989586621679126063"><span class="annot"><span class="annottext">Graph a -&gt; Graph a -&gt; Graph a
</span><a href="#local-6989586621679126063"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679126062"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126062"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span id="local-6989586621679126061"><span class="annot"><span class="annottext">[Graph a]
</span><a href="#local-6989586621679126061"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126062"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph a -&gt; Graph a -&gt; Graph a
</span><a href="#local-6989586621679126063"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126062"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; Maybe a
</span><a href="Algebra.Graph.Internal.html#foldr1Safe"><span class="hs-identifier hs-var">foldr1Safe</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a -&gt; Graph a -&gt; Graph a
</span><a href="#local-6989586621679126063"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[Graph a]
</span><a href="#local-6989586621679126061"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-comment">-- | Generalised graph folding: recursively collapse a 'Graph' by</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- applying the provided functions to the leaves and internal nodes of the</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- expression. The order of arguments is: vertex, overlay and connect.</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- Complexity: /O(s)/ applications of the given functions. As an example, the</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- complexity of 'size' is /O(s)/, since 'const' and '+' have constant costs.</span><span>
</span><span id="line-384"></span><span class="hs-comment">--</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- foldg1 'vertex'    'overlay' 'connect'        == id</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- foldg1 'vertex'    'overlay' ('flip' 'connect') == 'transpose'</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- foldg1 ('const' 1) (+)     (+)            == 'size'</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- foldg1 (== x)    (||)    (||)           == 'hasVertex' x</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-391"></span><span id="local-6989586621679126795"><span id="local-6989586621679126796"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-type">foldg1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126796"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126795"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126795"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126795"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126795"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126795"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126795"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126795"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126796"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126795"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-392"></span><span id="foldg1"><span class="annot"><span class="annottext">foldg1 :: forall a b.
(a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-var hs-var">foldg1</span></a></span></span><span> </span><span id="local-6989586621679126059"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679126059"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679126058"><span class="annot"><span class="annottext">b -&gt; b -&gt; b
</span><a href="#local-6989586621679126058"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679126057"><span class="annot"><span class="annottext">b -&gt; b -&gt; b
</span><a href="#local-6989586621679126057"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph a -&gt; b
</span><a href="#local-6989586621679126056"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-394"></span><span>    </span><span id="local-6989586621679126056"><span class="annot"><span class="annottext">go :: Graph a -&gt; b
</span><a href="#local-6989586621679126056"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span>  </span><span id="local-6989586621679126055"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126055"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679126059"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126055"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><a href="#local-6989586621679126056"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span> </span><span id="local-6989586621679126054"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126054"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126053"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126053"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
</span><a href="#local-6989586621679126058"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph a -&gt; b
</span><a href="#local-6989586621679126056"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126054"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph a -&gt; b
</span><a href="#local-6989586621679126056"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126053"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>    </span><span class="annot"><a href="#local-6989586621679126056"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Connect"><span class="hs-identifier hs-type">Connect</span></a></span><span> </span><span id="local-6989586621679126052"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126052"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126051"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126051"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
</span><a href="#local-6989586621679126057"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph a -&gt; b
</span><a href="#local-6989586621679126056"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126052"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph a -&gt; b
</span><a href="#local-6989586621679126056"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126051"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- | The 'isSubgraphOf' function takes two graphs and returns 'True' if the</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- first graph is a /subgraph/ of the second.</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- Complexity: /O(s + m * log(m))/ time. Note that the number of edges /m/ of a</span><span>
</span><span id="line-401"></span><span class="hs-comment">-- graph can be quadratic with respect to the expression size /s/.</span><span>
</span><span id="line-402"></span><span class="hs-comment">--</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- isSubgraphOf x             ('overlay' x y) ==  True</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- isSubgraphOf ('overlay' x y) ('connect' x y) ==  True</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- isSubgraphOf ('path1' xs)    ('circuit1' xs) ==  True</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- isSubgraphOf x y                         ==&gt; x &lt;= y</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-409"></span><span id="local-6989586621679126050"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#isSubgraphOf"><span class="hs-identifier hs-type">isSubgraphOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126050"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126050"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126050"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-410"></span><span id="isSubgraphOf"><span class="annot"><span class="annottext">isSubgraphOf :: forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.NonEmpty.html#isSubgraphOf"><span class="hs-identifier hs-var hs-var">isSubgraphOf</span></a></span></span><span> </span><span id="local-6989586621679126043"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126043"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126042"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126042"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; AdjacencyMap a -&gt; AdjacencyMap a -&gt; Bool
</span><a href="Algebra.Graph.AdjacencyMap.html#isSubgraphOf"><span class="hs-identifier hs-var">AM.isSubgraphOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t.
(ToGraph t, Ord (ToVertex t)) =&gt;
t -&gt; AdjacencyMap (ToVertex t)
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyMap"><span class="hs-identifier hs-var">T.toAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126043"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t.
(ToGraph t, Ord (ToVertex t)) =&gt;
t -&gt; AdjacencyMap (ToVertex t)
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyMap"><span class="hs-identifier hs-var">T.toAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126042"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#isSubgraphOf"><span class="hs-pragma hs-type">isSubgraphOf</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-412"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;isSubgraphOf/Int&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#isSubgraphOf"><span class="hs-pragma hs-type">isSubgraphOf</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#isSubgraphOfIntR"><span class="hs-pragma hs-type">isSubgraphOfIntR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="hs-comment">-- Like 'isSubgraphOf' but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-415"></span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#isSubgraphOfIntR"><span class="hs-identifier hs-type">isSubgraphOfIntR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-416"></span><span id="isSubgraphOfIntR"><span class="annot"><span class="annottext">isSubgraphOfIntR :: Graph Int -&gt; Graph Int -&gt; Bool
</span><a href="Algebra.Graph.NonEmpty.html#isSubgraphOfIntR"><span class="hs-identifier hs-var hs-var">isSubgraphOfIntR</span></a></span></span><span> </span><span id="local-6989586621679126039"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679126039"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679126038"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679126038"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AdjacencyIntMap -&gt; AdjacencyIntMap -&gt; Bool
</span><a href="Algebra.Graph.AdjacencyIntMap.html#isSubgraphOf"><span class="hs-identifier hs-var">AIM.isSubgraphOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. (ToGraph t, ToVertex t ~ Int) =&gt; t -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">T.toAdjacencyIntMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679126039"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. (ToGraph t, ToVertex t ~ Int) =&gt; t -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">T.toAdjacencyIntMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679126038"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">-- | Structural equality on graph expressions.</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- Complexity: /O(s)/ time.</span><span>
</span><span id="line-420"></span><span class="hs-comment">--</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-422"></span><span class="hs-comment">--     x === x     == True</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- x + y === x + y == True</span><span>
</span><span id="line-424"></span><span class="hs-comment">-- 1 + 2 === 2 + 1 == False</span><span>
</span><span id="line-425"></span><span class="hs-comment">-- x + y === x * y == False</span><span>
</span><span id="line-426"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-427"></span><span id="local-6989586621679126719"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#%3D%3D%3D"><span class="hs-operator hs-type">(===)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126719"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126719"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126719"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-428"></span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span>  </span><span id="local-6989586621679126030"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126030"><span class="hs-identifier hs-var">x1</span></a></span></span><span>   </span><span class="hs-special">)</span><span> </span><span id="%3D%3D%3D"><span class="annot"><span class="annottext">=== :: forall a. Eq a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.NonEmpty.html#%3D%3D%3D"><span class="hs-operator hs-var hs-var">===</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span>  </span><span id="local-6989586621679126029"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126029"><span class="hs-identifier hs-var">x2</span></a></span></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126030"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span>  </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126029"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-429"></span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span> </span><span id="local-6989586621679126028"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126028"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679126027"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126027"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span> </span><span id="local-6989586621679126026"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126026"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679126025"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126025"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126028"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.NonEmpty.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126026"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126027"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.NonEmpty.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126025"><span class="hs-identifier hs-var">y2</span></a></span><span>
</span><span id="line-430"></span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Connect"><span class="hs-identifier hs-type">Connect</span></a></span><span> </span><span id="local-6989586621679126023"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126023"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679126022"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126022"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Connect"><span class="hs-identifier hs-type">Connect</span></a></span><span> </span><span id="local-6989586621679126021"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126021"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679126020"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126020"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126023"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.NonEmpty.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126021"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126022"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.NonEmpty.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679126020"><span class="hs-identifier hs-var">y2</span></a></span><span>
</span><span id="line-431"></span><span class="annot"><span class="annottext">Graph a
</span><span class="hs-identifier">_</span></span><span>               </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-432"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">===</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Bool</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#%3D%3D%3D"><span class="hs-operator hs-type">===</span></a></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-comment">-- | The /size/ of a graph, i.e. the number of leaves of the expression.</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- Complexity: /O(s)/ time.</span><span>
</span><span id="line-438"></span><span class="hs-comment">--</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- size ('vertex' x)    == 1</span><span>
</span><span id="line-441"></span><span class="hs-comment">-- size ('overlay' x y) == size x + size y</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- size ('connect' x y) == size x + size y</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- size x             &gt;= 1</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- size x             &gt;= 'vertexCount' x</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-446"></span><span id="local-6989586621679126717"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126717"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-447"></span><span id="size"><span class="annot"><span class="annottext">size :: forall a. Graph a -&gt; Int
</span><a href="Algebra.Graph.NonEmpty.html#size"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-var">foldg1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(+)</span></a></span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span class="hs-comment">-- | Check if a graph contains a given vertex.</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- Complexity: /O(s)/ time.</span><span>
</span><span id="line-451"></span><span class="hs-comment">--</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- hasVertex x ('vertex' y) == (x == y)</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-455"></span><span id="local-6989586621679126714"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#hasVertex"><span class="hs-identifier hs-type">hasVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126714"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126714"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126714"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-456"></span><span id="hasVertex"><span class="annot"><span class="annottext">hasVertex :: forall a. Eq a =&gt; a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.NonEmpty.html#hasVertex"><span class="hs-identifier hs-var hs-var">hasVertex</span></a></span></span><span> </span><span id="local-6989586621679126013"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126013"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-var">foldg1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679126013"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(||)</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(||)</span></a></span><span>
</span><span id="line-457"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#hasVertex"><span class="hs-pragma hs-type">hasVertex</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Bool</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-comment">-- See the Note [The implementation of hasEdge] in &quot;Algebra.Graph&quot;.</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- | Check if a graph contains a given edge.</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- Complexity: /O(s)/ time.</span><span>
</span><span id="line-462"></span><span class="hs-comment">--</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- hasEdge x y ('vertex' z)       == False</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- hasEdge x y ('edge' x y)       == True</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- hasEdge x y . 'removeEdge' x y == 'const' False</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- hasEdge x y                  == 'elem' (x,y) . 'edgeList'</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-469"></span><span id="local-6989586621679126794"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#hasEdge"><span class="hs-identifier hs-type">hasEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126794"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126794"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126794"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126794"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-470"></span><span id="hasEdge"><span class="annot"><span class="annottext">hasEdge :: forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.NonEmpty.html#hasEdge"><span class="hs-identifier hs-var hs-var">hasEdge</span></a></span></span><span> </span><span id="local-6989586621679125994"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125994"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679125993"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125993"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679125992"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679125992"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-var">foldg1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Int
</span><a href="#local-6989586621679125991"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {t}. (Eq a, Num a) =&gt; (t -&gt; a) -&gt; (t -&gt; Int) -&gt; t -&gt; Int
</span><a href="#local-6989586621679125990"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall {t} {a} {t}.
(Eq t, Num t, Num a) =&gt;
(t -&gt; t) -&gt; (t -&gt; a) -&gt; t -&gt; a
</span><a href="#local-6989586621679125989"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679125992"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-472"></span><span>    </span><span id="local-6989586621679125991"><span class="annot"><span class="annottext">v :: a -&gt; Int -&gt; Int
</span><a href="#local-6989586621679125991"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679125988"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125988"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125988"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125994"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-473"></span><span>    </span><span class="annot"><a href="#local-6989586621679125991"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span id="local-6989586621679125987"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125987"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125987"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125993"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-474"></span><span>    </span><span id="local-6989586621679125990"><span class="annot"><span class="annottext">o :: (t -&gt; a) -&gt; (t -&gt; Int) -&gt; t -&gt; Int
</span><a href="#local-6989586621679125990"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679125976"><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679125976"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125975"><span class="annot"><span class="annottext">t -&gt; Int
</span><a href="#local-6989586621679125975"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679125974"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125974"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679125976"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125974"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-475"></span><span>        </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t -&gt; Int
</span><a href="#local-6989586621679125975"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125974"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-476"></span><span>        </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">t -&gt; Int
</span><a href="#local-6989586621679125975"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125974"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-477"></span><span>        </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-478"></span><span>    </span><span id="local-6989586621679125989"><span class="annot"><span class="annottext">c :: (t -&gt; t) -&gt; (t -&gt; a) -&gt; t -&gt; a
</span><a href="#local-6989586621679125989"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679125967"><span class="annot"><span class="annottext">t -&gt; t
</span><a href="#local-6989586621679125967"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125966"><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679125966"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679125965"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125965"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t -&gt; t
</span><a href="#local-6989586621679125967"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125965"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679125964"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125964"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679125966"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125964"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-479"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#hasEdge"><span class="hs-pragma hs-type">hasEdge</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Bool</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="hs-comment">-- | The number of vertices in a graph.</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- Complexity: /O(s * log(n))/ time.</span><span>
</span><span id="line-483"></span><span class="hs-comment">--</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- vertexCount ('vertex' x)        ==  1</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- vertexCount                   ==  'length' . 'vertexList'</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- vertexCount x \&lt; vertexCount y ==&gt; x \&lt; y</span><span>
</span><span id="line-488"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-489"></span><span id="local-6989586621679126706"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexCount"><span class="hs-identifier hs-type">vertexCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126706"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126706"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-490"></span><span id="vertexCount"><span class="annot"><span class="annottext">vertexCount :: forall a. Ord a =&gt; Graph a -&gt; Int
</span><a href="Algebra.Graph.NonEmpty.html#vertexCount"><span class="hs-identifier hs-var hs-var">vertexCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (ToGraph t, Ord (ToVertex t)) =&gt; t -&gt; Int
</span><a href="Algebra.Graph.ToGraph.html#vertexCount"><span class="hs-identifier hs-var">T.vertexCount</span></a></span><span>
</span><span id="line-491"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;vertexCount/Int&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexCount"><span class="hs-pragma hs-type">vertexCount</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexIntCount"><span class="hs-pragma hs-type">vertexIntCount</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-492"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexCount"><span class="hs-pragma hs-type">vertexCount</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-comment">-- Like 'vertexCount' but specialised for Graph with vertices of type 'Int'.</span><span>
</span><span id="line-495"></span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexIntCount"><span class="hs-identifier hs-type">vertexIntCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-496"></span><span id="vertexIntCount"><span class="annot"><span class="annottext">vertexIntCount :: Graph Int -&gt; Int
</span><a href="Algebra.Graph.NonEmpty.html#vertexIntCount"><span class="hs-identifier hs-var hs-var">vertexIntCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; Int
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">IntSet.size</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int -&gt; IntSet
</span><a href="Algebra.Graph.NonEmpty.html#vertexIntSet"><span class="hs-identifier hs-var">vertexIntSet</span></a></span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="hs-comment">-- | The number of edges in a graph.</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- Complexity: /O(s + m * log(m))/ time. Note that the number of edges /m/ of a</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- graph can be quadratic with respect to the expression size /s/.</span><span>
</span><span id="line-501"></span><span class="hs-comment">--</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- edgeCount ('vertex' x) == 0</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- edgeCount ('edge' x y) == 1</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- edgeCount            == 'length' . 'edgeList'</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-507"></span><span id="local-6989586621679125956"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeCount"><span class="hs-identifier hs-type">edgeCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125956"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125956"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-508"></span><span id="edgeCount"><span class="annot"><span class="annottext">edgeCount :: forall a. Ord a =&gt; Graph a -&gt; Int
</span><a href="Algebra.Graph.NonEmpty.html#edgeCount"><span class="hs-identifier hs-var hs-var">edgeCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (ToGraph t, Ord (ToVertex t)) =&gt; t -&gt; Int
</span><a href="Algebra.Graph.ToGraph.html#edgeCount"><span class="hs-identifier hs-var">T.edgeCount</span></a></span><span>
</span><span id="line-509"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeCount"><span class="hs-pragma hs-type">edgeCount</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-510"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;edgeCount/Int&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeCount"><span class="hs-pragma hs-type">edgeCount</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeCountInt"><span class="hs-pragma hs-type">edgeCountInt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="hs-comment">-- Like 'edgeCount' but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-513"></span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeCountInt"><span class="hs-identifier hs-type">edgeCountInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-514"></span><span id="edgeCountInt"><span class="annot"><span class="annottext">edgeCountInt :: Graph Int -&gt; Int
</span><a href="Algebra.Graph.NonEmpty.html#edgeCountInt"><span class="hs-identifier hs-var hs-var">edgeCountInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (ToGraph t, Ord (ToVertex t)) =&gt; t -&gt; Int
</span><a href="Algebra.Graph.ToGraph.html#edgeCount"><span class="hs-identifier hs-var">T.edgeCount</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. (ToGraph t, ToVertex t ~ Int) =&gt; t -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">T.toAdjacencyIntMap</span></a></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="hs-comment">-- | The sorted list of vertices of a given graph.</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- Complexity: /O(s * log(n))/ time and /O(n)/ memory.</span><span>
</span><span id="line-518"></span><span class="hs-comment">--</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- vertexList1 ('vertex' x)  == [x]</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- vertexList1 . 'vertices1' == 'Data.List.NonEmpty.nub' . 'Data.List.NonEmpty.sort'</span><span>
</span><span id="line-522"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-523"></span><span id="local-6989586621679126703"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexList1"><span class="hs-identifier hs-type">vertexList1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126703"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126703"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126703"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-524"></span><span id="vertexList1"><span class="annot"><span class="annottext">vertexList1 :: forall a. Ord a =&gt; Graph a -&gt; NonEmpty a
</span><a href="Algebra.Graph.NonEmpty.html#vertexList1"><span class="hs-identifier hs-var hs-var">vertexList1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">NonEmpty.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Set a
</span><a href="Algebra.Graph.NonEmpty.html#vertexSet"><span class="hs-identifier hs-var">vertexSet</span></a></span><span>
</span><span id="line-525"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;vertexList1/Int&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexList1"><span class="hs-pragma hs-type">vertexList1</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexIntList1"><span class="hs-pragma hs-type">vertexIntList1</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-526"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexList1"><span class="hs-pragma hs-type">vertexList1</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="hs-comment">-- | Like 'vertexList1' but specialised for Graph with vertices of type 'Int'.</span><span>
</span><span id="line-529"></span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexIntList1"><span class="hs-identifier hs-type">vertexIntList1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-530"></span><span id="vertexIntList1"><span class="annot"><span class="annottext">vertexIntList1 :: Graph Int -&gt; NonEmpty Int
</span><a href="Algebra.Graph.NonEmpty.html#vertexIntList1"><span class="hs-identifier hs-var hs-var">vertexIntList1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">NonEmpty.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; [Int]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">IntSet.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int -&gt; IntSet
</span><a href="Algebra.Graph.NonEmpty.html#vertexIntSet"><span class="hs-identifier hs-var">vertexIntSet</span></a></span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-comment">-- | The sorted list of edges of a graph.</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- Complexity: /O(s + m * log(m))/ time and /O(m)/ memory. Note that the number of</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- edges /m/ of a graph can be quadratic with respect to the expression size /s/.</span><span>
</span><span id="line-535"></span><span class="hs-comment">--</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- edgeList ('vertex' x)     == []</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- edgeList ('edge' x y)     == [(x,y)]</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- edgeList ('star' 2 [3,1]) == [(2,1), (2,3)]</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- edgeList . 'edges1'       == 'Data.List.nub' . 'Data.List.sort' . 'Data.List.NonEmpty.toList'</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- edgeList . 'transpose'    == 'Data.List.sort' . 'map' 'Data.Tuple.swap' . edgeList</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-543"></span><span id="local-6989586621679126698"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeList"><span class="hs-identifier hs-type">edgeList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126698"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126698"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126698"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679126698"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-544"></span><span id="edgeList"><span class="annot"><span class="annottext">edgeList :: forall a. Ord a =&gt; Graph a -&gt; [(a, a)]
</span><a href="Algebra.Graph.NonEmpty.html#edgeList"><span class="hs-identifier hs-var hs-var">edgeList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t.
(ToGraph t, Ord (ToVertex t)) =&gt;
t -&gt; [(ToVertex t, ToVertex t)]
</span><a href="Algebra.Graph.ToGraph.html#edgeList"><span class="hs-identifier hs-var">T.edgeList</span></a></span><span>
</span><span id="line-545"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;edgeList/Int&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeList"><span class="hs-pragma hs-type">edgeList</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeIntList"><span class="hs-pragma hs-type">edgeIntList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-546"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeList"><span class="hs-pragma hs-type">edgeList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="hs-comment">-- Like 'edgeList' but specialised for Graph with vertices of type 'Int'.</span><span>
</span><span id="line-549"></span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeIntList"><span class="hs-identifier hs-type">edgeIntList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-550"></span><span id="edgeIntList"><span class="annot"><span class="annottext">edgeIntList :: Graph Int -&gt; [Edge]
</span><a href="Algebra.Graph.NonEmpty.html#edgeIntList"><span class="hs-identifier hs-var hs-var">edgeIntList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t.
(ToGraph t, Ord (ToVertex t)) =&gt;
t -&gt; [(ToVertex t, ToVertex t)]
</span><a href="Algebra.Graph.ToGraph.html#edgeList"><span class="hs-identifier hs-var">T.edgeList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. (ToGraph t, ToVertex t ~ Int) =&gt; t -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.ToGraph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">T.toAdjacencyIntMap</span></a></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span class="hs-comment">-- | The set of vertices of a given graph.</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- Complexity: /O(s * log(n))/ time and /O(n)/ memory.</span><span>
</span><span id="line-554"></span><span class="hs-comment">--</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- vertexSet . 'vertex'    == Set.'Set.singleton'</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- vertexSet . 'vertices1' == Set.'Set.fromList' . 'Data.List.NonEmpty.toList'</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- vertexSet . 'clique1'   == Set.'Set.fromList' . 'Data.List.NonEmpty.toList'</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-560"></span><span id="local-6989586621679126699"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexSet"><span class="hs-identifier hs-type">vertexSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126699"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126699"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126699"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-561"></span><span id="vertexSet"><span class="annot"><span class="annottext">vertexSet :: forall a. Ord a =&gt; Graph a -&gt; Set a
</span><a href="Algebra.Graph.NonEmpty.html#vertexSet"><span class="hs-identifier hs-var hs-var">vertexSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (ToGraph t, Ord (ToVertex t)) =&gt; t -&gt; Set (ToVertex t)
</span><a href="Algebra.Graph.ToGraph.html#vertexSet"><span class="hs-identifier hs-var">T.vertexSet</span></a></span><span>
</span><span id="line-562"></span><span>
</span><span id="line-563"></span><span class="hs-comment">-- Like 'vertexSet' but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-564"></span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertexIntSet"><span class="hs-identifier hs-type">vertexIntSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">IntSet.IntSet</span></a></span><span>
</span><span id="line-565"></span><span id="vertexIntSet"><span class="annot"><span class="annottext">vertexIntSet :: Graph Int -&gt; IntSet
</span><a href="Algebra.Graph.NonEmpty.html#vertexIntSet"><span class="hs-identifier hs-var hs-var">vertexIntSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (ToGraph t, ToVertex t ~ Int) =&gt; t -&gt; IntSet
</span><a href="Algebra.Graph.ToGraph.html#vertexIntSet"><span class="hs-identifier hs-var">T.vertexIntSet</span></a></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-comment">-- | The set of edges of a given graph.</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- Complexity: /O(s * log(m))/ time and /O(m)/ memory.</span><span>
</span><span id="line-569"></span><span class="hs-comment">--</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-571"></span><span class="hs-comment">-- edgeSet ('vertex' x) == Set.'Set.empty'</span><span>
</span><span id="line-572"></span><span class="hs-comment">-- edgeSet ('edge' x y) == Set.'Set.singleton' (x,y)</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- edgeSet . 'edges1'   == Set.'Set.fromList' . 'Data.List.NonEmpty.toList'</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-575"></span><span id="local-6989586621679126695"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#edgeSet"><span class="hs-identifier hs-type">edgeSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126695"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126695"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126695"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679126695"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-576"></span><span id="edgeSet"><span class="annot"><span class="annottext">edgeSet :: forall a. Ord a =&gt; Graph a -&gt; Set (a, a)
</span><a href="Algebra.Graph.NonEmpty.html#edgeSet"><span class="hs-identifier hs-var hs-var">edgeSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t.
(ToGraph t, Ord (ToVertex t)) =&gt;
t -&gt; Set (ToVertex t, ToVertex t)
</span><a href="Algebra.Graph.ToGraph.html#edgeSet"><span class="hs-identifier hs-var">T.edgeSet</span></a></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="hs-comment">-- | The /path/ on a list of vertices.</span><span>
</span><span id="line-579"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-581"></span><span class="hs-comment">--</span><span>
</span><span id="line-582"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-583"></span><span class="hs-comment">-- path1 [x]       == 'vertex' x</span><span>
</span><span id="line-584"></span><span class="hs-comment">-- path1 [x,y]     == 'edge' x y</span><span>
</span><span id="line-585"></span><span class="hs-comment">-- path1 . 'Data.List.NonEmpty.reverse' == 'transpose' . path1</span><span>
</span><span id="line-586"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-587"></span><span id="local-6989586621679125930"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#path1"><span class="hs-identifier hs-type">path1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125930"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125930"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-588"></span><span id="path1"><span class="annot"><span class="annottext">path1 :: forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#path1"><span class="hs-identifier hs-var hs-var">path1</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125929"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125929"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125929"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-589"></span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#path1"><span class="hs-identifier hs-var">path1</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125928"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125928"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125927"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125927"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679125926"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125926"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty (a, a) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#edges1"><span class="hs-identifier hs-var">edges1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125928"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125927"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125927"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125926"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125926"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span class="hs-comment">-- | The /circuit/ on a list of vertices.</span><span>
</span><span id="line-592"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-593"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-594"></span><span class="hs-comment">--</span><span>
</span><span id="line-595"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- circuit1 [x]       == 'edge' x x</span><span>
</span><span id="line-597"></span><span class="hs-comment">-- circuit1 [x,y]     == 'edges1' [(x,y), (y,x)]</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- circuit1 . 'Data.List.NonEmpty.reverse' == 'transpose' . circuit1</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-600"></span><span id="local-6989586621679125925"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#circuit1"><span class="hs-identifier hs-type">circuit1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125925"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125925"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-601"></span><span id="circuit1"><span class="annot"><span class="annottext">circuit1 :: forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#circuit1"><span class="hs-identifier hs-var hs-var">circuit1</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125924"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125924"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span id="local-6989586621679125923"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125923"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#path1"><span class="hs-identifier hs-var">path1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125924"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125923"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125924"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span class="hs-comment">-- | The /clique/ on a list of vertices.</span><span>
</span><span id="line-604"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-605"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-606"></span><span class="hs-comment">--</span><span>
</span><span id="line-607"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-608"></span><span class="hs-comment">-- clique1 [x]        == 'vertex' x</span><span>
</span><span id="line-609"></span><span class="hs-comment">-- clique1 [x,y]      == 'edge' x y</span><span>
</span><span id="line-610"></span><span class="hs-comment">-- clique1 [x,y,z]    == 'edges1' [(x,y), (x,z), (y,z)]</span><span>
</span><span id="line-611"></span><span class="hs-comment">-- clique1 (xs '&lt;&gt;' ys) == 'connect' (clique1 xs) (clique1 ys)</span><span>
</span><span id="line-612"></span><span class="hs-comment">-- clique1 . 'Data.List.NonEmpty.reverse'  == 'transpose' . clique1</span><span>
</span><span id="line-613"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-614"></span><span id="local-6989586621679125922"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#clique1"><span class="hs-identifier hs-type">clique1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125922"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125922"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-615"></span><span id="clique1"><span class="annot"><span class="annottext">clique1 :: forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#clique1"><span class="hs-identifier hs-var hs-var">clique1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty (Graph a) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#connects1"><span class="hs-identifier hs-var">connects1</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span>
</span><span id="line-616"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#clique1"><span class="hs-pragma hs-type">clique1</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span class="hs-comment">-- | The /biclique/ on two lists of vertices.</span><span>
</span><span id="line-619"></span><span class="hs-comment">-- Complexity: /O(L1 + L2)/ time, memory and size, where /L1/ and /L2/ are the</span><span>
</span><span id="line-620"></span><span class="hs-comment">-- lengths of the given lists.</span><span>
</span><span id="line-621"></span><span class="hs-comment">--</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- biclique1 [x1,x2] [y1,y2] == 'edges1' [(x1,y1), (x1,y2), (x2,y1), (x2,y2)]</span><span>
</span><span id="line-624"></span><span class="hs-comment">-- biclique1 xs      ys      == 'connect' ('vertices1' xs) ('vertices1' ys)</span><span>
</span><span id="line-625"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-626"></span><span id="local-6989586621679126687"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#biclique1"><span class="hs-identifier hs-type">biclique1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126687"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126687"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126687"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-627"></span><span id="biclique1"><span class="annot"><span class="annottext">biclique1 :: forall a. NonEmpty a -&gt; NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#biclique1"><span class="hs-identifier hs-var hs-var">biclique1</span></a></span></span><span> </span><span id="local-6989586621679125920"><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679125920"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679125919"><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679125919"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#connect"><span class="hs-identifier hs-var">connect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertices1"><span class="hs-identifier hs-var">vertices1</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679125920"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertices1"><span class="hs-identifier hs-var">vertices1</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679125919"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span class="hs-comment">-- | The /star/ formed by a centre vertex connected to a list of leaves.</span><span>
</span><span id="line-630"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-631"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-632"></span><span class="hs-comment">--</span><span>
</span><span id="line-633"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-634"></span><span class="hs-comment">-- star x []    == 'vertex' x</span><span>
</span><span id="line-635"></span><span class="hs-comment">-- star x [y]   == 'edge' x y</span><span>
</span><span id="line-636"></span><span class="hs-comment">-- star x [y,z] == 'edges1' [(x,y), (x,z)]</span><span>
</span><span id="line-637"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-638"></span><span id="local-6989586621679126685"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#star"><span class="hs-identifier hs-type">star</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679126685"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679126685"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126685"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-639"></span><span id="star"><span class="annot"><span class="annottext">star :: forall a. a -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#star"><span class="hs-identifier hs-var hs-var">star</span></a></span></span><span> </span><span id="local-6989586621679125918"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125918"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125918"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-640"></span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#star"><span class="hs-identifier hs-var">star</span></a></span><span> </span><span id="local-6989586621679125917"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125917"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125916"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125916"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679125915"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125915"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#connect"><span class="hs-identifier hs-var">connect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125917"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertices1"><span class="hs-identifier hs-var">vertices1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125916"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125915"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#star"><span class="hs-pragma hs-type">star</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span class="hs-comment">-- | The /stars/ formed by overlaying a non-empty list of 'star's.</span><span>
</span><span id="line-644"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the total size of the</span><span>
</span><span id="line-645"></span><span class="hs-comment">-- input.</span><span>
</span><span id="line-646"></span><span class="hs-comment">--</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- stars1 [(x, [] )]               == 'vertex' x</span><span>
</span><span id="line-649"></span><span class="hs-comment">-- stars1 [(x, [y])]               == 'edge' x y</span><span>
</span><span id="line-650"></span><span class="hs-comment">-- stars1 [(x, ys )]               == 'star' x ys</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- stars1                          == 'overlays1' . 'fmap' ('uncurry' 'star')</span><span>
</span><span id="line-652"></span><span class="hs-comment">-- 'overlay' (stars1 xs) (stars1 ys) == stars1 (xs '&lt;&gt;' ys)</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-654"></span><span id="local-6989586621679126683"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#stars1"><span class="hs-identifier hs-type">stars1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126683"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679126683"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126683"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-655"></span><span id="stars1"><span class="annot"><span class="annottext">stars1 :: forall a. NonEmpty (a, [a]) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#stars1"><span class="hs-identifier hs-var hs-var">stars1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty (Graph a) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlays1"><span class="hs-identifier hs-var">overlays1</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#star"><span class="hs-identifier hs-var">star</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#stars1"><span class="hs-pragma hs-type">stars1</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span class="hs-comment">-- | The /tree graph/ constructed from a given 'Tree.Tree' data structure.</span><span>
</span><span id="line-659"></span><span class="hs-comment">-- Complexity: /O(T)/ time, memory and size, where /T/ is the size of the</span><span>
</span><span id="line-660"></span><span class="hs-comment">-- given tree (i.e. the number of vertices in the tree).</span><span>
</span><span id="line-661"></span><span class="hs-comment">--</span><span>
</span><span id="line-662"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-663"></span><span class="hs-comment">-- tree (Node x [])                                         == 'vertex' x</span><span>
</span><span id="line-664"></span><span class="hs-comment">-- tree (Node x [Node y [Node z []]])                       == 'path1' [x,y,z]</span><span>
</span><span id="line-665"></span><span class="hs-comment">-- tree (Node x [Node y [], Node z []])                     == 'star' x [y,z]</span><span>
</span><span id="line-666"></span><span class="hs-comment">-- tree (Node 1 [Node 2 [], Node 3 [Node 4 [], Node 5 []]]) == 'edges1' [(1,2), (1,3), (3,4), (3,5)]</span><span>
</span><span id="line-667"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-668"></span><span id="local-6989586621679126681"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#tree"><span class="hs-identifier hs-type">tree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Tree.Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126681"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126681"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-669"></span><span id="tree"><span class="annot"><span class="annottext">tree :: forall a. Tree a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#tree"><span class="hs-identifier hs-var hs-var">tree</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Tree.Node</span></a></span><span> </span><span id="local-6989586621679125912"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125912"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125911"><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679125911"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty (Graph a) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlays1"><span class="hs-identifier hs-var">overlays1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#star"><span class="hs-identifier hs-var">star</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125912"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Tree a -&gt; a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Tree.rootLabel</span></a></span><span> </span><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679125911"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Tree a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#tree"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679125911"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span class="hs-comment">-- | Construct a /mesh graph/ from two lists of vertices.</span><span>
</span><span id="line-672"></span><span class="hs-comment">-- Complexity: /O(L1 * L2)/ time, memory and size, where /L1/ and /L2/ are the</span><span>
</span><span id="line-673"></span><span class="hs-comment">-- lengths of the given lists.</span><span>
</span><span id="line-674"></span><span class="hs-comment">--</span><span>
</span><span id="line-675"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-676"></span><span class="hs-comment">-- mesh1 [x]     [y]        == 'vertex' (x, y)</span><span>
</span><span id="line-677"></span><span class="hs-comment">-- mesh1 xs      ys         == 'box' ('path1' xs) ('path1' ys)</span><span>
</span><span id="line-678"></span><span class="hs-comment">-- mesh1 [1,2,3] [\'a\', \'b\'] == 'edges1' [ ((1,\'a\'),(1,\'b\')), ((1,\'a\'),(2,\'a\'))</span><span>
</span><span id="line-679"></span><span class="hs-comment">--                                    , ((1,\'b\'),(2,\'b\')), ((2,\'a\'),(2,\'b\'))</span><span>
</span><span id="line-680"></span><span class="hs-comment">--                                    , ((2,\'a\'),(3,\'a\')), ((2,\'b\'),(3,\'b\'))</span><span>
</span><span id="line-681"></span><span class="hs-comment">--                                    , ((3,\'a\'),(3,\'b\')) ]</span><span>
</span><span id="line-682"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-683"></span><span id="local-6989586621679126674"><span id="local-6989586621679126675"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#mesh1"><span class="hs-identifier hs-type">mesh1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126675"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126674"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126675"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679126674"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-684"></span><span id="mesh1"><span class="annot"><span class="annottext">mesh1 :: forall a b. NonEmpty a -&gt; NonEmpty b -&gt; Graph (a, b)
</span><a href="Algebra.Graph.NonEmpty.html#mesh1"><span class="hs-identifier hs-var hs-var">mesh1</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125901"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125901"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679125900"><span class="annot"><span class="annottext">NonEmpty b
</span><a href="#local-6989586621679125900"><span class="hs-identifier hs-var">ys</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125901"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#path1"><span class="hs-identifier hs-var">path1</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty b
</span><a href="#local-6989586621679125900"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-685"></span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#mesh1"><span class="hs-identifier hs-var">mesh1</span></a></span><span> </span><span id="local-6989586621679125899"><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679125899"><span class="hs-identifier hs-var">xs</span></a></span></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679125898"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125898"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125898"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#path1"><span class="hs-identifier hs-var">path1</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679125899"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-686"></span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#mesh1"><span class="hs-identifier hs-var">mesh1</span></a></span><span> </span><span id="local-6989586621679125897"><span class="annot"><span class="annottext">xs :: NonEmpty a
</span><a href="#local-6989586621679125897"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679125896"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125896"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span id="local-6989586621679125895"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125895"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679125894"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125894"><span class="hs-identifier hs-var">xt</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679125893"><span class="annot"><span class="annottext">ys :: NonEmpty b
</span><a href="#local-6989586621679125893"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679125892"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125892"><span class="hs-identifier hs-var">y1</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span id="local-6989586621679125891"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125891"><span class="hs-identifier hs-var">y2</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679125890"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679125890"><span class="hs-identifier hs-var">yt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-687"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679125889"><span class="annot"><span class="annottext">star :: a -&gt; a -&gt; a -&gt; Graph a
</span><a href="#local-6989586621679125889"><span class="hs-identifier hs-var hs-var">star</span></a></span></span><span> </span><span id="local-6989586621679125888"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125888"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679125887"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125887"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679125886"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125886"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125888"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-operator hs-var">`overlay`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125887"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#connect"><span class="hs-operator hs-var">`connect`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125886"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-688"></span><span>        </span><span id="local-6989586621679125885"><span class="annot"><span class="annottext">innerStars :: Graph (a, b)
</span><a href="#local-6989586621679125885"><span class="hs-identifier hs-var hs-var">innerStars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty (Graph a) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlays1"><span class="hs-identifier hs-var">overlays1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-689"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679125884"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125884"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679125883"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125883"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. NonEmpty a -&gt; NonEmpty b -&gt; NonEmpty (a, b)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">NonEmpty.zip</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679125897"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125895"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125894"><span class="hs-identifier hs-var">xt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679125881"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125881"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679125880"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125880"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. NonEmpty a -&gt; NonEmpty b -&gt; NonEmpty (a, b)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">NonEmpty.zip</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty b
</span><a href="#local-6989586621679125893"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125891"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679125890"><span class="hs-identifier hs-var">yt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span>                </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. a -&gt; a -&gt; a -&gt; Graph a
</span><a href="#local-6989586621679125889"><span class="hs-identifier hs-var">star</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125884"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125880"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125883"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125881"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125883"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125880"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-693"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125896"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#path1"><span class="hs-identifier hs-var">path1</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty b
</span><a href="#local-6989586621679125893"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-operator hs-var">`overlay`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125892"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#path1"><span class="hs-identifier hs-var">path1</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679125897"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-operator hs-var">`overlay`</span></a></span><span> </span><span class="annot"><span class="annottext">Graph (a, b)
</span><a href="#local-6989586621679125885"><span class="hs-identifier hs-var">innerStars</span></a></span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span class="hs-comment">-- | Construct a /torus graph/ from two lists of vertices.</span><span>
</span><span id="line-696"></span><span class="hs-comment">-- Complexity: /O(L1 * L2)/ time, memory and size, where /L1/ and /L2/ are the</span><span>
</span><span id="line-697"></span><span class="hs-comment">-- lengths of the given lists.</span><span>
</span><span id="line-698"></span><span class="hs-comment">--</span><span>
</span><span id="line-699"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-700"></span><span class="hs-comment">-- torus1 [x]   [y]        == 'edge' (x,y) (x,y)</span><span>
</span><span id="line-701"></span><span class="hs-comment">-- torus1 xs    ys         == 'box' ('circuit1' xs) ('circuit1' ys)</span><span>
</span><span id="line-702"></span><span class="hs-comment">-- torus1 [1,2] [\'a\', \'b\'] == 'edges1' [ ((1,\'a\'),(1,\'b\')), ((1,\'a\'),(2,\'a\'))</span><span>
</span><span id="line-703"></span><span class="hs-comment">--                                   , ((1,\'b\'),(1,\'a\')), ((1,\'b\'),(2,\'b\'))</span><span>
</span><span id="line-704"></span><span class="hs-comment">--                                   , ((2,\'a\'),(1,\'a\')), ((2,\'a\'),(2,\'b\'))</span><span>
</span><span id="line-705"></span><span class="hs-comment">--                                   , ((2,\'b\'),(1,\'b\')), ((2,\'b\'),(2,\'a\')) ]</span><span>
</span><span id="line-706"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-707"></span><span id="local-6989586621679125878"><span id="local-6989586621679125879"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#torus1"><span class="hs-identifier hs-type">torus1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125879"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125878"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679125879"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679125878"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-708"></span><span id="torus1"><span class="annot"><span class="annottext">torus1 :: forall a b. NonEmpty a -&gt; NonEmpty b -&gt; Graph (a, b)
</span><a href="Algebra.Graph.NonEmpty.html#torus1"><span class="hs-identifier hs-var hs-var">torus1</span></a></span></span><span> </span><span id="local-6989586621679125874"><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679125874"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679125873"><span class="annot"><span class="annottext">NonEmpty b
</span><a href="#local-6989586621679125873"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty (a, [a]) -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#stars1"><span class="hs-identifier hs-var">stars1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-709"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679125872"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125872"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679125871"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125871"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; NonEmpty (a, a)
</span><a href="#local-6989586621679125870"><span class="hs-identifier hs-var">pairs1</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679125874"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-710"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679125869"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125869"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679125868"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125868"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; NonEmpty (a, a)
</span><a href="#local-6989586621679125870"><span class="hs-identifier hs-var">pairs1</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty b
</span><a href="#local-6989586621679125873"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-711"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125872"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125869"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125872"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125868"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125871"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125869"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-713"></span><span>    </span><span class="hs-comment">-- Turn a non-empty list into a cycle and return pairs of neighbours</span><span>
</span><span id="line-714"></span><span>    </span><span id="local-6989586621679126666"><span class="annot"><a href="#local-6989586621679125870"><span class="hs-identifier hs-type">pairs1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126666"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126666"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679126666"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-715"></span><span>    </span><span id="local-6989586621679125870"><span class="annot"><span class="annottext">pairs1 :: forall a. NonEmpty a -&gt; NonEmpty (a, a)
</span><a href="#local-6989586621679125870"><span class="hs-identifier hs-var hs-var">pairs1</span></a></span></span><span> </span><span id="local-6989586621679125867"><span class="annot"><span class="annottext">as :: NonEmpty a
</span><a href="#local-6989586621679125867"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679125866"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125866"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span id="local-6989586621679125865"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125865"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. NonEmpty a -&gt; NonEmpty b -&gt; NonEmpty (a, b)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">NonEmpty.zip</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679125867"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-716"></span><span>        </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125866"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; [a] -&gt; NonEmpty a
</span><a href="#local-6989586621679125864"><span class="hs-operator hs-var">`append1`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125866"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">NonEmpty.nonEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125865"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>    </span><span class="hs-comment">-- Append a list to a non-empty one</span><span>
</span><span id="line-718"></span><span>    </span><span id="local-6989586621679126664"><span class="annot"><a href="#local-6989586621679125864"><span class="hs-identifier hs-type">append1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126664"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679126664"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126664"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-719"></span><span>    </span><span id="local-6989586621679125864"><span class="annot"><span class="annottext">append1 :: forall a. NonEmpty a -&gt; [a] -&gt; NonEmpty a
</span><a href="#local-6989586621679125864"><span class="hs-identifier hs-var hs-var">append1</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679125862"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125862"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span id="local-6989586621679125861"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125861"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679125860"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125860"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125862"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125861"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125860"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>
</span><span id="line-721"></span><span class="hs-comment">-- | Remove a vertex from a given graph. Returns @Nothing@ if the resulting</span><span>
</span><span id="line-722"></span><span class="hs-comment">-- graph is empty.</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-724"></span><span class="hs-comment">--</span><span>
</span><span id="line-725"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-726"></span><span class="hs-comment">-- removeVertex1 x ('vertex' x)          == Nothing</span><span>
</span><span id="line-727"></span><span class="hs-comment">-- removeVertex1 1 ('vertex' 2)          == Just ('vertex' 2)</span><span>
</span><span id="line-728"></span><span class="hs-comment">-- removeVertex1 x ('edge' x x)          == Nothing</span><span>
</span><span id="line-729"></span><span class="hs-comment">-- removeVertex1 1 ('edge' 1 2)          == Just ('vertex' 2)</span><span>
</span><span id="line-730"></span><span class="hs-comment">-- removeVertex1 x '&gt;=&gt;' removeVertex1 x == removeVertex1 x</span><span>
</span><span id="line-731"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-732"></span><span id="local-6989586621679126661"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#removeVertex1"><span class="hs-identifier hs-type">removeVertex1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126661"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126661"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126661"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126661"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-733"></span><span id="removeVertex1"><span class="annot"><span class="annottext">removeVertex1 :: forall a. Eq a =&gt; a -&gt; Graph a -&gt; Maybe (Graph a)
</span><a href="Algebra.Graph.NonEmpty.html#removeVertex1"><span class="hs-identifier hs-var hs-var">removeVertex1</span></a></span></span><span> </span><span id="local-6989586621679125857"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125857"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Graph a -&gt; Maybe (Graph a)
</span><a href="Algebra.Graph.NonEmpty.html#induce1"><span class="hs-identifier hs-var">induce1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125857"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-734"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#removeVertex1"><span class="hs-pragma hs-type">removeVertex1</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-pragma hs-type">Maybe</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-735"></span><span>
</span><span id="line-736"></span><span class="hs-comment">-- | Remove an edge from a given graph.</span><span>
</span><span id="line-737"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-738"></span><span class="hs-comment">--</span><span>
</span><span id="line-739"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-740"></span><span class="hs-comment">-- removeEdge x y ('edge' x y)       == 'vertices1' [x,y]</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- removeEdge x y . removeEdge x y == removeEdge x y</span><span>
</span><span id="line-742"></span><span class="hs-comment">-- removeEdge 1 1 (1 * 1 * 2 * 2)  == 1 * 2 * 2</span><span>
</span><span id="line-743"></span><span class="hs-comment">-- removeEdge 1 2 (1 * 1 * 2 * 2)  == 1 * 1 + 2 * 2</span><span>
</span><span id="line-744"></span><span class="hs-comment">-- 'size' (removeEdge x y z)         &lt;= 3 * 'size' z</span><span>
</span><span id="line-745"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-746"></span><span id="local-6989586621679126658"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#removeEdge"><span class="hs-identifier hs-type">removeEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126658"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126658"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126658"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126658"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126658"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-747"></span><span id="removeEdge"><span class="annot"><span class="annottext">removeEdge :: forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#removeEdge"><span class="hs-identifier hs-var hs-var">removeEdge</span></a></span></span><span> </span><span id="local-6989586621679125851"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125851"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679125850"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125850"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
Eq a =&gt;
a -&gt; (a -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#filterContext"><span class="hs-identifier hs-var">filterContext</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125851"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125851"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125850"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-748"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#removeEdge"><span class="hs-pragma hs-type">removeEdge</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-749"></span><span>
</span><span id="line-750"></span><span class="hs-comment">-- TODO: Export</span><span>
</span><span id="line-751"></span><span id="local-6989586621679126656"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#filterContext"><span class="hs-identifier hs-type">filterContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126656"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126656"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126656"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126656"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126656"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126656"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-752"></span><span id="filterContext"><span class="annot"><span class="annottext">filterContext :: forall a.
Eq a =&gt;
a -&gt; (a -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#filterContext"><span class="hs-identifier hs-var hs-var">filterContext</span></a></span></span><span> </span><span id="local-6989586621679125843"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125843"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679125842"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679125842"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679125841"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679125841"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679125840"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679125840"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679125840"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Context a -&gt; Graph a
</span><a href="#local-6989586621679125839"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Graph a -&gt; Maybe (Context a)
</span><a href="Algebra.Graph.html#context"><span class="hs-identifier hs-var">G.context</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125843"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. ToGraph t =&gt; t -&gt; Graph (ToVertex t)
</span><a href="Algebra.Graph.ToGraph.html#toGraph"><span class="hs-identifier hs-var">T.toGraph</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679125840"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-754"></span><span>    </span><span id="local-6989586621679125839"><span class="annot"><span class="annottext">go :: Context a -&gt; Graph a
</span><a href="#local-6989586621679125839"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Context"><span class="hs-identifier hs-type">G.Context</span></a></span><span> </span><span id="local-6989586621679125835"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125835"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621679125834"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125834"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#induce"><span class="hs-identifier hs-var">G.induce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125843"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. ToGraph t =&gt; t -&gt; Graph (ToVertex t)
</span><a href="Algebra.Graph.ToGraph.html#toGraph"><span class="hs-identifier hs-var">T.toGraph</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679125840"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay1"><span class="hs-operator hs-var">`overlay1`</span></a></span><span>
</span><span id="line-755"></span><span>                           </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#star"><span class="hs-identifier hs-var">star</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125843"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679125842"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125835"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-operator hs-var">`overlay`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#star"><span class="hs-identifier hs-var">star</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125843"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679125841"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679125834"><span class="hs-identifier hs-var">os</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#filterContext"><span class="hs-pragma hs-type">filterContext</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Bool</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Bool</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span class="hs-comment">-- | The function 'replaceVertex' @x y@ replaces vertex @x@ with vertex @y@ in a</span><span>
</span><span id="line-759"></span><span class="hs-comment">-- given 'Graph'. If @y@ already exists, @x@ and @y@ will be merged.</span><span>
</span><span id="line-760"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-761"></span><span class="hs-comment">--</span><span>
</span><span id="line-762"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-763"></span><span class="hs-comment">-- replaceVertex x x            == id</span><span>
</span><span id="line-764"></span><span class="hs-comment">-- replaceVertex x y ('vertex' x) == 'vertex' y</span><span>
</span><span id="line-765"></span><span class="hs-comment">-- replaceVertex x y            == 'mergeVertices' (== x) y</span><span>
</span><span id="line-766"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-767"></span><span id="local-6989586621679125832"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#replaceVertex"><span class="hs-identifier hs-type">replaceVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125832"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125832"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679125832"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125832"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125832"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-768"></span><span id="replaceVertex"><span class="annot"><span class="annottext">replaceVertex :: forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#replaceVertex"><span class="hs-identifier hs-var hs-var">replaceVertex</span></a></span></span><span> </span><span id="local-6989586621679125828"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125828"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679125827"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125827"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679125826"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125826"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125826"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125828"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125827"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125826"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-769"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#replaceVertex"><span class="hs-pragma hs-type">replaceVertex</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-770"></span><span>
</span><span id="line-771"></span><span class="hs-comment">-- | Merge vertices satisfying a given predicate into a given vertex.</span><span>
</span><span id="line-772"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size, assuming that the predicate takes</span><span>
</span><span id="line-773"></span><span class="hs-comment">-- constant time.</span><span>
</span><span id="line-774"></span><span class="hs-comment">--</span><span>
</span><span id="line-775"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-776"></span><span class="hs-comment">-- mergeVertices ('const' False) x    == id</span><span>
</span><span id="line-777"></span><span class="hs-comment">-- mergeVertices (== x) y           == 'replaceVertex' x y</span><span>
</span><span id="line-778"></span><span class="hs-comment">-- mergeVertices 'even' 1 (0 * 2)     == 1 * 1</span><span>
</span><span id="line-779"></span><span class="hs-comment">-- mergeVertices 'odd'  1 (3 + 4 * 5) == 4 * 1</span><span>
</span><span id="line-780"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-781"></span><span id="local-6989586621679126648"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#mergeVertices"><span class="hs-identifier hs-type">mergeVertices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126648"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126648"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126648"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126648"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-782"></span><span id="mergeVertices"><span class="annot"><span class="annottext">mergeVertices :: forall a. (a -&gt; Bool) -&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#mergeVertices"><span class="hs-identifier hs-var hs-var">mergeVertices</span></a></span></span><span> </span><span id="local-6989586621679125824"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679125824"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679125823"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125823"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679125822"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125822"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679125824"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125822"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125823"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125822"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-783"></span><span>
</span><span id="line-784"></span><span class="hs-comment">-- | Split a vertex into a list of vertices with the same connectivity.</span><span>
</span><span id="line-785"></span><span class="hs-comment">-- Complexity: /O(s + k * L)/ time, memory and size, where /k/ is the number of</span><span>
</span><span id="line-786"></span><span class="hs-comment">-- occurrences of the vertex in the expression and /L/ is the length of the</span><span>
</span><span id="line-787"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-788"></span><span class="hs-comment">--</span><span>
</span><span id="line-789"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-790"></span><span class="hs-comment">-- splitVertex1 x [x]                 == id</span><span>
</span><span id="line-791"></span><span class="hs-comment">-- splitVertex1 x [y]                 == 'replaceVertex' x y</span><span>
</span><span id="line-792"></span><span class="hs-comment">-- splitVertex1 1 [0,1] $ 1 * (2 + 3) == (0 + 1) * (2 + 3)</span><span>
</span><span id="line-793"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-794"></span><span id="local-6989586621679126646"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#splitVertex1"><span class="hs-identifier hs-type">splitVertex1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126646"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126646"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126646"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126646"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126646"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-795"></span><span id="splitVertex1"><span class="annot"><span class="annottext">splitVertex1 :: forall a. Eq a =&gt; a -&gt; NonEmpty a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#splitVertex1"><span class="hs-identifier hs-var hs-var">splitVertex1</span></a></span></span><span> </span><span id="local-6989586621679125818"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125818"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679125817"><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679125817"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span id="local-6989586621679125816"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679125816"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679125816"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679125815"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125815"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125815"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125818"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertices1"><span class="hs-identifier hs-var">vertices1</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679125817"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125815"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-796"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#splitVertex1"><span class="hs-pragma hs-type">splitVertex1</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-pragma hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-797"></span><span>
</span><span id="line-798"></span><span class="hs-comment">-- | Transpose a given graph.</span><span>
</span><span id="line-799"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-800"></span><span class="hs-comment">--</span><span>
</span><span id="line-801"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-802"></span><span class="hs-comment">-- transpose ('vertex' x)  == 'vertex' x</span><span>
</span><span id="line-803"></span><span class="hs-comment">-- transpose ('edge' x y)  == 'edge' y x</span><span>
</span><span id="line-804"></span><span class="hs-comment">-- transpose . transpose == id</span><span>
</span><span id="line-805"></span><span class="hs-comment">-- transpose ('box' x y)   == 'box' (transpose x) (transpose y)</span><span>
</span><span id="line-806"></span><span class="hs-comment">-- 'edgeList' . transpose  == 'Data.List.sort' . 'map' 'Data.Tuple.swap' . 'edgeList'</span><span>
</span><span id="line-807"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-808"></span><span id="local-6989586621679126651"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-identifier hs-type">transpose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126651"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126651"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-809"></span><span id="transpose"><span class="annot"><span class="annottext">transpose :: forall a. Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-identifier hs-var hs-var">transpose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-var">foldg1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#connect"><span class="hs-identifier hs-var">connect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-810"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-811"></span><span>
</span><span id="line-812"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-813"></span><span class="annot"><span class="hs-pragma">&quot;transpose/Vertex&quot;</span></span><span>   </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679125813"><span class="annot"><a href="#local-6989586621679125813"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-pragma hs-type">Vertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125813"><span class="hs-pragma hs-type">x</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-pragma hs-type">Vertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125813"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-814"></span><span class="annot"><span class="hs-pragma">&quot;transpose/Overlay&quot;</span></span><span>  </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679125812"><span class="annot"><a href="#local-6989586621679125812"><span class="hs-pragma hs-var">g1</span></a></span></span><span> </span><span id="local-6989586621679125811"><span class="annot"><a href="#local-6989586621679125811"><span class="hs-pragma hs-var">g2</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Overlay"><span class="hs-pragma hs-type">Overlay</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125812"><span class="hs-pragma hs-type">g1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125811"><span class="hs-pragma hs-type">g2</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Overlay"><span class="hs-pragma hs-type">Overlay</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125812"><span class="hs-pragma hs-type">g1</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125811"><span class="hs-pragma hs-type">g2</span></a></span><span class="hs-pragma">)</span><span>
</span><span id="line-815"></span><span class="annot"><span class="hs-pragma">&quot;transpose/Connect&quot;</span></span><span>  </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679125810"><span class="annot"><a href="#local-6989586621679125810"><span class="hs-pragma hs-var">g1</span></a></span></span><span> </span><span id="local-6989586621679125809"><span class="annot"><a href="#local-6989586621679125809"><span class="hs-pragma hs-var">g2</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Connect"><span class="hs-pragma hs-type">Connect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125810"><span class="hs-pragma hs-type">g1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125809"><span class="hs-pragma hs-type">g2</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Connect"><span class="hs-pragma hs-type">Connect</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125809"><span class="hs-pragma hs-type">g2</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125810"><span class="hs-pragma hs-type">g1</span></a></span><span class="hs-pragma">)</span><span>
</span><span id="line-816"></span><span>
</span><span id="line-817"></span><span class="annot"><span class="hs-pragma">&quot;transpose/overlays1&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679125808"><span class="annot"><a href="#local-6989586621679125808"><span class="hs-pragma hs-var">xs</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#overlays1"><span class="hs-pragma hs-type">overlays1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125808"><span class="hs-pragma hs-type">xs</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#overlays1"><span class="hs-pragma hs-type">overlays1</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-pragma hs-type">fmap</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125808"><span class="hs-pragma hs-type">xs</span></a></span><span class="hs-pragma">)</span><span>
</span><span id="line-818"></span><span class="annot"><span class="hs-pragma">&quot;transpose/connects1&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679125807"><span class="annot"><a href="#local-6989586621679125807"><span class="hs-pragma hs-var">xs</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#connects1"><span class="hs-pragma hs-type">connects1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125807"><span class="hs-pragma hs-type">xs</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#connects1"><span class="hs-pragma hs-type">connects1</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-pragma hs-type">NonEmpty.reverse</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-pragma hs-type">fmap</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125807"><span class="hs-pragma hs-type">xs</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span>
</span><span id="line-819"></span><span>
</span><span id="line-820"></span><span class="annot"><span class="hs-pragma">&quot;transpose/vertices1&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679125805"><span class="annot"><a href="#local-6989586621679125805"><span class="hs-pragma hs-var">xs</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertices1"><span class="hs-pragma hs-type">vertices1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125805"><span class="hs-pragma hs-type">xs</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#vertices1"><span class="hs-pragma hs-type">vertices1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125805"><span class="hs-pragma hs-type">xs</span></a></span><span>
</span><span id="line-821"></span><span class="annot"><span class="hs-pragma">&quot;transpose/clique1&quot;</span></span><span>   </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679125804"><span class="annot"><a href="#local-6989586621679125804"><span class="hs-pragma hs-var">xs</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#clique1"><span class="hs-pragma hs-type">clique1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125804"><span class="hs-pragma hs-type">xs</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#clique1"><span class="hs-pragma hs-type">clique1</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-pragma hs-type">NonEmpty.reverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679125804"><span class="hs-pragma hs-type">xs</span></a></span><span class="hs-pragma">)</span><span>
</span><span id="line-822"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-823"></span><span>
</span><span id="line-824"></span><span class="hs-comment">-- | Construct the /induced subgraph/ of a given graph by removing the</span><span>
</span><span id="line-825"></span><span class="hs-comment">-- vertices that do not satisfy a given predicate. Returns @Nothing@ if the</span><span>
</span><span id="line-826"></span><span class="hs-comment">-- resulting graph is empty.</span><span>
</span><span id="line-827"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size, assuming that the predicate takes</span><span>
</span><span id="line-828"></span><span class="hs-comment">-- constant time.</span><span>
</span><span id="line-829"></span><span class="hs-comment">--</span><span>
</span><span id="line-830"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-831"></span><span class="hs-comment">-- induce1 ('const' True ) x == Just x</span><span>
</span><span id="line-832"></span><span class="hs-comment">-- induce1 ('const' False) x == Nothing</span><span>
</span><span id="line-833"></span><span class="hs-comment">-- induce1 (/= x)          == 'removeVertex1' x</span><span>
</span><span id="line-834"></span><span class="hs-comment">-- induce1 p '&gt;=&gt;' induce1 q == induce1 (\\x -&gt; p x &amp;&amp; q x)</span><span>
</span><span id="line-835"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-836"></span><span id="local-6989586621679126659"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#induce1"><span class="hs-identifier hs-type">induce1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126659"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126659"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126659"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-837"></span><span id="induce1"><span class="annot"><span class="annottext">induce1 :: forall a. (a -&gt; Bool) -&gt; Graph a -&gt; Maybe (Graph a)
</span><a href="Algebra.Graph.NonEmpty.html#induce1"><span class="hs-identifier hs-var hs-var">induce1</span></a></span></span><span> </span><span id="local-6989586621679125802"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679125802"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph (Maybe a) -&gt; Maybe (Graph a)
</span><a href="Algebra.Graph.NonEmpty.html#induceJust1"><span class="hs-identifier hs-var">induceJust1</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679125801"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125801"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679125802"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125801"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125801"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span class="hs-comment">-- | Construct the /induced subgraph/ of a given graph by removing the vertices</span><span>
</span><span id="line-840"></span><span class="hs-comment">-- that are 'Nothing'. Returns 'Nothing' if the resulting graph is empty.</span><span>
</span><span id="line-841"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-842"></span><span class="hs-comment">--</span><span>
</span><span id="line-843"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-844"></span><span class="hs-comment">-- induceJust1 ('vertex' 'Nothing')                               == 'Nothing'</span><span>
</span><span id="line-845"></span><span class="hs-comment">-- induceJust1 ('edge' ('Just' x) 'Nothing')                        == 'Just' ('vertex' x)</span><span>
</span><span id="line-846"></span><span class="hs-comment">-- induceJust1 . 'fmap' 'Just'                                    == 'Just'</span><span>
</span><span id="line-847"></span><span class="hs-comment">-- induceJust1 . 'fmap' (\\x -&gt; if p x then 'Just' x else 'Nothing') == 'induce1' p</span><span>
</span><span id="line-848"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-849"></span><span id="local-6989586621679126640"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#induceJust1"><span class="hs-identifier hs-type">induceJust1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126640"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126640"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-850"></span><span id="induceJust1"><span class="annot"><span class="annottext">induceJust1 :: forall a. Graph (Maybe a) -&gt; Maybe (Graph a)
</span><a href="Algebra.Graph.NonEmpty.html#induceJust1"><span class="hs-identifier hs-var hs-var">induceJust1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-var">foldg1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {t}. (t -&gt; t -&gt; t) -&gt; Maybe t -&gt; Maybe t -&gt; Maybe t
</span><a href="#local-6989586621679125798"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {t}. (t -&gt; t -&gt; t) -&gt; Maybe t -&gt; Maybe t -&gt; Maybe t
</span><a href="#local-6989586621679125798"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Connect"><span class="hs-identifier hs-var">Connect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-851"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-852"></span><span>    </span><span id="local-6989586621679125798"><span class="annot"><span class="annottext">k :: (t -&gt; t -&gt; t) -&gt; Maybe t -&gt; Maybe t -&gt; Maybe t
</span><a href="#local-6989586621679125798"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe t
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span id="local-6989586621679125797"><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679125797"><span class="hs-identifier hs-var">a</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679125797"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-853"></span><span>    </span><span class="annot"><a href="#local-6989586621679125798"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679125796"><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679125796"><span class="hs-identifier hs-var">a</span></a></span></span><span>        </span><span class="annot"><span class="annottext">Maybe t
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679125796"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-854"></span><span>    </span><span class="annot"><a href="#local-6989586621679125798"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span id="local-6989586621679125795"><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><a href="#local-6989586621679125795"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679125794"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125794"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679125793"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125793"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><a href="#local-6989586621679125795"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125794"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125793"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-855"></span><span>
</span><span id="line-856"></span><span class="hs-comment">-- | Simplify a graph expression. Semantically, this is the identity function,</span><span>
</span><span id="line-857"></span><span class="hs-comment">-- but it simplifies a given expression according to the laws of the algebra.</span><span>
</span><span id="line-858"></span><span class="hs-comment">-- The function does not compute the simplest possible expression,</span><span>
</span><span id="line-859"></span><span class="hs-comment">-- but uses heuristics to obtain useful simplifications in reasonable time.</span><span>
</span><span id="line-860"></span><span class="hs-comment">-- Complexity: the function performs /O(s)/ graph comparisons. It is guaranteed</span><span>
</span><span id="line-861"></span><span class="hs-comment">-- that the size of the result does not exceed the size of the given expression.</span><span>
</span><span id="line-862"></span><span class="hs-comment">--</span><span>
</span><span id="line-863"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-864"></span><span class="hs-comment">-- simplify             ==  id</span><span>
</span><span id="line-865"></span><span class="hs-comment">-- 'size' (simplify x)    &lt;=  'size' x</span><span>
</span><span id="line-866"></span><span class="hs-comment">-- simplify 1           '===' 1</span><span>
</span><span id="line-867"></span><span class="hs-comment">-- simplify (1 + 1)     '===' 1</span><span>
</span><span id="line-868"></span><span class="hs-comment">-- simplify (1 + 2 + 1) '===' 1 + 2</span><span>
</span><span id="line-869"></span><span class="hs-comment">-- simplify (1 * 1 * 1) '===' 1 * 1</span><span>
</span><span id="line-870"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-871"></span><span id="local-6989586621679126638"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#simplify"><span class="hs-identifier hs-type">simplify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126638"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-872"></span><span id="simplify"><span class="annot"><span class="annottext">simplify :: forall a. Ord a =&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#simplify"><span class="hs-identifier hs-var hs-var">simplify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-var">foldg1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall g. Eq g =&gt; (g -&gt; g -&gt; g) -&gt; g -&gt; g -&gt; g
</span><a href="Algebra.Graph.NonEmpty.html#simple"><span class="hs-identifier hs-var">simple</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall g. Eq g =&gt; (g -&gt; g -&gt; g) -&gt; g -&gt; g -&gt; g
</span><a href="Algebra.Graph.NonEmpty.html#simple"><span class="hs-identifier hs-var">simple</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#Connect"><span class="hs-identifier hs-var">Connect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-873"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#simplify"><span class="hs-pragma hs-type">simplify</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-874"></span><span>
</span><span id="line-875"></span><span id="local-6989586621679126636"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#simple"><span class="hs-identifier hs-type">simple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126636"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126636"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126636"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126636"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126636"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126636"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679126636"><span class="hs-identifier hs-type">g</span></a></span></span><span>
</span><span id="line-876"></span><span id="simple"><span class="annot"><span class="annottext">simple :: forall g. Eq g =&gt; (g -&gt; g -&gt; g) -&gt; g -&gt; g -&gt; g
</span><a href="Algebra.Graph.NonEmpty.html#simple"><span class="hs-identifier hs-var hs-var">simple</span></a></span></span><span> </span><span id="local-6989586621679125785"><span class="annot"><span class="annottext">g -&gt; g -&gt; g
</span><a href="#local-6989586621679125785"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679125784"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679125784"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125783"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679125783"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-877"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679125784"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679125782"><span class="hs-identifier hs-var">z</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679125784"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-878"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679125783"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679125782"><span class="hs-identifier hs-var">z</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679125783"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-879"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679125782"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-880"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-881"></span><span>    </span><span id="local-6989586621679125782"><span class="annot"><span class="annottext">z :: g
</span><a href="#local-6989586621679125782"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g -&gt; g -&gt; g
</span><a href="#local-6989586621679125785"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679125784"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679125783"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-882"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#simple"><span class="hs-pragma hs-type">simple</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-883"></span><span>
</span><span id="line-884"></span><span class="hs-comment">-- | Compute the /Cartesian product/ of graphs.</span><span>
</span><span id="line-885"></span><span class="hs-comment">-- Complexity: /O(s1 * s2)/ time, memory and size, where /s1/ and /s2/ are the</span><span>
</span><span id="line-886"></span><span class="hs-comment">-- sizes of the given graphs.</span><span>
</span><span id="line-887"></span><span class="hs-comment">--</span><span>
</span><span id="line-888"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-889"></span><span class="hs-comment">-- box ('path1' [0,1]) ('path1' [\'a\',\'b\']) == 'edges1' [ ((0,\'a\'), (0,\'b\'))</span><span>
</span><span id="line-890"></span><span class="hs-comment">--                                               , ((0,\'a\'), (1,\'a\'))</span><span>
</span><span id="line-891"></span><span class="hs-comment">--                                               , ((0,\'b\'), (1,\'b\'))</span><span>
</span><span id="line-892"></span><span class="hs-comment">--                                               , ((1,\'a\'), (1,\'b\')) ]</span><span>
</span><span id="line-893"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-894"></span><span class="hs-comment">-- Up to isomorphism between the resulting vertex types, this operation is</span><span>
</span><span id="line-895"></span><span class="hs-comment">-- /commutative/, /associative/, /distributes/ over 'overlay', and has</span><span>
</span><span id="line-896"></span><span class="hs-comment">-- singleton graphs as /identities/. Below @~~@ stands for equality up to an</span><span>
</span><span id="line-897"></span><span class="hs-comment">-- isomorphism, e.g. @(x,@ @()) ~~ x@.</span><span>
</span><span id="line-898"></span><span class="hs-comment">--</span><span>
</span><span id="line-899"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-900"></span><span class="hs-comment">-- box x y               ~~ box y x</span><span>
</span><span id="line-901"></span><span class="hs-comment">-- box x (box y z)       ~~ box (box x y) z</span><span>
</span><span id="line-902"></span><span class="hs-comment">-- box x ('overlay' y z)   == 'overlay' (box x y) (box x z)</span><span>
</span><span id="line-903"></span><span class="hs-comment">-- box x ('vertex' ())     ~~ x</span><span>
</span><span id="line-904"></span><span class="hs-comment">-- 'transpose'   (box x y) == box ('transpose' x) ('transpose' y)</span><span>
</span><span id="line-905"></span><span class="hs-comment">-- 'vertexCount' (box x y) == 'vertexCount' x * 'vertexCount' y</span><span>
</span><span id="line-906"></span><span class="hs-comment">-- 'edgeCount'   (box x y) &lt;= 'vertexCount' x * 'edgeCount' y + 'edgeCount' x * 'vertexCount' y</span><span>
</span><span id="line-907"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-908"></span><span id="local-6989586621679126633"><span id="local-6989586621679126634"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#box"><span class="hs-identifier hs-type">box</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126634"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126633"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679126634"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679126633"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-909"></span><span id="box"><span class="annot"><span class="annottext">box :: forall a b. Graph a -&gt; Graph b -&gt; Graph (a, b)
</span><a href="Algebra.Graph.NonEmpty.html#box"><span class="hs-identifier hs-var hs-var">box</span></a></span></span><span> </span><span id="local-6989586621679125779"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679125779"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125778"><span class="annot"><span class="annottext">Graph b
</span><a href="#local-6989586621679125778"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph (b -&gt; (a, b))
</span><a href="#local-6989586621679125777"><span class="hs-identifier hs-var">fx</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Graph b
</span><a href="#local-6989586621679125778"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph (a -&gt; (a, b))
</span><a href="#local-6989586621679125776"><span class="hs-identifier hs-var">fy</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679125779"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-910"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-911"></span><span>    </span><span id="local-6989586621679125777"><span class="annot"><span class="annottext">fx :: Graph (b -&gt; (a, b))
</span><a href="#local-6989586621679125777"><span class="hs-identifier hs-var hs-var">fx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-var">foldg1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span>      </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679125779"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-912"></span><span>    </span><span id="local-6989586621679125776"><span class="annot"><span class="annottext">fy :: Graph (a -&gt; (a, b))
</span><a href="#local-6989586621679125776"><span class="hs-identifier hs-var hs-var">fy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-var">foldg1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">Graph b
</span><a href="#local-6989586621679125778"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-913"></span><span>
</span><span id="line-914"></span><span class="hs-comment">-- | /Sparsify/ a graph by adding intermediate 'Left' @Int@ vertices between the</span><span>
</span><span id="line-915"></span><span class="hs-comment">-- original vertices (wrapping the latter in 'Right') such that the resulting</span><span>
</span><span id="line-916"></span><span class="hs-comment">-- graph is /sparse/, i.e. contains only /O(s)/ edges, but preserves the</span><span>
</span><span id="line-917"></span><span class="hs-comment">-- reachability relation between the original vertices. Sparsification is useful</span><span>
</span><span id="line-918"></span><span class="hs-comment">-- when working with dense graphs, as it can reduce the number of edges from</span><span>
</span><span id="line-919"></span><span class="hs-comment">-- /O(n^2)/ down to /O(n)/ by replacing cliques, bicliques and similar densely</span><span>
</span><span id="line-920"></span><span class="hs-comment">-- connected structures by sparse subgraphs built out of intermediate vertices.</span><span>
</span><span id="line-921"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-922"></span><span class="hs-comment">--</span><span>
</span><span id="line-923"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-924"></span><span class="hs-comment">-- 'Data.List.sort' . 'Algebra.Graph.ToGraph.reachable' x       == 'Data.List.sort' . 'Data.Either.rights' . 'Algebra.Graph.ToGraph.reachable' (sparsify x) . 'Data.Either.Right'</span><span>
</span><span id="line-925"></span><span class="hs-comment">-- 'vertexCount' (sparsify x) &lt;= 'vertexCount' x + 'size' x + 1</span><span>
</span><span id="line-926"></span><span class="hs-comment">-- 'edgeCount'   (sparsify x) &lt;= 3 * 'size' x</span><span>
</span><span id="line-927"></span><span class="hs-comment">-- 'size'        (sparsify x) &lt;= 3 * 'size' x</span><span>
</span><span id="line-928"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-929"></span><span id="local-6989586621679126630"><span class="annot"><a href="Algebra.Graph.NonEmpty.html#sparsify"><span class="hs-identifier hs-type">sparsify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126630"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679126630"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-930"></span><span id="sparsify"><span class="annot"><span class="annottext">sparsify :: forall a. Graph a -&gt; Graph (Either Int a)
</span><a href="Algebra.Graph.NonEmpty.html#sparsify"><span class="hs-identifier hs-var hs-var">sparsify</span></a></span></span><span> </span><span id="local-6989586621679125769"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679125769"><span class="hs-identifier hs-var">graph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph (Either Int a)
</span><a href="#local-6989586621679125768"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-931"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-932"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679125768"><span class="annot"><span class="annottext">Graph (Either Int a)
</span><a href="#local-6989586621679125768"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679125767"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679125767"><span class="hs-identifier hs-var">end</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s a. State s a -&gt; s -&gt; (a, s)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-var">foldg1</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {b} {a}.
Monad m =&gt;
b -&gt; a -&gt; a -&gt; m (Graph (Either a b))
</span><a href="#local-6989586621679125765"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *} {t} {t} {a}.
Applicative f =&gt;
(t -&gt; t -&gt; f (Graph a))
-&gt; (t -&gt; t -&gt; f (Graph a)) -&gt; t -&gt; t -&gt; f (Graph a)
</span><a href="#local-6989586621679125764"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {t} {t} {a} {t}.
(Monad m, Num t) =&gt;
(t -&gt; t -&gt; StateT t m (Graph a))
-&gt; (t -&gt; t -&gt; StateT t m (Graph a))
-&gt; t
-&gt; t
-&gt; StateT t m (Graph a)
</span><a href="#local-6989586621679125763"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679125769"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679125767"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-933"></span><span>    </span><span id="local-6989586621679125765"><span class="annot"><span class="annottext">v :: b -&gt; a -&gt; a -&gt; m (Graph (Either a b))
</span><a href="#local-6989586621679125765"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679125760"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125760"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span id="local-6989586621679125759"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125759"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679125758"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125758"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#clique1"><span class="hs-identifier hs-var">clique1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125759"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125760"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679125758"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-934"></span><span>    </span><span id="local-6989586621679125764"><span class="annot"><span class="annottext">o :: (t -&gt; t -&gt; f (Graph a))
-&gt; (t -&gt; t -&gt; f (Graph a)) -&gt; t -&gt; t -&gt; f (Graph a)
</span><a href="#local-6989586621679125764"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679125752"><span class="annot"><span class="annottext">t -&gt; t -&gt; f (Graph a)
</span><a href="#local-6989586621679125752"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125751"><span class="annot"><span class="annottext">t -&gt; t -&gt; f (Graph a)
</span><a href="#local-6989586621679125751"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679125750"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125750"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679125749"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125749"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125750"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; f (Graph a)
</span><a href="#local-6989586621679125752"><span class="hs-operator hs-var">`x`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125749"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125750"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; f (Graph a)
</span><a href="#local-6989586621679125751"><span class="hs-operator hs-var">`y`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125749"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-935"></span><span>    </span><span id="local-6989586621679125763"><span class="annot"><span class="annottext">c :: (t -&gt; t -&gt; StateT t m (Graph a))
-&gt; (t -&gt; t -&gt; StateT t m (Graph a))
-&gt; t
-&gt; t
-&gt; StateT t m (Graph a)
</span><a href="#local-6989586621679125763"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679125732"><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m (Graph a)
</span><a href="#local-6989586621679125732"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125731"><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m (Graph a)
</span><a href="#local-6989586621679125731"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679125730"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125730"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679125729"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125729"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-936"></span><span>        </span><span id="local-6989586621679125728"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125728"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-937"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125728"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-938"></span><span>        </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.NonEmpty.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125730"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m (Graph a)
</span><a href="#local-6989586621679125732"><span class="hs-operator hs-var">`x`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125728"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125728"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m (Graph a)
</span><a href="#local-6989586621679125731"><span class="hs-operator hs-var">`y`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125729"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-939"></span><span>
</span><span id="line-940"></span><span class="hs-comment">-- | Sparsify a graph whose vertices are integers in the range @[1..n]@, where</span><span>
</span><span id="line-941"></span><span class="hs-comment">-- @n@ is the first argument of the function, producing an array-based graph</span><span>
</span><span id="line-942"></span><span class="hs-comment">-- representation from &quot;Data.Graph&quot; (introduced by King and Launchbury, hence</span><span>
</span><span id="line-943"></span><span class="hs-comment">-- the name of the function). In the resulting graph, vertices @[1..n]@</span><span>
</span><span id="line-944"></span><span class="hs-comment">-- correspond to the original vertices, and all vertices greater than @n@ are</span><span>
</span><span id="line-945"></span><span class="hs-comment">-- introduced by the sparsification procedure.</span><span>
</span><span id="line-946"></span><span class="hs-comment">--</span><span>
</span><span id="line-947"></span><span class="hs-comment">-- Complexity: /O(s)/ time and memory. Note that thanks to sparsification, the</span><span>
</span><span id="line-948"></span><span class="hs-comment">-- resulting graph has a linear number of edges with respect to the size of the</span><span>
</span><span id="line-949"></span><span class="hs-comment">-- original algebraic representation even though the latter can potentially</span><span>
</span><span id="line-950"></span><span class="hs-comment">-- contain a quadratic /O(s^2)/ number of edges.</span><span>
</span><span id="line-951"></span><span class="hs-comment">--</span><span>
</span><span id="line-952"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-953"></span><span class="hs-comment">-- 'Data.List.sort' . 'Algebra.Graph.ToGraph.reachable' x                 == 'Data.List.sort' . 'filter' (&lt;= n) . 'Data.Graph.reachable' (sparsifyKL n x)</span><span>
</span><span id="line-954"></span><span class="hs-comment">-- 'length' ('Data.Graph.vertices' $ sparsifyKL n x) &lt;= 'vertexCount' x + 'size' x + 1</span><span>
</span><span id="line-955"></span><span class="hs-comment">-- 'length' ('Data.Graph.edges'    $ sparsifyKL n x) &lt;= 3 * 'size' x</span><span>
</span><span id="line-956"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-957"></span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#sparsifyKL"><span class="hs-identifier hs-type">sparsifyKL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.NonEmpty.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">KL.Graph</span></a></span><span>
</span><span id="line-958"></span><span id="sparsifyKL"><span class="annot"><span class="annottext">sparsifyKL :: Int -&gt; Graph Int -&gt; Graph
</span><a href="Algebra.Graph.NonEmpty.html#sparsifyKL"><span class="hs-identifier hs-var hs-var">sparsifyKL</span></a></span></span><span> </span><span id="local-6989586621679125725"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679125725"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679125724"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679125724"><span class="hs-identifier hs-var">graph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Edge -&gt; [Edge] -&gt; Graph
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">KL.buildG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679125722"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679125725"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679125725"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Exts.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List Edge
</span><a href="#local-6989586621679125721"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Internal.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">KL.Edge</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-959"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-960"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679125721"><span class="annot"><span class="annottext">List Edge
</span><a href="#local-6989586621679125721"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679125722"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679125722"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s a. State s a -&gt; s -&gt; (a, s)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.NonEmpty.html#foldg1"><span class="hs-identifier hs-var">foldg1</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {b} {m :: * -&gt; *}.
(Item a ~ (b, b), Monad m, IsList a) =&gt;
b -&gt; b -&gt; b -&gt; m a
</span><a href="#local-6989586621679125720"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *} {b} {t} {t}.
(Applicative f, Semigroup b) =&gt;
(t -&gt; t -&gt; f b) -&gt; (t -&gt; t -&gt; f b) -&gt; t -&gt; t -&gt; f b
</span><a href="#local-6989586621679125719"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall {b} {t} {m :: * -&gt; *}.
(Item b ~ (t, t), Monad m, Num t, Semigroup b, IsList b) =&gt;
(t -&gt; t -&gt; StateT t m b)
-&gt; (t -&gt; t -&gt; StateT t m b) -&gt; t -&gt; t -&gt; StateT t m b
</span><a href="#local-6989586621679125718"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679125724"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679125725"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679125725"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679125725"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-961"></span><span>    </span><span id="local-6989586621679125720"><span class="annot"><span class="annottext">v :: b -&gt; b -&gt; b -&gt; m a
</span><a href="#local-6989586621679125720"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679125711"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125711"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span id="local-6989586621679125710"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125710"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679125709"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125709"><span class="hs-identifier hs-var">t</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; [Item l] -&gt; l
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Exts.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125710"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125711"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125711"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125709"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-962"></span><span>    </span><span id="local-6989586621679125719"><span class="annot"><span class="annottext">o :: (t -&gt; t -&gt; f b) -&gt; (t -&gt; t -&gt; f b) -&gt; t -&gt; t -&gt; f b
</span><a href="#local-6989586621679125719"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679125702"><span class="annot"><span class="annottext">t -&gt; t -&gt; f b
</span><a href="#local-6989586621679125702"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125701"><span class="annot"><span class="annottext">t -&gt; t -&gt; f b
</span><a href="#local-6989586621679125701"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679125700"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125700"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679125699"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125699"><span class="hs-identifier hs-var">t</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(&lt;&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125700"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; f b
</span><a href="#local-6989586621679125702"><span class="hs-operator hs-var">`x`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125699"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125700"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; f b
</span><a href="#local-6989586621679125701"><span class="hs-operator hs-var">`y`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125699"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-963"></span><span>    </span><span id="local-6989586621679125718"><span class="annot"><span class="annottext">c :: (t -&gt; t -&gt; StateT t m b)
-&gt; (t -&gt; t -&gt; StateT t m b) -&gt; t -&gt; t -&gt; StateT t m b
</span><a href="#local-6989586621679125718"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679125677"><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m b
</span><a href="#local-6989586621679125677"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679125676"><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m b
</span><a href="#local-6989586621679125676"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679125675"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125675"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679125674"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125674"><span class="hs-identifier hs-var">t</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-964"></span><span>        </span><span id="local-6989586621679125673"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125673"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-965"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125673"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-966"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679125672"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125672"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679125671"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125671"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; [Item l] -&gt; l
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Exts.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125675"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125673"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125673"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125674"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125672"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679125671"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125675"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m b
</span><a href="#local-6989586621679125677"><span class="hs-operator hs-var">`x`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125673"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125673"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m b
</span><a href="#local-6989586621679125676"><span class="hs-operator hs-var">`y`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679125674"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-967"></span></pre></body></html>