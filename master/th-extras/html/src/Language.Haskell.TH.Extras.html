<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP, TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Extras</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../syb/html/src"><span class="hs-identifier">Data.Generics</span></a></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier">Language.Haskell.TH</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../th-abstraction/html/src"><span class="hs-identifier">Language.Haskell.TH.Datatype.TyVarBndr</span></a></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#intIs64"><span class="hs-identifier hs-type">intIs64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-14"></span><span id="intIs64"><span class="annot"><span class="annottext">intIs64 :: Bool
</span><a href="Language.Haskell.TH.Extras.html#intIs64"><span class="hs-identifier hs-var hs-var">intIs64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Integer
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span id="local-6989586621679042612"><span class="annot"><a href="Language.Haskell.TH.Extras.html#replace"><span class="hs-identifier hs-type">replace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679042612"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679042612"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679042612"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679042612"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-17"></span><span id="replace"><span class="annot"><span class="annottext">replace :: forall a. (a -&gt; Maybe a) -&gt; a -&gt; a
</span><a href="Language.Haskell.TH.Extras.html#replace"><span class="hs-identifier hs-var hs-var">replace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">ap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#composeExprs"><span class="hs-identifier hs-type">composeExprs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ExpQ</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ExpQ</span></a></span><span>
</span><span id="line-20"></span><span id="composeExprs"><span class="annot"><span class="annottext">composeExprs :: [ExpQ] -&gt; ExpQ
</span><a href="Language.Haskell.TH.Extras.html#composeExprs"><span class="hs-identifier hs-var hs-var">composeExprs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span> </span><span class="hs-identifier">id</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-21"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#composeExprs"><span class="hs-identifier hs-var">composeExprs</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679042474"><span class="annot"><span class="annottext">ExpQ
</span><a href="#local-6989586621679042474"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExpQ
</span><a href="#local-6989586621679042474"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-22"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#composeExprs"><span class="hs-identifier hs-var">composeExprs</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679042473"><span class="annot"><span class="annottext">ExpQ
</span><a href="#local-6989586621679042473"><span class="hs-identifier hs-var">f</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679042472"><span class="annot"><span class="annottext">[ExpQ]
</span><a href="#local-6989586621679042472"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span> </span><span class="hs-special">$</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="hs-identifier">composeExprs</span><span> </span><span class="hs-identifier">fs</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-comment">-- | Determines the name of a data constructor. It's an error if the 'Con' binds more than one name (which</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- happens in the case where you use GADT syntax, and give multiple data constructor names separated by commas</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- in a type signature in the where clause).</span><span>
</span><span id="line-27"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#nameOfCon"><span class="hs-identifier hs-type">nameOfCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-28"></span><span id="nameOfCon"><span class="annot"><span class="annottext">nameOfCon :: Con -&gt; Name
</span><a href="Language.Haskell.TH.Extras.html#nameOfCon"><span class="hs-identifier hs-var hs-var">nameOfCon</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">NormalC</span></a></span><span>  </span><span id="local-6989586621679042469"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042469"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042469"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-29"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#nameOfCon"><span class="hs-identifier hs-var">nameOfCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">RecC</span></a></span><span>     </span><span id="local-6989586621679042467"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042467"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042467"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-30"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#nameOfCon"><span class="hs-identifier hs-var">nameOfCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">InfixC</span></a></span><span> </span><span class="annot"><span class="annottext">BangType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042465"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042465"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">BangType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042465"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-31"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#nameOfCon"><span class="hs-identifier hs-var">nameOfCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ForallC</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042463"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679042463"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Con -&gt; Name
</span><a href="Language.Haskell.TH.Extras.html#nameOfCon"><span class="hs-identifier hs-var">nameOfCon</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679042463"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-cpp">
#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 800
</span><span class="annot"><a href="Language.Haskell.TH.Extras.html#nameOfCon"><span class="hs-identifier hs-var">nameOfCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">GadtC</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679042461"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042461"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042461"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-34"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#nameOfCon"><span class="hs-identifier hs-var">nameOfCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">GadtC</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;nameOfCon: GadtC: only single constructor names are supported&quot;</span></span><span>
</span><span id="line-35"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#nameOfCon"><span class="hs-identifier hs-var">nameOfCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">RecGadtC</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679042458"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042458"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042458"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-36"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#nameOfCon"><span class="hs-identifier hs-var">nameOfCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">RecGadtC</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;nameOfCon: RecGadtC: only single constructor names are supported&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- |WARNING: discards binders in GADTs and existentially-quantified constructors</span><span>
</span><span id="line-40"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#argTypesOfCon"><span class="hs-identifier hs-type">argTypesOfCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-41"></span><span id="argTypesOfCon"><span class="annot"><span class="annottext">argTypesOfCon :: Con -&gt; Cxt
</span><a href="Language.Haskell.TH.Extras.html#argTypesOfCon"><span class="hs-identifier hs-var hs-var">argTypesOfCon</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">NormalC</span></a></span><span>  </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042456"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679042456"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679042456"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-42"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#argTypesOfCon"><span class="hs-identifier hs-var">argTypesOfCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">RecC</span></a></span><span>     </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042455"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679042455"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042454"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bang
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679042454"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042454"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679042455"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-43"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#argTypesOfCon"><span class="hs-identifier hs-var">argTypesOfCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">InfixC</span></a></span><span> </span><span id="local-6989586621679042453"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679042453"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042452"><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679042452"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679042453"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679042452"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-44"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#argTypesOfCon"><span class="hs-identifier hs-var">argTypesOfCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ForallC</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042451"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679042451"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Con -&gt; Cxt
</span><a href="Language.Haskell.TH.Extras.html#argTypesOfCon"><span class="hs-identifier hs-var">argTypesOfCon</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679042451"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-cpp">
#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 800
</span><span class="annot"><a href="Language.Haskell.TH.Extras.html#argTypesOfCon"><span class="hs-identifier hs-var">argTypesOfCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">GadtC</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042450"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679042450"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679042450"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-47"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#argTypesOfCon"><span class="hs-identifier hs-var">argTypesOfCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">RecGadtC</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042449"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679042449"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042448"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bang
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679042448"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042448"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679042449"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-50"></span><span id="local-6989586621679042592"><span class="annot"><a href="Language.Haskell.TH.Extras.html#nameOfBinder"><span class="hs-identifier hs-type">nameOfBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../th-abstraction/html/src"><span class="hs-identifier hs-type">TyVarBndr_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679042592"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span></span><span>
</span><span id="line-51"></span><span id="nameOfBinder"><span class="annot"><span class="annottext">nameOfBinder :: forall a. TyVarBndr_ a -&gt; Name
</span><a href="Language.Haskell.TH.Extras.html#nameOfBinder"><span class="hs-identifier hs-var hs-var">nameOfBinder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. TyVarBndr_ a -&gt; Name
</span><a href="../../../../th-abstraction/html/src"><span class="hs-identifier hs-var">tvName</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#varsBoundInCon"><span class="hs-identifier hs-type">varsBoundInCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">TyVarBndrSpec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-54"></span><span id="varsBoundInCon"><span class="annot"><span class="annottext">varsBoundInCon :: Con -&gt; [TyVarBndr Specificity]
</span><a href="Language.Haskell.TH.Extras.html#varsBoundInCon"><span class="hs-identifier hs-var hs-var">varsBoundInCon</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ForallC</span></a></span><span> </span><span id="local-6989586621679042444"><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679042444"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042443"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679042443"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679042444"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Con -&gt; [TyVarBndr Specificity]
</span><a href="Language.Haskell.TH.Extras.html#varsBoundInCon"><span class="hs-identifier hs-var">varsBoundInCon</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679042443"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-55"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#varsBoundInCon"><span class="hs-identifier hs-var">varsBoundInCon</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-type">namesBoundInPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-58"></span><span id="namesBoundInPat"><span class="annot"><span class="annottext">namesBoundInPat :: Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var hs-var">namesBoundInPat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">VarP</span></a></span><span> </span><span id="local-6989586621679042440"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042440"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042440"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-59"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">TupP</span></a></span><span> </span><span id="local-6989586621679042438"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679042438"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679042438"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span class="hs-cpp">
#if MIN_VERSION_template_haskell(2,18,0)
</span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042436"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679042436"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679042436"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">namesBoundInPat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ConP</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">pats</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pats</span><span> </span><span class="hs-operator">&gt;&gt;=</span><span> </span><span class="hs-identifier">namesBoundInPat</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">InfixP</span></a></span><span> </span><span id="local-6989586621679042434"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042434"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042433"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042433"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042434"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042433"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-66"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">TildeP</span></a></span><span> </span><span id="local-6989586621679042431"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042431"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042431"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-67"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">AsP</span></a></span><span> </span><span id="local-6989586621679042429"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042429"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679042428"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042428"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042429"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042428"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-68"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">RecP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042426"><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679042426"><span class="hs-identifier hs-var">fieldPats</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679042426"><span class="hs-identifier hs-var">fieldPats</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span>
</span><span id="line-69"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ListP</span></a></span><span> </span><span id="local-6989586621679042424"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679042424"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679042424"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span>
</span><span id="line-70"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">SigP</span></a></span><span> </span><span id="local-6989586621679042422"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042422"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042422"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-cpp">

#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 612
</span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">BangP</span></a></span><span> </span><span id="local-6989586621679042420"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042420"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042420"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 700
</span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ViewP</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042418"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042418"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042418"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 702
</span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">UnboxedTupP</span></a></span><span> </span><span id="local-6989586621679042416"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679042416"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679042416"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-84"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier">_</span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInDec"><span class="hs-identifier hs-type">namesBoundInDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Dec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-88"></span><span id="namesBoundInDec"><span class="annot"><span class="annottext">namesBoundInDec :: Dec -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInDec"><span class="hs-identifier hs-var hs-var">namesBoundInDec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">FunD</span></a></span><span> </span><span id="local-6989586621679042413"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042413"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042413"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInDec"><span class="hs-identifier hs-var">namesBoundInDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ValD</span></a></span><span> </span><span id="local-6989586621679042411"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042411"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">Body
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInPat"><span class="hs-identifier hs-var">namesBoundInPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679042411"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-cpp">

#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 800
</span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInDec"><span class="hs-identifier hs-var">namesBoundInDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">DataD</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042409"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042409"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042409"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-93"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInDec"><span class="hs-identifier hs-var">namesBoundInDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">NewtypeD</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042407"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042407"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Con
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042407"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">namesBoundInDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">name</span><span class="hs-special">]</span><span>
</span><span id="line-96"></span><span class="hs-identifier">namesBoundInDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">name</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-99"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInDec"><span class="hs-identifier hs-var">namesBoundInDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">TySynD</span></a></span><span> </span><span id="local-6989586621679042405"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042405"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042405"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-100"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInDec"><span class="hs-identifier hs-var">namesBoundInDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ClassD</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042403"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042403"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[FunDep]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042403"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-101"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInDec"><span class="hs-identifier hs-var">namesBoundInDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ForeignD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ImportF</span></a></span><span> </span><span class="annot"><span class="annottext">Callconv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Safety
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042400"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042400"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042400"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span class="hs-cpp">

#if defined(__GLASGOW_HASKELL__)
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInDec"><span class="hs-identifier hs-var">namesBoundInDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">OpenTypeFamilyD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">TypeFamilyHead</span></a></span><span> </span><span id="local-6989586621679042397"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042397"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042397"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-106"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInDec"><span class="hs-identifier hs-var">namesBoundInDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ClosedTypeFamilyD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">TypeFamilyHead</span></a></span><span> </span><span id="local-6989586621679042395"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042395"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TySynEqn]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042395"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt;= 612
</span><span class="hs-identifier">namesBoundInDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">name</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span><span>
</span><span id="line-112"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#namesBoundInDec"><span class="hs-identifier hs-var">namesBoundInDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><span class="hs-identifier">_</span></span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#genericalizeName"><span class="hs-identifier hs-type">genericalizeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-115"></span><span id="genericalizeName"><span class="annot"><span class="annottext">genericalizeName :: Name -&gt; Name
</span><a href="Language.Haskell.TH.Extras.html#genericalizeName"><span class="hs-identifier hs-var hs-var">genericalizeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Name
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">mkName</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Char]
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">nameBase</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">-- Genericalize all names defined at the top level, to fix the lunacy introduced in GHC 7.2.</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- Why they should be fresh is beyond me; it really seems absurd because there is no way whatsoever</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- to refer to names known to be bound in [d||] quotes other than to scrounge around inside the</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- generated 'Dec's.</span><span>
</span><span id="line-121"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#genericalizeDecs"><span class="hs-identifier hs-type">genericalizeDecs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Dec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Dec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span id="genericalizeDecs"><span class="annot"><span class="annottext">genericalizeDecs :: [Dec] -&gt; [Dec]
</span><a href="Language.Haskell.TH.Extras.html#genericalizeDecs"><span class="hs-identifier hs-var hs-var">genericalizeDecs</span></a></span></span><span> </span><span id="local-6989586621679042390"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679042390"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Data a =&gt; a -&gt; a) -&gt; forall a. Data a =&gt; a -&gt; a
</span><a href="../../../../syb/html/src"><span class="hs-identifier hs-var">everywhere</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Typeable a, Typeable b) =&gt; (b -&gt; b) -&gt; a -&gt; a
</span><a href="../../../../syb/html/src"><span class="hs-identifier hs-var">mkT</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="#local-6989586621679042382"><span class="hs-identifier hs-var">fixName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679042390"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>        </span><span class="hs-comment">-- get all names bound in the decs and make them generic</span><span>
</span><span id="line-125"></span><span>        </span><span class="hs-comment">-- at every occurrence in decs.</span><span>
</span><span id="line-126"></span><span>        </span><span id="local-6989586621679042380"><span class="annot"><span class="annottext">names :: [Name]
</span><a href="#local-6989586621679042380"><span class="hs-identifier hs-var hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679042390"><span class="hs-identifier hs-var">decs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; [Name]
</span><a href="Language.Haskell.TH.Extras.html#namesBoundInDec"><span class="hs-identifier hs-var">namesBoundInDec</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span id="local-6989586621679042379"><span class="annot"><span class="annottext">genericalizedNames :: [(Name, Name)]
</span><a href="#local-6989586621679042379"><span class="hs-identifier hs-var hs-var">genericalizedNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042378"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="Language.Haskell.TH.Extras.html#genericalizeName"><span class="hs-identifier hs-var">genericalizeName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042378"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679042378"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042378"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679042380"><span class="hs-identifier hs-var">names</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>        </span><span id="local-6989586621679042382"><span class="annot"><span class="annottext">fixName :: Name -&gt; Name
</span><a href="#local-6989586621679042382"><span class="hs-identifier hs-var hs-var">fixName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Maybe a) -&gt; a -&gt; a
</span><a href="Language.Haskell.TH.Extras.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`lookup`</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, Name)]
</span><a href="#local-6989586621679042379"><span class="hs-identifier hs-var">genericalizedNames</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-type">headOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-131"></span><span id="headOfType"><span class="annot"><span class="annottext">headOfType :: Type -&gt; Name
</span><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-var hs-var">headOfType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ForallT</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042373"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042373"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Name
</span><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-var">headOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042373"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-132"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-var">headOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">VarT</span></a></span><span> </span><span id="local-6989586621679042371"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042371"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042371"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-133"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-var">headOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ConT</span></a></span><span> </span><span id="local-6989586621679042369"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042369"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042369"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-134"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-var">headOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">TupleT</span></a></span><span> </span><span id="local-6989586621679042367"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042367"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">tupleTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042367"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-var">headOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">ArrowT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-var">headOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">ListT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">''</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-137"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-var">headOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span id="local-6989586621679042362"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042362"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Name
</span><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-var">headOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042362"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-cpp">
#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 612
</span><span class="annot"><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-var">headOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">SigT</span></a></span><span> </span><span id="local-6989586621679042360"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042360"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Name
</span><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-var">headOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042360"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 702
</span><span class="annot"><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-var">headOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">UnboxedTupleT</span></a></span><span> </span><span id="local-6989586621679042358"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042358"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">unboxedTupleTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042358"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if defined (__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 704
</span><span class="annot"><a href="Language.Haskell.TH.Extras.html#headOfType"><span class="hs-identifier hs-var">headOfType</span></a></span><span> </span><span id="local-6989586621679042356"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042356"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;headOfType: Unhandled type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042356"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-148"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#occursInType"><span class="hs-identifier hs-type">occursInType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-149"></span><span id="occursInType"><span class="annot"><span class="annottext">occursInType :: Name -&gt; Type -&gt; Bool
</span><a href="Language.Haskell.TH.Extras.html#occursInType"><span class="hs-identifier hs-var hs-var">occursInType</span></a></span></span><span> </span><span id="local-6989586621679042353"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042353"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621679042352"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042352"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042352"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ForallT</span></a></span><span> </span><span id="local-6989586621679042351"><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679042351"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042350"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042350"><span class="hs-identifier hs-var">ty'</span></a></span></span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042353"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. TyVarBndr_ a -&gt; Name
</span><a href="../../../../th-abstraction/html/src"><span class="hs-identifier hs-var">tvName</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679042351"><span class="hs-identifier hs-var">bndrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-154"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Bool
</span><a href="Language.Haskell.TH.Extras.html#occursInType"><span class="hs-identifier hs-var">occursInType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042353"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042350"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">VarT</span></a></span><span> </span><span id="local-6989586621679042348"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042348"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-156"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042348"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042353"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-157"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span id="local-6989586621679042347"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042347"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679042346"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042346"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Bool
</span><a href="Language.Haskell.TH.Extras.html#occursInType"><span class="hs-identifier hs-var">occursInType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042353"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042347"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Bool
</span><a href="Language.Haskell.TH.Extras.html#occursInType"><span class="hs-identifier hs-var">occursInType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042353"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042346"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-cpp">
#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 612
</span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">SigT</span></a></span><span> </span><span id="local-6989586621679042344"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042344"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Bool
</span><a href="Language.Haskell.TH.Extras.html#occursInType"><span class="hs-identifier hs-var">occursInType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042353"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042344"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-cpp">
#endif
</span><span>        </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Assuming that we're building an instance of the form C (T v_1 ... v_(n-1)) for some GADT T, this function</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- takes a list of the variables v_1 ... v_(n-1) used in the instance head, as well as the result type of some data</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- constructor, say T x_1 ... x_(n-1) x_n, as well as the type t of some argument to it, and substitutes any of</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- x_i (1 &lt;= i &lt;= n-1) occurring in t for the corresponding v_i, taking care to avoid name capture by foralls in t.</span><span>
</span><span id="line-168"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#substVarsWith"><span class="hs-identifier hs-type">substVarsWith</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Names of variables used in the instance head in argument order</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-comment">-- Result type of constructor</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-comment">-- Type of argument to the constructor</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-comment">-- Type of argument with variables substituted for instance head variables.</span><span>
</span><span id="line-173"></span><span id="substVarsWith"><span class="annot"><span class="annottext">substVarsWith :: [Name] -&gt; Type -&gt; Type -&gt; Type
</span><a href="Language.Haskell.TH.Extras.html#substVarsWith"><span class="hs-identifier hs-var hs-var">substVarsWith</span></a></span></span><span> </span><span id="local-6989586621679042342"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679042342"><span class="hs-identifier hs-var">topVars</span></a></span></span><span> </span><span id="local-6989586621679042341"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042341"><span class="hs-identifier hs-var">resultType</span></a></span></span><span> </span><span id="local-6989586621679042340"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042340"><span class="hs-identifier hs-var">argType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; Type -&gt; Type
</span><a href="#local-6989586621679042339"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042340"><span class="hs-identifier hs-var">argType</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621679042337"><span class="annot"><span class="annottext">topVars' :: [Name]
</span><a href="#local-6989586621679042337"><span class="hs-identifier hs-var hs-var">topVars'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679042342"><span class="hs-identifier hs-var">topVars</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span id="local-6989586621679042335"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042335"><span class="hs-identifier hs-var">resultType'</span></a></span></span><span> </span><span id="local-6989586621679042334"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042334"><span class="hs-identifier hs-var">_indexType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042341"><span class="hs-identifier hs-var">resultType</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><a href="#local-6989586621679042339"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621679042339"><span class="annot"><span class="annottext">subst :: Set Name -&gt; Type -&gt; Type
</span><a href="#local-6989586621679042339"><span class="hs-identifier hs-var hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621679042333"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679042333"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621679042332"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042332"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042332"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-179"></span><span>      </span><span class="hs-comment">-- Several of the following cases could all be covered by an &quot;x -&gt; x&quot; case, but</span><span>
</span><span id="line-180"></span><span>      </span><span class="hs-comment">-- I'd rather know if new cases need to be handled specially in future versions</span><span>
</span><span id="line-181"></span><span>      </span><span class="hs-comment">-- of Template Haskell.</span><span class="hs-cpp">
#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 710
</span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ForallT</span></a></span><span> </span><span id="local-6989586621679042331"><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679042331"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span id="local-6989586621679042330"><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679042330"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679042329"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042329"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679042326"><span class="annot"><span class="annottext">bs' :: Set Name
</span><a href="#local-6989586621679042326"><span class="hs-identifier hs-var hs-var">bs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679042333"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. TyVarBndr_ a -&gt; Name
</span><a href="../../../../th-abstraction/html/src"><span class="hs-identifier hs-var">tvName</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679042331"><span class="hs-identifier hs-var">bndrs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity] -&gt; Cxt -&gt; Type -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">ForallT</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679042331"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; Type -&gt; Type
</span><a href="#local-6989586621679042339"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679042326"><span class="hs-identifier hs-var">bs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679042330"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; Type -&gt; Type
</span><a href="#local-6989586621679042339"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679042326"><span class="hs-identifier hs-var">bs'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042329"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-identifier">ForallT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;substVarsWith: ForallT substitutions have not been implemented for GHCs prior to 7.10&quot;</span><span class="hs-cpp">
#endif
</span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span id="local-6989586621679042323"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042323"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679042322"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042322"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">AppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; Type -&gt; Type
</span><a href="#local-6989586621679042339"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679042333"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042323"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; Type -&gt; Type
</span><a href="#local-6989586621679042339"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679042333"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042322"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">SigT</span></a></span><span> </span><span id="local-6989586621679042321"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042321"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679042320"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042320"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">SigT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; Type -&gt; Type
</span><a href="#local-6989586621679042339"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679042333"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042321"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042320"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-191"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">VarT</span></a></span><span> </span><span id="local-6989586621679042319"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042319"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.member</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042319"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679042333"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-192"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">VarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042319"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-193"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">VarT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Name -&gt; [a] -&gt; Type -&gt; a
</span><a href="#local-6989586621679042317"><span class="hs-identifier hs-var">findVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042319"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679042337"><span class="hs-identifier hs-var">topVars'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042335"><span class="hs-identifier hs-var">resultType'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ConT</span></a></span><span> </span><span id="local-6989586621679042316"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042316"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">ConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042316"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-195"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">TupleT</span></a></span><span> </span><span id="local-6989586621679042315"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042315"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">TupleT</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042315"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-196"></span><span>      </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">ArrowT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">ArrowT</span></a></span><span>
</span><span id="line-197"></span><span>      </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">ListT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">ListT</span></a></span><span class="hs-cpp">
#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 800
</span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">InfixT</span></a></span><span> </span><span id="local-6989586621679042313"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042313"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679042312"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042312"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679042311"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042311"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Name -&gt; Type -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">InfixT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; Type -&gt; Type
</span><a href="#local-6989586621679042339"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679042333"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042313"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042312"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; Type -&gt; Type
</span><a href="#local-6989586621679042339"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679042333"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042311"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ParensT</span></a></span><span> </span><span id="local-6989586621679042309"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042309"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">ParensT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; Type -&gt; Type
</span><a href="#local-6989586621679042339"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679042333"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042309"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">UInfixT</span></a></span><span> </span><span id="local-6989586621679042307"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042307"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679042306"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042306"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679042305"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042305"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Name -&gt; Type -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">UInfixT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; Type -&gt; Type
</span><a href="#local-6989586621679042339"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679042333"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042307"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042306"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; Type -&gt; Type
</span><a href="#local-6989586621679042339"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679042333"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042305"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>      </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">WildCardT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">WildCardT</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 802
</span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">UnboxedSumT</span></a></span><span> </span><span id="local-6989586621679042302"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042302"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">UnboxedSumT</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042302"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if defined (__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 710
</span><span>      </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">EqualityT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">EqualityT</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if defined (__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 706
</span><span>      </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">ConstraintT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">ConstraintT</span></a></span><span>
</span><span id="line-212"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">LitT</span></a></span><span> </span><span id="local-6989586621679042298"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621679042298"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">LitT</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621679042298"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-213"></span><span>      </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">PromotedConsT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">PromotedConsT</span></a></span><span>
</span><span id="line-214"></span><span>      </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">PromotedNilT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">PromotedNilT</span></a></span><span>
</span><span id="line-215"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">PromotedT</span></a></span><span> </span><span id="local-6989586621679042294"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042294"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">PromotedT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042294"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-216"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">PromotedTupleT</span></a></span><span> </span><span id="local-6989586621679042292"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042292"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">PromotedTupleT</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042292"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">StarT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">StarT</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if defined (__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt; 700
</span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">UnboxedTupleT</span></a></span><span> </span><span id="local-6989586621679042290"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042290"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">UnboxedTupleT</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042290"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-cpp">
#endif
</span><span>    </span><span id="local-6989586621679042317"><span class="annot"><span class="annottext">findVar :: Name -&gt; [a] -&gt; Type -&gt; a
</span><a href="#local-6989586621679042317"><span class="hs-identifier hs-var hs-var">findVar</span></a></span></span><span> </span><span id="local-6989586621679042281"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042281"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679042280"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679042280"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">VarT</span></a></span><span> </span><span id="local-6989586621679042279"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042279"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042281"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042279"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679042280"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><a href="#local-6989586621679042317"><span class="hs-identifier hs-var">findVar</span></a></span><span> </span><span id="local-6989586621679042278"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042278"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679042277"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679042277"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span id="local-6989586621679042276"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042276"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">VarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [a] -&gt; Type -&gt; a
</span><a href="#local-6989586621679042317"><span class="hs-identifier hs-var">findVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042278"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679042277"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042276"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><a href="#local-6989586621679042317"><span class="hs-identifier hs-var">findVar</span></a></span><span> </span><span id="local-6989586621679042275"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042275"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;substVarsWith: couldn't look up variable substitution for &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042275"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-225"></span><span>      </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; with topVars: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679042342"><span class="hs-identifier hs-var">topVars</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; resultType: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042341"><span class="hs-identifier hs-var">resultType</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; argType: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042340"><span class="hs-identifier hs-var">argType</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">-- | Determine the arity of a kind.</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- Starting in template-haskell 2.8.0.0, 'Kind' and 'Type' became synonymous.</span><span>
</span><span id="line-229"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#kindArity"><span class="hs-identifier hs-type">kindArity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Kind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-cpp">
#if defined (__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &lt; 706
</span><span class="hs-identifier">kindArity</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-identifier">StarK</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-identifier">ArrowK</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">k2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">kindArity</span><span> </span><span class="hs-identifier">k2</span><span class="hs-cpp">
#else
</span><span id="kindArity"><span class="annot"><span class="annottext">kindArity :: Type -&gt; Int
</span><a href="Language.Haskell.TH.Extras.html#kindArity"><span class="hs-identifier hs-var hs-var">kindArity</span></a></span></span><span> </span><span id="local-6989586621679042273"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042273"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042273"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ForallT</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042272"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042272"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int
</span><a href="Language.Haskell.TH.Extras.html#kindArity"><span class="hs-identifier hs-var">kindArity</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042272"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">ArrowT</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679042271"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042271"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int
</span><a href="Language.Haskell.TH.Extras.html#kindArity"><span class="hs-identifier hs-var">kindArity</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042271"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">SigT</span></a></span><span> </span><span id="local-6989586621679042269"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042269"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int
</span><a href="Language.Haskell.TH.Extras.html#kindArity"><span class="hs-identifier hs-var">kindArity</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042269"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-cpp">
#if defined (__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 800
</span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ParensT</span></a></span><span> </span><span id="local-6989586621679042268"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042268"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int
</span><a href="Language.Haskell.TH.Extras.html#kindArity"><span class="hs-identifier hs-var">kindArity</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679042268"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- | Given the name of a type constructor, determine its full arity</span><span>
</span><span id="line-246"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#tyConArity"><span class="hs-identifier hs-type">tyConArity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-247"></span><span id="tyConArity"><span class="annot"><span class="annottext">tyConArity :: Name -&gt; Q Int
</span><a href="Language.Haskell.TH.Extras.html#tyConArity"><span class="hs-identifier hs-var hs-var">tyConArity</span></a></span></span><span> </span><span id="local-6989586621679042266"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042266"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679042265"><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><a href="#local-6989586621679042265"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679042264"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042264"><span class="hs-identifier hs-var">ka</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q ([TyVarBndr ()], Int)
</span><a href="Language.Haskell.TH.Extras.html#tyConArity%27"><span class="hs-identifier hs-var">tyConArity'</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042266"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><a href="#local-6989586621679042265"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042264"><span class="hs-identifier hs-var">ka</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Given the name of a type constructor, determine a list of type variables bound as parameters by</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- its declaration, and the arity of the kind of type being defined (i.e. how many more arguments would</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- need to be supplied in addition to the bound parameters in order to obtain an ordinary type of kind *).</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- If the supplied 'Name' is anything other than a data or newtype, produces an error.</span><span>
</span><span id="line-255"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#tyConArity%27"><span class="hs-identifier hs-type">tyConArity'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">TyVarBndrUnit</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span id="tyConArity%27"><span class="annot"><span class="annottext">tyConArity' :: Name -&gt; Q ([TyVarBndr ()], Int)
</span><a href="Language.Haskell.TH.Extras.html#tyConArity%27"><span class="hs-identifier hs-var hs-var">tyConArity'</span></a></span></span><span> </span><span id="local-6989586621679042261"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042261"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679042260"><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679042260"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Info
</span><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042261"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679042260"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 800
</span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">TyConI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">DataD</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042257"><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><a href="#local-6989586621679042257"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621679042256"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679042256"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><a href="#local-6989586621679042257"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int
</span><a href="Language.Haskell.TH.Extras.html#kindArity"><span class="hs-identifier hs-var">kindArity</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679042256"><span class="hs-identifier hs-var">mk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">TyConI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">NewtypeD</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042255"><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><a href="#local-6989586621679042255"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621679042254"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679042254"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span class="annot"><span class="annottext">Con
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><a href="#local-6989586621679042255"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int
</span><a href="Language.Haskell.TH.Extras.html#kindArity"><span class="hs-identifier hs-var">kindArity</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679042254"><span class="hs-identifier hs-var">mk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">TyConI</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ts</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ts</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-identifier">TyConI</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ts</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ts</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>    </span><span class="annot"><span class="annottext">Info
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tyConArity': Supplied name reified to something other than a data declaration: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679042261"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- | Determine the constructors bound by a data or newtype declaration. Errors out if supplied with another</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- sort of declaration.</span><span>
</span><span id="line-270"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#decCons"><span class="hs-identifier hs-type">decCons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Dec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Con</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-271"></span><span id="decCons"><span class="annot"><span class="annottext">decCons :: Dec -&gt; [Con]
</span><a href="Language.Haskell.TH.Extras.html#decCons"><span class="hs-identifier hs-var hs-var">decCons</span></a></span></span><span> </span><span id="local-6989586621679042252"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679042252"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679042252"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 800
</span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">DataD</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042251"><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679042251"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679042251"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">NewtypeD</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr ()]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042250"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679042250"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679042250"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-identifier">DataD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">cs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">cs</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">c</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>  </span><span class="annot"><span class="annottext">Dec
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;decCons: Declaration found was not a data or newtype declaration.&quot;</span></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- | Determine the arity of a data constructor.</span><span>
</span><span id="line-282"></span><span class="annot"><a href="Language.Haskell.TH.Extras.html#conArity"><span class="hs-identifier hs-type">conArity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-283"></span><span id="conArity"><span class="annot"><span class="annottext">conArity :: Con -&gt; Int
</span><a href="Language.Haskell.TH.Extras.html#conArity"><span class="hs-identifier hs-var hs-var">conArity</span></a></span></span><span> </span><span id="local-6989586621679042248"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679042248"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679042248"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">NormalC</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042247"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679042247"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679042247"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-285"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">RecC</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042246"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679042246"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679042246"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">InfixC</span></a></span><span> </span><span class="annot"><span class="annottext">BangType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BangType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">ForallC</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042245"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679042245"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Con -&gt; Int
</span><a href="Language.Haskell.TH.Extras.html#conArity"><span class="hs-identifier hs-var">conArity</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679042245"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-cpp">
#if defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 800
</span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">GadtC</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042244"><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679042244"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679042244"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/template-haskell-2.18.0.0/src"><span class="hs-identifier hs-type">RecGadtC</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679042243"><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679042243"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679042243"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-cpp">
#endif
</span></pre></body></html>