<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP                  #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds            #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies         #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators        #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &lt; 707
</span><span class="hs-cpp">#error This code requires GHC 7.7+
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#include &quot;MachDeps.h&quot;
</span><span class="hs-cpp">#include &quot;HsBaseConfig.h&quot;
</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Module:  Data.IntCast</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Copyright:   &#169; 2014-2018  Herbert Valerio Riedel</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- License:     BSD-style (see the LICENSE file)</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Maintainer:  Herbert Valerio Riedel &lt;hvr@gnu.org&gt;</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- Stability:   experimental</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- Portability: GHC &#8805; 7.8</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- This module provides for statically or dynamically checked</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- conversions between 'Integral' types.</span><span>
</span><span id="line-25"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.IntCast</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Conversion functions</span></span><span>
</span><span id="line-27"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** statically checked</span></span><span>
</span><span id="line-28"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span>      </span><span class="hs-comment">-- | In the table below each cell denotes which of the three</span><span>
</span><span id="line-30"></span><span>      </span><span class="hs-comment">-- 'intCast', 'intCastIso' and 'intCastEq' conversion operations</span><span>
</span><span id="line-31"></span><span>      </span><span class="hs-comment">-- are allowed (i.e. by the type-checker). The rows represent</span><span>
</span><span id="line-32"></span><span>      </span><span class="hs-comment">-- the domain @a@ while the columns represent the codomain @b@</span><span>
</span><span id="line-33"></span><span>      </span><span class="hs-comment">-- of the @a-&gt;b@-typed conversion functions.</span><span>
</span><span id="line-34"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-35"></span><span>      </span><span class="hs-comment">-- +-----------+-----------------+--------------+----------------------------------------+------------------------------------------+</span><span>
</span><span id="line-36"></span><span>      </span><span class="hs-comment">-- |           | 'Natural'       | 'Word32'     | 'Word64'                               | 'Int'                                    |</span><span>
</span><span id="line-37"></span><span>      </span><span class="hs-comment">-- +-----------+-----------------+--------------+----------------------------------------+------------------------------------------+</span><span>
</span><span id="line-38"></span><span>      </span><span class="hs-comment">-- | 'Word'    | 'intCast'       |              | 'intCast' &amp; 'intCastEq' &amp; 'intCastIso' | 'intCastIso'                             |</span><span>
</span><span id="line-39"></span><span>      </span><span class="hs-comment">-- +-----------+-----------------+--------------+----------------------------------------+------------------------------------------+</span><span>
</span><span id="line-40"></span><span>      </span><span class="hs-comment">-- | 'Word16'  | 'intCast'       | 'intCast'    | 'intCast'                              | 'intCast'                                |</span><span>
</span><span id="line-41"></span><span>      </span><span class="hs-comment">-- +-----------+-----------------+--------------+----------------------------------------+------------------------------------------+</span><span>
</span><span id="line-42"></span><span>      </span><span class="hs-comment">-- | 'Int64'   |                 |              | 'intCastIso'                           | 'intCast' &amp; 'intCastEq' &amp; 'intCastIso'   |</span><span>
</span><span id="line-43"></span><span>      </span><span class="hs-comment">-- +-----------+-----------------+--------------+----------------------------------------+------------------------------------------+</span><span>
</span><span id="line-44"></span><span>      </span><span class="hs-comment">-- | 'Int8'    |                 |              |                                        | 'intCast'                                |</span><span>
</span><span id="line-45"></span><span>      </span><span class="hs-comment">-- +-----------+-----------------+--------------+----------------------------------------+------------------------------------------+</span><span>
</span><span id="line-46"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-47"></span><span>      </span><span class="hs-comment">-- __Note:__ The table above assumes a 64-bit platform (i.e. where @finiteBitSize (0 :: Word) == 64@).</span><span>
</span><span id="line-48"></span><span>      </span><span class="annot"><a href="Data.IntCast.html#intCast"><span class="hs-identifier">intCast</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#intCastIso"><span class="hs-identifier">intCastIso</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#intCastEq"><span class="hs-identifier">intCastEq</span></a></span><span>
</span><span id="line-51"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** dynamically checked</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#intCastMaybe"><span class="hs-identifier">intCastMaybe</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Registering new integer types</span></span><span>
</span><span id="line-55"></span><span>      </span><span class="hs-comment">-- |</span><span>
</span><span id="line-56"></span><span>      </span><span class="hs-comment">--  * For 'intCastMaybe' you need to provide type-class instances of 'Bits'</span><span>
</span><span id="line-57"></span><span>      </span><span class="hs-comment">--    (and 'Integral').</span><span>
</span><span id="line-58"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-59"></span><span>      </span><span class="hs-comment">--  * For 'intCast', 'intCastIso', and 'intCastEq' simply</span><span>
</span><span id="line-60"></span><span>      </span><span class="hs-comment">--    declare instances for the 'IntBaseType' type-family (as well</span><span>
</span><span id="line-61"></span><span>      </span><span class="hs-comment">--    as type-class instances of 'Integral') as described below.</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier">IntBaseType</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseTypeK"><span class="hs-identifier">IntBaseTypeK</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Type-level predicates</span></span><span>
</span><span id="line-66"></span><span>      </span><span class="hs-comment">-- | The following type-level predicates are used by 'intCast',</span><span>
</span><span id="line-67"></span><span>      </span><span class="hs-comment">-- 'intCastIso', and 'intCastEq' respectively.</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#IsIntSubType"><span class="hs-identifier">IsIntSubType</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#IsIntBaseSubType"><span class="hs-identifier">IsIntBaseSubType</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#IsIntTypeIso"><span class="hs-identifier">IsIntTypeIso</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#IsIntBaseTypeIso"><span class="hs-identifier">IsIntBaseTypeIso</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#IsIntTypeEq"><span class="hs-identifier">IsIntTypeEq</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#IsIntBaseTypeEq"><span class="hs-identifier">IsIntBaseTypeEq</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- Haskell 2010+</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Bits</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Int</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Foreign.C.Types</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- non-Haskell 2010</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.TypeLits</span></a></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &lt; 900
</span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Numeric.Natural</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Natural</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | (Kind) Meta-information about integral types.</span><span>
</span><span id="line-90"></span><span class="hs-comment">--</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- If also a 'Bits' instance is defined, the type-level information</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- provided by 'IntBaseType' ought to match the meta-information that</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- is conveyed by the 'Bits' class' 'isSigned' and 'bitSizeMaybe'</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- methods.</span><span>
</span><span id="line-95"></span><span class="hs-keyword">data</span><span> </span><span id="IntBaseTypeK"><span class="annot"><a href="Data.IntCast.html#IntBaseTypeK"><span class="hs-identifier hs-var">IntBaseTypeK</span></a></span></span><span>
</span><span id="line-96"></span><span>     </span><span class="hs-comment">-- | fixed-width \(n\)-bit integers with value range \( \left[ -2^{n-1}, 2^{n-1}-1 \right] \).</span><span>
</span><span id="line-97"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="FixedIntTag"><span class="annot"><a href="Data.IntCast.html#FixedIntTag"><span class="hs-identifier hs-var">FixedIntTag</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span>
</span><span id="line-98"></span><span>     </span><span class="hs-comment">-- | fixed-width \(n\)-bit integers with value range  \( \left[ 0, 2^{n} \right] \).</span><span>
</span><span id="line-99"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span id="FixedWordTag"><span class="annot"><a href="Data.IntCast.html#FixedWordTag"><span class="hs-identifier hs-var">FixedWordTag</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span>
</span><span id="line-100"></span><span>     </span><span class="hs-comment">-- | integers with value range \( \left] -\infty, +\infty \right[ \).</span><span>
</span><span id="line-101"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span id="BigIntTag"><span class="annot"><a href="Data.IntCast.html#BigIntTag"><span class="hs-identifier hs-var">BigIntTag</span></a></span></span><span>
</span><span id="line-102"></span><span>     </span><span class="hs-comment">-- | naturals with value range \( \left[ 0, +\infty \right[ \).</span><span>
</span><span id="line-103"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span id="BigWordTag"><span class="annot"><a href="Data.IntCast.html#BigWordTag"><span class="hs-identifier hs-var">BigWordTag</span></a></span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | The (open) type family 'IntBaseType' encodes type-level</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- information about the value range of an integral type.</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- This module also provides type family instances for the standard</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- Haskell 2010 integral types (including &quot;Foreign.C.Types&quot;) as well</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- as the 'Natural' type.</span><span>
</span><span id="line-111"></span><span class="hs-comment">--</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- Here's a simple example for registering a custom type with the</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- &quot;Data.IntCast&quot; facilities:</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- /-- user-implemented unsigned 4-bit integer/</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- data Nibble = &#8230;</span><span>
</span><span id="line-118"></span><span class="hs-comment">--</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- /-- declare meta-information/</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- type instance 'IntBaseType' Nibble = 'FixedWordTag' 4</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- /-- user-implemented signed 7-bit integer/</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- data MyInt7 = &#8230;</span><span>
</span><span id="line-124"></span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- /-- declare meta-information/</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- type instance 'IntBaseType' MyInt7 = 'FixedIntTag' 7</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-128"></span><span class="hs-comment">--</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- The type-level predicate 'IsIntSubType' provides a partial</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- ordering based on the types above. See also 'intCast'.</span><span>
</span><span id="line-131"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span id="local-6989586621679027995"><span class="annot"><a href="#local-6989586621679027995"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseTypeK"><span class="hs-identifier hs-type">IntBaseTypeK</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#BigIntTag"><span class="hs-identifier hs-type">BigIntTag</span></a></span><span>
</span><span id="line-134"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#BigWordTag"><span class="hs-identifier hs-type">BigWordTag</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- Haskell2010 Basic fixed-width Integer Types</span><span>
</span><span id="line-137"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int8</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedIntTag"><span class="hs-identifier hs-type">FixedIntTag</span></a></span><span>  </span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-138"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int16</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedIntTag"><span class="hs-identifier hs-type">FixedIntTag</span></a></span><span>  </span><span class="annot"><span class="hs-number">16</span></span><span>
</span><span id="line-139"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int32</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedIntTag"><span class="hs-identifier hs-type">FixedIntTag</span></a></span><span>  </span><span class="annot"><span class="hs-number">32</span></span><span>
</span><span id="line-140"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int64</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedIntTag"><span class="hs-identifier hs-type">FixedIntTag</span></a></span><span>  </span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-141"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedWordTag"><span class="hs-identifier hs-type">FixedWordTag</span></a></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-142"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedWordTag"><span class="hs-identifier hs-type">FixedWordTag</span></a></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span>
</span><span id="line-143"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedWordTag"><span class="hs-identifier hs-type">FixedWordTag</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span>
</span><span id="line-144"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedWordTag"><span class="hs-identifier hs-type">FixedWordTag</span></a></span><span> </span><span class="annot"><span class="hs-number">64</span></span><span class="hs-cpp">

#if defined(WORD_SIZE_IN_BITS)
</span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">{-'-}</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedIntTag"><span class="hs-identifier hs-type">FixedIntTag</span></a></span><span>  </span><span class="hs-identifier">WORD_SIZE_IN_BITS</span><span>
</span><span id="line-148"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Word</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">{-'-}</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedWordTag"><span class="hs-identifier hs-type">FixedWordTag</span></a></span><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS</span><span class="hs-cpp">
#else
</span><span class="hs-cpp">#error Cannot determine bit-size of 'Int'/'Word' type
</span><span class="hs-cpp">#endif
</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- Haskell2010 FFI Integer Types</span><span>
</span><span id="line-154"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CChar</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_CHAR</span><span>
</span><span id="line-155"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CInt</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_INT</span><span>
</span><span id="line-156"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CIntMax</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_INTMAX_T</span><span>
</span><span id="line-157"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CIntPtr</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_INTPTR_T</span><span>
</span><span id="line-158"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CLLong</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_LONG_LONG</span><span>
</span><span id="line-159"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CLong</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_LONG</span><span>
</span><span id="line-160"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CPtrdiff</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_PTRDIFF_T</span><span>
</span><span id="line-161"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CSChar</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_SIGNED_CHAR</span><span>
</span><span id="line-162"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CShort</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_SHORT</span><span>
</span><span id="line-163"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CSigAtomic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_SIG_ATOMIC_T</span><span>
</span><span id="line-164"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CSize</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_SIZE_T</span><span>
</span><span id="line-165"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CUChar</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_UNSIGNED_CHAR</span><span>
</span><span id="line-166"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CUInt</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_UNSIGNED_INT</span><span>
</span><span id="line-167"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CUIntMax</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_UINTMAX_T</span><span>
</span><span id="line-168"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CUIntPtr</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_UINTPTR_T</span><span>
</span><span id="line-169"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CULLong</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_UNSIGNED_LONG_LONG</span><span>
</span><span id="line-170"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CULong</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_UNSIGNED_LONG</span><span>
</span><span id="line-171"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="IntBaseType"><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-var">IntBaseType</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">CUShort</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="hs-identifier">HTYPE_UNSIGNED_SHORT</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Closed type family providing the partial order of (improper) subtype-relations</span><span>
</span><span id="line-174"></span><span class="hs-comment">--</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- 'IsIntSubType' provides a more convenient entry point.</span><span>
</span><span id="line-176"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="IsIntBaseSubType"><span class="annot"><a href="Data.IntCast.html#IsIntBaseSubType"><span class="hs-identifier hs-var">IsIntBaseSubType</span></a></span></span><span> </span><span id="local-6989586621679027976"><span class="annot"><a href="#local-6989586621679027976"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679027975"><span class="annot"><a href="#local-6989586621679027975"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-comment">-- this relation is reflexive</span><span>
</span><span id="line-178"></span><span>    </span><span id="IsIntBaseSubType"><span class="annot"><a href="Data.IntCast.html#IsIntBaseSubType"><span class="hs-identifier hs-var">IsIntBaseSubType</span></a></span></span><span> </span><span id="local-6989586621679027974"><span class="annot"><a href="#local-6989586621679027974"><span class="hs-identifier hs-type">a</span></a></span><span>                 </span><span class="annot"><a href="#local-6989586621679027974"><span class="hs-identifier hs-type">a</span></a></span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">True</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-comment">-- Every integer is a subset of 'Integer'</span><span>
</span><span id="line-181"></span><span>    </span><span id="IsIntBaseSubType"><span class="annot"><a href="Data.IntCast.html#IsIntBaseSubType"><span class="hs-identifier hs-var">IsIntBaseSubType</span></a></span></span><span> </span><span id="local-6989586621679027973"><span class="annot"><a href="#local-6989586621679027973"><span class="hs-identifier hs-type">a</span></a></span><span>                 </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#BigIntTag"><span class="hs-identifier hs-type">BigIntTag</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">True</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-comment">-- Even though Haskell2010 doesn't provide naturals, we can use the</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-comment">-- tag 'Nat' to denote such entities</span><span>
</span><span id="line-185"></span><span>    </span><span id="IsIntBaseSubType"><span class="annot"><a href="Data.IntCast.html#IsIntBaseSubType"><span class="hs-identifier hs-var">IsIntBaseSubType</span></a></span></span><span> </span><span id="local-6989586621679027972"><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedWordTag"><span class="hs-identifier hs-type">FixedWordTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027972"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#BigWordTag"><span class="hs-identifier hs-type">BigWordTag</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">True</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-comment">-- sub-type relations between fixed-with types</span><span>
</span><span id="line-188"></span><span>    </span><span id="IsIntBaseSubType"><span class="annot"><a href="Data.IntCast.html#IsIntBaseSubType"><span class="hs-identifier hs-var">IsIntBaseSubType</span></a></span></span><span> </span><span id="local-6989586621679027970"><span id="local-6989586621679027971"><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedIntTag"><span class="hs-identifier hs-type">FixedIntTag</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679027971"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedIntTag"><span class="hs-identifier hs-type">FixedIntTag</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679027970"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679027971"><span class="hs-identifier hs-type">a</span></a></span><span>   </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">&lt;=?</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027970"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span id="IsIntBaseSubType"><span class="annot"><a href="Data.IntCast.html#IsIntBaseSubType"><span class="hs-identifier hs-var">IsIntBaseSubType</span></a></span></span><span> </span><span id="local-6989586621679027967"><span id="local-6989586621679027968"><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedWordTag"><span class="hs-identifier hs-type">FixedWordTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027968"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedWordTag"><span class="hs-identifier hs-type">FixedWordTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027967"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679027968"><span class="hs-identifier hs-type">a</span></a></span><span>   </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">&lt;=?</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027967"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span id="IsIntBaseSubType"><span class="annot"><a href="Data.IntCast.html#IsIntBaseSubType"><span class="hs-identifier hs-var">IsIntBaseSubType</span></a></span></span><span> </span><span id="local-6989586621679027965"><span id="local-6989586621679027966"><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedWordTag"><span class="hs-identifier hs-type">FixedWordTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027966"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedIntTag"><span class="hs-identifier hs-type">FixedIntTag</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679027965"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679027966"><span class="hs-identifier hs-type">a</span></a></span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">+</span></a></span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-type">&lt;=?</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027965"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-comment">-- everything else is not a sub-type</span><span>
</span><span id="line-193"></span><span>    </span><span id="IsIntBaseSubType"><span class="annot"><a href="Data.IntCast.html#IsIntBaseSubType"><span class="hs-identifier hs-var">IsIntBaseSubType</span></a></span></span><span> </span><span id="local-6989586621679027963"><span id="local-6989586621679027964"><span class="annot"><a href="#local-6989586621679027964"><span class="hs-identifier hs-type">a</span></a></span><span>                 </span><span class="annot"><a href="#local-6989586621679027963"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">False</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-keyword">type</span><span> </span><span id="IsIntSubType"><span class="annot"><a href="Data.IntCast.html#IsIntSubType"><span class="hs-identifier hs-var">IsIntSubType</span></a></span></span><span> </span><span id="local-6989586621679027962"><span class="annot"><a href="#local-6989586621679027962"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679027961"><span class="annot"><a href="#local-6989586621679027961"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IsIntBaseSubType"><span class="hs-identifier hs-type">IsIntBaseSubType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027962"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027961"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- | Closed type family representing an equality-relation on bit-width</span><span>
</span><span id="line-198"></span><span class="hs-comment">--</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- This is a superset of the 'IsIntBaseTypeEq' relation, as it ignores</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- the signedness of fixed-size integers (i.e. 'Int32' is considered</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- equal to 'Word32').</span><span>
</span><span id="line-202"></span><span class="hs-comment">--</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- 'IsIntTypeIso' provides a more convenient entry point.</span><span>
</span><span id="line-204"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="IsIntBaseTypeIso"><span class="annot"><a href="Data.IntCast.html#IsIntBaseTypeIso"><span class="hs-identifier hs-var">IsIntBaseTypeIso</span></a></span></span><span> </span><span id="local-6989586621679027960"><span class="annot"><a href="#local-6989586621679027960"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679027959"><span class="annot"><a href="#local-6989586621679027959"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>    </span><span id="IsIntBaseTypeIso"><span class="annot"><a href="Data.IntCast.html#IsIntBaseTypeIso"><span class="hs-identifier hs-var">IsIntBaseTypeIso</span></a></span></span><span> </span><span id="local-6989586621679027958"><span class="annot"><a href="#local-6989586621679027958"><span class="hs-identifier hs-type">a</span></a></span><span>                 </span><span class="annot"><a href="#local-6989586621679027958"><span class="hs-identifier hs-type">a</span></a></span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">True</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span id="IsIntBaseTypeIso"><span class="annot"><a href="Data.IntCast.html#IsIntBaseTypeIso"><span class="hs-identifier hs-var">IsIntBaseTypeIso</span></a></span></span><span> </span><span id="local-6989586621679027957"><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedIntTag"><span class="hs-identifier hs-type">FixedIntTag</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679027957"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedWordTag"><span class="hs-identifier hs-type">FixedWordTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027957"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">True</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span id="IsIntBaseTypeIso"><span class="annot"><a href="Data.IntCast.html#IsIntBaseTypeIso"><span class="hs-identifier hs-var">IsIntBaseTypeIso</span></a></span></span><span> </span><span id="local-6989586621679027956"><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedWordTag"><span class="hs-identifier hs-type">FixedWordTag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027956"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Data.IntCast.html#FixedIntTag"><span class="hs-identifier hs-type">FixedIntTag</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679027956"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">True</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span id="IsIntBaseTypeIso"><span class="annot"><a href="Data.IntCast.html#IsIntBaseTypeIso"><span class="hs-identifier hs-var">IsIntBaseTypeIso</span></a></span></span><span> </span><span id="local-6989586621679027954"><span id="local-6989586621679027955"><span class="annot"><a href="#local-6989586621679027955"><span class="hs-identifier hs-type">a</span></a></span><span>                 </span><span class="annot"><a href="#local-6989586621679027954"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">False</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-keyword">type</span><span> </span><span id="IsIntTypeIso"><span class="annot"><a href="Data.IntCast.html#IsIntTypeIso"><span class="hs-identifier hs-var">IsIntTypeIso</span></a></span></span><span> </span><span id="local-6989586621679027953"><span class="annot"><a href="#local-6989586621679027953"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679027952"><span class="annot"><a href="#local-6989586621679027952"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IsIntBaseTypeIso"><span class="hs-identifier hs-type">IsIntBaseTypeIso</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027953"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027952"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-comment">-- | Closed type family representing an equality-relation on the integer base-type.</span><span>
</span><span id="line-213"></span><span class="hs-comment">--</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- 'IsIntBaseTypeEq' provides a more convenient entry point.</span><span>
</span><span id="line-215"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="IsIntBaseTypeEq"><span class="annot"><a href="Data.IntCast.html#IsIntBaseTypeEq"><span class="hs-identifier hs-var">IsIntBaseTypeEq</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679027951"><span class="annot"><a href="#local-6989586621679027951"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseTypeK"><span class="hs-identifier hs-type">IntBaseTypeK</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679027950"><span class="annot"><a href="#local-6989586621679027950"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IntCast.html#IntBaseTypeK"><span class="hs-identifier hs-type">IntBaseTypeK</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>    </span><span id="IsIntBaseTypeEq"><span class="annot"><a href="Data.IntCast.html#IsIntBaseTypeEq"><span class="hs-identifier hs-var">IsIntBaseTypeEq</span></a></span></span><span> </span><span id="local-6989586621679027949"><span class="annot"><a href="#local-6989586621679027949"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027949"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">True</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span id="IsIntBaseTypeEq"><span class="annot"><a href="Data.IntCast.html#IsIntBaseTypeEq"><span class="hs-identifier hs-var">IsIntBaseTypeEq</span></a></span></span><span> </span><span id="local-6989586621679027947"><span id="local-6989586621679027948"><span class="annot"><a href="#local-6989586621679027948"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027947"><span class="hs-identifier hs-type">b</span></a></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">False</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-keyword">type</span><span> </span><span id="IsIntTypeEq"><span class="annot"><a href="Data.IntCast.html#IsIntTypeEq"><span class="hs-identifier hs-var">IsIntTypeEq</span></a></span></span><span> </span><span id="local-6989586621679027946"><span class="annot"><a href="#local-6989586621679027946"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679027945"><span class="annot"><a href="#local-6989586621679027945"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IntCast.html#IsIntBaseTypeEq"><span class="hs-identifier hs-type">IsIntBaseTypeEq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027946"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IntCast.html#IntBaseType"><span class="hs-identifier hs-type">IntBaseType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679027945"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- Starting w/ GHC 8.4, (==) became a closed type-family, so the</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- following convenience instance isn't possibly anymore</span><span>
</span><span id="line-223"></span><span class="hs-comment">--</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- type instance a == b = IsIntBaseTypeEq a b</span><span>
</span><span id="line-225"></span><span class="hs-comment">--</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- https://github.com/haskell-hvr/int-cast/issues/3</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Statically checked integer conversion which satisfies the property</span><span>
</span><span id="line-229"></span><span class="hs-comment">--</span><span>
</span><span id="line-230"></span><span class="hs-comment">--  * @'toInteger' &#8801; 'toInteger' . intCast@</span><span>
</span><span id="line-231"></span><span class="hs-comment">--</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- __Note:__ This is just a type-restricted alias of 'fromIntegral' and</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- should therefore lead to the same compiled code as if</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- 'fromIntegral' had been used instead of 'intCast'.</span><span>
</span><span id="line-235"></span><span id="local-6989586621679028047"><span id="local-6989586621679028048"><span class="annot"><a href="Data.IntCast.html#intCast"><span class="hs-identifier hs-type">intCast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028048"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028047"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#IsIntSubType"><span class="hs-identifier hs-type">IsIntSubType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028048"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028047"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">True</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679028048"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679028047"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-236"></span><span id="intCast"><span class="annot"><span class="annottext">intCast :: forall a b.
(Integral a, Integral b, IsIntSubType a b ~ 'True) =&gt;
a -&gt; b
</span><a href="Data.IntCast.html#intCast"><span class="hs-identifier hs-var hs-var">intCast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-237"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.IntCast.html#intCast"><span class="hs-pragma hs-type">intCast</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | Statically checked integer conversion which satisfies the properties</span><span>
</span><span id="line-240"></span><span class="hs-comment">--</span><span>
</span><span id="line-241"></span><span class="hs-comment">--  * @&#8704;&#946; . 'intCastIso' ('intCastIso' a &#8759; &#946;) == a@</span><span>
</span><span id="line-242"></span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span class="hs-comment">--  * @'toInteger' ('intCastIso' a) == 'toInteger' b     (__if__ 'toInteger' a == 'toInteger' b)@</span><span>
</span><span id="line-244"></span><span class="hs-comment">--</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- __Note:__ This is just a type-restricted alias of 'fromIntegral' and</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- should therefore lead to the same compiled code as if</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- 'fromIntegral' had been used instead of 'intCastIso'.</span><span>
</span><span id="line-248"></span><span id="local-6989586621679028038"><span id="local-6989586621679028039"><span class="annot"><a href="Data.IntCast.html#intCastIso"><span class="hs-identifier hs-type">intCastIso</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028039"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028038"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#IsIntTypeIso"><span class="hs-identifier hs-type">IsIntTypeIso</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028039"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028038"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">True</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679028039"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679028038"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-249"></span><span id="intCastIso"><span class="annot"><span class="annottext">intCastIso :: forall a b.
(Integral a, Integral b, IsIntTypeIso a b ~ 'True) =&gt;
a -&gt; b
</span><a href="Data.IntCast.html#intCastIso"><span class="hs-identifier hs-var hs-var">intCastIso</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-250"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.IntCast.html#intCastIso"><span class="hs-pragma hs-type">intCastIso</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | Version of 'intCast' restricted to casts between types with same value domain.</span><span>
</span><span id="line-253"></span><span class="hs-comment">--</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- 'intCastEq' is the most constrained of the three conversions: The</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- existence of a 'intCastEq' conversion implies the existence of the</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- other two, i.e. 'intCastIso' and 'intCast'.</span><span>
</span><span id="line-257"></span><span class="hs-comment">--</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- __Note:__ This is just a type-restricted alias of 'fromIntegral' and</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- should therefore lead to the same compiled code as if</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- 'fromIntegral' had been used instead of 'intCastIso'.</span><span>
</span><span id="line-261"></span><span id="local-6989586621679028033"><span id="local-6989586621679028034"><span class="annot"><a href="Data.IntCast.html#intCastEq"><span class="hs-identifier hs-type">intCastEq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028034"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028033"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IntCast.html#IsIntTypeEq"><span class="hs-identifier hs-type">IsIntTypeEq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028034"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028033"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">True</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679028034"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679028033"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-262"></span><span id="intCastEq"><span class="annot"><span class="annottext">intCastEq :: forall a b.
(Integral a, Integral b, IsIntTypeEq a b ~ 'True) =&gt;
a -&gt; b
</span><a href="Data.IntCast.html#intCastEq"><span class="hs-identifier hs-var hs-var">intCastEq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-263"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.IntCast.html#intCastEq"><span class="hs-pragma hs-type">intCastEq</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-266"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- dynamically checked conversion</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | 'Bits' class based value-level predicate with same semantics as 'IsIntSubType'</span><span>
</span><span id="line-270"></span><span id="local-6989586621679028027"><span id="local-6989586621679028029"><span class="annot"><a href="Data.IntCast.html#isBitSubType"><span class="hs-identifier hs-type">isBitSubType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Bits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028029"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Bits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028027"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679028029"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679028027"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-271"></span><span id="isBitSubType"><span class="annot"><span class="annottext">isBitSubType :: forall a b. (Bits a, Bits b) =&gt; a -&gt; b -&gt; Bool
</span><a href="Data.IntCast.html#isBitSubType"><span class="hs-identifier hs-var hs-var">isBitSubType</span></a></span></span><span> </span><span id="local-6989586621679027902"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679027902"><span class="hs-identifier hs-var">_x</span></a></span></span><span> </span><span id="local-6989586621679027901"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679027901"><span class="hs-identifier hs-var">_y</span></a></span></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-comment">-- reflexive</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679027900"><span class="hs-identifier hs-var">xWidth</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679027899"><span class="hs-identifier hs-var">yWidth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679027898"><span class="hs-identifier hs-var">xSigned</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679027897"><span class="hs-identifier hs-var">ySigned</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-comment">-- Every integer is a subset of 'Integer'</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679027897"><span class="hs-identifier hs-var">ySigned</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679027899"><span class="hs-identifier hs-var">yWidth</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679027898"><span class="hs-identifier hs-var">xSigned</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679027897"><span class="hs-identifier hs-var">ySigned</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679027899"><span class="hs-identifier hs-var">yWidth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-comment">-- sub-type relations between fixed-with types</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679027898"><span class="hs-identifier hs-var">xSigned</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679027897"><span class="hs-identifier hs-var">ySigned</span></a></span><span class="hs-special">,</span><span>   </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679027895"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027895"><span class="hs-identifier hs-var">xW</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679027900"><span class="hs-identifier hs-var">xWidth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679027894"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027894"><span class="hs-identifier hs-var">yW</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679027899"><span class="hs-identifier hs-var">yWidth</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027895"><span class="hs-identifier hs-var">xW</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027894"><span class="hs-identifier hs-var">yW</span></a></span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679027898"><span class="hs-identifier hs-var">xSigned</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679027897"><span class="hs-identifier hs-var">ySigned</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679027892"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027892"><span class="hs-identifier hs-var">xW</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679027900"><span class="hs-identifier hs-var">xWidth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679027891"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027891"><span class="hs-identifier hs-var">yW</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679027899"><span class="hs-identifier hs-var">yWidth</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027892"><span class="hs-identifier hs-var">xW</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027891"><span class="hs-identifier hs-var">yW</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>    </span><span id="local-6989586621679027900"><span class="annot"><span class="annottext">xWidth :: Maybe Int
</span><a href="#local-6989586621679027900"><span class="hs-identifier hs-var hs-var">xWidth</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Maybe Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bitSizeMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679027902"><span class="hs-identifier hs-var">_x</span></a></span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621679027898"><span class="annot"><span class="annottext">xSigned :: Bool
</span><a href="#local-6989586621679027898"><span class="hs-identifier hs-var hs-var">xSigned</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isSigned</span></a></span><span>     </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679027902"><span class="hs-identifier hs-var">_x</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621679027899"><span class="annot"><span class="annottext">yWidth :: Maybe Int
</span><a href="#local-6989586621679027899"><span class="hs-identifier hs-var hs-var">yWidth</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Maybe Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bitSizeMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679027901"><span class="hs-identifier hs-var">_y</span></a></span><span>
</span><span id="line-289"></span><span>    </span><span id="local-6989586621679027897"><span class="annot"><span class="annottext">ySigned :: Bool
</span><a href="#local-6989586621679027897"><span class="hs-identifier hs-var hs-var">ySigned</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isSigned</span></a></span><span>     </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679027901"><span class="hs-identifier hs-var">_y</span></a></span><span>
</span><span id="line-290"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.IntCast.html#isBitSubType"><span class="hs-pragma hs-type">isBitSubType</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">-- | Run-time-checked integer conversion</span><span>
</span><span id="line-293"></span><span class="hs-comment">--</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- This is an optimized version of the following generic code below</span><span>
</span><span id="line-295"></span><span class="hs-comment">--</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- &gt; intCastMaybeRef :: (Integral a, Integral b) =&gt; a -&gt; Maybe b</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- &gt; intCastMaybeRef x</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- &gt;   | toInteger x == toInteger y = Just y</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- &gt;   | otherwise                  = Nothing</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- &gt;   where</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- &gt;     y = fromIntegral x</span><span>
</span><span id="line-302"></span><span class="hs-comment">--</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- The code above is rather inefficient as it needs to go via the</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- 'Integer' type. The function 'intCastMaybe', however, is marked @INLINEABLE@ and</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- if both integral types are statically known, GHC will be able</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- optimize the code signficantly (for @-O1@ and better).</span><span>
</span><span id="line-307"></span><span class="hs-comment">--</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- For instance (as of GHC 7.8.1) the following definitions</span><span>
</span><span id="line-309"></span><span class="hs-comment">--</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- &gt; w16_to_i32 = intCastMaybe :: Word16 -&gt; Maybe Int32</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- &gt; i16_to_w16 = intCastMaybe :: Int16 -&gt; Maybe Word16</span><span>
</span><span id="line-313"></span><span class="hs-comment">--</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- are translated into the following (simplified) /GHC Core/ language</span><span>
</span><span id="line-315"></span><span class="hs-comment">--</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- &gt; w16_to_i32 = \x -&gt; Just (case x of _ { W16# x# -&gt; I32# (word2Int# x#) })</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- &gt; i16_to_w16 = \x -&gt; case eta of _</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- &gt;   { I16# b1 -&gt; case tagToEnum# (&lt;=# 0 b1) of _</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- &gt;       { False -&gt; Nothing</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- &gt;       ; True -&gt; Just (W16# (narrow16Word# (int2Word# b1)))</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- &gt;       }</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- &gt;   }</span><span>
</span><span id="line-324"></span><span class="hs-comment">--</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- __Note:__ Starting with @base-4.8@, this function has been added to &quot;Data.Bits&quot;</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- under the name 'Data.Bits.toIntegralSized'.</span><span>
</span><span id="line-327"></span><span class="hs-comment">--</span><span>
</span><span id="line-328"></span><span id="local-6989586621679028018"><span id="local-6989586621679028019"><span class="annot"><a href="Data.IntCast.html#intCastMaybe"><span class="hs-identifier hs-type">intCastMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028019"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028018"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Bits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028019"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Bits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028018"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679028019"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679028018"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-329"></span><span class="hs-comment">-- the code below relies on GHC optimizing away statically decidable branches</span><span>
</span><span id="line-330"></span><span id="intCastMaybe"><span class="annot"><span class="annottext">intCastMaybe :: forall a b.
(Integral a, Integral b, Bits a, Bits b) =&gt;
a -&gt; Maybe b
</span><a href="Data.IntCast.html#intCastMaybe"><span class="hs-identifier hs-var hs-var">intCastMaybe</span></a></span></span><span> </span><span id="local-6989586621679027843"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679027843"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679027843"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679027841"><span class="hs-identifier hs-var">yMinBound</span></a></span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679027843"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679027840"><span class="hs-identifier hs-var">yMaxBound</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679027839"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-335"></span><span>    </span><span id="local-6989586621679027839"><span class="annot"><span class="annottext">y :: b
</span><a href="#local-6989586621679027839"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679027843"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621679027838"><span class="annot"><span class="annottext">xWidth :: Maybe Int
</span><a href="#local-6989586621679027838"><span class="hs-identifier hs-var hs-var">xWidth</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Maybe Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bitSizeMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679027843"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621679027837"><span class="annot"><span class="annottext">yWidth :: Maybe Int
</span><a href="#local-6989586621679027837"><span class="hs-identifier hs-var hs-var">yWidth</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Maybe Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bitSizeMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679027839"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621679027841"><span class="annot"><span class="annottext">yMinBound :: Maybe a
</span><a href="#local-6989586621679027841"><span class="hs-identifier hs-var hs-var">yMinBound</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a b. (Bits a, Bits b) =&gt; a -&gt; b -&gt; Bool
</span><a href="Data.IntCast.html#isBitSubType"><span class="hs-identifier hs-var">isBitSubType</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679027843"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679027839"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-341"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isSigned</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679027843"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isSigned</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679027839"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-342"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isSigned</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679027843"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isSigned</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679027839"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679027836"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027836"><span class="hs-identifier hs-var">yW</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679027837"><span class="hs-identifier hs-var">yWidth</span></a></span><span>
</span><span id="line-343"></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027836"><span class="hs-identifier hs-var">yW</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- N.B. assumes sub-type</span><span>
</span><span id="line-344"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621679027840"><span class="annot"><span class="annottext">yMaxBound :: Maybe a
</span><a href="#local-6989586621679027840"><span class="hs-identifier hs-var hs-var">yMaxBound</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a b. (Bits a, Bits b) =&gt; a -&gt; b -&gt; Bool
</span><a href="Data.IntCast.html#isBitSubType"><span class="hs-identifier hs-var">isBitSubType</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679027843"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679027839"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-347"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isSigned</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679027843"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isSigned</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679027839"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679027834"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027834"><span class="hs-identifier hs-var">xW</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679027838"><span class="hs-identifier hs-var">xWidth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679027833"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027833"><span class="hs-identifier hs-var">yW</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679027837"><span class="hs-identifier hs-var">yWidth</span></a></span><span>
</span><span id="line-348"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027834"><span class="hs-identifier hs-var">xW</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027833"><span class="hs-identifier hs-var">yW</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-comment">-- max-bound beyond a's domain</span><span>
</span><span id="line-349"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679027831"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027831"><span class="hs-identifier hs-var">yW</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679027837"><span class="hs-identifier hs-var">yWidth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">isSigned</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679027839"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bits a =&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027831"><span class="hs-identifier hs-var">yW</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bits a =&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">bit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679027831"><span class="hs-identifier hs-var">yW</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-351"></span><span class="hs-pragma">{-# INLINEABLE</span><span> </span><span class="annot"><a href="Data.IntCast.html#intCastMaybe"><span class="hs-pragma hs-type">intCastMaybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-352"></span></pre></body></html>