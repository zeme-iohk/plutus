

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>12. Other Haskell utility programs &mdash; Glasgow Haskell Compiler 9.2.5 User&#39;s Guide</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Glasgow Haskell Compiler 9.2.5 User&#39;s Guide"
          href="_static/opensearch.xml"/>

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="13. Running GHC on Win32 systems" href="win32-dlls.html" />
    <link rel="prev" title="11. Hints" href="hints.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Glasgow Haskell Compiler
          

          
          </a>

          
            
            
              <div class="version">
                9.2.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-notes.html">2. Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="ghci.html">3. Using GHCi</a></li>
<li class="toctree-l1"><a class="reference internal" href="runghc.html">4. Using runghc</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">5. Using GHC</a></li>
<li class="toctree-l1"><a class="reference internal" href="exts.html">6. Language extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="extending_ghc.html">7. Extending and using GHC as a Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="profiling.html">8. Profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="debug-info.html">9. Debugging compiled programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="gone_wrong.html">10. What to do when something goes wrong</a></li>
<li class="toctree-l1"><a class="reference internal" href="hints.html">11. Hints</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">12. Other Haskell utility programs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#yacc-for-haskell-happy">12.1. “Yacc for Haskell”: <code class="docutils literal notranslate"><span class="pre">happy</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-haskell-interfaces-to-c-code-hsc2hs">12.2. Writing Haskell interfaces to C code: <code class="docutils literal notranslate"><span class="pre">hsc2hs</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#command-line-syntax">12.2.1. command line syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-syntax">12.2.2. Input syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-constructs">12.2.3. Custom constructs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cross-compilation">12.2.4. Cross-compilation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="win32-dlls.html">13. Running GHC on Win32 systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="bugs.html">14. Known bugs and infelicities</a></li>
<li class="toctree-l1"><a class="reference internal" href="eventlog-formats.html">15. Eventlog encodings</a></li>
<li class="toctree-l1"><a class="reference internal" href="editing-guide.html">16. Care and feeding of your GHC User’s Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Glasgow Haskell Compiler</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">12. </span>Other Haskell utility programs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="other-haskell-utility-programs">
<span id="utils"></span><h1><span class="section-number">12. </span>Other Haskell utility programs<a class="headerlink" href="#other-haskell-utility-programs" title="Permalink to this heading">¶</a></h1>
<p id="index-0">This section describes other program(s) which we distribute, that help
with the Great Haskell Programming Task.</p>
<section id="yacc-for-haskell-happy">
<span id="happy"></span><h2><span class="section-number">12.1. </span>“Yacc for Haskell”: <code class="docutils literal notranslate"><span class="pre">happy</span></code><a class="headerlink" href="#yacc-for-haskell-happy" title="Permalink to this heading">¶</a></h2>
<p id="index-1">Andy Gill and Simon Marlow have written a parser-generator for Haskell,
called <code class="docutils literal notranslate"><span class="pre">happy</span></code>. <code class="docutils literal notranslate"><span class="pre">Happy</span></code> is to Haskell what <code class="docutils literal notranslate"><span class="pre">Yacc</span></code> is to C.</p>
<p>You can get <code class="docutils literal notranslate"><span class="pre">happy</span></code> from <a class="reference external" href="http://www.haskell.org/happy/">the Happy
Homepage</a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">Happy</span></code> is at its shining best when compiled by GHC.</p>
</section>
<section id="writing-haskell-interfaces-to-c-code-hsc2hs">
<span id="hsc2hs"></span><h2><span class="section-number">12.2. </span>Writing Haskell interfaces to C code: <code class="docutils literal notranslate"><span class="pre">hsc2hs</span></code><a class="headerlink" href="#writing-haskell-interfaces-to-c-code-hsc2hs" title="Permalink to this heading">¶</a></h2>
<p id="index-2">The <code class="docutils literal notranslate"><span class="pre">hsc2hs</span></code> command can be used to automate some parts of the process
of writing Haskell bindings to C code. It reads an almost-Haskell source
with embedded special constructs, and outputs a real Haskell file with
these constructs processed, based on information taken from some C
headers. The extra constructs deal with accessing C data from Haskell.</p>
<p>It may also output a C file which contains additional C functions to be
linked into the program, together with a C header that gets included
into the C code to which the Haskell module will be compiled (when
compiled via C) and into the C file. These two files are created when
the <code class="docutils literal notranslate"><span class="pre">#def</span></code> construct is used (see below).</p>
<p>Actually <code class="docutils literal notranslate"><span class="pre">hsc2hs</span></code> does not output the Haskell file directly. It
creates a C program that includes the headers, gets automatically
compiled and run. That program outputs the Haskell code.</p>
<p>In the following, “Haskell file” is the main output (usually a <code class="docutils literal notranslate"><span class="pre">.hs</span></code>
file), “compiled Haskell file” is the Haskell file after <code class="docutils literal notranslate"><span class="pre">ghc</span></code> has
compiled it to C (i.e. a <code class="docutils literal notranslate"><span class="pre">.hc</span></code> file), “C program” is the program that
outputs the Haskell file, “C file” is the optionally generated C file,
and “C header” is its header file.</p>
<section id="command-line-syntax">
<h3><span class="section-number">12.2.1. </span>command line syntax<a class="headerlink" href="#command-line-syntax" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">hsc2hs</span></code> takes input files as arguments, and flags that modify its
behavior:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">-o</span> <span class="pre">FILE</span></code>, <code class="docutils literal notranslate"><span class="pre">--output=FILE</span></code></dt><dd><p>Name of the Haskell file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-t</span> <span class="pre">FILE</span></code>, <code class="docutils literal notranslate"><span class="pre">--template=FILE</span></code></dt><dd><p>The template file (see below).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-c</span> <span class="pre">PROG</span></code>, <code class="docutils literal notranslate"><span class="pre">--cc=PROG</span></code></dt><dd><p>The C compiler to use (default: <code class="docutils literal notranslate"><span class="pre">gcc</span></code>)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-l</span> <span class="pre">PROG</span></code>, <code class="docutils literal notranslate"><span class="pre">--ld=PROG</span></code></dt><dd><p>The linker to use (default: <code class="docutils literal notranslate"><span class="pre">gcc</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-C</span> <span class="pre">FLAG</span></code>, <code class="docutils literal notranslate"><span class="pre">--cflag=FLAG</span></code></dt><dd><p>An extra flag to pass to the C compiler.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-I</span> <span class="pre">DIR</span></code></dt><dd><p>Passed to the C compiler.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-L</span> <span class="pre">FLAG</span></code>, <code class="docutils literal notranslate"><span class="pre">--lflag=FLAG</span></code></dt><dd><p>An extra flag to pass to the linker.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-i</span> <span class="pre">FILE</span></code>, <code class="docutils literal notranslate"><span class="pre">--include=FILE</span></code></dt><dd><p>As if the appropriate <code class="docutils literal notranslate"><span class="pre">#include</span></code> directive was placed in the
source.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-D</span> <span class="pre">NAME[=VALUE]</span></code>, <code class="docutils literal notranslate"><span class="pre">--define=NAME[=VALUE]</span></code></dt><dd><p>As if the appropriate <code class="docutils literal notranslate"><span class="pre">#define</span></code> directive was placed in the
source.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--no-compile</span></code></dt><dd><p>Stop after writing out the intermediate C program to disk. The file
name for the intermediate C program is the input file name with
<code class="docutils literal notranslate"><span class="pre">.hsc</span></code> replaced with <code class="docutils literal notranslate"><span class="pre">_hsc_make.c</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-k</span></code>, <code class="docutils literal notranslate"><span class="pre">--keep-files</span></code></dt><dd><p>Proceed as normal, but do not delete any intermediate files.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-x</span></code>, <code class="docutils literal notranslate"><span class="pre">--cross-compile</span></code></dt><dd><p>Activate cross-compilation mode (see <a class="reference internal" href="#hsc2hs-cross"><span class="std std-ref">Cross-compilation</span></a>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">--cross-safe</span></code></dt><dd><p>Restrict the .hsc directives to those supported by the
<code class="docutils literal notranslate"><span class="pre">--cross-compile</span></code> mode (see <a class="reference internal" href="#hsc2hs-cross"><span class="std std-ref">Cross-compilation</span></a>). This should be
useful if your <code class="docutils literal notranslate"><span class="pre">.hsc</span></code> files must be safely cross-compiled and you
wish to keep non-cross-compilable constructs from creeping into
them.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-?</span></code>, <code class="docutils literal notranslate"><span class="pre">--help</span></code></dt><dd><p>Display a summary of the available flags and exit successfully.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-V</span></code>, <code class="docutils literal notranslate"><span class="pre">--version</span></code></dt><dd><p>Output version information and exit successfully.</p>
</dd>
</dl>
<p>The input file should end with .hsc (it should be plain Haskell source
only; literate Haskell is not supported at the moment). Output files by
default get names with the <code class="docutils literal notranslate"><span class="pre">.hsc</span></code> suffix replaced:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">.hs</span></code></p></td>
<td><p>Haskell file</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">_hsc.h</span></code></p></td>
<td><p>C header</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">_hsc.c</span></code></p></td>
<td><p>C file</p></td>
</tr>
</tbody>
</table>
<p>The C program is compiled using the Haskell compiler. This provides the
include path to <code class="docutils literal notranslate"><span class="pre">HsFFI.h</span></code> which is automatically included into the C
program.</p>
</section>
<section id="input-syntax">
<h3><span class="section-number">12.2.2. </span>Input syntax<a class="headerlink" href="#input-syntax" title="Permalink to this heading">¶</a></h3>
<p>All special processing is triggered by the <code class="docutils literal notranslate"><span class="pre">#</span></code> operator. To output a
literal <code class="docutils literal notranslate"><span class="pre">#</span></code>, write it twice: <code class="docutils literal notranslate"><span class="pre">##</span></code>. Inside string literals and
comments <code class="docutils literal notranslate"><span class="pre">#</span></code> characters are not processed.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">#</span></code> is followed by optional spaces and tabs, an alphanumeric keyword
that describes the kind of processing, and its arguments. Arguments look
like C expressions separated by commas (they are not written inside
parens). They extend up to the nearest unmatched <code class="docutils literal notranslate"><span class="pre">)</span></code>, <code class="docutils literal notranslate"><span class="pre">]</span></code> or <code class="docutils literal notranslate"><span class="pre">}</span></code>,
or to the end of line if it occurs outside any <code class="docutils literal notranslate"><span class="pre">()</span> <span class="pre">[]</span> <span class="pre">{}</span> <span class="pre">''</span> <span class="pre">&quot;&quot;</span> <span class="pre">/**/</span></code>
and is not preceded by a backslash. Backslash-newline pairs are
stripped.</p>
<p>In addition <code class="docutils literal notranslate"><span class="pre">#{stuff}</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">#stuff</span></code> except that it’s
self-delimited and thus needs not to be placed at the end of line or in
some brackets.</p>
<p>Meanings of specific keywords:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;file.h&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&quot;file.h&quot;</span></code></dt><dd><p>The specified file gets included into the C program, the compiled
Haskell file, and the C header. <code class="docutils literal notranslate"><span class="pre">&lt;HsFFI.h&gt;</span></code> is included
automatically.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#define</span> <span class="pre">⟨name⟩</span></code>, <code class="docutils literal notranslate"><span class="pre">#define</span> <span class="pre">⟨name</span> <span class="pre">⟨value⟩</span></code>, <code class="docutils literal notranslate"><span class="pre">#undef</span> <span class="pre">⟨name⟩</span></code></dt><dd><p>Similar to <code class="docutils literal notranslate"><span class="pre">#include</span></code>. Note that <code class="docutils literal notranslate"><span class="pre">#includes</span></code> and <code class="docutils literal notranslate"><span class="pre">#defines</span></code>
may be put in the same file twice so they should not assume
otherwise.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#let</span> <span class="pre">⟨name⟩</span> <span class="pre">⟨parameters⟩</span> <span class="pre">=</span> <span class="pre">&quot;⟨definition⟩&quot;</span></code></dt><dd><p>Defines a macro to be applied to the Haskell source. Parameter names
are comma-separated, not inside parens. Such macro is invoked as
other <code class="docutils literal notranslate"><span class="pre">#</span></code>-constructs, starting with <code class="docutils literal notranslate"><span class="pre">#name</span></code>. The definition will
be put in the C program inside parens as arguments of <code class="docutils literal notranslate"><span class="pre">printf</span></code>. To
refer to a parameter, close the quote, put a parameter name and open
the quote again, to let C string literals concatenate. Or use
<code class="docutils literal notranslate"><span class="pre">printf</span></code>’s format directives. Values of arguments must be given as
strings, unless the macro stringifies them itself using the C
preprocessor’s <code class="docutils literal notranslate"><span class="pre">#parameter</span></code> syntax.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#def</span> <span class="pre">⟨C_definition⟩</span></code></dt><dd><p>The definition (of a function, variable, struct or typedef) is
written to the C file, and its prototype or extern declaration to
the C header. Inline functions are handled correctly. struct
definitions and typedefs are written to the C program too. The
<code class="docutils literal notranslate"><span class="pre">inline</span></code>, <code class="docutils literal notranslate"><span class="pre">struct</span></code> or <code class="docutils literal notranslate"><span class="pre">typedef</span></code> keyword must come just after
<code class="docutils literal notranslate"><span class="pre">def</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#if</span> <span class="pre">⟨condition⟩</span></code>, <code class="docutils literal notranslate"><span class="pre">#ifdef</span> <span class="pre">⟨name⟩</span></code>, <code class="docutils literal notranslate"><span class="pre">#ifndef</span> <span class="pre">⟨name⟩</span></code>, <code class="docutils literal notranslate"><span class="pre">#elif</span> <span class="pre">⟨condition⟩</span></code>, <code class="docutils literal notranslate"><span class="pre">#else</span></code>, <code class="docutils literal notranslate"><span class="pre">#endif</span></code>, <code class="docutils literal notranslate"><span class="pre">#error</span> <span class="pre">⟨message⟩</span></code>, <code class="docutils literal notranslate"><span class="pre">#warning</span> <span class="pre">⟨message⟩</span></code></dt><dd><p>Conditional compilation directives are passed unmodified to the C
program, C file, and C header. Putting them in the C program means
that appropriate parts of the Haskell file will be skipped.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#const</span> <span class="pre">⟨C_expression⟩</span></code></dt><dd><p>The expression must be convertible to <code class="docutils literal notranslate"><span class="pre">long</span></code> or <code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">long</span></code>.
Its value (literal or negated literal) will be output.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#const_str</span> <span class="pre">⟨C_expression⟩</span></code></dt><dd><p>The expression must be convertible to const char pointer. Its value
(string literal) will be output.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#type</span> <span class="pre">⟨C_type⟩</span></code></dt><dd><p>A Haskell equivalent of the C numeric type will be output. It will
be one of <code class="docutils literal notranslate"><span class="pre">{Int,Word}{8,16,32,64}</span></code>, <code class="docutils literal notranslate"><span class="pre">Float</span></code>, <code class="docutils literal notranslate"><span class="pre">Double</span></code>,
<code class="docutils literal notranslate"><span class="pre">LDouble</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#peek</span> <span class="pre">⟨struct_type⟩,</span> <span class="pre">⟨field⟩</span></code></dt><dd><p>A function that peeks a field of a C struct will be output. It will
have the type <code class="docutils literal notranslate"><span class="pre">Storable</span> <span class="pre">b</span> <span class="pre">=&gt;</span> <span class="pre">Ptr</span> <span class="pre">a</span> <span class="pre">-&gt;</span> <span class="pre">IO</span> <span class="pre">b</span></code>. The intention is that
<code class="docutils literal notranslate"><span class="pre">#peek</span></code> and <code class="docutils literal notranslate"><span class="pre">#poke</span></code> can be used for implementing the operations
of class <code class="docutils literal notranslate"><span class="pre">Storable</span></code> for a given C struct (see the
<code class="docutils literal notranslate"><span class="pre">Foreign.Storable</span></code> module in the library documentation).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#poke</span> <span class="pre">⟨struct_type⟩,</span> <span class="pre">⟨field⟩</span></code></dt><dd><p>Similarly for poke. It will have the type
<code class="docutils literal notranslate"><span class="pre">Storable</span> <span class="pre">b</span> <span class="pre">=&gt;</span> <span class="pre">Ptr</span> <span class="pre">a</span> <span class="pre">-&gt;</span> <span class="pre">b</span> <span class="pre">-&gt;</span> <span class="pre">IO</span> <span class="pre">()</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#ptr</span> <span class="pre">⟨struct_type⟩,</span> <span class="pre">⟨field⟩</span></code></dt><dd><p>Makes a pointer to a field struct. It will have the type
<code class="docutils literal notranslate"><span class="pre">Ptr</span> <span class="pre">a</span> <span class="pre">-&gt;</span> <span class="pre">Ptr</span> <span class="pre">b</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#offset</span> <span class="pre">⟨struct_type⟩,</span> <span class="pre">⟨field⟩</span></code></dt><dd><p>Computes the offset, in bytes, of <code class="docutils literal notranslate"><span class="pre">field</span></code> in <code class="docutils literal notranslate"><span class="pre">struct_type</span></code>. It
will have type <code class="docutils literal notranslate"><span class="pre">Int</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#size</span> <span class="pre">⟨struct_type⟩</span></code></dt><dd><p>Computes the size, in bytes, of <code class="docutils literal notranslate"><span class="pre">struct_type</span></code>. It will have type
<code class="docutils literal notranslate"><span class="pre">Int</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#alignment</span> <span class="pre">⟨struct_type⟩</span></code></dt><dd><p>Computes the alignment, in bytes, of <code class="docutils literal notranslate"><span class="pre">struct_type</span></code>. It will have type
<code class="docutils literal notranslate"><span class="pre">Int</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">#enum</span> <span class="pre">⟨type⟩,</span> <span class="pre">⟨constructor⟩,</span> <span class="pre">⟨value⟩,</span> <span class="pre">⟨value⟩,</span> <span class="pre">...</span></code></dt><dd><p>A shortcut for multiple definitions which use <code class="docutils literal notranslate"><span class="pre">#const</span></code>. Each
<code class="docutils literal notranslate"><span class="pre">value</span></code> is a name of a C integer constant, e.g. enumeration value.
The name will be translated to Haskell by making each letter
following an underscore uppercase, making all the rest lowercase,
and removing underscores. You can supply a different translation by
writing <code class="docutils literal notranslate"><span class="pre">hs_name</span> <span class="pre">=</span> <span class="pre">c_value</span></code> instead of a <code class="docutils literal notranslate"><span class="pre">value</span></code>, in which case
<code class="docutils literal notranslate"><span class="pre">c_value</span></code> may be an arbitrary expression. The <code class="docutils literal notranslate"><span class="pre">hs_name</span></code> will be
defined as having the specified <code class="docutils literal notranslate"><span class="pre">type</span></code>. Its definition is the
specified <code class="docutils literal notranslate"><span class="pre">constructor</span></code> (which in fact may be an expression or be
empty) applied to the appropriate integer value. You can have
multiple <code class="docutils literal notranslate"><span class="pre">#enum</span></code> definitions with the same <code class="docutils literal notranslate"><span class="pre">type</span></code>; this
construct does not emit the type definition itself.</p>
</dd>
</dl>
</section>
<section id="custom-constructs">
<h3><span class="section-number">12.2.3. </span>Custom constructs<a class="headerlink" href="#custom-constructs" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">#const</span></code>, <code class="docutils literal notranslate"><span class="pre">#type</span></code>, <code class="docutils literal notranslate"><span class="pre">#peek</span></code>, <code class="docutils literal notranslate"><span class="pre">#poke</span></code> and <code class="docutils literal notranslate"><span class="pre">#ptr</span></code> are not
hardwired into the <code class="docutils literal notranslate"><span class="pre">hsc2hs</span></code>, but are defined in a C template that is
included in the C program: <code class="docutils literal notranslate"><span class="pre">template-hsc.h</span></code>. Custom constructs and
templates can be used too. Any <code class="docutils literal notranslate"><span class="pre">#</span></code>-construct with unknown key is
expected to be handled by a C template.</p>
<p>A C template should define a macro or function with name prefixed by
<code class="docutils literal notranslate"><span class="pre">hsc_</span></code> that handles the construct by emitting the expansion to stdout.
See <code class="docutils literal notranslate"><span class="pre">template-hsc.h</span></code> for examples.</p>
<p>Such macros can also be defined directly in the source. They are useful
for making a <code class="docutils literal notranslate"><span class="pre">#let</span></code>-like macro whose expansion uses other <code class="docutils literal notranslate"><span class="pre">#let</span></code>
macros. Plain <code class="docutils literal notranslate"><span class="pre">#let</span></code> prepends <code class="docutils literal notranslate"><span class="pre">hsc_</span></code> to the macro name and wraps the
definition in a <code class="docutils literal notranslate"><span class="pre">printf</span></code> call.</p>
</section>
<section id="cross-compilation">
<span id="hsc2hs-cross"></span><h3><span class="section-number">12.2.4. </span>Cross-compilation<a class="headerlink" href="#cross-compilation" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">hsc2hs</span></code> normally operates by creating, compiling, and running a C
program. That approach doesn’t work when cross-compiling — in this
case, the C compiler’s generates code for the target machine, not the
host machine. For this situation, there’s a special mode
<code class="docutils literal notranslate"><span class="pre">hsc2hs</span> <span class="pre">--cross-compile</span></code> which can generate the .hs by extracting
information from compilations only — specifically, whether or not
compilation fails.</p>
<p>Only a subset of <code class="docutils literal notranslate"><span class="pre">.hsc</span></code> syntax is supported by <code class="docutils literal notranslate"><span class="pre">--cross-compile</span></code>.
The following are unsupported:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#{const_str}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#{let}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#{def}</span></code></p></li>
<li><p>Custom constructs</p></li>
</ul>
</section>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="win32-dlls.html" class="btn btn-neutral float-right" title="13. Running GHC on Win32 systems" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="hints.html" class="btn btn-neutral float-left" title="11. Hints" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, GHC Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>