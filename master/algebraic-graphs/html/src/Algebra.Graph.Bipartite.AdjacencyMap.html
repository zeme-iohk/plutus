<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module     : Algebra.Graph.Bipartite.AdjacencyMap</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright  : (c) Andrey Mokhov 2016-2022</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License    : MIT (see the file LICENSE)</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer : andrey.mokhov@gmail.com</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability  : experimental</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- __Alga__ is a library for algebraic construction and manipulation of graphs</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- in Haskell. See &lt;https://github.com/snowleopard/alga-paper this paper&gt; for</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- the motivation behind the library, the underlying theory, and</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- implementation details.</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- This module defines the 'AdjacencyMap' data type for undirected bipartite</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- graphs and associated functions. See</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- &quot;Algebra.Graph.Bipartite.AdjacencyMap.Algorithm&quot; for basic bipartite graph</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- algorithms.</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- To avoid name clashes with &quot;Algebra.Graph.AdjacencyMap&quot;, this module can be</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- imported qualified:</span><span>
</span><span id="line-21"></span><span class="hs-comment">--</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- import qualified Algebra.Graph.Bipartite.AdjacencyMap as Bipartite</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-25"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algebra.Graph.Bipartite.AdjacencyMap</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Data structure</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier">AdjacencyMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftAdjacencyMap"><span class="hs-identifier">leftAdjacencyMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightAdjacencyMap"><span class="hs-identifier">rightAdjacencyMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Basic graph construction primitives</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#empty"><span class="hs-identifier">empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertex"><span class="hs-identifier">leftVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertex"><span class="hs-identifier">rightVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertex"><span class="hs-identifier">vertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edge"><span class="hs-identifier">edge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#overlay"><span class="hs-identifier">overlay</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#connect"><span class="hs-identifier">connect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertices"><span class="hs-identifier">vertices</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edges"><span class="hs-identifier">edges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#overlays"><span class="hs-identifier">overlays</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#connects"><span class="hs-identifier">connects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#swap"><span class="hs-identifier">swap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Conversion functions</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#toBipartite"><span class="hs-identifier">toBipartite</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#toBipartiteWith"><span class="hs-identifier">toBipartiteWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#fromBipartite"><span class="hs-identifier">fromBipartite</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#fromBipartiteWith"><span class="hs-identifier">fromBipartiteWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph properties</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#isEmpty"><span class="hs-identifier">isEmpty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasLeftVertex"><span class="hs-identifier">hasLeftVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasRightVertex"><span class="hs-identifier">hasRightVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasVertex"><span class="hs-identifier">hasVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasEdge"><span class="hs-identifier">hasEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertexCount"><span class="hs-identifier">leftVertexCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertexCount"><span class="hs-identifier">rightVertexCount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexCount"><span class="hs-identifier">vertexCount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeCount"><span class="hs-identifier">edgeCount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertexList"><span class="hs-identifier">leftVertexList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertexList"><span class="hs-identifier">rightVertexList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexList"><span class="hs-identifier">vertexList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeList"><span class="hs-identifier">edgeList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertexSet"><span class="hs-identifier">leftVertexSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertexSet"><span class="hs-identifier">rightVertexSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexSet"><span class="hs-identifier">vertexSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeSet"><span class="hs-identifier">edgeSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftAdjacencyList"><span class="hs-identifier">leftAdjacencyList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightAdjacencyList"><span class="hs-identifier">rightAdjacencyList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Standard families of graphs</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#List"><span class="hs-identifier">List</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#evenList"><span class="hs-identifier">evenList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#oddList"><span class="hs-identifier">oddList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#path"><span class="hs-identifier">path</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#circuit"><span class="hs-identifier">circuit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#biclique"><span class="hs-identifier">biclique</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#star"><span class="hs-identifier">star</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#stars"><span class="hs-identifier">stars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#mesh"><span class="hs-identifier">mesh</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph transformation</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#removeLeftVertex"><span class="hs-identifier">removeLeftVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#removeRightVertex"><span class="hs-identifier">removeRightVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#removeEdge"><span class="hs-identifier">removeEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#bimap"><span class="hs-identifier">bimap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph composition</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#box"><span class="hs-identifier">box</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#boxWith"><span class="hs-identifier">boxWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Miscellaneous</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#consistent"><span class="hs-identifier">consistent</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.Maybe</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.State</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Either</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">asum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator">(\\)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">sort</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Exts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">IsList</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Algebra.Graph.html"><span class="hs-identifier">Algebra.Graph</span></a></span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Algebra.Graph.AdjacencyMap.html"><span class="hs-identifier">Algebra.Graph.AdjacencyMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AM</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span>        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Tuple</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">{-| The 'Bipartite.AdjacencyMap' data type represents an undirected bipartite
graph. The two type parameters determine the types of vertices of each part. If
the types coincide, the vertices of the left part are still treated as disjoint
from the vertices of the right part. See examples for more details.

We define a 'Num' instance as a convenient notation for working with bipartite
graphs:

@
0                     == 'rightVertex' 0
'swap' 1                == 'leftVertex' 1
'swap' 1 + 2            == 'vertices' [1] [2]
'swap' 1 * 2            == 'edge' 1 2
'swap' 1 + 2 * 'swap' 3   == 'overlay' ('leftVertex' 1) ('edge' 3 2)
'swap' 1 * (2 + 'swap' 3) == 'connect' ('leftVertex' 1) ('vertices' [3] [2])
@

__Note:__ the 'Num' instance does not satisfy several &quot;customary laws&quot; of 'Num',
which dictate that 'fromInteger' @0@ and 'fromInteger' @1@ should act as
additive and multiplicative identities, and 'negate' as additive inverse.
Nevertheless, overloading 'fromInteger', '+' and '*' is very convenient when
working with algebraic graphs; we hope that in future Haskell's Prelude will
provide a more fine-grained class hierarchy for algebraic structures, which we
would be able to utilise without violating any laws.

The 'Show' instance is defined using basic graph construction primitives:

@
show empty                 == &quot;empty&quot;
show 1                     == &quot;rightVertex 1&quot;
show ('swap' 2)              == &quot;leftVertex 2&quot;
show (1 + 2)               == &quot;vertices [] [1,2]&quot;
show ('swap' (1 + 2))        == &quot;vertices [1,2] []&quot;
show ('swap' 1 * 2)          == &quot;edge 1 2&quot;
show ('swap' 1 * 2 * 'swap' 3) == &quot;edges [(1,2),(3,2)]&quot;
show ('swap' 1 * 2 + 'swap' 3) == &quot;overlay (leftVertex 3) (edge 1 2)&quot;
@

The 'Eq' instance satisfies all axioms of undirected bipartite algebraic graphs:

    * 'overlay' is commutative and associative:

        &gt;       x + y == y + x
        &gt; x + (y + z) == (x + y) + z

    * 'connect' is commutative, associative and has 'empty' as the identity:

        &gt;   x * empty == x
        &gt;   empty * x == x
        &gt;       x * y == y * x
        &gt; x * (y * z) == (x * y) * z

    * 'connect' distributes over 'overlay':

        &gt; x * (y + z) == x * y + x * z
        &gt; (x + y) * z == x * z + y * z

    * 'connect' can be decomposed:

        &gt; x * y * z == x * y + x * z + y * z

    * 'connect' has the same effect as 'overlay' on vertices of the same part:

        &gt;  leftVertex x * leftVertex y  ==  leftVertex x + leftVertex y
        &gt; rightVertex x * rightVertex y == rightVertex x + rightVertex y

The following useful theorems can be proved from the above set of axioms.

    * 'overlay' has 'empty' as the identity and is idempotent:

        &gt; x + empty == x
        &gt; empty + x == x
        &gt;     x + x == x

    * Absorption and saturation of 'connect':

        &gt; x * y + x + y == x * y
        &gt;     x * x * x == x * x

When specifying the time and memory complexity of graph algorithms, /n/ and /m/
will denote the number of vertices and edges of the graph, respectively. In
addition, /l/ and /r/ will denote the number of vertices in the left and right
parts of the graph, respectively.
-}</span><span>
</span><span id="line-159"></span><span id="local-6989586621679118004"><span id="local-6989586621679118005"></span></span><span class="hs-keyword">data</span><span> </span><span id="AdjacencyMap"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-var">AdjacencyMap</span></a></span></span><span> </span><span id="local-6989586621679118492"><span class="annot"><a href="#local-6989586621679118492"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679118491"><span class="annot"><a href="#local-6989586621679118491"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BAM"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-comment">-- | The /adjacency map/ of the left part of the graph: each left vertex is</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-comment">-- associated with a set of its right neighbours.</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-comment">-- Complexity: /O(1)/ time and memory.</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-comment">-- @</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-comment">-- leftAdjacencyMap 'empty'           == Map.'Map.empty'</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-comment">-- leftAdjacencyMap ('leftVertex' x)  == Map.'Map.singleton' x Set.'Set.empty'</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-comment">-- leftAdjacencyMap ('rightVertex' x) == Map.'Map.empty'</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-comment">-- leftAdjacencyMap ('edge' x y)      == Map.'Map.singleton' x (Set.'Set.singleton' y)</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-comment">-- @</span><span>
</span><span id="line-170"></span><span>    </span><span id="leftAdjacencyMap"><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Map a (Set b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftAdjacencyMap"><span class="hs-identifier hs-var hs-var">leftAdjacencyMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118492"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118491"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-comment">-- | The /adjacency map/ of the right part of the graph: each right vertex</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-comment">-- is associated with a set of its left neighbours.</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-comment">-- Complexity: /O(1)/ time and memory.</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-comment">-- @</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-comment">-- rightAdjacencyMap 'empty'           == Map.'Map.empty'</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-comment">-- rightAdjacencyMap ('leftVertex' x)  == Map.'Map.empty'</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-comment">-- rightAdjacencyMap ('rightVertex' x) == Map.'Map.singleton' x Set.'Set.empty'</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-comment">-- rightAdjacencyMap ('edge' x y)      == Map.'Map.singleton' y (Set.'Set.singleton' x)</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-comment">-- @</span><span>
</span><span id="line-182"></span><span>    </span><span id="rightAdjacencyMap"><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Map b (Set a)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightAdjacencyMap"><span class="hs-identifier hs-var hs-var">rightAdjacencyMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118491"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118492"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a b x. Rep (AdjacencyMap a b) x -&gt; AdjacencyMap a b
forall a b x. AdjacencyMap a b -&gt; Rep (AdjacencyMap a b) x
$cto :: forall a b x. Rep (AdjacencyMap a b) x -&gt; AdjacencyMap a b
$cfrom :: forall a b x. AdjacencyMap a b -&gt; Rep (AdjacencyMap a b) x
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- | __Note:__ this does not satisfy the usual ring laws; see 'AdjacencyMap'</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- for more details.</span><span>
</span><span id="line-187"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679117996"><span id="local-6989586621679118481"><span id="local-6989586621679118482"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118482"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118481"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118481"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118482"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118481"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679117988"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; AdjacencyMap a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertex"><span class="hs-identifier hs-var">rightVertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; Integer -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromInteger</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679117984"><span class="annot"><span class="annottext">+ :: AdjacencyMap a b -&gt; AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(+)</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap a b -&gt; AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679117980"><span class="annot"><span class="annottext">* :: AdjacencyMap a b -&gt; AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(*)</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap a b -&gt; AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#connect"><span class="hs-identifier hs-var">connect</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679117978"><span class="annot"><span class="annottext">signum :: AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679117975"><span class="annot"><span class="annottext">abs :: AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679117972"><span class="annot"><span class="annottext">negate :: AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679117969"><span id="local-6989586621679118466"><span id="local-6989586621679118467"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118467"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118466"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118467"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118466"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117962"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117962"><span class="hs-identifier hs-var">ab1</span></a></span></span><span> </span><span id="local-6989586621679117961"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117961"><span class="hs-identifier hs-var">ba1</span></a></span></span><span> </span><span id="local-6989586621679117960"><span class="annot"><span class="annottext">== :: AdjacencyMap a b -&gt; AdjacencyMap a b -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117959"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117959"><span class="hs-identifier hs-var">ab2</span></a></span></span><span> </span><span id="local-6989586621679117958"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117958"><span class="hs-identifier hs-var">ba2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117962"><span class="hs-identifier hs-var">ab1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117959"><span class="hs-identifier hs-var">ab2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117961"><span class="hs-identifier hs-var">ba1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117958"><span class="hs-identifier hs-var">ba2</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679117941"><span id="local-6989586621679117943"><span id="local-6989586621679117945"><span id="local-6989586621679117947"><span id="local-6989586621679117949"><span id="local-6989586621679117951"><span id="local-6989586621679118458"><span id="local-6989586621679118459"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118459"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118458"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118459"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118458"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621679117919"><span class="annot"><span class="annottext">compare :: AdjacencyMap a b -&gt; AdjacencyMap a b -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span id="local-6989586621679117917"><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117917"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679117916"><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117916"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Int
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexCount"><span class="hs-identifier hs-var">vertexCount</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117917"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Int
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexCount"><span class="hs-identifier hs-var">vertexCount</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117916"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Ord a, Ord b) =&gt; AdjacencyMap a b -&gt; Set (Either a b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexSet"><span class="hs-identifier hs-var">vertexSet</span></a></span><span>   </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117917"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Ord a, Ord b) =&gt; AdjacencyMap a b -&gt; Set (Either a b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexSet"><span class="hs-identifier hs-var">vertexSet</span></a></span><span>   </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117916"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Int
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeCount"><span class="hs-identifier hs-var">edgeCount</span></a></span><span>   </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117917"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Int
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeCount"><span class="hs-identifier hs-var">edgeCount</span></a></span><span>   </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117916"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Ord a, Ord b) =&gt; AdjacencyMap a b -&gt; Set (a, b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeSet"><span class="hs-identifier hs-var">edgeSet</span></a></span><span>     </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117917"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Ord a, Ord b) =&gt; AdjacencyMap a b -&gt; Set (a, b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeSet"><span class="hs-identifier hs-var">edgeSet</span></a></span><span>     </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117916"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679117911"><span id="local-6989586621679117913"><span id="local-6989586621679118442"><span id="local-6989586621679118443"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118443"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118442"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118443"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118442"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118443"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118442"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>    </span><span id="local-6989586621679117883"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; AdjacencyMap a b -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679117881"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117881"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679117880"><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117880"><span class="hs-identifier hs-var">g</span></a></span></span><span>
</span><span id="line-207"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117878"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117877"><span class="hs-identifier hs-var">bs</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty&quot;</span></span><span>
</span><span id="line-208"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679117875"><span class="hs-identifier hs-var">es</span></a></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showParen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117881"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. (Show a, Show a) =&gt; [a] -&gt; [a] -&gt; ShowS
</span><a href="#local-6989586621679117872"><span class="hs-identifier hs-var">vShow</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117878"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117877"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117878"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117871"><span class="hs-identifier hs-var">aUsed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117877"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117870"><span class="hs-identifier hs-var">bUsed</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showParen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117881"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. (Show a, Show a) =&gt; [(a, a)] -&gt; ShowS
</span><a href="#local-6989586621679117869"><span class="hs-identifier hs-var">eShow</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679117875"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showParen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117881"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>                                         </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;overlay (&quot;</span></span><span>
</span><span id="line-212"></span><span>                                         </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. (Show a, Show a) =&gt; [Either a a] -&gt; ShowS
</span><a href="#local-6989586621679117868"><span class="hs-identifier hs-var">veShow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679117867"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a b]
</span><a href="#local-6989586621679117866"><span class="hs-identifier hs-var">used</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>                                         </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) (&quot;</span></span><span>
</span><span id="line-214"></span><span>                                         </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. (Show a, Show a) =&gt; [(a, a)] -&gt; ShowS
</span><a href="#local-6989586621679117869"><span class="hs-identifier hs-var">eShow</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679117875"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-215"></span><span>                                         </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>        </span><span id="local-6989586621679117878"><span class="annot"><span class="annottext">as :: [a]
</span><a href="#local-6989586621679117878"><span class="hs-keyword hs-var hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; [a]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertexList"><span class="hs-identifier hs-var">leftVertexList</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117880"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-218"></span><span>        </span><span id="local-6989586621679117877"><span class="annot"><span class="annottext">bs :: [b]
</span><a href="#local-6989586621679117877"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; [b]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertexList"><span class="hs-identifier hs-var">rightVertexList</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117880"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-219"></span><span>        </span><span id="local-6989586621679117867"><span class="annot"><span class="annottext">vs :: [Either a b]
</span><a href="#local-6989586621679117867"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; [Either a b]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexList"><span class="hs-identifier hs-var">vertexList</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117880"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-220"></span><span>        </span><span id="local-6989586621679117875"><span class="annot"><span class="annottext">es :: [(a, b)]
</span><a href="#local-6989586621679117875"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; [(a, b)]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeList"><span class="hs-identifier hs-var">edgeList</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117880"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-221"></span><span>        </span><span id="local-6989586621679117871"><span class="annot"><span class="annottext">aUsed :: [a]
</span><a href="#local-6989586621679117871"><span class="hs-identifier hs-var hs-var">aUsed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromAscList</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117863"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117863"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117863"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; [(a, b)]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeList"><span class="hs-identifier hs-var">edgeList</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117880"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span>        </span><span id="local-6989586621679117870"><span class="annot"><span class="annottext">bUsed :: [b]
</span><a href="#local-6989586621679117870"><span class="hs-identifier hs-var hs-var">bUsed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromAscList</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117862"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117862"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117862"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; [(a, b)]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeList"><span class="hs-identifier hs-var">edgeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; AdjacencyMap b a
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#swap"><span class="hs-identifier hs-var">swap</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117880"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-223"></span><span>        </span><span id="local-6989586621679117866"><span class="annot"><span class="annottext">used :: [Either a b]
</span><a href="#local-6989586621679117866"><span class="hs-identifier hs-var hs-var">used</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117871"><span class="hs-identifier hs-var">aUsed</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117870"><span class="hs-identifier hs-var">bUsed</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span id="local-6989586621679117872"><span class="annot"><span class="annottext">vShow :: [a] -&gt; [a] -&gt; ShowS
</span><a href="#local-6989586621679117872"><span class="hs-identifier hs-var hs-var">vShow</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679117854"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117854"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;leftVertex &quot;</span></span><span>  </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showsPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117854"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><a href="#local-6989586621679117872"><span class="hs-identifier hs-var">vShow</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679117853"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117853"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rightVertex &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showsPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117853"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><a href="#local-6989586621679117872"><span class="hs-identifier hs-var">vShow</span></a></span><span> </span><span id="local-6989586621679117852"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117852"><span class="hs-keyword hs-var">as</span></a></span></span><span>  </span><span id="local-6989586621679117851"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117851"><span class="hs-identifier hs-var">bs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;vertices &quot;</span></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showsPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117852"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-227"></span><span>                      </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showsPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117851"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-228"></span><span>        </span><span id="local-6989586621679117869"><span class="annot"><span class="annottext">eShow :: [(a, a)] -&gt; ShowS
</span><a href="#local-6989586621679117869"><span class="hs-identifier hs-var hs-var">eShow</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679117843"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117843"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117842"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117842"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;edge &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showsPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117843"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-229"></span><span>                       </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showsPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117842"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><a href="#local-6989586621679117869"><span class="hs-identifier hs-var">eShow</span></a></span><span> </span><span id="local-6989586621679117841"><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679117841"><span class="hs-identifier hs-var">es</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;edges &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">showsPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679117841"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-231"></span><span>        </span><span id="local-6989586621679117868"><span class="annot"><span class="annottext">veShow :: [Either a a] -&gt; ShowS
</span><a href="#local-6989586621679117868"><span class="hs-identifier hs-var hs-var">veShow</span></a></span></span><span> </span><span id="local-6989586621679117836"><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679117836"><span class="hs-identifier hs-var">xs</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. (Show a, Show a) =&gt; [a] -&gt; [a] -&gt; ShowS
</span><a href="#local-6989586621679117872"><span class="hs-identifier hs-var">vShow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [Either a b] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">lefts</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679117836"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [Either a b] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">rights</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679117836"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-comment">-- | Defined via 'overlay'.</span><span>
</span><span id="line-234"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679117829"><span id="local-6989586621679117831"><span id="local-6989586621679118399"><span id="local-6989586621679118400"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118400"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118399"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118400"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118399"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621679117825"><span class="annot"><span class="annottext">&lt;&gt; :: AdjacencyMap a b -&gt; AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap a b -&gt; AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | Defined via 'overlay' and 'empty'.</span><span>
</span><span id="line-238"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679117818"><span id="local-6989586621679117820"><span id="local-6989586621679118397"><span id="local-6989586621679118398"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118398"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118397"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118398"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118397"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-239"></span><span>    </span><span id="local-6989586621679117816"><span class="annot"><span class="annottext">mempty :: AdjacencyMap a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | Construct the /empty graph/.</span><span>
</span><span id="line-242"></span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- 'isEmpty' empty           == True</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- 'leftAdjacencyMap' empty  == Map.'Map.empty'</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- 'rightAdjacencyMap' empty == Map.'Map.empty'</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- 'hasVertex' x empty       == False</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-249"></span><span id="local-6989586621679118470"><span id="local-6989586621679118471"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118471"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118470"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-250"></span><span id="empty"><span class="annot"><span class="annottext">empty :: forall a b. AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#empty"><span class="hs-identifier hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | Construct the graph comprising /a single isolated vertex/ in the left part.</span><span>
</span><span id="line-253"></span><span class="hs-comment">--</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- 'leftAdjacencyMap' (leftVertex x)  == Map.'Map.singleton' x Set.'Set.empty'</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- 'rightAdjacencyMap' (leftVertex x) == Map.'Map.empty'</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- 'hasLeftVertex' x (leftVertex y)   == (x == y)</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- 'hasRightVertex' x (leftVertex y)  == False</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- 'hasEdge' x y (leftVertex z)       == False</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-261"></span><span id="local-6989586621679118393"><span id="local-6989586621679118394"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertex"><span class="hs-identifier hs-type">leftVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679118394"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118394"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118393"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-262"></span><span id="leftVertex"><span class="annot"><span class="annottext">leftVertex :: forall a b. a -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertex"><span class="hs-identifier hs-var hs-var">leftVertex</span></a></span></span><span> </span><span id="local-6989586621679117814"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117814"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117814"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | Construct the graph comprising /a single isolated vertex/ in the right part.</span><span>
</span><span id="line-265"></span><span class="hs-comment">--</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- 'leftAdjacencyMap' (rightVertex x)  == Map.'Map.empty'</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- 'rightAdjacencyMap' (rightVertex x) == Map.'Map.singleton' x Set.'Set.empty'</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- 'hasLeftVertex' x (rightVertex y)   == False</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- 'hasRightVertex' x (rightVertex y)  == (x == y)</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- 'hasEdge' x y (rightVertex z)       == False</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-273"></span><span id="local-6989586621679118479"><span id="local-6989586621679118480"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertex"><span class="hs-identifier hs-type">rightVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679118480"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118479"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118480"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-274"></span><span id="rightVertex"><span class="annot"><span class="annottext">rightVertex :: forall b a. b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertex"><span class="hs-identifier hs-var hs-var">rightVertex</span></a></span></span><span> </span><span id="local-6989586621679117811"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117811"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117811"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | Construct the graph comprising /a single isolated vertex/.</span><span>
</span><span id="line-277"></span><span class="hs-comment">--</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- vertex . Left  == 'leftVertex'</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- vertex . Right == 'rightVertex'</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-282"></span><span id="local-6989586621679118386"><span id="local-6989586621679118387"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertex"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118387"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118386"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118387"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118386"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-283"></span><span id="vertex"><span class="annot"><span class="annottext">vertex :: forall a b. Either a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertex"><span class="hs-identifier hs-var hs-var">vertex</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span>  </span><span id="local-6989586621679117810"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117810"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertex"><span class="hs-identifier hs-var">leftVertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117810"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-284"></span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679117809"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117809"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertex"><span class="hs-identifier hs-var">rightVertex</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117809"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | Construct the graph comprising /a single edge/.</span><span>
</span><span id="line-287"></span><span class="hs-comment">--</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- edge x y                     == 'connect' ('leftVertex' x) ('rightVertex' y)</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- 'leftAdjacencyMap' (edge x y)  == Map.'Map.singleton' x (Set.'Set.singleton' y)</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- 'rightAdjacencyMap' (edge x y) == Map.'Map.singleton' y (Set.'Set.singleton' x)</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- 'hasEdge' x y (edge x y)       == True</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- 'hasEdge' 1 2 (edge 2 1)       == False</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-295"></span><span id="local-6989586621679118382"><span id="local-6989586621679118383"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edge"><span class="hs-identifier hs-type">edge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679118383"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118382"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118383"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118382"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-296"></span><span id="edge"><span class="annot"><span class="annottext">edge :: forall a b. a -&gt; b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edge"><span class="hs-identifier hs-var hs-var">edge</span></a></span></span><span> </span><span id="local-6989586621679117808"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117808"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679117807"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117807"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117808"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117807"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117807"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117808"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-- | /Overlay/ two graphs. This is a commutative, associative and idempotent</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- operation with the identity 'empty'.</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- Complexity: /O((n + m) * log(n))/ time and /O(n + m)/ memory.</span><span>
</span><span id="line-302"></span><span class="hs-comment">--</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- 'isEmpty'     (overlay x y) == 'isEmpty'   x   &amp;&amp; 'isEmpty'   y</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- 'hasVertex' z (overlay x y) == 'hasVertex' z x || 'hasVertex' z y</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- 'vertexCount' (overlay x y) &gt;= 'vertexCount' x</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- 'vertexCount' (overlay x y) &lt;= 'vertexCount' x + 'vertexCount' y</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- 'edgeCount'   (overlay x y) &gt;= 'edgeCount' x</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- 'edgeCount'   (overlay x y) &lt;= 'edgeCount' x   + 'edgeCount' y</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-311"></span><span id="local-6989586621679118474"><span id="local-6989586621679118475"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#overlay"><span class="hs-identifier hs-type">overlay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118475"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118474"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118475"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118474"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118475"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118474"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118475"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118474"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-312"></span><span id="overlay"><span class="annot"><span class="annottext">overlay :: forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap a b -&gt; AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#overlay"><span class="hs-identifier hs-var hs-var">overlay</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117799"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117799"><span class="hs-identifier hs-var">ab1</span></a></span></span><span> </span><span id="local-6989586621679117798"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117798"><span class="hs-identifier hs-var">ba1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117797"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117797"><span class="hs-identifier hs-var">ab2</span></a></span></span><span> </span><span id="local-6989586621679117796"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117796"><span class="hs-identifier hs-var">ba2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.unionWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117799"><span class="hs-identifier hs-var">ab1</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117797"><span class="hs-identifier hs-var">ab2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.unionWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117798"><span class="hs-identifier hs-var">ba1</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117796"><span class="hs-identifier hs-var">ba2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="hs-comment">-- | /Connect/ two graphs, filtering out the edges between vertices of the same</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- part. This is a commutative and associative operation with the identity</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- 'empty', which distributes over 'overlay' and obeys the decomposition axiom.</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- Complexity: /O((n + m) * log(n))/ time and /O(n + m)/ memory. Note that the</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- number of edges in the resulting graph is quadratic with respect to the</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- number of vertices in the arguments: /O(m1 + m2 + l1 * r2 + l2 * r1)/.</span><span>
</span><span id="line-321"></span><span class="hs-comment">--</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- connect ('leftVertex' x)     ('leftVertex' y)     == 'vertices' [x,y] []</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- connect ('leftVertex' x)     ('rightVertex' y)    == 'edge' x y</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- connect ('rightVertex' x)    ('leftVertex' y)     == 'edge' y x</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- connect ('rightVertex' x)    ('rightVertex' y)    == 'vertices' [] [x,y]</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- connect ('vertices' xs1 ys1) ('vertices' xs2 ys2) == 'overlay' ('biclique' xs1 ys2) ('biclique' xs2 ys1)</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- 'isEmpty'     (connect x y)                     == 'isEmpty'   x   &amp;&amp; 'isEmpty'   y</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- 'hasVertex' z (connect x y)                     == 'hasVertex' z x || 'hasVertex' z y</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- 'vertexCount' (connect x y)                     &gt;= 'vertexCount' x</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- 'vertexCount' (connect x y)                     &lt;= 'vertexCount' x + 'vertexCount' y</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- 'edgeCount'   (connect x y)                     &gt;= 'edgeCount' x</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- 'edgeCount'   (connect x y)                     &gt;= 'leftVertexCount' x * 'rightVertexCount' y</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- 'edgeCount'   (connect x y)                     &lt;= 'leftVertexCount' x * 'rightVertexCount' y + 'rightVertexCount' x * 'leftVertexCount' y + 'edgeCount' x + 'edgeCount' y</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-336"></span><span id="local-6989586621679117792"><span id="local-6989586621679117793"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#connect"><span class="hs-identifier hs-type">connect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117793"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117792"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117793"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117792"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117793"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117792"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117793"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117792"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-337"></span><span id="connect"><span class="annot"><span class="annottext">connect :: forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap a b -&gt; AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#connect"><span class="hs-identifier hs-var hs-var">connect</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117783"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117783"><span class="hs-identifier hs-var">ab1</span></a></span></span><span> </span><span id="local-6989586621679117782"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117782"><span class="hs-identifier hs-var">ba1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117781"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117781"><span class="hs-identifier hs-var">ab2</span></a></span></span><span> </span><span id="local-6989586621679117780"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117780"><span class="hs-identifier hs-var">ba2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117779"><span class="hs-identifier hs-var">ab</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117778"><span class="hs-identifier hs-var">ba</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>    </span><span id="local-6989586621679117777"><span class="annot"><span class="annottext">a1 :: Set a
</span><a href="#local-6989586621679117777"><span class="hs-identifier hs-var hs-var">a1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117783"><span class="hs-identifier hs-var">ab1</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621679117776"><span class="annot"><span class="annottext">a2 :: Set a
</span><a href="#local-6989586621679117776"><span class="hs-identifier hs-var hs-var">a2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117781"><span class="hs-identifier hs-var">ab2</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span id="local-6989586621679117775"><span class="annot"><span class="annottext">b1 :: Set b
</span><a href="#local-6989586621679117775"><span class="hs-identifier hs-var hs-var">b1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117782"><span class="hs-identifier hs-var">ba1</span></a></span><span>
</span><span id="line-342"></span><span>    </span><span id="local-6989586621679117774"><span class="annot"><span class="annottext">b2 :: Set b
</span><a href="#local-6989586621679117774"><span class="hs-identifier hs-var hs-var">b2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117780"><span class="hs-identifier hs-var">ba2</span></a></span><span>
</span><span id="line-343"></span><span>    </span><span id="local-6989586621679117779"><span class="annot"><span class="annottext">ab :: Map a (Set b)
</span><a href="#local-6989586621679117779"><span class="hs-identifier hs-var hs-var">ab</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
(a -&gt; a -&gt; a) -&gt; f (Map k a) -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.unionsWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span>
</span><span id="line-344"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117783"><span class="hs-identifier hs-var">ab1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117781"><span class="hs-identifier hs-var">ab2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117774"><span class="hs-identifier hs-var">b2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679117777"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117775"><span class="hs-identifier hs-var">b1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679117776"><span class="hs-identifier hs-var">a2</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621679117778"><span class="annot"><span class="annottext">ba :: Map b (Set a)
</span><a href="#local-6989586621679117778"><span class="hs-identifier hs-var hs-var">ba</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
(a -&gt; a -&gt; a) -&gt; f (Map k a) -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.unionsWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117782"><span class="hs-identifier hs-var">ba1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117780"><span class="hs-identifier hs-var">ba2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679117776"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117775"><span class="hs-identifier hs-var">b1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679117777"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117774"><span class="hs-identifier hs-var">b2</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-comment">-- | Construct the graph comprising given lists of isolated vertices in each</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- part.</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- Complexity: /O(L * log(L))/ time and /O(L)/ memory, where /L/ is the total</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- length of two lists.</span><span>
</span><span id="line-352"></span><span class="hs-comment">--</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- vertices [] []                    == 'empty'</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- vertices [x] []                   == 'leftVertex' x</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- vertices [] [x]                   == 'rightVertex' x</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- vertices xs ys                    == 'overlays' ('map' 'leftVertex' xs ++ 'map' 'rightVertex' ys)</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- 'hasLeftVertex'  x (vertices xs ys) == 'elem' x xs</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- 'hasRightVertex' y (vertices xs ys) == 'elem' y ys</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-361"></span><span id="local-6989586621679118365"><span id="local-6989586621679118366"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertices"><span class="hs-identifier hs-type">vertices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118366"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118365"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679118366"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679118365"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118366"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118365"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-362"></span><span id="vertices"><span class="annot"><span class="annottext">vertices :: forall a b. (Ord a, Ord b) =&gt; [a] -&gt; [b] -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertices"><span class="hs-identifier hs-var hs-var">vertices</span></a></span></span><span> </span><span id="local-6989586621679117767"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117767"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679117766"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117766"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117764"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679117764"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117764"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117767"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117763"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679117763"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117763"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117766"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-comment">-- | Construct the graph from a list of edges.</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- Complexity: /O((n + m) * log(n))/ time and /O(n + m)/ memory.</span><span>
</span><span id="line-367"></span><span class="hs-comment">--</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- edges []            == 'empty'</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- edges [(x,y)]       == 'edge' x y</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- edges               == 'overlays' . 'map' ('uncurry' 'edge')</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- 'hasEdge' x y . edges == 'elem' (x,y)</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- 'edgeCount'   . edges == 'length' . 'nub'</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-375"></span><span id="local-6989586621679118359"><span id="local-6989586621679118360"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edges"><span class="hs-identifier hs-type">edges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118360"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118359"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118360"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679118359"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118360"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118359"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-376"></span><span id="edges"><span class="annot"><span class="annottext">edges :: forall a b. (Ord a, Ord b) =&gt; [(a, b)] -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edges"><span class="hs-identifier hs-var hs-var">edges</span></a></span></span><span> </span><span id="local-6989586621679117756"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679117756"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromListWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117754"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117753"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117754"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117754"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117753"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117753"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679117756"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromListWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117752"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117751"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117751"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117751"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117752"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117752"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679117756"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-comment">-- | Overlay a given list of graphs.</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- Complexity: /O((n + m) * log(n))/ time and /O(n + m)/ memory.</span><span>
</span><span id="line-381"></span><span class="hs-comment">--</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- overlays []        == 'empty'</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- overlays [x]       == x</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- overlays [x,y]     == 'overlay' x y</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- overlays           == 'foldr' 'overlay' 'empty'</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- 'isEmpty' . overlays == 'all' 'isEmpty'</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-389"></span><span id="local-6989586621679117749"><span id="local-6989586621679117750"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#overlays"><span class="hs-identifier hs-type">overlays</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117750"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117749"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117750"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117749"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117750"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117749"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-390"></span><span id="overlays"><span class="annot"><span class="annottext">overlays :: forall a b.
(Ord a, Ord b) =&gt;
[AdjacencyMap a b] -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#overlays"><span class="hs-identifier hs-var hs-var">overlays</span></a></span></span><span> </span><span id="local-6989586621679117740"><span class="annot"><span class="annottext">[AdjacencyMap a b]
</span><a href="#local-6989586621679117740"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
(a -&gt; a -&gt; a) -&gt; f (Map k a) -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.unionsWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Map a (Set b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftAdjacencyMap"><span class="hs-identifier hs-var">leftAdjacencyMap</span></a></span><span>  </span><span class="annot"><span class="annottext">[AdjacencyMap a b]
</span><a href="#local-6989586621679117740"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
(a -&gt; a -&gt; a) -&gt; f (Map k a) -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.unionsWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Map b (Set a)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightAdjacencyMap"><span class="hs-identifier hs-var">rightAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">[AdjacencyMap a b]
</span><a href="#local-6989586621679117740"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- | Connect a given list of graphs.</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- Complexity: /O((n + m) * log(n))/ time and /O(n + m)/ memory.</span><span>
</span><span id="line-395"></span><span class="hs-comment">--</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- connects []        == 'empty'</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- connects [x]       == x</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- connects [x,y]     == connect x y</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- connects           == 'foldr' 'connect' 'empty'</span><span>
</span><span id="line-401"></span><span class="hs-comment">-- 'isEmpty' . connects == 'all' 'isEmpty'</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-403"></span><span id="local-6989586621679117738"><span id="local-6989586621679117739"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#connects"><span class="hs-identifier hs-type">connects</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117739"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117738"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117739"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117738"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117739"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117738"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-404"></span><span id="connects"><span class="annot"><span class="annottext">connects :: forall a b.
(Ord a, Ord b) =&gt;
[AdjacencyMap a b] -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#connects"><span class="hs-identifier hs-var hs-var">connects</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap a b -&gt; AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#connect"><span class="hs-identifier hs-var">connect</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="hs-comment">-- | Swap the parts of a given graph.</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- Complexity: /O(1)/ time and memory.</span><span>
</span><span id="line-408"></span><span class="hs-comment">--</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- swap 'empty'            == 'empty'</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- swap . 'leftVertex'     == 'rightVertex'</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- swap ('vertices' xs ys) == 'vertices' ys xs</span><span>
</span><span id="line-413"></span><span class="hs-comment">-- swap ('edge' x y)       == 'edge' y x</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- swap . 'edges'          == 'edges' . 'map' Data.Tuple.'Data.Tuple.swap'</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- swap . swap           == 'id'</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-417"></span><span id="local-6989586621679118415"><span id="local-6989586621679118416"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#swap"><span class="hs-identifier hs-type">swap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118416"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118415"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118415"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118416"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-418"></span><span id="swap"><span class="annot"><span class="annottext">swap :: forall a b. AdjacencyMap a b -&gt; AdjacencyMap b a
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#swap"><span class="hs-identifier hs-var hs-var">swap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117731"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117731"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span id="local-6989586621679117730"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117730"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117730"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117731"><span class="hs-identifier hs-var">ab</span></a></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="hs-comment">-- | Construct a bipartite 'AdjacencyMap' from an &quot;Algebra.Graph.AdjacencyMap&quot;,</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- adding any missing edges to make the graph undirected and filtering out the</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- edges within the same parts.</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- Complexity: /O(m * log(n))/.</span><span>
</span><span id="line-424"></span><span class="hs-comment">--</span><span>
</span><span id="line-425"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-426"></span><span class="hs-comment">-- toBipartite 'Algebra.Graph.AdjacencyMap.empty'                      == 'empty'</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- toBipartite ('Algebra.Graph.AdjacencyMap.vertex' (Left x))          == 'leftVertex' x</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- toBipartite ('Algebra.Graph.AdjacencyMap.vertex' (Right x))         == 'rightVertex' x</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- toBipartite ('Algebra.Graph.AdjacencyMap.edge' (Left x) (Left y))   == 'vertices' [x,y] []</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- toBipartite ('Algebra.Graph.AdjacencyMap.edge' (Left x) (Right y))  == 'edge' x y</span><span>
</span><span id="line-431"></span><span class="hs-comment">-- toBipartite ('Algebra.Graph.AdjacencyMap.edge' (Right x) (Left y))  == 'edge' y x</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- toBipartite ('Algebra.Graph.AdjacencyMap.edge' (Right x) (Right y)) == 'vertices' [] [x,y]</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- toBipartite . 'Algebra.Graph.AdjacencyMap.clique'                   == 'uncurry' 'biclique' . 'partitionEithers'</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- toBipartite . 'fromBipartite'            == 'id'</span><span>
</span><span id="line-435"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-436"></span><span id="local-6989586621679118345"><span id="local-6989586621679118346"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#toBipartite"><span class="hs-identifier hs-type">toBipartite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118346"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118345"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AM.AdjacencyMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118346"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118345"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118346"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118345"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-437"></span><span id="toBipartite"><span class="annot"><span class="annottext">toBipartite :: forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap (Either a b) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#toBipartite"><span class="hs-identifier hs-var hs-var">toBipartite</span></a></span></span><span> </span><span id="local-6989586621679117722"><span class="annot"><span class="annottext">AdjacencyMap (Either a b)
</span><a href="#local-6989586621679117722"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Eq k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromAscList</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117720"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall {a}. Set (Either a b) -&gt; Set b
</span><a href="#local-6989586621679117719"><span class="hs-identifier hs-var">getRights</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Either a b)
</span><a href="#local-6989586621679117718"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span>  </span><span id="local-6989586621679117720"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117720"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117718"><span class="annot"><span class="annottext">Set (Either a b)
</span><a href="#local-6989586621679117718"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Either a b, Set (Either a b))]
</span><a href="#local-6989586621679117717"><span class="hs-identifier hs-var">am</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Eq k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromAscList</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117716"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall {b}. Set (Either a b) -&gt; Set a
</span><a href="#local-6989586621679117715"><span class="hs-identifier hs-var">getLefts</span></a></span><span>  </span><span class="annot"><span class="annottext">Set (Either a b)
</span><a href="#local-6989586621679117714"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679117716"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117716"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117714"><span class="annot"><span class="annottext">Set (Either a b)
</span><a href="#local-6989586621679117714"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Either a b, Set (Either a b))]
</span><a href="#local-6989586621679117717"><span class="hs-identifier hs-var">am</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-440"></span><span>    </span><span id="local-6989586621679117719"><span class="annot"><span class="annottext">getRights :: Set (Either a b) -&gt; Set b
</span><a href="#local-6989586621679117719"><span class="hs-identifier hs-var hs-var">getRights</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromAscList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [Either a b] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">rights</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toAscList</span></a></span><span>
</span><span id="line-441"></span><span>    </span><span id="local-6989586621679117715"><span class="annot"><span class="annottext">getLefts :: Set (Either a b) -&gt; Set a
</span><a href="#local-6989586621679117715"><span class="hs-identifier hs-var hs-var">getLefts</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromAscList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [Either a b] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">lefts</span></a></span><span>  </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toAscList</span></a></span><span>
</span><span id="line-442"></span><span>    </span><span id="local-6989586621679117717"><span class="annot"><span class="annottext">am :: [(Either a b, Set (Either a b))]
</span><a href="#local-6989586621679117717"><span class="hs-identifier hs-var hs-var">am</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. AdjacencyMap a -&gt; Map a (Set a)
</span><a href="Algebra.Graph.AdjacencyMap.html#adjacencyMap"><span class="hs-identifier hs-var">AM.adjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; AdjacencyMap a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.AdjacencyMap.html#symmetricClosure"><span class="hs-identifier hs-var">AM.symmetricClosure</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap (Either a b)
</span><a href="#local-6989586621679117722"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-comment">-- | Construct a bipartite 'AdjacencyMap' from an &quot;Algebra.Graph.AdjacencyMap&quot;,</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- where the two parts are identified by a separate function, adding any missing</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- edges to make the graph undirected and filtering out the edges within the</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- same parts.</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- Complexity: /O(m * log(n))/.</span><span>
</span><span id="line-449"></span><span class="hs-comment">--</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- toBipartiteWith f 'Algebra.Graph.AdjacencyMap.empty' == 'empty'</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- toBipartiteWith Left x  == 'vertices' ('vertexList' x) []</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- toBipartiteWith Right x == 'vertices' [] ('vertexList' x)</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- toBipartiteWith f       == 'toBipartite' . 'Algebra.Graph.AdjacencyMap.gmap' f</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- toBipartiteWith id      == 'toBipartite'</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-457"></span><span id="local-6989586621679118331"><span id="local-6989586621679118332"><span id="local-6989586621679118333"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#toBipartiteWith"><span class="hs-identifier hs-type">toBipartiteWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118333"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118332"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118331"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118333"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118332"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118331"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AM.AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118333"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118332"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118331"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-458"></span><span id="toBipartiteWith"><span class="annot"><span class="annottext">toBipartiteWith :: forall a b c.
(Ord a, Ord b, Ord c) =&gt;
(a -&gt; Either b c) -&gt; AdjacencyMap a -&gt; AdjacencyMap b c
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#toBipartiteWith"><span class="hs-identifier hs-var hs-var">toBipartiteWith</span></a></span></span><span> </span><span id="local-6989586621679117701"><span class="annot"><span class="annottext">a -&gt; Either b c
</span><a href="#local-6989586621679117701"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap (Either a b) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#toBipartite"><span class="hs-identifier hs-var">toBipartite</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
(a -&gt; b) -&gt; AdjacencyMap a -&gt; AdjacencyMap b
</span><a href="Algebra.Graph.AdjacencyMap.html#gmap"><span class="hs-identifier hs-var">AM.gmap</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either b c
</span><a href="#local-6989586621679117701"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="hs-comment">-- | Construct an &quot;Algebra.Graph.AdjacencyMap&quot; from a bipartite 'AdjacencyMap'.</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- Complexity: /O(m * log(n))/.</span><span>
</span><span id="line-462"></span><span class="hs-comment">--</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- fromBipartite 'empty'          == 'Algebra.Graph.AdjacencyMap.empty'</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- fromBipartite ('leftVertex' x) == 'Algebra.Graph.AdjacencyMap.vertex' (Left x)</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- fromBipartite ('edge' x y)     == 'Algebra.Graph.AdjacencyMap.edges' [(Left x, Right y), (Right y, Left x)]</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- 'toBipartite' . fromBipartite  == 'id'</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-469"></span><span id="local-6989586621679118324"><span id="local-6989586621679118325"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#fromBipartite"><span class="hs-identifier hs-type">fromBipartite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118325"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118324"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118325"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118324"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AM.AdjacencyMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118325"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118324"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-470"></span><span id="fromBipartite"><span class="annot"><span class="annottext">fromBipartite :: forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap a b -&gt; AdjacencyMap (Either a b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#fromBipartite"><span class="hs-identifier hs-var hs-var">fromBipartite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117696"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117696"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span id="local-6989586621679117695"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117695"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [(a, Set a)] -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.AdjacencyMap.html#fromAdjacencySets"><span class="hs-identifier hs-var">AM.fromAdjacencySets</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-471"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span>  </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117693"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; Set a -&gt; Set b
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.mapMonotonic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117691"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117693"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117693"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117691"><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117691"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117696"><span class="hs-identifier hs-var">ab</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-472"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117690"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; Set a -&gt; Set b
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.mapMonotonic</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span>  </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679117689"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117690"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117690"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117689"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679117689"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117695"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="hs-comment">-- | Construct an &quot;Algebra.Graph.AdjacencyMap&quot; from a bipartite 'AdjacencyMap'</span><span>
</span><span id="line-475"></span><span class="hs-comment">-- given a way to inject vertices of the two parts into the resulting vertex</span><span>
</span><span id="line-476"></span><span class="hs-comment">-- type.</span><span>
</span><span id="line-477"></span><span class="hs-comment">-- Complexity: /O(m * log(n))/.</span><span>
</span><span id="line-478"></span><span class="hs-comment">--</span><span>
</span><span id="line-479"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-480"></span><span class="hs-comment">-- fromBipartiteWith Left Right             == 'fromBipartite'</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- fromBipartiteWith id id ('vertices' xs ys) == 'Algebra.Graph.AdjacencyMap.vertices' (xs ++ ys)</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- fromBipartiteWith id id . 'edges'          == 'Algebra.Graph.AdjacencyMap.symmetricClosure' . 'Algebra.Graph.AdjacencyMap.edges'</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-484"></span><span id="local-6989586621679118316"><span id="local-6989586621679118317"><span id="local-6989586621679118318"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#fromBipartiteWith"><span class="hs-identifier hs-type">fromBipartiteWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118318"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118317"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118318"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118316"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118318"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118317"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118316"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AM.AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118318"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-485"></span><span id="fromBipartiteWith"><span class="annot"><span class="annottext">fromBipartiteWith :: forall c a b.
Ord c =&gt;
(a -&gt; c) -&gt; (b -&gt; c) -&gt; AdjacencyMap a b -&gt; AdjacencyMap c
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#fromBipartiteWith"><span class="hs-identifier hs-var hs-var">fromBipartiteWith</span></a></span></span><span> </span><span id="local-6989586621679117684"><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621679117684"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679117683"><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679117683"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117682"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117682"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span id="local-6989586621679117681"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117681"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [(a, Set a)] -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.AdjacencyMap.html#fromAdjacencySets"><span class="hs-identifier hs-var">AM.fromAdjacencySets</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621679117684"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117680"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.map</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679117683"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117678"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117680"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117680"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117678"><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117678"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117682"><span class="hs-identifier hs-var">ab</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679117683"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117677"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.map</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621679117684"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679117676"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117677"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117677"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117676"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679117676"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117681"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="hs-comment">-- | Check if a graph is empty.</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- Complexity: /O(1)/ time.</span><span>
</span><span id="line-491"></span><span class="hs-comment">--</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- isEmpty 'empty'                 == True</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- isEmpty ('overlay' 'empty' 'empty') == True</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- isEmpty ('vertex' x)            == False</span><span>
</span><span id="line-496"></span><span class="hs-comment">-- isEmpty                       == (==) 'empty'</span><span>
</span><span id="line-497"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-498"></span><span id="local-6989586621679118309"><span id="local-6989586621679118310"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#isEmpty"><span class="hs-identifier hs-type">isEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118310"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118309"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-499"></span><span id="isEmpty"><span class="annot"><span class="annottext">isEmpty :: forall a b. AdjacencyMap a b -&gt; Bool
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#isEmpty"><span class="hs-identifier hs-var hs-var">isEmpty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117675"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117675"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span id="local-6989586621679117674"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117674"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.null</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117675"><span class="hs-identifier hs-var">ab</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.null</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117674"><span class="hs-identifier hs-var">ba</span></a></span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span class="hs-comment">-- | Check if a graph contains a given vertex in the left part.</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- Complexity: /O(log(l))/ time.</span><span>
</span><span id="line-503"></span><span class="hs-comment">--</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- hasLeftVertex x 'empty'           == False</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- hasLeftVertex x ('leftVertex' y)  == (x == y)</span><span>
</span><span id="line-507"></span><span class="hs-comment">-- hasLeftVertex x ('rightVertex' y) == False</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-509"></span><span id="local-6989586621679118303"><span id="local-6989586621679118304"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasLeftVertex"><span class="hs-identifier hs-type">hasLeftVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118304"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118304"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118304"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118303"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-510"></span><span id="hasLeftVertex"><span class="annot"><span class="annottext">hasLeftVertex :: forall a b. Ord a =&gt; a -&gt; AdjacencyMap a b -&gt; Bool
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasLeftVertex"><span class="hs-identifier hs-var hs-var">hasLeftVertex</span></a></span></span><span> </span><span id="local-6989586621679117670"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117670"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117669"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117669"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.member</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117670"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117669"><span class="hs-identifier hs-var">ab</span></a></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="hs-comment">-- | Check if a graph contains a given vertex in the right part.</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- Complexity: /O(log(r))/ time.</span><span>
</span><span id="line-514"></span><span class="hs-comment">--</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- hasRightVertex x 'empty'           == False</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- hasRightVertex x ('leftVertex' y)  == False</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- hasRightVertex x ('rightVertex' y) == (x == y)</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-520"></span><span id="local-6989586621679118297"><span id="local-6989586621679118298"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasRightVertex"><span class="hs-identifier hs-type">hasRightVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118298"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118298"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118297"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118298"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-521"></span><span id="hasRightVertex"><span class="annot"><span class="annottext">hasRightVertex :: forall b a. Ord b =&gt; b -&gt; AdjacencyMap a b -&gt; Bool
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasRightVertex"><span class="hs-identifier hs-var hs-var">hasRightVertex</span></a></span></span><span> </span><span id="local-6989586621679117665"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117665"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679117664"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117664"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.member</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117665"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117664"><span class="hs-identifier hs-var">ba</span></a></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="hs-comment">-- | Check if a graph contains a given vertex.</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- Complexity: /O(log(n))/ time.</span><span>
</span><span id="line-525"></span><span class="hs-comment">--</span><span>
</span><span id="line-526"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-527"></span><span class="hs-comment">-- hasVertex . Left  == 'hasLeftVertex'</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- hasVertex . Right == 'hasRightVertex'</span><span>
</span><span id="line-529"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-530"></span><span id="local-6989586621679118293"><span id="local-6989586621679118294"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasVertex"><span class="hs-identifier hs-type">hasVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118294"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118293"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118294"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118293"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118294"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118293"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-531"></span><span id="hasVertex"><span class="annot"><span class="annottext">hasVertex :: forall a b.
(Ord a, Ord b) =&gt;
Either a b -&gt; AdjacencyMap a b -&gt; Bool
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasVertex"><span class="hs-identifier hs-var hs-var">hasVertex</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span>  </span><span id="local-6989586621679117659"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117659"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Ord a =&gt; a -&gt; AdjacencyMap a b -&gt; Bool
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasLeftVertex"><span class="hs-identifier hs-var">hasLeftVertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117659"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-532"></span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasVertex"><span class="hs-identifier hs-var">hasVertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679117658"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117658"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; b -&gt; AdjacencyMap a b -&gt; Bool
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasRightVertex"><span class="hs-identifier hs-var">hasRightVertex</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117658"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span class="hs-comment">-- | Check if a graph contains a given edge.</span><span>
</span><span id="line-535"></span><span class="hs-comment">-- Complexity: /O(log(n))/ time.</span><span>
</span><span id="line-536"></span><span class="hs-comment">--</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- hasEdge x y 'empty'      == False</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- hasEdge x y ('vertex' z) == False</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- hasEdge x y ('edge' x y) == True</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- hasEdge x y            == 'elem' (x,y) . 'edgeList'</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-543"></span><span id="local-6989586621679118289"><span id="local-6989586621679118290"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasEdge"><span class="hs-identifier hs-type">hasEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118290"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118289"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118290"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118289"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118290"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118289"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-544"></span><span id="hasEdge"><span class="annot"><span class="annottext">hasEdge :: forall a b. (Ord a, Ord b) =&gt; a -&gt; b -&gt; AdjacencyMap a b -&gt; Bool
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#hasEdge"><span class="hs-identifier hs-var hs-var">hasEdge</span></a></span></span><span> </span><span id="local-6989586621679117647"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117647"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679117646"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117646"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117645"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117645"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.member</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117646"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117647"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117645"><span class="hs-identifier hs-var">ab</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span class="hs-comment">-- | The number of vertices in the left part of a graph.</span><span>
</span><span id="line-547"></span><span class="hs-comment">-- Complexity: /O(1)/ time.</span><span>
</span><span id="line-548"></span><span class="hs-comment">--</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- leftVertexCount 'empty'           == 0</span><span>
</span><span id="line-551"></span><span class="hs-comment">-- leftVertexCount ('leftVertex' x)  == 1</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- leftVertexCount ('rightVertex' x) == 0</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- leftVertexCount ('edge' x y)      == 1</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- leftVertexCount . 'edges'         == 'length' . 'nub' . 'map' 'fst'</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-556"></span><span id="local-6989586621679117640"><span id="local-6989586621679117641"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertexCount"><span class="hs-identifier hs-type">leftVertexCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117641"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117640"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span></span><span>
</span><span id="line-557"></span><span id="leftVertexCount"><span class="annot"><span class="annottext">leftVertexCount :: forall a b. AdjacencyMap a b -&gt; Int
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertexCount"><span class="hs-identifier hs-var hs-var">leftVertexCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Int
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.size</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Map a (Set b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftAdjacencyMap"><span class="hs-identifier hs-var">leftAdjacencyMap</span></a></span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span class="hs-comment">-- | The number of vertices in the right part of a graph.</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- Complexity: /O(1)/ time.</span><span>
</span><span id="line-561"></span><span class="hs-comment">--</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- rightVertexCount 'empty'           == 0</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- rightVertexCount ('leftVertex' x)  == 0</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- rightVertexCount ('rightVertex' x) == 1</span><span>
</span><span id="line-566"></span><span class="hs-comment">-- rightVertexCount ('edge' x y)      == 1</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- rightVertexCount . 'edges'         == 'length' . 'nub' . 'map' 'snd'</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-569"></span><span id="local-6989586621679117637"><span id="local-6989586621679117638"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertexCount"><span class="hs-identifier hs-type">rightVertexCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117637"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span></span><span>
</span><span id="line-570"></span><span id="rightVertexCount"><span class="annot"><span class="annottext">rightVertexCount :: forall a b. AdjacencyMap a b -&gt; Int
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertexCount"><span class="hs-identifier hs-var hs-var">rightVertexCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Int
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.size</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Map b (Set a)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightAdjacencyMap"><span class="hs-identifier hs-var">rightAdjacencyMap</span></a></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span class="hs-comment">-- | The number of vertices in a graph.</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- Complexity: /O(1)/ time.</span><span>
</span><span id="line-574"></span><span class="hs-comment">--</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- vertexCount 'empty'      == 0</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- vertexCount ('vertex' x) == 1</span><span>
</span><span id="line-578"></span><span class="hs-comment">-- vertexCount ('edge' x y) == 2</span><span>
</span><span id="line-579"></span><span class="hs-comment">-- vertexCount x          == 'leftVertexCount' x + 'rightVertexCount' x</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-581"></span><span id="local-6989586621679118450"><span id="local-6989586621679118451"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexCount"><span class="hs-identifier hs-type">vertexCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118451"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118450"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span></span><span>
</span><span id="line-582"></span><span id="vertexCount"><span class="annot"><span class="annottext">vertexCount :: forall a b. AdjacencyMap a b -&gt; Int
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexCount"><span class="hs-identifier hs-var hs-var">vertexCount</span></a></span></span><span> </span><span id="local-6989586621679117635"><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117635"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Int
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertexCount"><span class="hs-identifier hs-var">leftVertexCount</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117635"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Int
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertexCount"><span class="hs-identifier hs-var">rightVertexCount</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117635"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span class="hs-comment">-- | The number of edges in a graph.</span><span>
</span><span id="line-585"></span><span class="hs-comment">-- Complexity: /O(l)/ time.</span><span>
</span><span id="line-586"></span><span class="hs-comment">--</span><span>
</span><span id="line-587"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-588"></span><span class="hs-comment">-- edgeCount 'empty'      == 0</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- edgeCount ('vertex' x) == 0</span><span>
</span><span id="line-590"></span><span class="hs-comment">-- edgeCount ('edge' x y) == 1</span><span>
</span><span id="line-591"></span><span class="hs-comment">-- edgeCount . 'edges'    == 'length' . 'nub'</span><span>
</span><span id="line-592"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-593"></span><span id="local-6989586621679117633"><span id="local-6989586621679117634"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeCount"><span class="hs-identifier hs-type">edgeCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117634"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117633"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span></span><span>
</span><span id="line-594"></span><span id="edgeCount"><span class="annot"><span class="annottext">edgeCount :: forall a b. AdjacencyMap a b -&gt; Int
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeCount"><span class="hs-identifier hs-var hs-var">edgeCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b k. (a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; Int
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Map a (Set b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftAdjacencyMap"><span class="hs-identifier hs-var">leftAdjacencyMap</span></a></span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="hs-comment">-- | The sorted list of vertices of the left part of a graph.</span><span>
</span><span id="line-597"></span><span class="hs-comment">-- Complexity: /O(l)/ time and memory.</span><span>
</span><span id="line-598"></span><span class="hs-comment">--</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-600"></span><span class="hs-comment">-- leftVertexList 'empty'              == []</span><span>
</span><span id="line-601"></span><span class="hs-comment">-- leftVertexList ('leftVertex' x)     == [x]</span><span>
</span><span id="line-602"></span><span class="hs-comment">-- leftVertexList ('rightVertex' x)    == []</span><span>
</span><span id="line-603"></span><span class="hs-comment">-- leftVertexList . 'flip' 'vertices' [] == 'nub' . 'sort'</span><span>
</span><span id="line-604"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-605"></span><span id="local-6989586621679118425"><span id="local-6989586621679118426"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertexList"><span class="hs-identifier hs-type">leftVertexList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118426"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118425"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679118426"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-606"></span><span id="leftVertexList"><span class="annot"><span class="annottext">leftVertexList :: forall a b. AdjacencyMap a b -&gt; [a]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertexList"><span class="hs-identifier hs-var hs-var">leftVertexList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [k]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keys</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Map a (Set b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftAdjacencyMap"><span class="hs-identifier hs-var">leftAdjacencyMap</span></a></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="hs-comment">-- | The sorted list of vertices of the right part of a graph.</span><span>
</span><span id="line-609"></span><span class="hs-comment">-- Complexity: /O(r)/ time and memory.</span><span>
</span><span id="line-610"></span><span class="hs-comment">--</span><span>
</span><span id="line-611"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-612"></span><span class="hs-comment">-- rightVertexList 'empty'           == []</span><span>
</span><span id="line-613"></span><span class="hs-comment">-- rightVertexList ('leftVertex' x)  == []</span><span>
</span><span id="line-614"></span><span class="hs-comment">-- rightVertexList ('rightVertex' x) == [x]</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- rightVertexList . 'vertices' []   == 'nub' . 'sort'</span><span>
</span><span id="line-616"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-617"></span><span id="local-6989586621679118423"><span id="local-6989586621679118424"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertexList"><span class="hs-identifier hs-type">rightVertexList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118424"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118423"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679118423"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-618"></span><span id="rightVertexList"><span class="annot"><span class="annottext">rightVertexList :: forall a b. AdjacencyMap a b -&gt; [b]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertexList"><span class="hs-identifier hs-var hs-var">rightVertexList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [k]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keys</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Map b (Set a)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightAdjacencyMap"><span class="hs-identifier hs-var">rightAdjacencyMap</span></a></span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="hs-comment">-- | The sorted list of vertices of a graph.</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- Complexity: /O(n)/ time and memory</span><span>
</span><span id="line-622"></span><span class="hs-comment">--</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-624"></span><span class="hs-comment">-- vertexList 'empty'                             == []</span><span>
</span><span id="line-625"></span><span class="hs-comment">-- vertexList ('vertex' x)                        == [x]</span><span>
</span><span id="line-626"></span><span class="hs-comment">-- vertexList ('edge' x y)                        == [Left x, Right y]</span><span>
</span><span id="line-627"></span><span class="hs-comment">-- vertexList ('vertices' ('lefts' xs) ('rights' xs)) == 'nub' ('sort' xs)</span><span>
</span><span id="line-628"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-629"></span><span id="local-6989586621679118421"><span id="local-6989586621679118422"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexList"><span class="hs-identifier hs-type">vertexList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118422"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118421"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118422"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118421"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-630"></span><span id="vertexList"><span class="annot"><span class="annottext">vertexList :: forall a b. AdjacencyMap a b -&gt; [Either a b]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexList"><span class="hs-identifier hs-var hs-var">vertexList</span></a></span></span><span> </span><span id="local-6989586621679117627"><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117627"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; [a]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertexList"><span class="hs-identifier hs-var">leftVertexList</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117627"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; [b]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertexList"><span class="hs-identifier hs-var">rightVertexList</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117627"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>
</span><span id="line-632"></span><span class="hs-comment">-- | The sorted list of edges of a graph.</span><span>
</span><span id="line-633"></span><span class="hs-comment">-- Complexity: /O(n + m)/ time and /O(m)/ memory.</span><span>
</span><span id="line-634"></span><span class="hs-comment">--</span><span>
</span><span id="line-635"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-636"></span><span class="hs-comment">-- edgeList 'empty'      == []</span><span>
</span><span id="line-637"></span><span class="hs-comment">-- edgeList ('vertex' x) == []</span><span>
</span><span id="line-638"></span><span class="hs-comment">-- edgeList ('edge' x y) == [(x,y)]</span><span>
</span><span id="line-639"></span><span class="hs-comment">-- edgeList . 'edges'    == 'nub' . 'sort'</span><span>
</span><span id="line-640"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-641"></span><span id="local-6989586621679118419"><span id="local-6989586621679118420"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeList"><span class="hs-identifier hs-type">edgeList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118420"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118419"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118420"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679118419"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-642"></span><span id="edgeList"><span class="annot"><span class="annottext">edgeList :: forall a b. AdjacencyMap a b -&gt; [(a, b)]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeList"><span class="hs-identifier hs-var hs-var">edgeList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117626"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117626"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117625"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117624"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117625"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117625"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117623"><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117623"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117626"><span class="hs-identifier hs-var">ab</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117624"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117624"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117623"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span class="hs-comment">-- | The set of vertices of the left part of a graph.</span><span>
</span><span id="line-645"></span><span class="hs-comment">-- Complexity: /O(l)/ time and memory.</span><span>
</span><span id="line-646"></span><span class="hs-comment">--</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- leftVertexSet 'empty'              == Set.'Set.empty'</span><span>
</span><span id="line-649"></span><span class="hs-comment">-- leftVertexSet . 'leftVertex'       == Set.'Set.singleton'</span><span>
</span><span id="line-650"></span><span class="hs-comment">-- leftVertexSet . 'rightVertex'      == 'const' Set.'Set.empty'</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- leftVertexSet . 'flip' 'vertices' [] == Set.'Set.fromList'</span><span>
</span><span id="line-652"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-653"></span><span id="local-6989586621679118253"><span id="local-6989586621679118254"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertexSet"><span class="hs-identifier hs-type">leftVertexSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118254"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118253"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118254"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-654"></span><span id="leftVertexSet"><span class="annot"><span class="annottext">leftVertexSet :: forall a b. AdjacencyMap a b -&gt; Set a
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertexSet"><span class="hs-identifier hs-var hs-var">leftVertexSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Map a (Set b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftAdjacencyMap"><span class="hs-identifier hs-var">leftAdjacencyMap</span></a></span><span>
</span><span id="line-655"></span><span>
</span><span id="line-656"></span><span class="hs-comment">-- | The set of vertices of the right part of a graph.</span><span>
</span><span id="line-657"></span><span class="hs-comment">-- Complexity: /O(r)/ time and memory.</span><span>
</span><span id="line-658"></span><span class="hs-comment">--</span><span>
</span><span id="line-659"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-660"></span><span class="hs-comment">-- rightVertexSet 'empty'         == Set.'Set.empty'</span><span>
</span><span id="line-661"></span><span class="hs-comment">-- rightVertexSet . 'leftVertex'  == 'const' Set.'Set.empty'</span><span>
</span><span id="line-662"></span><span class="hs-comment">-- rightVertexSet . 'rightVertex' == Set.'Set.singleton'</span><span>
</span><span id="line-663"></span><span class="hs-comment">-- rightVertexSet . 'vertices' [] == Set.'Set.fromList'</span><span>
</span><span id="line-664"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-665"></span><span id="local-6989586621679118249"><span id="local-6989586621679118250"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertexSet"><span class="hs-identifier hs-type">rightVertexSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118250"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118249"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118249"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-666"></span><span id="rightVertexSet"><span class="annot"><span class="annottext">rightVertexSet :: forall a b. AdjacencyMap a b -&gt; Set b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightVertexSet"><span class="hs-identifier hs-var hs-var">rightVertexSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; Map b (Set a)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightAdjacencyMap"><span class="hs-identifier hs-var">rightAdjacencyMap</span></a></span><span>
</span><span id="line-667"></span><span>
</span><span id="line-668"></span><span class="hs-comment">-- TODO: Check if implementing this via 'Set.mapMonotonic' would be faster.</span><span>
</span><span id="line-669"></span><span class="hs-comment">-- | The set of vertices of a graph.</span><span>
</span><span id="line-670"></span><span class="hs-comment">-- Complexity: /O(n)/ time and memory.</span><span>
</span><span id="line-671"></span><span class="hs-comment">--</span><span>
</span><span id="line-672"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-673"></span><span class="hs-comment">-- vertexSet 'empty'                             == Set.'Set.empty'</span><span>
</span><span id="line-674"></span><span class="hs-comment">-- vertexSet . 'vertex'                          == Set.'Set.singleton'</span><span>
</span><span id="line-675"></span><span class="hs-comment">-- vertexSet ('edge' x y)                        == Set.'Set.fromList' [Left x, Right y]</span><span>
</span><span id="line-676"></span><span class="hs-comment">-- vertexSet ('vertices' ('lefts' xs) ('rights' xs)) == Set.'Set.fromList' xs</span><span>
</span><span id="line-677"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-678"></span><span id="local-6989586621679118448"><span id="local-6989586621679118449"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexSet"><span class="hs-identifier hs-type">vertexSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118449"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118448"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118449"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118448"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118449"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118448"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-679"></span><span id="vertexSet"><span class="annot"><span class="annottext">vertexSet :: forall a b. (Ord a, Ord b) =&gt; AdjacencyMap a b -&gt; Set (Either a b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexSet"><span class="hs-identifier hs-var hs-var">vertexSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromAscList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; [Either a b]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertexList"><span class="hs-identifier hs-var">vertexList</span></a></span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span class="hs-comment">-- | The set of edges of a graph.</span><span>
</span><span id="line-682"></span><span class="hs-comment">-- Complexity: /O(n + m)/ time and /O(m)/ memory.</span><span>
</span><span id="line-683"></span><span class="hs-comment">--</span><span>
</span><span id="line-684"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-685"></span><span class="hs-comment">-- edgeSet 'empty'      == Set.'Data.Set.empty'</span><span>
</span><span id="line-686"></span><span class="hs-comment">-- edgeSet ('vertex' x) == Set.'Data.Set.empty'</span><span>
</span><span id="line-687"></span><span class="hs-comment">-- edgeSet ('edge' x y) == Set.'Data.Set.singleton' (x,y)</span><span>
</span><span id="line-688"></span><span class="hs-comment">-- edgeSet . 'edges'    == Set.'Data.Set.fromList'</span><span>
</span><span id="line-689"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-690"></span><span id="local-6989586621679118446"><span id="local-6989586621679118447"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeSet"><span class="hs-identifier hs-type">edgeSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118447"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118446"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118447"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118446"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118447"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679118446"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-691"></span><span id="edgeSet"><span class="annot"><span class="annottext">edgeSet :: forall a b. (Ord a, Ord b) =&gt; AdjacencyMap a b -&gt; Set (a, b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeSet"><span class="hs-identifier hs-var hs-var">edgeSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromAscList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b -&gt; [(a, b)]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edgeList"><span class="hs-identifier hs-var">edgeList</span></a></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span class="hs-comment">-- | The sorted /adjacency list/ of the left part of a graph.</span><span>
</span><span id="line-694"></span><span class="hs-comment">-- Complexity: /O(n + m)/ time and memory.</span><span>
</span><span id="line-695"></span><span class="hs-comment">--</span><span>
</span><span id="line-696"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-697"></span><span class="hs-comment">-- leftAdjacencyList 'empty'            == []</span><span>
</span><span id="line-698"></span><span class="hs-comment">-- leftAdjacencyList ('vertices' [] xs) == []</span><span>
</span><span id="line-699"></span><span class="hs-comment">-- leftAdjacencyList ('vertices' xs []) == [(x, []) | x &lt;- 'nub' ('sort' xs)]</span><span>
</span><span id="line-700"></span><span class="hs-comment">-- leftAdjacencyList ('edge' x y)       == [(x, [y])]</span><span>
</span><span id="line-701"></span><span class="hs-comment">-- leftAdjacencyList ('star' x ys)      == [(x, 'nub' ('sort' ys))]</span><span>
</span><span id="line-702"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-703"></span><span id="local-6989586621679118239"><span id="local-6989586621679118240"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftAdjacencyList"><span class="hs-identifier hs-type">leftAdjacencyList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118240"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118239"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118240"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679118239"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-704"></span><span id="leftAdjacencyList"><span class="annot"><span class="annottext">leftAdjacencyList :: forall a b. AdjacencyMap a b -&gt; [(a, [b])]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftAdjacencyList"><span class="hs-identifier hs-var hs-var">leftAdjacencyList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117607"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117607"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117607"><span class="hs-identifier hs-var">ab</span></a></span><span>
</span><span id="line-705"></span><span>
</span><span id="line-706"></span><span class="hs-comment">-- | The sorted /adjacency list/ of the right part of a graph.</span><span>
</span><span id="line-707"></span><span class="hs-comment">-- Complexity: /O(n + m)/ time and memory.</span><span>
</span><span id="line-708"></span><span class="hs-comment">--</span><span>
</span><span id="line-709"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-710"></span><span class="hs-comment">-- rightAdjacencyList 'empty'            == []</span><span>
</span><span id="line-711"></span><span class="hs-comment">-- rightAdjacencyList ('vertices' [] xs) == [(x, []) | x &lt;- 'nub' ('sort' xs)]</span><span>
</span><span id="line-712"></span><span class="hs-comment">-- rightAdjacencyList ('vertices' xs []) == []</span><span>
</span><span id="line-713"></span><span class="hs-comment">-- rightAdjacencyList ('edge' x y)       == [(y, [x])]</span><span>
</span><span id="line-714"></span><span class="hs-comment">-- rightAdjacencyList ('star' x ys)      == [(y, [x])  | y &lt;- 'nub' ('sort' ys)]</span><span>
</span><span id="line-715"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-716"></span><span id="local-6989586621679118231"><span id="local-6989586621679118232"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightAdjacencyList"><span class="hs-identifier hs-type">rightAdjacencyList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118232"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118231"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118231"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679118232"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-717"></span><span id="rightAdjacencyList"><span class="annot"><span class="annottext">rightAdjacencyList :: forall a b. AdjacencyMap a b -&gt; [(b, [a])]
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#rightAdjacencyList"><span class="hs-identifier hs-var hs-var">rightAdjacencyList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679117604"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117604"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117604"><span class="hs-identifier hs-var">ba</span></a></span><span>
</span><span id="line-718"></span><span>
</span><span id="line-719"></span><span class="hs-comment">-- | A list of values of two alternating types. The first type argument denotes</span><span>
</span><span id="line-720"></span><span class="hs-comment">-- the type of the value at the head.</span><span>
</span><span id="line-721"></span><span class="hs-comment">--</span><span>
</span><span id="line-722"></span><span class="hs-comment">-- With the @OverloadedLists@ extension it is possible to use the standard list</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- notation to construct a 'List' where the two types coincide, for example:</span><span>
</span><span id="line-724"></span><span class="hs-comment">--</span><span>
</span><span id="line-725"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-726"></span><span class="hs-comment">-- [1, 2, 3, 4, 5] :: List Int Int</span><span>
</span><span id="line-727"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-728"></span><span class="hs-comment">--</span><span>
</span><span id="line-729"></span><span class="hs-comment">-- We make use of this shorthand notation in the examples below.</span><span>
</span><span id="line-730"></span><span id="local-6989586621679117602"><span id="local-6989586621679117603"></span></span><span class="hs-keyword">data</span><span> </span><span id="List"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#List"><span class="hs-identifier hs-var">List</span></a></span></span><span> </span><span id="local-6989586621679118226"><span class="annot"><a href="#local-6989586621679118226"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679118225"><span class="annot"><a href="#local-6989586621679118225"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Nil"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Cons"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679118226"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118225"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117594"><span id="local-6989586621679117598"><span class="annot"><span class="annottext">List a b -&gt; List a b -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall a b. (Eq a, Eq b) =&gt; List a b -&gt; List a b -&gt; Bool
/= :: List a b -&gt; List a b -&gt; Bool
$c/= :: forall a b. (Eq a, Eq b) =&gt; List a b -&gt; List a b -&gt; Bool
== :: List a b -&gt; List a b -&gt; Bool
$c== :: forall a b. (Eq a, Eq b) =&gt; List a b -&gt; List a b -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a b x. Rep (List a b) x -&gt; List a b
forall a b x. List a b -&gt; Rep (List a b) x
$cto :: forall a b x. Rep (List a b) x -&gt; List a b
$cfrom :: forall a b x. List a b -&gt; Rep (List a b) x
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117568"><span id="local-6989586621679117570"><span id="local-6989586621679117573"><span id="local-6989586621679117576"><span id="local-6989586621679117579"><span id="local-6989586621679117583"><span id="local-6989586621679117587"><span class="annot"><span class="annottext">List a b -&gt; List a b -&gt; Bool
List a b -&gt; List a b -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {a} {b}. (Ord a, Ord b) =&gt; Eq (List a b)
forall a b. (Ord a, Ord b) =&gt; List a b -&gt; List a b -&gt; Bool
forall a b. (Ord a, Ord b) =&gt; List a b -&gt; List a b -&gt; Ordering
forall a b. (Ord a, Ord b) =&gt; List a b -&gt; List a b -&gt; List a b
min :: List a b -&gt; List a b -&gt; List a b
$cmin :: forall a b. (Ord a, Ord b) =&gt; List a b -&gt; List a b -&gt; List a b
max :: List a b -&gt; List a b -&gt; List a b
$cmax :: forall a b. (Ord a, Ord b) =&gt; List a b -&gt; List a b -&gt; List a b
&gt;= :: List a b -&gt; List a b -&gt; Bool
$c&gt;= :: forall a b. (Ord a, Ord b) =&gt; List a b -&gt; List a b -&gt; Bool
&gt; :: List a b -&gt; List a b -&gt; Bool
$c&gt; :: forall a b. (Ord a, Ord b) =&gt; List a b -&gt; List a b -&gt; Bool
&lt;= :: List a b -&gt; List a b -&gt; Bool
$c&lt;= :: forall a b. (Ord a, Ord b) =&gt; List a b -&gt; List a b -&gt; Bool
&lt; :: List a b -&gt; List a b -&gt; Bool
$c&lt; :: forall a b. (Ord a, Ord b) =&gt; List a b -&gt; List a b -&gt; Bool
compare :: List a b -&gt; List a b -&gt; Ordering
$ccompare :: forall a b. (Ord a, Ord b) =&gt; List a b -&gt; List a b -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117559"><span id="local-6989586621679117561"><span id="local-6989586621679117566"><span class="annot"><span class="annottext">Int -&gt; List a b -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall a b. (Show a, Show b) =&gt; Int -&gt; List a b -&gt; ShowS
forall a b. (Show a, Show b) =&gt; [List a b] -&gt; ShowS
forall a b. (Show a, Show b) =&gt; List a b -&gt; String
showList :: [List a b] -&gt; ShowS
$cshowList :: forall a b. (Show a, Show b) =&gt; [List a b] -&gt; ShowS
show :: List a b -&gt; String
$cshow :: forall a b. (Show a, Show b) =&gt; List a b -&gt; String
showsPrec :: Int -&gt; List a b -&gt; ShowS
$cshowsPrec :: forall a b. (Show a, Show b) =&gt; Int -&gt; List a b -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679117556"><span id="local-6989586621679118222"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">IsList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118222"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-733"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Item"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Item</span></a></span></span><span> </span><span id="local-6989586621679118222"><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118222"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679118222"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-734"></span><span>
</span><span id="line-735"></span><span>    </span><span id="local-6989586621679117552"><span class="annot"><span class="annottext">fromList :: [Item (List a a)] -&gt; List a a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; List b a -&gt; List a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. List a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>
</span><span id="line-736"></span><span>
</span><span id="line-737"></span><span>    </span><span id="local-6989586621679117550"><span class="annot"><span class="annottext">toList :: List a a -&gt; [Item (List a a)]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toList</span></a></span></span><span> </span><span class="annot"><span class="annottext">List a a
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-738"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span id="local-6989586621679117549"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117549"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679117548"><span class="annot"><span class="annottext">List a a
</span><a href="#local-6989586621679117548"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117549"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">List a a
</span><a href="#local-6989586621679117548"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span class="hs-comment">-- | Construct a 'List' of even length from a list of pairs.</span><span>
</span><span id="line-741"></span><span class="hs-comment">--</span><span>
</span><span id="line-742"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-743"></span><span class="hs-comment">-- evenList []                 == 'Nil'</span><span>
</span><span id="line-744"></span><span class="hs-comment">-- evenList [(1,2), (3,4)]     == [1, 2, 3, 4] :: 'List' Int Int</span><span>
</span><span id="line-745"></span><span class="hs-comment">-- evenList [(1,\'a\'), (2,\'b\')] == 'Cons' 1 ('Cons' \'a\' ('Cons' 2 ('Cons' \'b\' 'Nil')))</span><span>
</span><span id="line-746"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-747"></span><span id="local-6989586621679118220"><span id="local-6989586621679118221"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#evenList"><span class="hs-identifier hs-type">evenList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679118220"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118221"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118220"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-748"></span><span id="evenList"><span class="annot"><span class="annottext">evenList :: forall a b. [(a, b)] -&gt; List a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#evenList"><span class="hs-identifier hs-var hs-var">evenList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679117546"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117546"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117545"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117545"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; List b a -&gt; List a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117546"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; List b a -&gt; List a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117545"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. List a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>
</span><span id="line-749"></span><span>
</span><span id="line-750"></span><span class="hs-comment">-- | Construct a 'List' of odd length given the first element and a list of pairs.</span><span>
</span><span id="line-751"></span><span class="hs-comment">--</span><span>
</span><span id="line-752"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-753"></span><span class="hs-comment">-- oddList 1 []                 == 'Cons' 1 'Nil'</span><span>
</span><span id="line-754"></span><span class="hs-comment">-- oddList 1 [(2,3), (4,5)]     == [1, 2, 3, 4, 5] :: 'List' Int Int</span><span>
</span><span id="line-755"></span><span class="hs-comment">-- oddList 1 [(\'a\',2), (\'b\',3)] == 'Cons' 1 ('Cons' \'a\' ('Cons' 2 ('Cons' \'b\' ('Cons' 3 'Nil'))))</span><span>
</span><span id="line-756"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-757"></span><span id="local-6989586621679118216"><span id="local-6989586621679118217"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#oddList"><span class="hs-identifier hs-type">oddList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679118217"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118216"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679118217"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118217"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118216"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-758"></span><span id="oddList"><span class="annot"><span class="annottext">oddList :: forall a b. a -&gt; [(b, a)] -&gt; List a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#oddList"><span class="hs-identifier hs-var hs-var">oddList</span></a></span></span><span> </span><span id="local-6989586621679117544"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117544"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; List b a -&gt; List a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Cons"><span class="hs-identifier hs-var">Cons</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117544"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [(a, b)] -&gt; List a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#evenList"><span class="hs-identifier hs-var">evenList</span></a></span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span class="hs-comment">-- | The /path/ on a 'List' of vertices.</span><span>
</span><span id="line-761"></span><span class="hs-comment">-- Complexity: /O(L * log(L))/ time, where /L/ is the length of the given list.</span><span>
</span><span id="line-762"></span><span class="hs-comment">--</span><span>
</span><span id="line-763"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-764"></span><span class="hs-comment">-- path 'Nil'                   == 'empty'</span><span>
</span><span id="line-765"></span><span class="hs-comment">-- path ('Cons' x 'Nil')          == 'leftVertex' x</span><span>
</span><span id="line-766"></span><span class="hs-comment">-- path ('Cons' x ('Cons' y 'Nil')) == 'edge' x y</span><span>
</span><span id="line-767"></span><span class="hs-comment">-- path [1, 2, 3, 4, 5]       == 'edges' [(1,2), (3,2), (3,4), (5,4)]</span><span>
</span><span id="line-768"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-769"></span><span id="local-6989586621679118212"><span id="local-6989586621679118213"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#path"><span class="hs-identifier hs-type">path</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118213"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118212"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118213"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118212"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118213"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118212"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-770"></span><span id="path"><span class="annot"><span class="annottext">path :: forall a b. (Ord a, Ord b) =&gt; List a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#path"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="annot"><span class="annottext">List a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-771"></span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#path"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span id="local-6989586621679117539"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117539"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">List b a
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertex"><span class="hs-identifier hs-var">leftVertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117539"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-772"></span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#path"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span id="local-6989586621679117538"><span class="annot"><span class="annottext">List a b
</span><a href="#local-6989586621679117538"><span class="hs-identifier hs-var">abs</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Ord a, Ord b) =&gt; [(a, b)] -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edges"><span class="hs-identifier hs-var">edges</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117537"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117536"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117537"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117536"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-773"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-774"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679117537"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117537"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117536"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117536"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. List a b -&gt; ([a], [b])
</span><a href="#local-6989586621679117534"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">List a b
</span><a href="#local-6989586621679117538"><span class="hs-identifier hs-var">abs</span></a></span><span>
</span><span id="line-775"></span><span>
</span><span id="line-776"></span><span>    </span><span id="local-6989586621679118205"><span id="local-6989586621679118206"><span class="annot"><a href="#local-6989586621679117534"><span class="hs-identifier hs-type">split</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118206"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118205"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679118206"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679118205"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-777"></span><span>    </span><span id="local-6989586621679117534"><span class="annot"><span class="annottext">split :: forall a b. List a b -&gt; ([a], [b])
</span><a href="#local-6989586621679117534"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621679117533"><span class="annot"><span class="annottext">List a b
</span><a href="#local-6989586621679117533"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">List a b
</span><a href="#local-6989586621679117533"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-778"></span><span>        </span><span class="annot"><span class="annottext">List a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>        </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span id="local-6989586621679117532"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117532"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">List b a
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Nil"><span class="hs-identifier hs-var">Nil</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117532"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-780"></span><span>        </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span id="local-6989586621679117531"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117531"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#Cons"><span class="hs-identifier hs-type">Cons</span></a></span><span> </span><span id="local-6989586621679117530"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117530"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679117529"><span class="annot"><span class="annottext">List a b
</span><a href="#local-6989586621679117529"><span class="hs-identifier hs-var">abs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117531"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117528"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117530"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117527"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117528"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117528"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117527"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117527"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. List a b -&gt; ([a], [b])
</span><a href="#local-6989586621679117534"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">List a b
</span><a href="#local-6989586621679117529"><span class="hs-identifier hs-var">abs</span></a></span><span>
</span><span id="line-781"></span><span>
</span><span id="line-782"></span><span class="hs-comment">-- | The /circuit/ on a list of pairs of vertices.</span><span>
</span><span id="line-783"></span><span class="hs-comment">-- Complexity: /O(L * log(L))/ time, where L is the length of the given list.</span><span>
</span><span id="line-784"></span><span class="hs-comment">--</span><span>
</span><span id="line-785"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-786"></span><span class="hs-comment">-- circuit []                    == 'empty'</span><span>
</span><span id="line-787"></span><span class="hs-comment">-- circuit [(x,y)]               == 'edge' x y</span><span>
</span><span id="line-788"></span><span class="hs-comment">-- circuit [(1,2), (3,4), (5,6)] == 'edges' [(1,2), (3,2), (3,4), (5,4), (5,6), (1,6)]</span><span>
</span><span id="line-789"></span><span class="hs-comment">-- circuit . 'reverse'             == 'swap' . circuit . 'map' Data.Tuple.'Data.Tuple.swap'</span><span>
</span><span id="line-790"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-791"></span><span id="local-6989586621679117525"><span id="local-6989586621679117526"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#circuit"><span class="hs-identifier hs-type">circuit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117526"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117525"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679117526"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679117525"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117526"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117525"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-792"></span><span id="circuit"><span class="annot"><span class="annottext">circuit :: forall a b. (Ord a, Ord b) =&gt; [(a, b)] -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#circuit"><span class="hs-identifier hs-var hs-var">circuit</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-793"></span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#circuit"><span class="hs-identifier hs-var">circuit</span></a></span><span> </span><span id="local-6989586621679117520"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679117520"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Ord a, Ord b) =&gt; [(a, b)] -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#edges"><span class="hs-identifier hs-var">edges</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679117520"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">cycle</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117518"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117517"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-794"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-795"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679117518"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117518"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117517"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117517"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679117520"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-796"></span><span>
</span><span id="line-797"></span><span class="hs-comment">-- | The /biclique/ on two lists of vertices.</span><span>
</span><span id="line-798"></span><span class="hs-comment">-- Complexity: /O(n * log(n) + m)/ time and /O(n + m)/ memory.</span><span>
</span><span id="line-799"></span><span class="hs-comment">--</span><span>
</span><span id="line-800"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-801"></span><span class="hs-comment">-- biclique [] [] == 'empty'</span><span>
</span><span id="line-802"></span><span class="hs-comment">-- biclique xs [] == 'vertices' xs []</span><span>
</span><span id="line-803"></span><span class="hs-comment">-- biclique [] ys == 'vertices' [] ys</span><span>
</span><span id="line-804"></span><span class="hs-comment">-- biclique xs ys == 'connect' ('vertices' xs []) ('vertices' [] ys)</span><span>
</span><span id="line-805"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-806"></span><span id="local-6989586621679117514"><span id="local-6989586621679117515"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#biclique"><span class="hs-identifier hs-type">biclique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117515"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117514"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679117515"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679117514"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117515"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117514"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-807"></span><span id="biclique"><span class="annot"><span class="annottext">biclique :: forall a b. (Ord a, Ord b) =&gt; [a] -&gt; [b] -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#biclique"><span class="hs-identifier hs-var hs-var">biclique</span></a></span></span><span> </span><span id="local-6989586621679117509"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117509"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679117508"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117508"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117507"><span class="hs-identifier hs-var">sys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679117506"><span class="hs-identifier hs-var">sxs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679117506"><span class="hs-identifier hs-var">sxs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117507"><span class="hs-identifier hs-var">sys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-808"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-809"></span><span>    </span><span id="local-6989586621679117506"><span class="annot"><span class="annottext">sxs :: Set a
</span><a href="#local-6989586621679117506"><span class="hs-identifier hs-var hs-var">sxs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117509"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-810"></span><span>    </span><span id="local-6989586621679117507"><span class="annot"><span class="annottext">sys :: Set b
</span><a href="#local-6989586621679117507"><span class="hs-identifier hs-var hs-var">sys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117508"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-811"></span><span>
</span><span id="line-812"></span><span class="hs-comment">-- | The /star/ formed by a center vertex connected to a list of leaves.</span><span>
</span><span id="line-813"></span><span class="hs-comment">-- Complexity: /O(L * log(L))/ time, where /L/ is the length of the given list.</span><span>
</span><span id="line-814"></span><span class="hs-comment">--</span><span>
</span><span id="line-815"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-816"></span><span class="hs-comment">-- star x []    == 'leftVertex' x</span><span>
</span><span id="line-817"></span><span class="hs-comment">-- star x [y]   == 'edge' x y</span><span>
</span><span id="line-818"></span><span class="hs-comment">-- star x [y,z] == 'edges' [(x,y), (x,z)]</span><span>
</span><span id="line-819"></span><span class="hs-comment">-- star x ys    == 'connect' ('leftVertex' x) ('vertices' [] ys)</span><span>
</span><span id="line-820"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-821"></span><span id="local-6989586621679118193"><span id="local-6989586621679118194"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#star"><span class="hs-identifier hs-type">star</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118194"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118193"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118194"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679118193"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118194"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118193"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-822"></span><span id="star"><span class="annot"><span class="annottext">star :: forall a b. (Ord a, Ord b) =&gt; a -&gt; [b] -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#star"><span class="hs-identifier hs-var hs-var">star</span></a></span></span><span> </span><span id="local-6989586621679117498"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117498"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679117497"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117497"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap a b -&gt; AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#connect"><span class="hs-identifier hs-var">connect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#leftVertex"><span class="hs-identifier hs-var">leftVertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117498"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Ord a, Ord b) =&gt; [a] -&gt; [b] -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117497"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-823"></span><span>
</span><span id="line-824"></span><span class="hs-comment">-- | The /stars/ formed by overlaying a list of 'star's.</span><span>
</span><span id="line-825"></span><span class="hs-comment">-- Complexity: /O(L * log(L))/ time, where /L/ is the total size of the input.</span><span>
</span><span id="line-826"></span><span class="hs-comment">--</span><span>
</span><span id="line-827"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-828"></span><span class="hs-comment">-- stars []                      == 'empty'</span><span>
</span><span id="line-829"></span><span class="hs-comment">-- stars [(x, [])]               == 'leftVertex' x</span><span>
</span><span id="line-830"></span><span class="hs-comment">-- stars [(x, [y])]              == 'edge' x y</span><span>
</span><span id="line-831"></span><span class="hs-comment">-- stars [(x, ys)]               == 'star' x ys</span><span>
</span><span id="line-832"></span><span class="hs-comment">-- stars                         == 'overlays' . 'map' ('uncurry' 'star')</span><span>
</span><span id="line-833"></span><span class="hs-comment">-- 'overlay' (stars xs) (stars ys) == stars (xs ++ ys)</span><span>
</span><span id="line-834"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-835"></span><span id="local-6989586621679118189"><span id="local-6989586621679118190"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#stars"><span class="hs-identifier hs-type">stars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118189"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679118189"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118189"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-836"></span><span id="stars"><span class="annot"><span class="annottext">stars :: forall a b. (Ord a, Ord b) =&gt; [(a, [b])] -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#stars"><span class="hs-identifier hs-var hs-var">stars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
[AdjacencyMap a b] -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#overlays"><span class="hs-identifier hs-var">overlays</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Ord a, Ord b) =&gt; a -&gt; [b] -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#star"><span class="hs-identifier hs-var">star</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-837"></span><span>
</span><span id="line-838"></span><span class="hs-comment">-- | Remove a vertex from the left part of a given graph.</span><span>
</span><span id="line-839"></span><span class="hs-comment">-- Complexity: /O(r * log(l))/ time.</span><span>
</span><span id="line-840"></span><span class="hs-comment">--</span><span>
</span><span id="line-841"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-842"></span><span class="hs-comment">-- removeLeftVertex x ('leftVertex' x)       == 'empty'</span><span>
</span><span id="line-843"></span><span class="hs-comment">-- removeLeftVertex 1 ('leftVertex' 2)       == 'leftVertex' 2</span><span>
</span><span id="line-844"></span><span class="hs-comment">-- removeLeftVertex x ('rightVertex' y)      == 'rightVertex' y</span><span>
</span><span id="line-845"></span><span class="hs-comment">-- removeLeftVertex x ('edge' x y)           == 'rightVertex' y</span><span>
</span><span id="line-846"></span><span class="hs-comment">-- removeLeftVertex x . removeLeftVertex x == removeLeftVertex x</span><span>
</span><span id="line-847"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-848"></span><span id="local-6989586621679118182"><span id="local-6989586621679118183"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#removeLeftVertex"><span class="hs-identifier hs-type">removeLeftVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118183"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118183"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118183"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118182"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118183"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118182"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-849"></span><span id="removeLeftVertex"><span class="annot"><span class="annottext">removeLeftVertex :: forall a b. Ord a =&gt; a -&gt; AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#removeLeftVertex"><span class="hs-identifier hs-var hs-var">removeLeftVertex</span></a></span></span><span> </span><span id="local-6989586621679117486"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117486"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117485"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117485"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span id="local-6989586621679117484"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117484"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.delete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117486"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117485"><span class="hs-identifier hs-var">ab</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117486"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117484"><span class="hs-identifier hs-var">ba</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-850"></span><span>
</span><span id="line-851"></span><span class="hs-comment">-- | Remove a vertex from the right part of a given graph.</span><span>
</span><span id="line-852"></span><span class="hs-comment">-- Complexity: /O(l * log(r))/ time.</span><span>
</span><span id="line-853"></span><span class="hs-comment">--</span><span>
</span><span id="line-854"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-855"></span><span class="hs-comment">-- removeRightVertex x ('rightVertex' x)       == 'empty'</span><span>
</span><span id="line-856"></span><span class="hs-comment">-- removeRightVertex 1 ('rightVertex' 2)       == 'rightVertex' 2</span><span>
</span><span id="line-857"></span><span class="hs-comment">-- removeRightVertex x ('leftVertex' y)        == 'leftVertex' y</span><span>
</span><span id="line-858"></span><span class="hs-comment">-- removeRightVertex y ('edge' x y)            == 'leftVertex' x</span><span>
</span><span id="line-859"></span><span class="hs-comment">-- removeRightVertex x . removeRightVertex x == removeRightVertex x</span><span>
</span><span id="line-860"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-861"></span><span id="local-6989586621679118172"><span id="local-6989586621679118173"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#removeRightVertex"><span class="hs-identifier hs-type">removeRightVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118173"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118173"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118172"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118173"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118172"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118173"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-862"></span><span id="removeRightVertex"><span class="annot"><span class="annottext">removeRightVertex :: forall b a. Ord b =&gt; b -&gt; AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#removeRightVertex"><span class="hs-identifier hs-var hs-var">removeRightVertex</span></a></span></span><span> </span><span id="local-6989586621679117477"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117477"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117476"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117476"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span id="local-6989586621679117475"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117475"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117477"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117476"><span class="hs-identifier hs-var">ab</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.delete</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117477"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117475"><span class="hs-identifier hs-var">ba</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span class="hs-comment">-- | Remove an edge from a given graph.</span><span>
</span><span id="line-865"></span><span class="hs-comment">-- Complexity: /O(log(l) + log(r))/ time.</span><span>
</span><span id="line-866"></span><span class="hs-comment">--</span><span>
</span><span id="line-867"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-868"></span><span class="hs-comment">-- removeEdge x y ('edge' x y)            == 'vertices' [x] [y]</span><span>
</span><span id="line-869"></span><span class="hs-comment">-- removeEdge x y . removeEdge x y      == removeEdge x y</span><span>
</span><span id="line-870"></span><span class="hs-comment">-- removeEdge x y . 'removeLeftVertex' x  == 'removeLeftVertex' x</span><span>
</span><span id="line-871"></span><span class="hs-comment">-- removeEdge x y . 'removeRightVertex' y == 'removeRightVertex' y</span><span>
</span><span id="line-872"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-873"></span><span id="local-6989586621679118168"><span id="local-6989586621679118169"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#removeEdge"><span class="hs-identifier hs-type">removeEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118169"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118168"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118169"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118168"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118169"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118168"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118169"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118168"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-874"></span><span id="removeEdge"><span class="annot"><span class="annottext">removeEdge :: forall a b.
(Ord a, Ord b) =&gt;
a -&gt; b -&gt; AdjacencyMap a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#removeEdge"><span class="hs-identifier hs-var hs-var">removeEdge</span></a></span></span><span> </span><span id="local-6989586621679117468"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117468"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679117467"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117467"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117466"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117466"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span id="local-6989586621679117465"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117465"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-875"></span><span>    </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117467"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117468"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117466"><span class="hs-identifier hs-var">ab</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117468"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117467"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117465"><span class="hs-identifier hs-var">ba</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-876"></span><span>
</span><span id="line-877"></span><span class="hs-comment">-- | Transform a graph by applying given functions to the vertices of each part.</span><span>
</span><span id="line-878"></span><span class="hs-comment">-- Complexity: /O((n + m) * log(n))/ time.</span><span>
</span><span id="line-879"></span><span class="hs-comment">--</span><span>
</span><span id="line-880"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-881"></span><span class="hs-comment">-- bimap f g 'empty'           == 'empty'</span><span>
</span><span id="line-882"></span><span class="hs-comment">-- bimap f g . 'vertex'        == 'vertex' . Data.Bifunctor.'Data.Bifunctor.bimap' f g</span><span>
</span><span id="line-883"></span><span class="hs-comment">-- bimap f g ('edge' x y)      == 'edge' (f x) (g y)</span><span>
</span><span id="line-884"></span><span class="hs-comment">-- bimap 'id' 'id'               == 'id'</span><span>
</span><span id="line-885"></span><span class="hs-comment">-- bimap f1 g1 . bimap f2 g2 == bimap (f1 . f2) (g1 . g2)</span><span>
</span><span id="line-886"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-887"></span><span id="local-6989586621679118160"><span id="local-6989586621679118161"><span id="local-6989586621679118162"><span id="local-6989586621679118163"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#bimap"><span class="hs-identifier hs-type">bimap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118163"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118162"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118161"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118160"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118163"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118161"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118162"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118160"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118163"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118162"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118161"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118160"><span class="hs-identifier hs-type">d</span></a></span></span></span></span></span><span>
</span><span id="line-888"></span><span id="bimap"><span class="annot"><span class="annottext">bimap :: forall a b c d.
(Ord a, Ord b, Ord c, Ord d) =&gt;
(a -&gt; c) -&gt; (b -&gt; d) -&gt; AdjacencyMap a b -&gt; AdjacencyMap c d
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#bimap"><span class="hs-identifier hs-var hs-var">bimap</span></a></span></span><span> </span><span id="local-6989586621679117453"><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621679117453"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679117452"><span class="annot"><span class="annottext">b -&gt; d
</span><a href="#local-6989586621679117452"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117451"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117451"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span id="local-6989586621679117450"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117450"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. Map a (Set b) -&gt; Map b (Set a) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-var">BAM</span></a></span><span> </span><span class="annot"><span class="annottext">Map c (Set d)
</span><a href="#local-6989586621679117449"><span class="hs-identifier hs-var">cd</span></a></span><span> </span><span class="annot"><span class="annottext">Map d (Set c)
</span><a href="#local-6989586621679117448"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-889"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-890"></span><span>    </span><span id="local-6989586621679117449"><span class="annot"><span class="annottext">cd :: Map c (Set d)
</span><a href="#local-6989586621679117449"><span class="hs-identifier hs-var hs-var">cd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.map</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; d
</span><a href="#local-6989586621679117452"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k2 a k1.
Ord k2 =&gt;
(a -&gt; a -&gt; a) -&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.mapKeysWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621679117453"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117451"><span class="hs-identifier hs-var">ab</span></a></span><span>
</span><span id="line-891"></span><span>    </span><span id="local-6989586621679117448"><span class="annot"><span class="annottext">dc :: Map d (Set c)
</span><a href="#local-6989586621679117448"><span class="hs-identifier hs-var hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.map</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621679117453"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k2 a k1.
Ord k2 =&gt;
(a -&gt; a -&gt; a) -&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.mapKeysWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; d
</span><a href="#local-6989586621679117452"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117450"><span class="hs-identifier hs-var">ba</span></a></span><span>
</span><span id="line-892"></span><span>
</span><span id="line-893"></span><span class="hs-comment">-- TODO: Add torus?</span><span>
</span><span id="line-894"></span><span class="hs-comment">-- | Construct a /mesh/ graph from two lists of vertices.</span><span>
</span><span id="line-895"></span><span class="hs-comment">-- Complexity: /O(L1 * L2 * log(L1 * L2))/ time, where /L1/ and /L2/ are the</span><span>
</span><span id="line-896"></span><span class="hs-comment">-- lengths of the given lists.</span><span>
</span><span id="line-897"></span><span class="hs-comment">--</span><span>
</span><span id="line-898"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-899"></span><span class="hs-comment">-- mesh xs []           == 'empty'</span><span>
</span><span id="line-900"></span><span class="hs-comment">-- mesh [] ys           == 'empty'</span><span>
</span><span id="line-901"></span><span class="hs-comment">-- mesh [x] [y]         == 'leftVertex' (x,y)</span><span>
</span><span id="line-902"></span><span class="hs-comment">-- mesh [1,1] [\'a\',\'b\'] == 'biclique' [(1,\'a\'), (1,\'b\')] [(1,\'a\'), (1,\'b\')]</span><span>
</span><span id="line-903"></span><span class="hs-comment">-- mesh [1,2] [\'a\',\'b\'] == 'biclique' [(1,\'a\'), (2,\'b\')] [(1,\'b\'), (2,\'a\')]</span><span>
</span><span id="line-904"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-905"></span><span id="local-6989586621679118151"><span id="local-6989586621679118152"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#mesh"><span class="hs-identifier hs-type">mesh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118152"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118151"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679118152"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679118151"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118152"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679118151"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118152"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679118151"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-906"></span><span id="mesh"><span class="annot"><span class="annottext">mesh :: forall a b.
(Ord a, Ord b) =&gt;
[a] -&gt; [b] -&gt; AdjacencyMap (a, b) (a, b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#mesh"><span class="hs-identifier hs-var hs-var">mesh</span></a></span></span><span> </span><span id="local-6989586621679117436"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117436"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679117435"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117435"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap a a -&gt; AdjacencyMap b b -&gt; AdjacencyMap (a, b) (a, b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#box"><span class="hs-identifier hs-var">box</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Ord a, Ord b) =&gt; List a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#path"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; [Item l] -&gt; l
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679117436"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Ord a, Ord b) =&gt; List a b -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#path"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; [Item l] -&gt; l
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679117435"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-907"></span><span>
</span><span id="line-908"></span><span class="hs-comment">-- | Compute the /Cartesian product/ of two graphs.</span><span>
</span><span id="line-909"></span><span class="hs-comment">-- Complexity: /O((n + m) * log(n))/ time and /O(n + m)/ memory.</span><span>
</span><span id="line-910"></span><span class="hs-comment">--</span><span>
</span><span id="line-911"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-912"></span><span class="hs-comment">-- 'box' ('path' [0,1]) ('path' [\'a\',\'b\']) == 'edges' [ ((0,\'a\'), (0,\'b\'))</span><span>
</span><span id="line-913"></span><span class="hs-comment">--                                            , ((0,\'a\'), (1,\'a\'))</span><span>
</span><span id="line-914"></span><span class="hs-comment">--                                            , ((1,\'b\'), (0,\'b\'))</span><span>
</span><span id="line-915"></span><span class="hs-comment">--                                            , ((1,\'b\'), (1,\'a\')) ]</span><span>
</span><span id="line-916"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-917"></span><span class="hs-comment">-- Up to isomorphism between the resulting vertex types, this operation is</span><span>
</span><span id="line-918"></span><span class="hs-comment">-- /commutative/, /associative/, /distributes/ over 'overlay', has singleton</span><span>
</span><span id="line-919"></span><span class="hs-comment">-- graphs as /identities/ and /swapping identities/, and 'empty' as the</span><span>
</span><span id="line-920"></span><span class="hs-comment">-- /annihilating zero/. Below @~~@ stands for equality up to an isomorphism,</span><span>
</span><span id="line-921"></span><span class="hs-comment">-- e.g. @(x,@ @()) ~~ x@.</span><span>
</span><span id="line-922"></span><span class="hs-comment">--</span><span>
</span><span id="line-923"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-924"></span><span class="hs-comment">-- box x y                ~~ box y x</span><span>
</span><span id="line-925"></span><span class="hs-comment">-- box x (box y z)        ~~ box (box x y) z</span><span>
</span><span id="line-926"></span><span class="hs-comment">-- box x ('overlay' y z)    == 'overlay' (box x y) (box x z)</span><span>
</span><span id="line-927"></span><span class="hs-comment">-- box x ('leftVertex' ())  ~~ x</span><span>
</span><span id="line-928"></span><span class="hs-comment">-- box x ('rightVertex' ()) ~~ 'swap' x</span><span>
</span><span id="line-929"></span><span class="hs-comment">-- box x 'empty'            ~~ 'empty'</span><span>
</span><span id="line-930"></span><span class="hs-comment">-- 'vertexCount' (box x y)  == 'vertexCount' x * 'vertexCount' y</span><span>
</span><span id="line-931"></span><span class="hs-comment">-- 'edgeCount'   (box x y)  == 'vertexCount' x * 'edgeCount' y + 'edgeCount' x * 'vertexCount' y</span><span>
</span><span id="line-932"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-933"></span><span id="local-6989586621679118147"><span id="local-6989586621679118148"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#box"><span class="hs-identifier hs-type">box</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118148"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118147"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118148"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118148"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118147"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118147"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118148"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679118147"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118148"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679118147"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-934"></span><span id="box"><span class="annot"><span class="annottext">box :: forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap a a -&gt; AdjacencyMap b b -&gt; AdjacencyMap (a, b) (a, b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#box"><span class="hs-identifier hs-var hs-var">box</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c d e f.
(Ord a, Ord b, Ord c, Ord d, Ord e, Ord f) =&gt;
(a -&gt; c -&gt; e)
-&gt; (b -&gt; d -&gt; e)
-&gt; (a -&gt; d -&gt; f)
-&gt; (b -&gt; c -&gt; f)
-&gt; AdjacencyMap a b
-&gt; AdjacencyMap c d
-&gt; AdjacencyMap e f
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#boxWith"><span class="hs-identifier hs-var">boxWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-935"></span><span>
</span><span id="line-936"></span><span class="hs-comment">-- | Compute the generalised /Cartesian product/ of two graphs. The resulting</span><span>
</span><span id="line-937"></span><span class="hs-comment">-- vertices are obtained using the given vertex combinators.</span><span>
</span><span id="line-938"></span><span class="hs-comment">-- Complexity: /O((n + m) * log(n))/ time and /O(n + m)/ memory.</span><span>
</span><span id="line-939"></span><span class="hs-comment">--</span><span>
</span><span id="line-940"></span><span class="hs-comment">-- See 'box' for some examples.</span><span>
</span><span id="line-941"></span><span class="hs-comment">--</span><span>
</span><span id="line-942"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-943"></span><span class="hs-comment">-- box == boxWith (,) (,) (,) (,)</span><span>
</span><span id="line-944"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-945"></span><span id="local-6989586621679118139"><span id="local-6989586621679118140"><span id="local-6989586621679118141"><span id="local-6989586621679118142"><span id="local-6989586621679118143"><span id="local-6989586621679118144"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#boxWith"><span class="hs-identifier hs-type">boxWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118144"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118143"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118142"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118141"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118140"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118139"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-946"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118144"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118142"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118140"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118143"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118141"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118140"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118144"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118141"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118139"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118143"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118142"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118139"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-947"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118144"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118143"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118142"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118141"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118140"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118139"><span class="hs-identifier hs-type">f</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-948"></span><span id="boxWith"><span class="annot"><span class="annottext">boxWith :: forall a b c d e f.
(Ord a, Ord b, Ord c, Ord d, Ord e, Ord f) =&gt;
(a -&gt; c -&gt; e)
-&gt; (b -&gt; d -&gt; e)
-&gt; (a -&gt; d -&gt; f)
-&gt; (b -&gt; c -&gt; f)
-&gt; AdjacencyMap a b
-&gt; AdjacencyMap c d
-&gt; AdjacencyMap e f
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#boxWith"><span class="hs-identifier hs-var hs-var">boxWith</span></a></span></span><span> </span><span id="local-6989586621679117410"><span class="annot"><span class="annottext">a -&gt; c -&gt; e
</span><a href="#local-6989586621679117410"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span id="local-6989586621679117409"><span class="annot"><span class="annottext">b -&gt; d -&gt; e
</span><a href="#local-6989586621679117409"><span class="hs-identifier hs-var">bd</span></a></span></span><span> </span><span id="local-6989586621679117408"><span class="annot"><span class="annottext">a -&gt; d -&gt; f
</span><a href="#local-6989586621679117408"><span class="hs-identifier hs-var">ad</span></a></span></span><span> </span><span id="local-6989586621679117407"><span class="annot"><span class="annottext">b -&gt; c -&gt; f
</span><a href="#local-6989586621679117407"><span class="hs-identifier hs-var">bc</span></a></span></span><span> </span><span id="local-6989586621679117406"><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117406"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679117405"><span class="annot"><span class="annottext">AdjacencyMap c d
</span><a href="#local-6989586621679117405"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap (Either a b) -&gt; AdjacencyMap a b
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#toBipartite"><span class="hs-identifier hs-var">toBipartite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
(a -&gt; b) -&gt; AdjacencyMap a -&gt; AdjacencyMap b
</span><a href="Algebra.Graph.AdjacencyMap.html#gmap"><span class="hs-identifier hs-var">AM.gmap</span></a></span><span> </span><span class="annot"><span class="annottext">(Either a b, Either c d) -&gt; Either e f
</span><a href="#local-6989586621679117404"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap (Either a b, Either c d)
</span><a href="#local-6989586621679117403"><span class="hs-identifier hs-var">ambox</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-949"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-950"></span><span>    </span><span class="hs-comment">-- ambox :: AM.AdjacencyMap (Either a b, Either c d)</span><span>
</span><span id="line-951"></span><span>    </span><span id="local-6989586621679117403"><span class="annot"><span class="annottext">ambox :: AdjacencyMap (Either a b, Either c d)
</span><a href="#local-6989586621679117403"><span class="hs-identifier hs-var hs-var">ambox</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap a -&gt; AdjacencyMap b -&gt; AdjacencyMap (a, b)
</span><a href="Algebra.Graph.AdjacencyMap.html#box"><span class="hs-identifier hs-var">AM.box</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap a b -&gt; AdjacencyMap (Either a b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#fromBipartite"><span class="hs-identifier hs-var">fromBipartite</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a b
</span><a href="#local-6989586621679117406"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b.
(Ord a, Ord b) =&gt;
AdjacencyMap a b -&gt; AdjacencyMap (Either a b)
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#fromBipartite"><span class="hs-identifier hs-var">fromBipartite</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap c d
</span><a href="#local-6989586621679117405"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-952"></span><span>
</span><span id="line-953"></span><span>    </span><span class="hs-comment">-- combine :: (Either a b, Either c d) -&gt; Either e f</span><span>
</span><span id="line-954"></span><span>    </span><span id="local-6989586621679117404"><span class="annot"><span class="annottext">combine :: (Either a b, Either c d) -&gt; Either e f
</span><a href="#local-6989586621679117404"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span>  </span><span id="local-6989586621679117401"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117401"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span>  </span><span id="local-6989586621679117400"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679117400"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; c -&gt; e
</span><a href="#local-6989586621679117410"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117401"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679117400"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-955"></span><span>    </span><span class="annot"><a href="#local-6989586621679117404"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span>  </span><span id="local-6989586621679117399"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117399"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679117398"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679117398"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; d -&gt; f
</span><a href="#local-6989586621679117408"><span class="hs-identifier hs-var">ad</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117399"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679117398"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-956"></span><span>    </span><span class="annot"><a href="#local-6989586621679117404"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679117397"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117397"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span>  </span><span id="local-6989586621679117396"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679117396"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; c -&gt; f
</span><a href="#local-6989586621679117407"><span class="hs-identifier hs-var">bc</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117397"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679117396"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-957"></span><span>    </span><span class="annot"><a href="#local-6989586621679117404"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679117395"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117395"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679117394"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679117394"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; d -&gt; e
</span><a href="#local-6989586621679117409"><span class="hs-identifier hs-var">bd</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117395"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679117394"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-958"></span><span>
</span><span id="line-959"></span><span class="hs-comment">-- | Check that the internal graph representation is consistent, i.e. that all</span><span>
</span><span id="line-960"></span><span class="hs-comment">-- edges that are present in the 'leftAdjacencyMap' are also present in the</span><span>
</span><span id="line-961"></span><span class="hs-comment">-- 'rightAdjacencyMap' map. It should be impossible to create an inconsistent</span><span>
</span><span id="line-962"></span><span class="hs-comment">-- adjacency map, and we use this function in testing.</span><span>
</span><span id="line-963"></span><span class="hs-comment">--</span><span>
</span><span id="line-964"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-965"></span><span class="hs-comment">-- consistent 'empty'           == True</span><span>
</span><span id="line-966"></span><span class="hs-comment">-- consistent ('vertex' x)      == True</span><span>
</span><span id="line-967"></span><span class="hs-comment">-- consistent ('edge' x y)      == True</span><span>
</span><span id="line-968"></span><span class="hs-comment">-- consistent ('edges' x)       == True</span><span>
</span><span id="line-969"></span><span class="hs-comment">-- consistent ('toBipartite' x) == True</span><span>
</span><span id="line-970"></span><span class="hs-comment">-- consistent ('swap' x)        == True</span><span>
</span><span id="line-971"></span><span class="hs-comment">-- consistent ('circuit' x)     == True</span><span>
</span><span id="line-972"></span><span class="hs-comment">-- consistent ('biclique' x y)  == True</span><span>
</span><span id="line-973"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-974"></span><span id="local-6989586621679118128"><span id="local-6989586621679118129"><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#consistent"><span class="hs-identifier hs-type">consistent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118129"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118128"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118129"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118128"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-975"></span><span id="consistent"><span class="annot"><span class="annottext">consistent :: forall a b. (Ord a, Ord b) =&gt; AdjacencyMap a b -&gt; Bool
</span><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#consistent"><span class="hs-identifier hs-var hs-var">consistent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Bipartite.AdjacencyMap.html#BAM"><span class="hs-identifier hs-type">BAM</span></a></span><span> </span><span id="local-6989586621679117386"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117386"><span class="hs-identifier hs-var">lr</span></a></span></span><span> </span><span id="local-6989586621679117385"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117385"><span class="hs-identifier hs-var">rl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} {b}. Map a (Set b) -&gt; [(a, b)]
</span><a href="#local-6989586621679117384"><span class="hs-identifier hs-var">edgeList</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117386"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; (b, a)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Data.Tuple.swap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {b}. Map a (Set b) -&gt; [(a, b)]
</span><a href="#local-6989586621679117384"><span class="hs-identifier hs-var">edgeList</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679117385"><span class="hs-identifier hs-var">rl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-976"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-977"></span><span>    </span><span id="local-6989586621679117384"><span class="annot"><span class="annottext">edgeList :: Map a (Set b) -&gt; [(a, b)]
</span><a href="#local-6989586621679117384"><span class="hs-identifier hs-var hs-var">edgeList</span></a></span></span><span> </span><span id="local-6989586621679117382"><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117382"><span class="hs-identifier hs-var">lr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117381"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117380"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117381"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117381"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117379"><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117379"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (Set b)
</span><a href="#local-6989586621679117382"><span class="hs-identifier hs-var">lr</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117380"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679117380"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679117379"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-978"></span></pre></body></html>