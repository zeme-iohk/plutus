

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6.5.3. Record field disambiguation &mdash; Glasgow Haskell Compiler 9.2.5 User&#39;s Guide</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Glasgow Haskell Compiler 9.2.5 User&#39;s Guide"
          href="../_static/opensearch.xml"/>

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.5.4. Duplicate record fields" href="duplicate_record_fields.html" />
    <link rel="prev" title="6.5.2. Field selectors and TypeApplications" href="field_selectors_and_type_applications.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Glasgow Haskell Compiler
          

          
          </a>

          
            
            
              <div class="version">
                9.2.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">2. Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ghci.html">3. Using GHCi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runghc.html">4. Using runghc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">5. Using GHC</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../exts.html">6. Language extensions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">6.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="syntax.html">6.2. Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="import_export.html">6.3. Import and export</a></li>
<li class="toctree-l2"><a class="reference internal" href="types.html">6.4. Types</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="records.html">6.5. Records</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="traditional_record_syntax.html">6.5.1. Traditional record syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="field_selectors_and_type_applications.html">6.5.2. Field selectors and <code class="docutils literal notranslate"><span class="pre">TypeApplications</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">6.5.3. Record field disambiguation</a></li>
<li class="toctree-l3"><a class="reference internal" href="duplicate_record_fields.html">6.5.4. Duplicate record fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="field_selectors.html">6.5.5. Field selectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="record_puns.html">6.5.6. Record puns</a></li>
<li class="toctree-l3"><a class="reference internal" href="record_wildcards.html">6.5.7. Record wildcards</a></li>
<li class="toctree-l3"><a class="reference internal" href="hasfield.html">6.5.8. Record field selector polymorphism</a></li>
<li class="toctree-l3"><a class="reference internal" href="overloaded_record_dot.html">6.5.9. Overloaded record dot</a></li>
<li class="toctree-l3"><a class="reference internal" href="overloaded_record_update.html">6.5.10. Overloaded record update</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deriving.html">6.6. Deriving mechanism</a></li>
<li class="toctree-l2"><a class="reference internal" href="patterns.html">6.7. Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="typeclasses.html">6.8. Class and instances declarations</a></li>
<li class="toctree-l2"><a class="reference internal" href="literals.html">6.9. Literals</a></li>
<li class="toctree-l2"><a class="reference internal" href="constraints.html">6.10. Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="type_signatures.html">6.11. Type signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="bindings.html">6.12. Bindings and generalisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="template_haskell.html">6.13. Template Haskell</a></li>
<li class="toctree-l2"><a class="reference internal" href="strict.html">6.14. Bang patterns and Strict Haskell</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallel.html">6.15. Parallel and Concurrent</a></li>
<li class="toctree-l2"><a class="reference internal" href="primitives.html">6.16. Unboxed types and primitive operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ffi.html">6.17. Foreign function interface (FFI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="safe_haskell.html">6.18. Safe Haskell</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html">6.19. Miscellaneous</a></li>
<li class="toctree-l2"><a class="reference internal" href="pragmas.html">6.20. Pragmas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extending_ghc.html">7. Extending and using GHC as a Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../profiling.html">8. Profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug-info.html">9. Debugging compiled programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gone_wrong.html">10. What to do when something goes wrong</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hints.html">11. Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">12. Other Haskell utility programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../win32-dlls.html">13. Running GHC on Win32 systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugs.html">14. Known bugs and infelicities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eventlog-formats.html">15. Eventlog encodings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../editing-guide.html">16. Care and feeding of your GHC Userâ€™s Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Glasgow Haskell Compiler</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../exts.html"><span class="section-number">6. </span>Language extensions</a> &raquo;</li>
        
          <li><a href="records.html"><span class="section-number">6.5. </span>Records</a> &raquo;</li>
        
      <li><span class="section-number">6.5.3. </span>Record field disambiguation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/exts/disambiguate_record_fields.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="record-field-disambiguation">
<span id="disambiguate-fields"></span><h1><span class="section-number">6.5.3. </span>Record field disambiguation<a class="headerlink" href="#record-field-disambiguation" title="Permalink to this heading">Â¶</a></h1>
<dl class="std extension">
<dt class="sig sig-object std" id="extension-DisambiguateRecordFields">
<span id="ghc-flag--XDisambiguateRecordFields"></span><span id="extension-NoDisambiguateRecordFields"></span><span class="sig-name descname"><span class="pre">DisambiguateRecordFields</span></span><a class="headerlink" href="#extension-DisambiguateRecordFields" title="Permalink to this definition">Â¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Since<span class="colon">:</span></dt>
<dd class="field-odd"><p>6.8.1</p>
</dd>
<dt class="field-even">Implied by<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="record_wildcards.html#extension-RecordWildCards"><code class="xref std std-extension docutils literal notranslate"><span class="pre">RecordWildCards</span></code></a>, <a class="reference internal" href="duplicate_record_fields.html#extension-DuplicateRecordFields"><code class="xref std std-extension docutils literal notranslate"><span class="pre">DuplicateRecordFields</span></code></a></p>
</dd>
</dl>
<p>Allow the compiler to automatically choose between identically-named record
fields (if the choice is unambiguous).</p>
</dd></dl>

<p>In record construction and record pattern matching it is entirely
unambiguous which field is referred to, even if there are two different
data types in scope with a common field name. For example:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">module</span><span class="w"> </span><span class="nn">M</span><span class="w"> </span><span class="kr">where</span><span class="w"></span>
<span class="w">  </span><span class="kr">data</span><span class="w"> </span><span class="kt">S</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">MkS</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Bool</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="kr">module</span><span class="w"> </span><span class="nn">Foo</span><span class="w"> </span><span class="kr">where</span><span class="w"></span>
<span class="w">  </span><span class="kr">import</span><span class="w"> </span><span class="nn">M</span><span class="w"></span>

<span class="w">  </span><span class="kr">data</span><span class="w"> </span><span class="kt">T</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">MkT</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="n">ok1</span><span class="w"> </span><span class="p">(</span><span class="kt">MkS</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="w">   </span><span class="c1">-- Unambiguous</span><span class="w"></span>
<span class="w">  </span><span class="n">ok2</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">MkT</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">}</span><span class="w">     </span><span class="c1">-- Unambiguous</span><span class="w"></span>

<span class="w">  </span><span class="n">bad1</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">}</span><span class="w">        </span><span class="c1">-- Ambiguous</span><span class="w"></span>
<span class="w">  </span><span class="n">bad2</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">k</span><span class="w">                </span><span class="c1">-- Ambiguous</span><span class="w"></span>
</pre></div>
</div>
<p>Even though there are two <code class="docutils literal notranslate"><span class="pre">x</span></code>â€™s in scope, it is clear that the <code class="docutils literal notranslate"><span class="pre">x</span></code>
in the pattern in the definition of <code class="docutils literal notranslate"><span class="pre">ok1</span></code> can only mean the field
<code class="docutils literal notranslate"><span class="pre">x</span></code> from type <code class="docutils literal notranslate"><span class="pre">S</span></code>. Similarly for the function <code class="docutils literal notranslate"><span class="pre">ok2</span></code>. However, in
the record update in <code class="docutils literal notranslate"><span class="pre">bad1</span></code> and the record selection in <code class="docutils literal notranslate"><span class="pre">bad2</span></code> it is
not clear which of the two types is intended.</p>
<p>Haskell 98 regards all four as ambiguous, but with the
<a class="reference internal" href="#extension-DisambiguateRecordFields"><code class="xref std std-extension docutils literal notranslate"><span class="pre">DisambiguateRecordFields</span></code></a> extension, GHC will accept the former two. The
rules are precisely the same as those for instance declarations in
Haskell 98, where the method names on the left-hand side of the method
bindings in an instance declaration refer unambiguously to the method of
that class (provided they are in scope at all), even if there are other
variables in scope with the same name. This reduces the clutter of
qualified names when you import two records from different modules that
use the same field name.</p>
<p>Since version 9.2.1, record fields in updates are disambiguated by ignoring
non-field names in scope. For example, the following is accepted under
<a class="reference internal" href="#extension-DisambiguateRecordFields"><code class="xref std std-extension docutils literal notranslate"><span class="pre">DisambiguateRecordFields</span></code></a>:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">module</span><span class="w"> </span><span class="nn">Bar</span><span class="w"> </span><span class="kr">where</span><span class="w"></span>
<span class="w">  </span><span class="kr">import</span><span class="w"> </span><span class="nn">M</span><span class="w">  </span><span class="c1">-- imports the field x</span><span class="w"></span>

<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nb">()</span><span class="w"></span>

<span class="w">  </span><span class="n">e</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="c1">-- unambiguously refers to the field</span><span class="w"></span>
</pre></div>
</div>
<p>Some details:</p>
<ul>
<li><p>Field disambiguation can be combined with punning (see
<a class="reference internal" href="record_puns.html#record-puns"><span class="std std-ref">Record puns</span></a>). For example:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">module</span><span class="w"> </span><span class="nn">Foo</span><span class="w"> </span><span class="kr">where</span><span class="w"></span>
<span class="w">  </span><span class="kr">import</span><span class="w"> </span><span class="nn">M</span><span class="w"></span>
<span class="w">  </span><span class="n">x</span><span class="ow">=</span><span class="kt">True</span><span class="w"></span>
<span class="w">  </span><span class="n">ok3</span><span class="w"> </span><span class="p">(</span><span class="kt">MkS</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="w">   </span><span class="c1">-- Uses both disambiguation and punning</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p>With <a class="reference internal" href="#extension-DisambiguateRecordFields"><code class="xref std std-extension docutils literal notranslate"><span class="pre">DisambiguateRecordFields</span></code></a> you can use <em>unqualified</em> field
names even if the corresponding selector is only in scope <em>qualified</em>
For example, assuming the same module <code class="docutils literal notranslate"><span class="pre">M</span></code> as in our earlier
example, this is legal:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">module</span><span class="w"> </span><span class="nn">Foo</span><span class="w"> </span><span class="kr">where</span><span class="w"></span>
<span class="w">  </span><span class="kr">import</span><span class="w"> </span><span class="k">qualified</span><span class="w"> </span><span class="nn">M</span><span class="w">    </span><span class="c1">-- Note qualified</span><span class="w"></span>

<span class="w">  </span><span class="n">ok4</span><span class="w"> </span><span class="p">(</span><span class="kt">M</span><span class="o">.</span><span class="kt">MkS</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="w">   </span><span class="c1">-- Unambiguous</span><span class="w"></span>
</pre></div>
</div>
<p>Since the constructor <code class="docutils literal notranslate"><span class="pre">MkS</span></code> is only in scope qualified, you must
name it <code class="docutils literal notranslate"><span class="pre">M.MkS</span></code>, but the field <code class="docutils literal notranslate"><span class="pre">x</span></code> does not need to be qualified
even though <code class="docutils literal notranslate"><span class="pre">M.x</span></code> is in scope but <code class="docutils literal notranslate"><span class="pre">x</span></code> is not (In effect, it is
qualified by the constructor).</p>
</li>
</ul>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="duplicate_record_fields.html" class="btn btn-neutral float-right" title="6.5.4. Duplicate record fields" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="field_selectors_and_type_applications.html" class="btn btn-neutral float-left" title="6.5.2. Field selectors and TypeApplications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, GHC Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>