

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6.5.4. Duplicate record fields &mdash; Glasgow Haskell Compiler 9.2.5 User&#39;s Guide</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Glasgow Haskell Compiler 9.2.5 User&#39;s Guide"
          href="../_static/opensearch.xml"/>

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.5.5. Field selectors" href="field_selectors.html" />
    <link rel="prev" title="6.5.3. Record field disambiguation" href="disambiguate_record_fields.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Glasgow Haskell Compiler
          

          
          </a>

          
            
            
              <div class="version">
                9.2.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">2. Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ghci.html">3. Using GHCi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runghc.html">4. Using runghc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">5. Using GHC</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../exts.html">6. Language extensions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">6.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="syntax.html">6.2. Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="import_export.html">6.3. Import and export</a></li>
<li class="toctree-l2"><a class="reference internal" href="types.html">6.4. Types</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="records.html">6.5. Records</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="traditional_record_syntax.html">6.5.1. Traditional record syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="field_selectors_and_type_applications.html">6.5.2. Field selectors and <code class="docutils literal notranslate"><span class="pre">TypeApplications</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="disambiguate_record_fields.html">6.5.3. Record field disambiguation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">6.5.4. Duplicate record fields</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#selector-functions">6.5.4.1. Selector functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#record-updates">6.5.4.2. Record updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#import-and-export-of-record-fields">6.5.4.3. Import and export of record fields</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="field_selectors.html">6.5.5. Field selectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="record_puns.html">6.5.6. Record puns</a></li>
<li class="toctree-l3"><a class="reference internal" href="record_wildcards.html">6.5.7. Record wildcards</a></li>
<li class="toctree-l3"><a class="reference internal" href="hasfield.html">6.5.8. Record field selector polymorphism</a></li>
<li class="toctree-l3"><a class="reference internal" href="overloaded_record_dot.html">6.5.9. Overloaded record dot</a></li>
<li class="toctree-l3"><a class="reference internal" href="overloaded_record_update.html">6.5.10. Overloaded record update</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deriving.html">6.6. Deriving mechanism</a></li>
<li class="toctree-l2"><a class="reference internal" href="patterns.html">6.7. Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="typeclasses.html">6.8. Class and instances declarations</a></li>
<li class="toctree-l2"><a class="reference internal" href="literals.html">6.9. Literals</a></li>
<li class="toctree-l2"><a class="reference internal" href="constraints.html">6.10. Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="type_signatures.html">6.11. Type signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="bindings.html">6.12. Bindings and generalisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="template_haskell.html">6.13. Template Haskell</a></li>
<li class="toctree-l2"><a class="reference internal" href="strict.html">6.14. Bang patterns and Strict Haskell</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallel.html">6.15. Parallel and Concurrent</a></li>
<li class="toctree-l2"><a class="reference internal" href="primitives.html">6.16. Unboxed types and primitive operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ffi.html">6.17. Foreign function interface (FFI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="safe_haskell.html">6.18. Safe Haskell</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html">6.19. Miscellaneous</a></li>
<li class="toctree-l2"><a class="reference internal" href="pragmas.html">6.20. Pragmas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extending_ghc.html">7. Extending and using GHC as a Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../profiling.html">8. Profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug-info.html">9. Debugging compiled programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gone_wrong.html">10. What to do when something goes wrong</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hints.html">11. Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">12. Other Haskell utility programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../win32-dlls.html">13. Running GHC on Win32 systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugs.html">14. Known bugs and infelicities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eventlog-formats.html">15. Eventlog encodings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../editing-guide.html">16. Care and feeding of your GHC User’s Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Glasgow Haskell Compiler</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../exts.html"><span class="section-number">6. </span>Language extensions</a> &raquo;</li>
        
          <li><a href="records.html"><span class="section-number">6.5. </span>Records</a> &raquo;</li>
        
      <li><span class="section-number">6.5.4. </span>Duplicate record fields</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/exts/duplicate_record_fields.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="duplicate-record-fields">
<span id="id1"></span><h1><span class="section-number">6.5.4. </span>Duplicate record fields<a class="headerlink" href="#duplicate-record-fields" title="Permalink to this heading">¶</a></h1>
<dl class="std extension">
<dt class="sig sig-object std" id="extension-DuplicateRecordFields">
<span id="ghc-flag--XDuplicateRecordFields"></span><span id="extension-NoDuplicateRecordFields"></span><span class="sig-name descname"><span class="pre">DuplicateRecordFields</span></span><a class="headerlink" href="#extension-DuplicateRecordFields" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Implies<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="disambiguate_record_fields.html#extension-DisambiguateRecordFields"><code class="xref std std-extension docutils literal notranslate"><span class="pre">DisambiguateRecordFields</span></code></a></p>
</dd>
<dt class="field-even">Since<span class="colon">:</span></dt>
<dd class="field-even"><p>8.0.1</p>
</dd>
</dl>
<p>Allow definition of record types with identically-named fields.</p>
</dd></dl>

<p>Going beyond <a class="reference internal" href="disambiguate_record_fields.html#extension-DisambiguateRecordFields"><code class="xref std std-extension docutils literal notranslate"><span class="pre">DisambiguateRecordFields</span></code></a> (see <a class="reference internal" href="disambiguate_record_fields.html#disambiguate-fields"><span class="std std-ref">Record field disambiguation</span></a>),
the <a class="reference internal" href="#extension-DuplicateRecordFields"><code class="xref std std-extension docutils literal notranslate"><span class="pre">DuplicateRecordFields</span></code></a> extension allows multiple datatypes to be
declared using the same field names in a single module. For example, it allows
this:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">module</span><span class="w"> </span><span class="nn">M</span><span class="w"> </span><span class="kr">where</span><span class="w"></span>
<span class="w">  </span><span class="kr">data</span><span class="w"> </span><span class="kt">S</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">MkS</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="kr">data</span><span class="w"> </span><span class="kt">T</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">MkT</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Bool</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Uses of fields that are always unambiguous because they mention the constructor,
including construction and pattern-matching, may freely use duplicated field
names. For example, the following are permitted (just as with
<a class="reference internal" href="disambiguate_record_fields.html#extension-DisambiguateRecordFields"><code class="xref std std-extension docutils literal notranslate"><span class="pre">DisambiguateRecordFields</span></code></a>):</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">s</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">MkS</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="nf">f</span><span class="w"> </span><span class="p">(</span><span class="kt">MkT</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">b</span><span class="w"></span>
</pre></div>
</div>
<p>Field names used as selector functions or in record updates must be unambiguous,
either because there is only one such field in scope, or because a type
signature is supplied, as described in the following sections.</p>
<p>While <a class="reference internal" href="#extension-DuplicateRecordFields"><code class="xref std std-extension docutils literal notranslate"><span class="pre">DuplicateRecordFields</span></code></a> permits multiple fields with the same
name in a single module, it does not permit a field and a normal value binding
to have the same name.  For that, use <a class="reference internal" href="field_selectors.html#extension-FieldSelectors"><code class="xref std std-extension docutils literal notranslate"><span class="pre">NoFieldSelectors</span></code></a>.</p>
<section id="selector-functions">
<h2><span class="section-number">6.5.4.1. </span>Selector functions<a class="headerlink" href="#selector-functions" title="Permalink to this heading">¶</a></h2>
<p>Fields may be used as selector functions only if they are unambiguous, so this
is still not allowed if both <code class="docutils literal notranslate"><span class="pre">S(x)</span></code> and <code class="docutils literal notranslate"><span class="pre">T(x)</span></code> are in scope:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">bad</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">r</span><span class="w"></span>
</pre></div>
</div>
<p><strong>Warning</strong>: the type-based disambiguation rules described in the remainder of
this section are being removed (see the proposal <a class="reference external" href="https://github.com/ghc-proposals/ghc-proposals/blob/master/proposals/0366-no-ambiguous-field-access.rst">DuplicateRecordFields without
ambiguous field access</a>).
The <a class="reference internal" href="../using-warnings.html#ghc-flag-Wambiguous-fields"><code class="xref std std-ghc-flag docutils literal notranslate"><span class="pre">-Wambiguous-fields</span></code></a> option will warn about code that relies on
these rules. In a future GHC release, such code will produce ambiguity errors.</p>
<p>An ambiguous selector may be disambiguated by the type being “pushed down” to
the occurrence of the selector (see <a class="reference internal" href="rank_polymorphism.html#higher-rank-type-inference"><span class="std std-ref">Type inference</span></a> for more
details on what “pushed down” means). For example, the following are permitted:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">ok1</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">S</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"></span>

<span class="nf">ok2</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">S</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"></span>
<span class="nf">ok2</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">x</span><span class="w"></span>

<span class="nf">ok3</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="c1">-- assuming we already have k :: (S -&gt; Int) -&gt; _</span><span class="w"></span>
</pre></div>
</div>
<p>In addition, the datatype that is meant may be given as a type signature on the
argument to the selector:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">ok4</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">S</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>However, we do not infer the type of the argument to determine the datatype, or
have any way of deferring the choice to the constraint solver. Thus the
following is ambiguous:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">bad</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">S</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"></span>
<span class="nf">bad</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">s</span><span class="w"></span>
</pre></div>
</div>
<p>Even though a field label is duplicated in its defining module, it may be
possible to use the selector unambiguously elsewhere. For example, another
module could import <code class="docutils literal notranslate"><span class="pre">S(x)</span></code> but not <code class="docutils literal notranslate"><span class="pre">T(x)</span></code>, and then use <code class="docutils literal notranslate"><span class="pre">x</span></code> unambiguously.</p>
</section>
<section id="record-updates">
<h2><span class="section-number">6.5.4.2. </span>Record updates<a class="headerlink" href="#record-updates" title="Permalink to this heading">¶</a></h2>
<p>In a record update such as <code class="docutils literal notranslate"><span class="pre">e</span> <span class="pre">{</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">1</span> <span class="pre">}</span></code>, if there are multiple <code class="docutils literal notranslate"><span class="pre">x</span></code> fields
in scope, then the type of the context must fix which record datatype is
intended, or a type annotation must be supplied. Consider the following
definitions:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">data</span><span class="w"> </span><span class="kt">S</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">MkS</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="kr">data</span><span class="w"> </span><span class="kt">T</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">MkT</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="kr">data</span><span class="w"> </span><span class="kt">U</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">MkU</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="n">baz</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Without <a class="reference internal" href="#extension-DuplicateRecordFields"><code class="xref std std-extension docutils literal notranslate"><span class="pre">DuplicateRecordFields</span></code></a>, an update mentioning <code class="docutils literal notranslate"><span class="pre">foo</span></code> will always be
ambiguous if all these definitions were in scope. When the extension is enabled,
and there is exactly one type that has all the fields being updated, that type will be used.
For example:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">f</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">f</span></code> must be updating <code class="docutils literal notranslate"><span class="pre">T</span></code> because neither <code class="docutils literal notranslate"><span class="pre">S</span></code> nor <code class="docutils literal notranslate"><span class="pre">U</span></code> have both
fields.</p>
<p>If there are multiple types with all the fields, type information may be used to
disambiguate which record type is meant. <strong>Warning</strong>: the following rules are
being removed (see the proposal <a class="reference external" href="https://github.com/ghc-proposals/ghc-proposals/blob/master/proposals/0366-no-ambiguous-field-access.rst">DuplicateRecordFields without ambiguous field
access</a>).
The <a class="reference internal" href="../using-warnings.html#ghc-flag-Wambiguous-fields"><code class="xref std std-ghc-flag docutils literal notranslate"><span class="pre">-Wambiguous-fields</span></code></a> option will warn about code that relies on
these rules. In a future GHC release, such code will produce ambiguity errors.</p>
<ul>
<li><p>Use the type being pushed in to the record update, as in the following:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">g1</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">T</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">T</span><span class="w"></span>
<span class="nf">g1</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="nf">g2</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">T</span><span class="w"></span>

<span class="nf">g3</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="c1">-- assuming we already have k :: T -&gt; _</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p>Use an explicit type signature on the record expression, as in:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">h</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">T</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</li>
</ul>
<p>The type of the expression being updated will not be inferred, and no
constraint-solving will be performed, so the following will be rejected as
ambiguous:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">T</span><span class="w"></span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">blah</span><span class="w"></span>
<span class="kr">in</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="nf">\</span><span class="n">x</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="n">blah</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">T</span><span class="w"> </span><span class="p">]</span><span class="w"></span>

<span class="nf">\</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">T</span><span class="p">)</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="import-and-export-of-record-fields">
<h2><span class="section-number">6.5.4.3. </span>Import and export of record fields<a class="headerlink" href="#import-and-export-of-record-fields" title="Permalink to this heading">¶</a></h2>
<p>When <a class="reference internal" href="#extension-DuplicateRecordFields"><code class="xref std std-extension docutils literal notranslate"><span class="pre">DuplicateRecordFields</span></code></a> is enabled, an ambiguous field must be exported
as part of its datatype, rather than at the top level. For example, the
following is legal:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">module</span><span class="w"> </span><span class="nn">M</span><span class="w"> </span><span class="p">(</span><span class="kt">S</span><span class="p">(</span><span class="nf">x</span><span class="p">),</span><span class="w"> </span><span class="kt">T</span><span class="p">(</span><span class="o">..</span><span class="p">))</span><span class="w"> </span><span class="kr">where</span><span class="w"></span>
<span class="w">  </span><span class="kr">data</span><span class="w"> </span><span class="kt">S</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">MkS</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="kr">data</span><span class="w"> </span><span class="kt">T</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">MkT</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Bool</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>However, this would not be permitted, because <code class="docutils literal notranslate"><span class="pre">x</span></code> is ambiguous:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="kr">module</span><span class="w"> </span><span class="nn">M</span><span class="w"> </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span><span class="w"> </span><span class="kr">where</span><span class="w"> </span><span class="o">...</span><span class="w"></span>
</pre></div>
</div>
<p>Similar restrictions apply on import.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="field_selectors.html" class="btn btn-neutral float-right" title="6.5.5. Field selectors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="disambiguate_record_fields.html" class="btn btn-neutral float-left" title="6.5.3. Record field disambiguation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, GHC Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>