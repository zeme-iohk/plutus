<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns        #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP                 #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE MagicHash           #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf          #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TupleSections       #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE UnboxedTuples       #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">-- |Encoding Primitives</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Flat.Encoder.Prim</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eBits16F"><span class="hs-identifier">eBits16F</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eBitsF"><span class="hs-identifier">eBitsF</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eFloatF"><span class="hs-identifier">eFloatF</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eDoubleF"><span class="hs-identifier">eDoubleF</span></a></span><span class="hs-cpp">
#if ! defined(ghcjs_HOST_OS) &amp;&amp; ! defined (ETA_VERSION)
</span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eUTF16F"><span class="hs-identifier">eUTF16F</span></a></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eUTF8F"><span class="hs-identifier">eUTF8F</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eCharF"><span class="hs-identifier">eCharF</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eNaturalF"><span class="hs-identifier">eNaturalF</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eIntegerF"><span class="hs-identifier">eIntegerF</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eInt64F"><span class="hs-identifier">eInt64F</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eInt32F"><span class="hs-identifier">eInt32F</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eIntF"><span class="hs-identifier">eIntF</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eInt16F"><span class="hs-identifier">eInt16F</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eInt8F"><span class="hs-identifier">eInt8F</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWordF"><span class="hs-identifier">eWordF</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord64F"><span class="hs-identifier">eWord64F</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord32F"><span class="hs-identifier">eWord32F</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord16F"><span class="hs-identifier">eWord16F</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eBytesF"><span class="hs-identifier">eBytesF</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eLazyBytesF"><span class="hs-identifier">eLazyBytesF</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eShortBytesF"><span class="hs-identifier">eShortBytesF</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord8F"><span class="hs-identifier">eWord8F</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eFillerF"><span class="hs-identifier">eFillerF</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eBoolF"><span class="hs-identifier">eBoolF</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eTrueF"><span class="hs-identifier">eTrueF</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eFalseF"><span class="hs-identifier">eFalseF</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#varWordF"><span class="hs-identifier">varWordF</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#w7l"><span class="hs-identifier">w7l</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Exported for testing only</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord32BEF"><span class="hs-identifier">eWord32BEF</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord64BEF"><span class="hs-identifier">eWord64BEF</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord32E"><span class="hs-identifier">eWord32E</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord64E"><span class="hs-identifier">eWord64E</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy.Internal</span></a></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString.Short.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SBS</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Char</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Flat.Encoder.Types.html"><span class="hs-identifier">Flat.Encoder.Types</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Flat.Endian.html"><span class="hs-identifier">Flat.Endian</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Flat.Memory.html"><span class="hs-identifier">Flat.Memory</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Flat.Types.html"><span class="hs-identifier">Flat.Types</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.FloatCast.html"><span class="hs-identifier">Data.FloatCast</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">Data.Primitive.ByteArray</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span>                      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span class="hs-cpp">
#if! defined(ghcjs_HOST_OS) &amp;&amp; ! defined (ETA_VERSION)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text.Array</span></a></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TA</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text.Internal</span></a></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TI</span></span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TE</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.ZigZag.html"><span class="hs-identifier">Data.ZigZag</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Foreign</span></a></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- import Debug.Trace</span><span class="hs-cpp">
#include &quot;MachDeps.h&quot;
</span><span class="hs-comment">-- traceShowId :: a -&gt; a</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- traceShowId = id</span><span>
</span><span id="line-72"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eFloatF"><span class="hs-pragma hs-type">eFloatF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-73"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eFloatF"><span class="hs-identifier hs-type">eFloatF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Float</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-74"></span><span id="eFloatF"><span class="annot"><span class="annottext">eFloatF :: Float -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eFloatF"><span class="hs-identifier hs-var hs-var">eFloatF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord32BEF"><span class="hs-identifier hs-var">eWord32BEF</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Word32
</span><a href="Data.FloatCast.html#floatToWord"><span class="hs-identifier hs-var">floatToWord</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eDoubleF"><span class="hs-pragma hs-type">eDoubleF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-77"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eDoubleF"><span class="hs-identifier hs-type">eDoubleF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-78"></span><span id="eDoubleF"><span class="annot"><span class="annottext">eDoubleF :: Double -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eDoubleF"><span class="hs-identifier hs-var hs-var">eDoubleF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord64BEF"><span class="hs-identifier hs-var">eWord64BEF</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Word64
</span><a href="Data.FloatCast.html#doubleToWord"><span class="hs-identifier hs-var">doubleToWord</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord64BEF"><span class="hs-pragma hs-type">eWord64BEF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-81"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord64BEF"><span class="hs-identifier hs-type">eWord64BEF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-82"></span><span id="eWord64BEF"><span class="annot"><span class="annottext">eWord64BEF :: Word64 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord64BEF"><span class="hs-identifier hs-var hs-var">eWord64BEF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Word64) -&gt; Word64 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord64E"><span class="hs-identifier hs-var">eWord64E</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Flat.Endian.html#toBE64"><span class="hs-identifier hs-var">toBE64</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord32BEF"><span class="hs-pragma hs-type">eWord32BEF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-85"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord32BEF"><span class="hs-identifier hs-type">eWord32BEF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-86"></span><span id="eWord32BEF"><span class="annot"><span class="annottext">eWord32BEF :: Word32 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord32BEF"><span class="hs-identifier hs-var hs-var">eWord32BEF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word32) -&gt; Word32 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord32E"><span class="hs-identifier hs-var">eWord32E</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Flat.Endian.html#toBE32"><span class="hs-identifier hs-var">toBE32</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eCharF"><span class="hs-pragma hs-type">eCharF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-89"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eCharF"><span class="hs-identifier hs-type">eCharF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-90"></span><span id="eCharF"><span class="annot"><span class="annottext">eCharF :: Char -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eCharF"><span class="hs-identifier hs-var hs-var">eCharF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord32F"><span class="hs-identifier hs-var">eWord32F</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">ord</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWordF"><span class="hs-pragma hs-type">eWordF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-93"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eWordF"><span class="hs-identifier hs-type">eWordF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-94"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eIntF"><span class="hs-pragma hs-type">eIntF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-95"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eIntF"><span class="hs-identifier hs-type">eIntF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span class="hs-cpp">
#if WORD_SIZE_IN_BITS == 64
</span><span id="eWordF"><span class="annot"><span class="annottext">eWordF :: Word -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWordF"><span class="hs-identifier hs-var hs-var">eWordF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord64F"><span class="hs-identifier hs-var">eWord64F</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span id="eIntF"><span class="annot"><span class="annottext">eIntF :: Int -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eIntF"><span class="hs-identifier hs-var hs-var">eIntF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eInt64F"><span class="hs-identifier hs-var">eInt64F</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#elif WORD_SIZE_IN_BITS == 32
</span><span class="hs-identifier">eWordF</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">eWord32F</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word32</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-identifier">eIntF</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">eInt32F</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int32</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-cpp">#error expected WORD_SIZE_IN_BITS to be 32 or 64
</span><span class="hs-cpp">#endif
</span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eInt8F"><span class="hs-pragma hs-type">eInt8F</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-108"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eInt8F"><span class="hs-identifier hs-type">eInt8F</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-109"></span><span id="eInt8F"><span class="annot"><span class="annottext">eInt8F :: Int8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eInt8F"><span class="hs-identifier hs-var hs-var">eInt8F</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord8F"><span class="hs-identifier hs-var">eWord8F</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall signed unsigned.
ZigZag signed unsigned =&gt;
signed -&gt; unsigned
</span><a href="Data.ZigZag.html#zigZag"><span class="hs-identifier hs-var">zigZag</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eInt16F"><span class="hs-pragma hs-type">eInt16F</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-112"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eInt16F"><span class="hs-identifier hs-type">eInt16F</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-113"></span><span id="eInt16F"><span class="annot"><span class="annottext">eInt16F :: Int16 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eInt16F"><span class="hs-identifier hs-var hs-var">eInt16F</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord16F"><span class="hs-identifier hs-var">eWord16F</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall signed unsigned.
ZigZag signed unsigned =&gt;
signed -&gt; unsigned
</span><a href="Data.ZigZag.html#zigZag"><span class="hs-identifier hs-var">zigZag</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eInt32F"><span class="hs-pragma hs-type">eInt32F</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-116"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eInt32F"><span class="hs-identifier hs-type">eInt32F</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-117"></span><span id="eInt32F"><span class="annot"><span class="annottext">eInt32F :: Int32 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eInt32F"><span class="hs-identifier hs-var hs-var">eInt32F</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord32F"><span class="hs-identifier hs-var">eWord32F</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall signed unsigned.
ZigZag signed unsigned =&gt;
signed -&gt; unsigned
</span><a href="Data.ZigZag.html#zigZag"><span class="hs-identifier hs-var">zigZag</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eInt64F"><span class="hs-pragma hs-type">eInt64F</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-120"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eInt64F"><span class="hs-identifier hs-type">eInt64F</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-121"></span><span id="eInt64F"><span class="annot"><span class="annottext">eInt64F :: Int64 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eInt64F"><span class="hs-identifier hs-var hs-var">eInt64F</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord64F"><span class="hs-identifier hs-var">eWord64F</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall signed unsigned.
ZigZag signed unsigned =&gt;
signed -&gt; unsigned
</span><a href="Data.ZigZag.html#zigZag"><span class="hs-identifier hs-var">zigZag</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eIntegerF"><span class="hs-pragma hs-type">eIntegerF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-124"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eIntegerF"><span class="hs-identifier hs-type">eIntegerF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-125"></span><span id="eIntegerF"><span class="annot"><span class="annottext">eIntegerF :: Integer -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eIntegerF"><span class="hs-identifier hs-var hs-var">eIntegerF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (Bits t, Integral t) =&gt; t -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eIntegralF"><span class="hs-identifier hs-var">eIntegralF</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall signed unsigned.
ZigZag signed unsigned =&gt;
signed -&gt; unsigned
</span><a href="Data.ZigZag.html#zigZag"><span class="hs-identifier hs-var">zigZag</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eNaturalF"><span class="hs-pragma hs-type">eNaturalF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-128"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eNaturalF"><span class="hs-identifier hs-type">eNaturalF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-129"></span><span id="eNaturalF"><span class="annot"><span class="annottext">eNaturalF :: Natural -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eNaturalF"><span class="hs-identifier hs-var hs-var">eNaturalF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (Bits t, Integral t) =&gt; t -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eIntegralF"><span class="hs-identifier hs-var">eIntegralF</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Integer
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toInteger</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eIntegralF"><span class="hs-pragma hs-type">eIntegralF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-132"></span><span id="local-6989586621679097121"><span class="annot"><a href="Flat.Encoder.Prim.html#eIntegralF"><span class="hs-identifier hs-type">eIntegralF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Bits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097121"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097121"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097121"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span></span><span>
</span><span id="line-133"></span><span id="eIntegralF"><span class="annot"><span class="annottext">eIntegralF :: forall t. (Bits t, Integral t) =&gt; t -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eIntegralF"><span class="hs-identifier hs-var hs-var">eIntegralF</span></a></span></span><span> </span><span id="local-6989586621679096796"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096796"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679096793"><span class="annot"><span class="annottext">vs :: [Word8]
</span><a href="#local-6989586621679096793"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (Bits t, Integral t) =&gt; t -&gt; [Word8]
</span><a href="Flat.Encoder.Prim.html#w7l"><span class="hs-identifier hs-var">w7l</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096796"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-135"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eIntegralW"><span class="hs-identifier hs-var">eIntegralW</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679096793"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679097118"><span class="annot"><a href="Flat.Encoder.Prim.html#w7l"><span class="hs-identifier hs-type">w7l</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Bits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097118"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097118"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097118"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-138"></span><span id="w7l"><span class="annot"><span class="annottext">w7l :: forall t. (Bits t, Integral t) =&gt; t -&gt; [Word8]
</span><a href="Flat.Encoder.Prim.html#w7l"><span class="hs-identifier hs-var hs-var">w7l</span></a></span></span><span> </span><span id="local-6989586621679096777"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096777"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679096775"><span class="annot"><span class="annottext">l :: Word8
</span><a href="#local-6989586621679096775"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Word8
</span><a href="Flat.Encoder.Prim.html#low7"><span class="hs-identifier hs-var">low7</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096777"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-140"></span><span>      </span><span id="local-6989586621679096772"><span class="annot"><span class="annottext">t' :: t
</span><a href="#local-6989586621679096772"><span class="hs-identifier hs-var hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096777"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-141"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096772"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096775"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="#local-6989586621679096770"><span class="hs-identifier hs-var">w7</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096775"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. (Bits t, Integral t) =&gt; t -&gt; [Word8]
</span><a href="Flat.Encoder.Prim.html#w7l"><span class="hs-identifier hs-var">w7l</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096772"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679096770"><span class="hs-pragma hs-type">w7</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-comment">--lowByte :: (Bits t, Num t) =&gt; t -&gt; Word8</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="#local-6989586621679096770"><span class="hs-identifier hs-type">w7</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679096770"><span class="annot"><span class="annottext">w7 :: Word8 -&gt; Word8
</span><a href="#local-6989586621679096770"><span class="hs-identifier hs-var hs-var">w7</span></a></span></span><span> </span><span id="local-6989586621679096769"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096769"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096769"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x80</span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | Encoded as: data NonEmptyList = Elem Word7 | Cons Word7 List</span><span>
</span><span id="line-151"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eIntegralW"><span class="hs-pragma hs-type">eIntegralW</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-152"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eIntegralW"><span class="hs-identifier hs-type">eIntegralW</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-153"></span><span id="eIntegralW"><span class="annot"><span class="annottext">eIntegralW :: [Word8] -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eIntegralW"><span class="hs-identifier hs-var hs-var">eIntegralW</span></a></span></span><span> </span><span id="local-6989586621679096767"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679096767"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679096766"><span class="annot"><span class="annottext">s :: S
</span><a href="#local-6989586621679096766"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679096764"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096764"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679096763"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096763"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096763"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldM</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. Storable a =&gt; Ptr a -&gt; a -&gt; IO (Ptr b)
</span><a href="Flat.Encoder.Prim.html#pokeWord%27"><span class="hs-identifier hs-var">pokeWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096764"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679096767"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679096760"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096760"><span class="hs-identifier hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; Int -&gt; S
</span><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096760"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord8F"><span class="hs-identifier hs-var">eWord8F</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096766"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679096767"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord8F"><span class="hs-pragma hs-type">eWord8F</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-158"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord8F"><span class="hs-identifier hs-type">eWord8F</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-159"></span><span id="eWord8F"><span class="annot"><span class="annottext">eWord8F :: Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord8F"><span class="hs-identifier hs-var hs-var">eWord8F</span></a></span></span><span> </span><span id="local-6989586621679096758"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096758"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679096757"><span class="annot"><span class="annottext">s :: S
</span><a href="#local-6989586621679096757"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679096756"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096756"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679096755"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096755"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096755"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO S
</span><a href="Flat.Encoder.Prim.html#pokeWord"><span class="hs-identifier hs-var">pokeWord</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096756"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096758"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#pokeByteUnaligned"><span class="hs-identifier hs-var">pokeByteUnaligned</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096758"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096757"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord32E"><span class="hs-pragma hs-type">eWord32E</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-164"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord32E"><span class="hs-identifier hs-type">eWord32E</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-165"></span><span id="eWord32E"><span class="annot"><span class="annottext">eWord32E :: (Word32 -&gt; Word32) -&gt; Word32 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord32E"><span class="hs-identifier hs-var hs-var">eWord32E</span></a></span></span><span> </span><span id="local-6989586621679096752"><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="#local-6989586621679096752"><span class="hs-identifier hs-var">conv</span></a></span></span><span> </span><span id="local-6989586621679096751"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679096751"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679096750"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096750"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679096749"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096749"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679096748"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096748"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096748"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a t a1. Storable a =&gt; (t -&gt; a) -&gt; Ptr a1 -&gt; t -&gt; IO ()
</span><a href="Flat.Encoder.Prim.html#pokeW"><span class="hs-identifier hs-var">pokeW</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="#local-6989586621679096752"><span class="hs-identifier hs-var">conv</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096750"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679096751"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; Ptr a -&gt; Int -&gt; m S
</span><a href="Flat.Encoder.Prim.html#skipBytes"><span class="hs-identifier hs-var">skipBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096750"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="annottext">forall a t a1. Storable a =&gt; (t -&gt; a) -&gt; Ptr a1 -&gt; t -&gt; IO ()
</span><a href="Flat.Encoder.Prim.html#pokeW"><span class="hs-identifier hs-var">pokeW</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="#local-6989586621679096752"><span class="hs-identifier hs-var">conv</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096750"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Word32
</span><a href="Flat.Encoder.Prim.html#asWord32"><span class="hs-identifier hs-var">asWord32</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096749"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679096751"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096748"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; Int -&gt; S
</span><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">plusPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096750"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Word8
</span><a href="Flat.Encoder.Prim.html#asWord8"><span class="hs-identifier hs-var">asWord8</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679096751"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftL`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096748"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096748"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord64E"><span class="hs-pragma hs-type">eWord64E</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-172"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord64E"><span class="hs-identifier hs-type">eWord64E</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-173"></span><span id="eWord64E"><span class="annot"><span class="annottext">eWord64E :: (Word64 -&gt; Word64) -&gt; Word64 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord64E"><span class="hs-identifier hs-var hs-var">eWord64E</span></a></span></span><span> </span><span id="local-6989586621679096741"><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="#local-6989586621679096741"><span class="hs-identifier hs-var">conv</span></a></span></span><span> </span><span id="local-6989586621679096740"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679096740"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679096739"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096739"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679096738"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096738"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679096737"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096737"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096737"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t a. (t -&gt; Word64) -&gt; Ptr a -&gt; t -&gt; IO ()
</span><a href="Flat.Encoder.Prim.html#poke64"><span class="hs-identifier hs-var">poke64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="#local-6989586621679096741"><span class="hs-identifier hs-var">conv</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096739"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679096740"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; Ptr a -&gt; Int -&gt; m S
</span><a href="Flat.Encoder.Prim.html#skipBytes"><span class="hs-identifier hs-var">skipBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096739"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="annottext">forall t a. (t -&gt; Word64) -&gt; Ptr a -&gt; t -&gt; IO ()
</span><a href="Flat.Encoder.Prim.html#poke64"><span class="hs-identifier hs-var">poke64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="#local-6989586621679096741"><span class="hs-identifier hs-var">conv</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096739"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Word64
</span><a href="Flat.Encoder.Prim.html#asWord64"><span class="hs-identifier hs-var">asWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096738"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">56</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679096740"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096737"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; Int -&gt; S
</span><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">plusPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096739"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Word8
</span><a href="Flat.Encoder.Prim.html#asWord8"><span class="hs-identifier hs-var">asWord8</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679096740"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftL`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096737"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096737"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord16F"><span class="hs-pragma hs-type">eWord16F</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-180"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord16F"><span class="hs-identifier hs-type">eWord16F</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-181"></span><span id="eWord16F"><span class="annot"><span class="annottext">eWord16F :: Word16 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord16F"><span class="hs-identifier hs-var hs-var">eWord16F</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (Bits t, Integral t) =&gt; t -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#varWordF"><span class="hs-identifier hs-var">varWordF</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord32F"><span class="hs-pragma hs-type">eWord32F</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-184"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord32F"><span class="hs-identifier hs-type">eWord32F</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-185"></span><span id="eWord32F"><span class="annot"><span class="annottext">eWord32F :: Word32 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord32F"><span class="hs-identifier hs-var hs-var">eWord32F</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (Bits t, Integral t) =&gt; t -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#varWordF"><span class="hs-identifier hs-var">varWordF</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord64F"><span class="hs-pragma hs-type">eWord64F</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-188"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eWord64F"><span class="hs-identifier hs-type">eWord64F</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-189"></span><span id="eWord64F"><span class="annot"><span class="annottext">eWord64F :: Word64 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eWord64F"><span class="hs-identifier hs-var hs-var">eWord64F</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (Bits t, Integral t) =&gt; t -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#varWordF"><span class="hs-identifier hs-var">varWordF</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#varWordF"><span class="hs-pragma hs-type">varWordF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-192"></span><span id="local-6989586621679096734"><span class="annot"><a href="Flat.Encoder.Prim.html#varWordF"><span class="hs-identifier hs-type">varWordF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Bits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679096734"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679096734"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679096734"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span></span><span>
</span><span id="line-193"></span><span id="varWordF"><span class="annot"><span class="annottext">varWordF :: forall t. (Bits t, Integral t) =&gt; t -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#varWordF"><span class="hs-identifier hs-var hs-var">varWordF</span></a></span></span><span> </span><span id="local-6989586621679096725"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096725"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679096724"><span class="annot"><span class="annottext">s :: S
</span><a href="#local-6989586621679096724"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679096723"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096723"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096723"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (Bits t, Integral t) =&gt; (Word8 -&gt; Prim) -&gt; t -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#varWord"><span class="hs-identifier hs-var">varWord</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#pokeByteAligned"><span class="hs-identifier hs-var">pokeByteAligned</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096725"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096724"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (Bits t, Integral t) =&gt; (Word8 -&gt; Prim) -&gt; t -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#varWord"><span class="hs-identifier hs-var">varWord</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#pokeByteUnaligned"><span class="hs-identifier hs-var">pokeByteUnaligned</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096725"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096724"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#varWord"><span class="hs-pragma hs-type">varWord</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-198"></span><span id="local-6989586621679097081"><span class="annot"><a href="Flat.Encoder.Prim.html#varWord"><span class="hs-identifier hs-type">varWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Bits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097081"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097081"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097081"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span></span><span>
</span><span id="line-199"></span><span id="varWord"><span class="annot"><span class="annottext">varWord :: forall t. (Bits t, Integral t) =&gt; (Word8 -&gt; Prim) -&gt; t -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#varWord"><span class="hs-identifier hs-var hs-var">varWord</span></a></span></span><span> </span><span id="local-6989586621679096694"><span class="annot"><span class="annottext">Word8 -&gt; Prim
</span><a href="#local-6989586621679096694"><span class="hs-identifier hs-var">writeByte</span></a></span></span><span> </span><span id="local-6989586621679096693"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096693"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679096692"><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096692"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096693"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">128</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Prim
</span><a href="#local-6989586621679096694"><span class="hs-identifier hs-var">writeByte</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096693"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096692"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096693"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">16384</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {t} {b}.
(Monad m, Integral a, Bits t, Bits a, Num t) =&gt;
(t -&gt; b -&gt; m b) -&gt; a -&gt; b -&gt; m b
</span><a href="#local-6989586621679096690"><span class="hs-identifier hs-var">varWord2_</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Prim
</span><a href="#local-6989586621679096694"><span class="hs-identifier hs-var">writeByte</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096693"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096692"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096693"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">2097152</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {t} {b}.
(Monad m, Integral a, Bits t, Bits a, Num t) =&gt;
(t -&gt; b -&gt; m b) -&gt; a -&gt; b -&gt; m b
</span><a href="#local-6989586621679096689"><span class="hs-identifier hs-var">varWord3_</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Prim
</span><a href="#local-6989586621679096694"><span class="hs-identifier hs-var">writeByte</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096693"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096692"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (Bits t, Integral t) =&gt; (Word8 -&gt; Prim) -&gt; t -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#varWordN_"><span class="hs-identifier hs-var">varWordN_</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Prim
</span><a href="#local-6989586621679096694"><span class="hs-identifier hs-var">writeByte</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096693"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096692"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679096690"><span class="hs-pragma hs-type">varWord2_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-comment">-- TODO: optimise, using a single Write16?</span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679096690"><span class="annot"><span class="annottext">varWord2_ :: (t -&gt; b -&gt; m b) -&gt; a -&gt; b -&gt; m b
</span><a href="#local-6989586621679096690"><span class="hs-identifier hs-var hs-var">varWord2_</span></a></span></span><span> </span><span id="local-6989586621679096672"><span class="annot"><span class="annottext">t -&gt; b -&gt; m b
</span><a href="#local-6989586621679096672"><span class="hs-identifier hs-var">writeByte</span></a></span></span><span> </span><span id="local-6989586621679096671"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096671"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679096670"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679096670"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>      </span><span class="annot"><span class="annottext">t -&gt; b -&gt; m b
</span><a href="#local-6989586621679096672"><span class="hs-identifier hs-var">writeByte</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096671"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0x80</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679096670"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><span class="annottext">t -&gt; b -&gt; m b
</span><a href="#local-6989586621679096672"><span class="hs-identifier hs-var">writeByte</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096671"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0x7F</span></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679096689"><span class="hs-pragma hs-type">varWord3_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621679096689"><span class="annot"><span class="annottext">varWord3_ :: (t -&gt; b -&gt; m b) -&gt; a -&gt; b -&gt; m b
</span><a href="#local-6989586621679096689"><span class="hs-identifier hs-var hs-var">varWord3_</span></a></span></span><span> </span><span id="local-6989586621679096647"><span class="annot"><span class="annottext">t -&gt; b -&gt; m b
</span><a href="#local-6989586621679096647"><span class="hs-identifier hs-var">writeByte</span></a></span></span><span> </span><span id="local-6989586621679096646"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096646"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679096645"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679096645"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>      </span><span class="annot"><span class="annottext">t -&gt; b -&gt; m b
</span><a href="#local-6989586621679096647"><span class="hs-identifier hs-var">writeByte</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096646"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0x80</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679096645"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span>
</span><span id="line-213"></span><span>      </span><span class="annot"><span class="annottext">t -&gt; b -&gt; m b
</span><a href="#local-6989586621679096647"><span class="hs-identifier hs-var">writeByte</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096646"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0x80</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span>
</span><span id="line-214"></span><span>      </span><span class="annot"><span class="annottext">t -&gt; b -&gt; m b
</span><a href="#local-6989586621679096647"><span class="hs-identifier hs-var">writeByte</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096646"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">14</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0x7F</span></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- {-# INLINE varWordN #-}</span><span>
</span><span id="line-217"></span><span id="local-6989586621679096644"><span class="annot"><a href="Flat.Encoder.Prim.html#varWordN_"><span class="hs-identifier hs-type">varWordN_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Bits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679096644"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679096644"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679096644"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span></span><span>
</span><span id="line-218"></span><span id="varWordN_"><span class="annot"><span class="annottext">varWordN_ :: forall t. (Bits t, Integral t) =&gt; (Word8 -&gt; Prim) -&gt; t -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#varWordN_"><span class="hs-identifier hs-var hs-var">varWordN_</span></a></span></span><span> </span><span id="local-6989586621679096639"><span class="annot"><span class="annottext">Word8 -&gt; Prim
</span><a href="#local-6989586621679096639"><span class="hs-identifier hs-var">writeByte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (Bits t, Integral t) =&gt; t -&gt; Prim
</span><a href="#local-6989586621679096638"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679096638"><span class="annot"><span class="annottext">go :: t -&gt; Prim
</span><a href="#local-6989586621679096638"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679096627"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096627"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679096626"><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096626"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679096624"><span class="annot"><span class="annottext">l :: Word8
</span><a href="#local-6989586621679096624"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Word8
</span><a href="Flat.Encoder.Prim.html#low7"><span class="hs-identifier hs-var">low7</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096627"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-222"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679096622"><span class="annot"><span class="annottext">v' :: t
</span><a href="#local-6989586621679096622"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096627"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-223"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096622"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span>
</span><span id="line-224"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Prim
</span><a href="#local-6989586621679096639"><span class="hs-identifier hs-var">writeByte</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096624"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096626"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-225"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Prim
</span><a href="#local-6989586621679096639"><span class="hs-identifier hs-var">writeByte</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096624"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x80</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096626"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; Prim
</span><a href="#local-6989586621679096638"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096622"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#low7"><span class="hs-pragma hs-type">low7</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-228"></span><span id="local-6989586621679097114"><span class="annot"><a href="Flat.Encoder.Prim.html#low7"><span class="hs-identifier hs-type">low7</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097114"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097114"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span></span><span>
</span><span id="line-229"></span><span id="low7"><span class="annot"><span class="annottext">low7 :: forall a. Integral a =&gt; a -&gt; Word8
</span><a href="Flat.Encoder.Prim.html#low7"><span class="hs-identifier hs-var hs-var">low7</span></a></span></span><span> </span><span id="local-6989586621679096616"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096616"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096616"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x7F</span></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Encode text as UTF8 and encode the result as an array of bytes</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- PROB: encodeUtf8 calls a C primitive, not compatible with GHCJS (fixed in latest versions of GHCJS?)</span><span>
</span><span id="line-233"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eUTF8F"><span class="hs-identifier hs-type">eUTF8F</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">T.Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-234"></span><span id="eUTF8F"><span class="annot"><span class="annottext">eUTF8F :: Text -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eUTF8F"><span class="hs-identifier hs-var hs-var">eUTF8F</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eBytesF"><span class="hs-identifier hs-var">eBytesF</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">TE.encodeUtf8</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- PROB: Not compatible with GHCJS or ETA (that is big endian and writes contents in reverse order)</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | Encode text as UTF16 and encode the result as an array of bytes</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- Efficient, as Text is already internally encoded as UTF16.</span><span class="hs-cpp">
#if ! defined(ghcjs_HOST_OS) &amp;&amp; ! defined (ETA_VERSION)
</span><span class="annot"><a href="Flat.Encoder.Prim.html#eUTF16F"><span class="hs-identifier hs-type">eUTF16F</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">T.Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-241"></span><span id="eUTF16F"><span class="annot"><span class="annottext">eUTF16F :: Text -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eUTF16F"><span class="hs-identifier hs-var hs-var">eUTF16F</span></a></span></span><span> </span><span id="local-6989586621679096614"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679096614"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eFillerF"><span class="hs-identifier hs-var">eFillerF</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Prim
</span><a href="#local-6989586621679096612"><span class="hs-identifier hs-var">eUTF16F_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679096614"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621679096612"><span class="annot"><span class="annottext">eUTF16F_ :: Text -&gt; Prim
</span><a href="#local-6989586621679096612"><span class="hs-identifier hs-var hs-var">eUTF16F_</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">TI.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">TA.Array</span></a></span><span> </span><span id="local-6989586621679096605"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679096605"><span class="hs-identifier hs-var">array</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679096604"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096604"><span class="hs-identifier hs-var">w16Off</span></a></span></span><span> </span><span id="local-6989586621679096603"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096603"><span class="hs-identifier hs-var">w16Len</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679096602"><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096602"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-244"></span><span>      </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int -&gt; Int -&gt; Ptr Word8 -&gt; IO S
</span><a href="Flat.Encoder.Prim.html#writeArray"><span class="hs-identifier hs-var">writeArray</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679096605"><span class="hs-identifier hs-var">array</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096604"><span class="hs-identifier hs-var">w16Off</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096603"><span class="hs-identifier hs-var">w16Len</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">S -&gt; Ptr Word8
</span><a href="Flat.Encoder.Types.html#nextPtr"><span class="hs-identifier hs-var">nextPtr</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096602"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- |Encode a Lazy ByteString</span><span>
</span><span id="line-248"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eLazyBytesF"><span class="hs-identifier hs-type">eLazyBytesF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">L.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-249"></span><span id="eLazyBytesF"><span class="annot"><span class="annottext">eLazyBytesF :: ByteString -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eLazyBytesF"><span class="hs-identifier hs-var hs-var">eLazyBytesF</span></a></span></span><span> </span><span id="local-6989586621679096598"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096598"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eFillerF"><span class="hs-identifier hs-var">eFillerF</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679096597"><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096597"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Ptr Word8 -&gt; IO S
</span><a href="#local-6989586621679096596"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096598"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">S -&gt; Ptr Word8
</span><a href="Flat.Encoder.Types.html#nextPtr"><span class="hs-identifier hs-var">nextPtr</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096597"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-comment">-- Single copy</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621679096596"><span class="annot"><span class="annottext">write :: ByteString -&gt; Ptr Word8 -&gt; IO S
</span><a href="#local-6989586621679096596"><span class="hs-identifier hs-var hs-var">write</span></a></span></span><span> </span><span id="local-6989586621679096592"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096592"><span class="hs-identifier hs-var">lbs</span></a></span></span><span> </span><span id="local-6989586621679096591"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096591"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-253"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096592"><span class="hs-identifier hs-var">lbs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">L.Chunk</span></a></span><span> </span><span id="local-6989586621679096589"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096589"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679096588"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096588"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Ptr Word8 -&gt; IO (Ptr Word8)
</span><a href="Flat.Encoder.Prim.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096589"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096591"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Ptr Word8 -&gt; IO S
</span><a href="#local-6989586621679096596"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096588"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-255"></span><span>        </span><span class="annot"><span class="annottext">ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">L.Empty</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO S
</span><a href="Flat.Encoder.Prim.html#pokeWord"><span class="hs-identifier hs-var">pokeWord</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096591"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eShortBytesF"><span class="hs-pragma hs-type">eShortBytesF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-258"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eShortBytesF"><span class="hs-identifier hs-type">eShortBytesF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">SBS.ShortByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-259"></span><span id="eShortBytesF"><span class="annot"><span class="annottext">eShortBytesF :: ShortByteString -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eShortBytesF"><span class="hs-identifier hs-var hs-var">eShortBytesF</span></a></span></span><span> </span><span id="local-6989586621679096585"><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679096585"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eFillerF"><span class="hs-identifier hs-var">eFillerF</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eShortBytesF_"><span class="hs-identifier hs-var">eShortBytesF_</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679096585"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eShortBytesF_"><span class="hs-identifier hs-type">eShortBytesF_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">SBS.ShortByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-262"></span><span id="eShortBytesF_"><span class="annot"><span class="annottext">eShortBytesF_ :: ShortByteString -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eShortBytesF_"><span class="hs-identifier hs-var hs-var">eShortBytesF_</span></a></span></span><span> </span><span id="local-6989586621679096583"><span class="annot"><span class="annottext">bs :: ShortByteString
</span><a href="#local-6989586621679096583"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">SBS.SBS</span></a></span><span> </span><span id="local-6989586621679096581"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679096581"><span class="hs-identifier hs-var">arr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679096580"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096580"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int -&gt; Int -&gt; Ptr Word8 -&gt; IO S
</span><a href="Flat.Encoder.Prim.html#writeArray"><span class="hs-identifier hs-var">writeArray</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679096581"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShortByteString -&gt; Int
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">SBS.length</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679096583"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096580"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- data Array a = Array0 | Array1 a ... | Array255 ...</span><span>
</span><span id="line-266"></span><span class="annot"><a href="Flat.Encoder.Prim.html#writeArray"><span class="hs-identifier hs-type">writeArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span><span>
</span><span id="line-267"></span><span id="writeArray"><span class="annot"><span class="annottext">writeArray :: ByteArray# -&gt; Int -&gt; Int -&gt; Ptr Word8 -&gt; IO S
</span><a href="Flat.Encoder.Prim.html#writeArray"><span class="hs-identifier hs-var hs-var">writeArray</span></a></span></span><span> </span><span id="local-6989586621679096578"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679096578"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679096577"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096577"><span class="hs-identifier hs-var">soff</span></a></span></span><span> </span><span id="local-6989586621679096576"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096576"><span class="hs-identifier hs-var">slen</span></a></span></span><span> </span><span id="local-6989586621679096575"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096575"><span class="hs-identifier hs-var">sop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679096574"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096574"><span class="hs-identifier hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ptr Word8 -&gt; IO (Ptr Word8)
</span><a href="#local-6989586621679096573"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096577"><span class="hs-identifier hs-var">soff</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096576"><span class="hs-identifier hs-var">slen</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096575"><span class="hs-identifier hs-var">sop</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO S
</span><a href="Flat.Encoder.Prim.html#pokeWord"><span class="hs-identifier hs-var">pokeWord</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096574"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621679096573"><span class="annot"><span class="annottext">go :: Int -&gt; Int -&gt; Ptr Word8 -&gt; IO (Ptr Word8)
</span><a href="#local-6989586621679096573"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679096562"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096562"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679096561"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096561"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679096560"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096560"><span class="hs-identifier hs-var">op</span></a></span></span><span>
</span><span id="line-272"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096561"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096560"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-273"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-274"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679096557"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679096557"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">255</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096561"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-275"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a b. Storable a =&gt; Ptr a -&gt; a -&gt; IO (Ptr b)
</span><a href="Flat.Encoder.Prim.html#pokeWord%27"><span class="hs-identifier hs-var">pokeWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096560"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096557"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int -&gt; Int -&gt; Ptr Word8 -&gt; IO (Ptr Word8)
</span><a href="Flat.Memory.html#pokeByteArray"><span class="hs-identifier hs-var">pokeByteArray</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679096578"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096562"><span class="hs-identifier hs-var">off</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096557"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span>
</span><span id="line-276"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ptr Word8 -&gt; IO (Ptr Word8)
</span><a href="#local-6989586621679096573"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096562"><span class="hs-identifier hs-var">off</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096557"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096561"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096557"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eBytesF"><span class="hs-identifier hs-type">eBytesF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">B.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-279"></span><span id="eBytesF"><span class="annot"><span class="annottext">eBytesF :: ByteString -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eBytesF"><span class="hs-identifier hs-var hs-var">eBytesF</span></a></span></span><span> </span><span id="local-6989586621679096553"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096553"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eFillerF"><span class="hs-identifier hs-var">eFillerF</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="#local-6989586621679096552"><span class="hs-identifier hs-var">eBytesF_</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679096552"><span class="annot"><span class="annottext">eBytesF_ :: Prim
</span><a href="#local-6989586621679096552"><span class="hs-identifier hs-var hs-var">eBytesF_</span></a></span></span><span> </span><span id="local-6989586621679096548"><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096548"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-282"></span><span>      </span><span id="local-6989586621679096547"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096547"><span class="hs-identifier hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Ptr Word8 -&gt; IO (Ptr Word8)
</span><a href="Flat.Encoder.Prim.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096553"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">S -&gt; Ptr Word8
</span><a href="Flat.Encoder.Types.html#nextPtr"><span class="hs-identifier hs-var">nextPtr</span></a></span><span> </span><span class="annot"><span class="annottext">S
</span><a href="#local-6989586621679096548"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO S
</span><a href="Flat.Encoder.Prim.html#pokeWord"><span class="hs-identifier hs-var">pokeWord</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096547"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- |Encode up to 9 bits</span><span>
</span><span id="line-286"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eBits16F"><span class="hs-pragma hs-type">eBits16F</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-287"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eBits16F"><span class="hs-identifier hs-type">eBits16F</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Flat.Types.html#NumBits"><span class="hs-identifier hs-type">NumBits</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-288"></span><span class="hs-comment">--eBits16F numBits code | numBits &gt;8 = eBitsF (numBits-8) (fromIntegral $ code `unsafeShiftR` 8) &gt;=&gt; eBitsF 8 (fromIntegral code)</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- eBits16F _ _ = eFalseF</span><span>
</span><span id="line-290"></span><span id="eBits16F"><span class="annot"><span class="annottext">eBits16F :: Int -&gt; Word16 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eBits16F"><span class="hs-identifier hs-var hs-var">eBits16F</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span id="local-6989586621679096545"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679096545"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eBitsF"><span class="hs-identifier hs-var">eBitsF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679096545"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eBitsF_"><span class="hs-identifier hs-var">eBitsF_</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679096545"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eBits16F"><span class="hs-identifier hs-var">eBits16F</span></a></span><span> </span><span id="local-6989586621679096543"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096543"><span class="hs-identifier hs-var">numBits</span></a></span></span><span> </span><span id="local-6989586621679096542"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679096542"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eBitsF"><span class="hs-identifier hs-var">eBitsF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096543"><span class="hs-identifier hs-var">numBits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679096542"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- |Encode up to 8 bits.</span><span>
</span><span id="line-296"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eBitsF"><span class="hs-pragma hs-type">eBitsF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-297"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eBitsF"><span class="hs-identifier hs-type">eBitsF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Flat.Types.html#NumBits"><span class="hs-identifier hs-type">NumBits</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-298"></span><span id="eBitsF"><span class="annot"><span class="annottext">eBitsF :: Int -&gt; Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eBitsF"><span class="hs-identifier hs-var hs-var">eBitsF</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eFalseF"><span class="hs-identifier hs-var">eFalseF</span></a></span><span>
</span><span id="line-299"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eBitsF"><span class="hs-identifier hs-var">eBitsF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eTrueF"><span class="hs-identifier hs-var">eTrueF</span></a></span><span>
</span><span id="line-300"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eBitsF"><span class="hs-identifier hs-var">eBitsF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eFalseF"><span class="hs-identifier hs-var">eFalseF</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eFalseF"><span class="hs-identifier hs-var">eFalseF</span></a></span><span>
</span><span id="line-301"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eBitsF"><span class="hs-identifier hs-var">eBitsF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eFalseF"><span class="hs-identifier hs-var">eFalseF</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eTrueF"><span class="hs-identifier hs-var">eTrueF</span></a></span><span>
</span><span id="line-302"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eBitsF"><span class="hs-identifier hs-var">eBitsF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eTrueF"><span class="hs-identifier hs-var">eTrueF</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eFalseF"><span class="hs-identifier hs-var">eFalseF</span></a></span><span>
</span><span id="line-303"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eBitsF"><span class="hs-identifier hs-var">eBitsF</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eTrueF"><span class="hs-identifier hs-var">eTrueF</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eTrueF"><span class="hs-identifier hs-var">eTrueF</span></a></span><span>
</span><span id="line-304"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eBitsF"><span class="hs-identifier hs-var">eBitsF</span></a></span><span> </span><span id="local-6989586621679096541"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096541"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679096540"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096540"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eBitsF_"><span class="hs-identifier hs-var">eBitsF_</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096541"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096540"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-comment">{-
eBits Example:
Before:
n = 6
t = 00.101011
o = 3
w = 111.00000

After:
[ptr] = w(111)t(10101)
w' = t(1)0000000
o'= 1

o'=3+6=9
f = 8-9 = -1
o'' = 1
8-o''=7

if n=8,o=3:
o'=11
f=8-11=-3
o''=3
8-o''=5
-}</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- {-# NOINLINE eBitsF_ #-}</span><span>
</span><span id="line-331"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eBitsF_"><span class="hs-identifier hs-type">eBitsF_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Flat.Types.html#NumBits"><span class="hs-identifier hs-type">NumBits</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-332"></span><span id="eBitsF_"><span class="annot"><span class="annottext">eBitsF_ :: Int -&gt; Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eBitsF_"><span class="hs-identifier hs-var hs-var">eBitsF_</span></a></span></span><span> </span><span id="local-6989586621679096539"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096539"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679096538"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096538"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679096537"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096537"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679096536"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096536"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679096535"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096535"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679096533"><span class="annot"><span class="annottext">o' :: Int
</span><a href="#local-6989586621679096533"><span class="hs-identifier hs-var hs-var">o'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096535"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096539"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-comment">-- used bits</span><span>
</span><span id="line-335"></span><span>        </span><span id="local-6989586621679096530"><span class="annot"><span class="annottext">f :: Int
</span><a href="#local-6989586621679096530"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096533"><span class="hs-identifier hs-var">o'</span></a></span><span> </span><span class="hs-comment">-- remaining free bits</span><span>
</span><span id="line-336"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096530"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; Int -&gt; S
</span><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096537"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096536"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096538"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096530"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096533"><span class="hs-identifier hs-var">o'</span></a></span><span>
</span><span id="line-337"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096530"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO S
</span><a href="Flat.Encoder.Prim.html#pokeWord"><span class="hs-identifier hs-var">pokeWord</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096537"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096536"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096538"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-339"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679096527"><span class="annot"><span class="annottext">o'' :: Int
</span><a href="#local-6989586621679096527"><span class="hs-identifier hs-var hs-var">o''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096530"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-340"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096537"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096536"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096538"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096527"><span class="hs-identifier hs-var">o''</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span>
</span><span id="line-341"></span><span>                 </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; Int -&gt; S
</span><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">plusPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096537"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096538"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftL`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096527"><span class="hs-identifier hs-var">o''</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096527"><span class="hs-identifier hs-var">o''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eBoolF"><span class="hs-pragma hs-type">eBoolF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-344"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eBoolF"><span class="hs-identifier hs-type">eBoolF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-345"></span><span id="eBoolF"><span class="annot"><span class="annottext">eBoolF :: Bool -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#eBoolF"><span class="hs-identifier hs-var hs-var">eBoolF</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eFalseF"><span class="hs-identifier hs-var">eFalseF</span></a></span><span>
</span><span id="line-346"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eBoolF"><span class="hs-identifier hs-var">eBoolF</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Flat.Encoder.Prim.html#eTrueF"><span class="hs-identifier hs-var">eTrueF</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eTrueF"><span class="hs-pragma hs-type">eTrueF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-349"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eTrueF"><span class="hs-identifier hs-type">eTrueF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-350"></span><span id="eTrueF"><span class="annot"><span class="annottext">eTrueF :: Prim
</span><a href="Flat.Encoder.Prim.html#eTrueF"><span class="hs-identifier hs-var hs-var">eTrueF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679096525"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096525"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679096524"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096524"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679096523"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096523"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096523"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO S
</span><a href="Flat.Encoder.Prim.html#pokeWord"><span class="hs-identifier hs-var">pokeWord</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096525"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096524"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; Int -&gt; S
</span><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096525"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096524"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">128</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096523"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096523"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eFalseF"><span class="hs-pragma hs-type">eFalseF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-355"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eFalseF"><span class="hs-identifier hs-type">eFalseF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-356"></span><span id="eFalseF"><span class="annot"><span class="annottext">eFalseF :: Prim
</span><a href="Flat.Encoder.Prim.html#eFalseF"><span class="hs-identifier hs-var hs-var">eFalseF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679096522"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096522"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679096521"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096521"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679096520"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096520"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096520"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO S
</span><a href="Flat.Encoder.Prim.html#pokeWord"><span class="hs-identifier hs-var">pokeWord</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096522"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096521"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; Int -&gt; S
</span><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096522"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096521"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096520"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#eFillerF"><span class="hs-pragma hs-type">eFillerF</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-361"></span><span class="annot"><a href="Flat.Encoder.Prim.html#eFillerF"><span class="hs-identifier hs-type">eFillerF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-362"></span><span id="eFillerF"><span class="annot"><span class="annottext">eFillerF :: Prim
</span><a href="Flat.Encoder.Prim.html#eFillerF"><span class="hs-identifier hs-var hs-var">eFillerF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679096519"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096519"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679096518"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096518"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO S
</span><a href="Flat.Encoder.Prim.html#pokeWord"><span class="hs-identifier hs-var">pokeWord</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096519"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096518"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- {-# INLINE poke16 #-}</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- TODO TEST</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- poke16 :: Word16 -&gt; Prim</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- poke16 t (S op w o) | o == 0 = poke op w &gt;&gt; skipBytes op 2</span><span>
</span><span id="line-368"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#pokeByteUnaligned"><span class="hs-pragma hs-type">pokeByteUnaligned</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-369"></span><span class="annot"><a href="Flat.Encoder.Prim.html#pokeByteUnaligned"><span class="hs-identifier hs-type">pokeByteUnaligned</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-370"></span><span id="pokeByteUnaligned"><span class="annot"><span class="annottext">pokeByteUnaligned :: Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#pokeByteUnaligned"><span class="hs-identifier hs-var hs-var">pokeByteUnaligned</span></a></span></span><span> </span><span id="local-6989586621679096517"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096517"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679096516"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096516"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679096515"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096515"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679096514"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096514"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-371"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096516"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096515"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096517"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096514"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; Int -&gt; S
</span><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">plusPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096516"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096517"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`unsafeShiftL`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096514"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096514"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#pokeByteAligned"><span class="hs-pragma hs-type">pokeByteAligned</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-375"></span><span class="annot"><a href="Flat.Encoder.Prim.html#pokeByteAligned"><span class="hs-identifier hs-type">pokeByteAligned</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>
</span><span id="line-376"></span><span id="pokeByteAligned"><span class="annot"><span class="annottext">pokeByteAligned :: Word8 -&gt; Prim
</span><a href="Flat.Encoder.Prim.html#pokeByteAligned"><span class="hs-identifier hs-var hs-var">pokeByteAligned</span></a></span></span><span> </span><span id="local-6989586621679096513"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096513"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679096512"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096512"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO S
</span><a href="Flat.Encoder.Prim.html#pokeWord"><span class="hs-identifier hs-var">pokeWord</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096512"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679096513"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#pokeWord"><span class="hs-pragma hs-type">pokeWord</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-379"></span><span id="local-6989586621679097097"><span class="annot"><a href="Flat.Encoder.Prim.html#pokeWord"><span class="hs-identifier hs-type">pokeWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Storable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097097"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097097"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097097"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span></span><span>
</span><span id="line-380"></span><span id="pokeWord"><span class="annot"><span class="annottext">pokeWord :: forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO S
</span><a href="Flat.Encoder.Prim.html#pokeWord"><span class="hs-identifier hs-var hs-var">pokeWord</span></a></span></span><span> </span><span id="local-6989586621679096507"><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679096507"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679096506"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096506"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679096507"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096506"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; Ptr a -&gt; m S
</span><a href="Flat.Encoder.Prim.html#skipByte"><span class="hs-identifier hs-var">skipByte</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679096507"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#pokeWord%27"><span class="hs-pragma hs-type">pokeWord'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-383"></span><span id="local-6989586621679097105"><span id="local-6989586621679097106"><span class="annot"><a href="Flat.Encoder.Prim.html#pokeWord%27"><span class="hs-identifier hs-type">pokeWord'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Storable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097106"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097106"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097106"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097105"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-384"></span><span id="pokeWord%27"><span class="annot"><span class="annottext">pokeWord' :: forall a b. Storable a =&gt; Ptr a -&gt; a -&gt; IO (Ptr b)
</span><a href="Flat.Encoder.Prim.html#pokeWord%27"><span class="hs-identifier hs-var hs-var">pokeWord'</span></a></span></span><span> </span><span id="local-6989586621679096500"><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679096500"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679096499"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096499"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679096500"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679096499"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">plusPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679096500"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#pokeW"><span class="hs-pragma hs-type">pokeW</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-387"></span><span id="local-6989586621679097094"><span id="local-6989586621679097095"><span id="local-6989586621679097096"><span class="annot"><a href="Flat.Encoder.Prim.html#pokeW"><span class="hs-identifier hs-type">pokeW</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Storable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097096"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097095"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097094"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097095"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-388"></span><span id="pokeW"><span class="annot"><span class="annottext">pokeW :: forall a t a1. Storable a =&gt; (t -&gt; a) -&gt; Ptr a1 -&gt; t -&gt; IO ()
</span><a href="Flat.Encoder.Prim.html#pokeW"><span class="hs-identifier hs-var hs-var">pokeW</span></a></span></span><span> </span><span id="local-6989586621679096496"><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679096496"><span class="hs-identifier hs-var">conv</span></a></span></span><span> </span><span id="local-6989586621679096495"><span class="annot"><span class="annottext">Ptr a1
</span><a href="#local-6989586621679096495"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679096494"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096494"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Ptr a -&gt; Ptr b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">castPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a1
</span><a href="#local-6989586621679096495"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679096496"><span class="hs-identifier hs-var">conv</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096494"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#poke64"><span class="hs-pragma hs-type">poke64</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-391"></span><span id="local-6989586621679097084"><span id="local-6989586621679097085"><span class="annot"><a href="Flat.Encoder.Prim.html#poke64"><span class="hs-identifier hs-type">poke64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097085"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097084"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097085"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-392"></span><span id="poke64"><span class="annot"><span class="annottext">poke64 :: forall t a. (t -&gt; Word64) -&gt; Ptr a -&gt; t -&gt; IO ()
</span><a href="Flat.Encoder.Prim.html#poke64"><span class="hs-identifier hs-var hs-var">poke64</span></a></span></span><span> </span><span id="local-6989586621679096490"><span class="annot"><span class="annottext">t -&gt; Word64
</span><a href="#local-6989586621679096490"><span class="hs-identifier hs-var">conv</span></a></span></span><span> </span><span id="local-6989586621679096489"><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679096489"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679096488"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096488"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Ptr a -&gt; Ptr b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">castPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679096489"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Word64
</span><a href="#local-6989586621679096490"><span class="hs-identifier hs-var">conv</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679096488"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- poke64 conv op t = poke (castPtr op) (fix64 . conv $ t)</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#skipByte"><span class="hs-pragma hs-type">skipByte</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-396"></span><span id="local-6989586621679097052"><span id="local-6989586621679097053"><span class="annot"><a href="Flat.Encoder.Prim.html#skipByte"><span class="hs-identifier hs-type">skipByte</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097053"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097052"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097053"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span></span></span><span>
</span><span id="line-397"></span><span id="skipByte"><span class="annot"><span class="annottext">skipByte :: forall (m :: * -&gt; *) a. Monad m =&gt; Ptr a -&gt; m S
</span><a href="Flat.Encoder.Prim.html#skipByte"><span class="hs-identifier hs-var hs-var">skipByte</span></a></span></span><span> </span><span id="local-6989586621679096484"><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679096484"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; Int -&gt; S
</span><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">plusPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679096484"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#skipBytes"><span class="hs-pragma hs-type">skipBytes</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-400"></span><span id="local-6989586621679097090"><span id="local-6989586621679097091"><span class="annot"><a href="Flat.Encoder.Prim.html#skipBytes"><span class="hs-identifier hs-type">skipBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097091"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097090"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097091"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-type">S</span></a></span></span></span><span>
</span><span id="line-401"></span><span id="skipBytes"><span class="annot"><span class="annottext">skipBytes :: forall (m :: * -&gt; *) a. Monad m =&gt; Ptr a -&gt; Int -&gt; m S
</span><a href="Flat.Encoder.Prim.html#skipBytes"><span class="hs-identifier hs-var hs-var">skipBytes</span></a></span></span><span> </span><span id="local-6989586621679096480"><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679096480"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679096479"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096479"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; Int -&gt; S
</span><a href="Flat.Encoder.Types.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">plusPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679096480"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679096479"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">--{-# INLINE nextByteW #-}</span><span>
</span><span id="line-404"></span><span class="hs-comment">--nextByteW op w = return (S (plusPtr op 1) 0 0)</span><span>
</span><span id="line-405"></span><span class="annot"><a href="Flat.Encoder.Prim.html#writeBS"><span class="hs-identifier hs-type">writeBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">B.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span id="writeBS"><span class="annot"><span class="annottext">writeBS :: ByteString -&gt; Ptr Word8 -&gt; IO (Ptr Word8)
</span><a href="Flat.Encoder.Prim.html#writeBS"><span class="hs-identifier hs-var hs-var">writeBS</span></a></span></span><span> </span><span id="local-6989586621679096478"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096478"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621679096477"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096477"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-comment">-- @(BS.PS foreignPointer sourceOffset sourceLength) op</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096478"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096477"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679096475"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096475"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679096474"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096474"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B.splitAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">255</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096478"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-410"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a b. Storable a =&gt; Ptr a -&gt; a -&gt; IO (Ptr b)
</span><a href="Flat.Encoder.Prim.html#pokeWord%27"><span class="hs-identifier hs-var">pokeWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679096477"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096475"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Ptr Word8 -&gt; IO (Ptr Word8)
</span><a href="Flat.Memory.html#pokeByteString"><span class="hs-identifier hs-var">pokeByteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096475"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span>
</span><span id="line-411"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Ptr Word8 -&gt; IO (Ptr Word8)
</span><a href="Flat.Encoder.Prim.html#writeBS"><span class="hs-identifier hs-var">writeBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679096474"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-comment">-- 2X slower (why?)</span><span>
</span><span id="line-413"></span><span>    </span><span class="hs-comment">-- withForeignPtr foreignPointer goS</span><span>
</span><span id="line-414"></span><span>    </span><span class="hs-comment">--   where</span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-comment">--     goS sourcePointer = go op (sourcePointer `plusPtr` sourceOffset) sourceLength</span><span>
</span><span id="line-416"></span><span>    </span><span class="hs-comment">--       where</span><span>
</span><span id="line-417"></span><span>    </span><span class="hs-comment">--         go !op !off !len | len == 0 = return op</span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-comment">--                          | otherwise = do</span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-comment">--                           let l = min 255 len</span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-comment">--                           op' &lt;- pokeWord' op (fromIntegral l)</span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-comment">--                           BS.memcpy op' off l</span><span>
</span><span id="line-422"></span><span>    </span><span class="hs-comment">--                           go (op' `plusPtr` l) (off `plusPtr` l) (len-l)</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#asWord64"><span class="hs-pragma hs-type">asWord64</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-425"></span><span id="local-6989586621679097083"><span class="annot"><a href="Flat.Encoder.Prim.html#asWord64"><span class="hs-identifier hs-type">asWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097083"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097083"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span></span><span>
</span><span id="line-426"></span><span id="asWord64"><span class="annot"><span class="annottext">asWord64 :: forall a. Integral a =&gt; a -&gt; Word64
</span><a href="Flat.Encoder.Prim.html#asWord64"><span class="hs-identifier hs-var hs-var">asWord64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#asWord32"><span class="hs-pragma hs-type">asWord32</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-429"></span><span id="local-6989586621679097089"><span class="annot"><a href="Flat.Encoder.Prim.html#asWord32"><span class="hs-identifier hs-type">asWord32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097089"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097089"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span></span><span>
</span><span id="line-430"></span><span id="asWord32"><span class="annot"><span class="annottext">asWord32 :: forall a. Integral a =&gt; a -&gt; Word32
</span><a href="Flat.Encoder.Prim.html#asWord32"><span class="hs-identifier hs-var hs-var">asWord32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Flat.Encoder.Prim.html#asWord8"><span class="hs-pragma hs-type">asWord8</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-433"></span><span id="local-6989586621679096465"><span class="annot"><a href="Flat.Encoder.Prim.html#asWord8"><span class="hs-identifier hs-type">asWord8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679096465"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679096465"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span></span><span>
</span><span id="line-434"></span><span id="asWord8"><span class="annot"><span class="annottext">asWord8 :: forall a. Integral a =&gt; a -&gt; Word8
</span><a href="Flat.Encoder.Prim.html#asWord8"><span class="hs-identifier hs-var hs-var">asWord8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span></pre></body></html>