<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds        #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs                  #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase             #-}</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver</span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Breakpointable"><span class="hs-identifier">Breakpointable</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#CekState"><span class="hs-identifier">CekState</span></a></span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Cmd"><span class="hs-identifier">Cmd</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#runDriver"><span class="hs-identifier">runDriver</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#DebugF"><span class="hs-identifier">DebugF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Reexport some functions for convenience</span></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#handleStep"><span class="hs-identifier">handleStep</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#tryHandleStep"><span class="hs-identifier">tryHandleStep</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier">F.MonadFree</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier">F.iterM</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier">F.iterTM</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier">F.partialIterT</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier">F.cutoff</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier">FreeT</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html"><span class="hs-identifier">UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../lens/html/src"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../lens/html/src"><span class="hs-identifier">Context</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier">Control.Monad.Reader</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier">Control.Monad.Trans.Free</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Function</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">{- Note [Stepping the driver]

The client instructs the driver to do a single step of the Cek (`Step` Cmd) or multiple steps until
a condition is met (`Continue`,`Next`,`Finish`). The driver upon receiving a Command (via `inputF`)
fires a series of `stepF` actions to fulfill the command. A `stepF` action is supposed to move the
underlying CEK machine a *single* step forward. Since the driver is written as a free monad, the
interpretation of the `stepF` action is left open.

When the driver calls `stepF state`, it yields its coroutine with the current driver/cek state
(before the stepping interpretation). The interpreter of `stepF` receives the currentState and
calculates a newstate from it (e.g. **actually stepping the cek machine**). The interpreter then
resumes the driver coroutine with the new state.

The sensible interpretation to this is the CEK's state transition function (`handleStep oldState
===&gt; newState`), but other exotic options may be: logging the before/after states, or even
&quot;mutating&quot; the running program's variables in the environment before/after the state transition
(similar to C debuggers). The interpreter can even supply a different state transition function
(e.g. `id`), but we see little benefit in it at the moment. Currently all interpreters
(brick,repl,testing) just call`handleStep`.
-}</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- | Leave abstract the types of annotation and breakpoints.</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- The only thing the driver requires is an inclusion relation of breakpoints into the Annotation</span><span>
</span><span id="line-53"></span><span class="hs-keyword">class</span><span> </span><span id="Breakpointable"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Breakpointable"><span class="hs-identifier hs-var">Breakpointable</span></a></span></span><span> </span><span id="local-6989586621680899913"><span class="annot"><a href="#local-6989586621680899913"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span id="local-6989586621680899912"><span class="annot"><a href="#local-6989586621680899912"><span class="hs-identifier hs-type">bps</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621680899913"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899912"><span class="hs-identifier hs-type">bps</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-comment">-- MAYBE: we cannot know which breakpoint fired, return instead `Maybe Breakpoint`?</span><span>
</span><span id="line-55"></span><span>    </span><span id="hasBreakpoints"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#hasBreakpoints"><span class="hs-identifier hs-type">hasBreakpoints</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680899913"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899912"><span class="hs-identifier hs-type">bps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- | The commands that the driver may receive from the client (tui,cli,test,etc)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">data</span><span> </span><span id="Cmd"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Cmd"><span class="hs-identifier hs-var">Cmd</span></a></span></span><span> </span><span id="local-6989586621680900002"><span class="annot"><a href="#local-6989586621680900002"><span class="hs-identifier hs-type">bps</span></a></span></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Step"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Step"><span class="hs-identifier hs-var">Step</span></a></span></span><span> </span><span class="hs-comment">-- ^ Instruct the driver to a *SINGLE* step.</span><span>
</span><span id="line-60"></span><span>         </span><span class="hs-comment">-- Note: No need to pass breakpoints here because the stepping granularity is *minimal*.</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Continue"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Continue"><span class="hs-identifier hs-var">Continue</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621680900002"><span class="hs-identifier hs-type">bps</span></a></span><span> </span><span class="hs-comment">-- ^ Instruct to multi-step until end-of-program or until breakpoint reached</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Next"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Next"><span class="hs-identifier hs-var">Next</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621680900002"><span class="hs-identifier hs-type">bps</span></a></span><span> </span><span class="hs-comment">-- ^ Instruct to multi-step over the function call at point or until breakpoint reached</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Finish"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Finish"><span class="hs-identifier hs-var">Finish</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621680900002"><span class="hs-identifier hs-type">bps</span></a></span><span> </span><span class="hs-comment">-- ^ Instruct to multi-step to end of current function or until breakpoint reached</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680899777"><span id="local-6989586621680899779"><span id="local-6989586621680899788"><span class="annot"><span class="annottext">Int -&gt; Cmd bps -&gt; ShowS
forall bps. Show bps =&gt; Int -&gt; Cmd bps -&gt; ShowS
forall bps. Show bps =&gt; [Cmd bps] -&gt; ShowS
forall bps. Show bps =&gt; Cmd bps -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Cmd bps] -&gt; ShowS
$cshowList :: forall bps. Show bps =&gt; [Cmd bps] -&gt; ShowS
show :: Cmd bps -&gt; String
$cshow :: forall bps. Show bps =&gt; Cmd bps -&gt; String
showsPrec :: Int -&gt; Cmd bps -&gt; ShowS
$cshowsPrec :: forall bps. Show bps =&gt; Int -&gt; Cmd bps -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680899752"><span id="local-6989586621680899769"><span id="local-6989586621680899772"><span id="local-6989586621680899774"><span class="annot"><span class="annottext">ReadPrec [Cmd bps]
ReadPrec (Cmd bps)
ReadS [Cmd bps]
forall bps. Read bps =&gt; ReadPrec [Cmd bps]
forall bps. Read bps =&gt; ReadPrec (Cmd bps)
forall bps. Read bps =&gt; Int -&gt; ReadS (Cmd bps)
forall bps. Read bps =&gt; ReadS [Cmd bps]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Cmd bps]
$creadListPrec :: forall bps. Read bps =&gt; ReadPrec [Cmd bps]
readPrec :: ReadPrec (Cmd bps)
$creadPrec :: forall bps. Read bps =&gt; ReadPrec (Cmd bps)
readList :: ReadS [Cmd bps]
$creadList :: forall bps. Read bps =&gt; ReadS [Cmd bps]
readsPrec :: Int -&gt; ReadS (Cmd bps)
$creadsPrec :: forall bps. Read bps =&gt; Int -&gt; ReadS (Cmd bps)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | The drivers's suspension functor</span><span>
</span><span id="line-67"></span><span class="hs-keyword">data</span><span> </span><span id="DebugF"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#DebugF"><span class="hs-identifier hs-var">DebugF</span></a></span></span><span> </span><span id="local-6989586621680899988"><span class="annot"><a href="#local-6989586621680899988"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621680899987"><span class="annot"><a href="#local-6989586621680899987"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span id="local-6989586621680899986"><span class="annot"><a href="#local-6989586621680899986"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span id="local-6989586621680899985"><span class="annot"><a href="#local-6989586621680899985"><span class="hs-identifier hs-type">bps</span></a></span></span><span> </span><span id="local-6989586621680899828"><span class="annot"><a href="#local-6989586621680899828"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-68"></span><span>   </span><span class="hs-comment">-- | Await for the client (e.g. TUI) to tell what to do next (Cmd).</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="InputF"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#InputF"><span class="hs-identifier hs-var">InputF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899985"><span class="hs-identifier hs-type">bps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899828"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-comment">-- | A generator of logging messages of the driver</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LogF"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#LogF"><span class="hs-identifier hs-var">LogF</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899828"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-comment">-- | An enumeratee of Driver State (generator+iteratee):</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-comment">-- Yield a state before doing a step, then await for a state to resume after the step.</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-comment">-- See Note [Stepping the driver].</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="StepF"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#StepF"><span class="hs-identifier hs-var">StepF</span></a></span></span><span>
</span><span id="line-76"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#CekState"><span class="hs-identifier hs-type">CekState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899988"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899987"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899986"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ yield with the current driver's state before running a step</span><span>
</span><span id="line-77"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#CekState"><span class="hs-identifier hs-type">CekState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899988"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899987"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899986"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899828"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ resume back with a state after the step interpretation</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-comment">-- | A generator of CekState to yield to client (e.g. TUI)</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UpdateClientF"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#UpdateClientF"><span class="hs-identifier hs-var">UpdateClientF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#CekState"><span class="hs-identifier hs-type">CekState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899988"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899987"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899986"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680899828"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span id="local-6989586621680899742"><span id="local-6989586621680899744"><span class="annot"><span class="annottext">forall a b.
a -&gt; DebugF uni fun ann bps b -&gt; DebugF uni fun ann bps a
forall a b.
(a -&gt; b) -&gt; DebugF uni fun ann bps a -&gt; DebugF uni fun ann bps b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (uni :: * -&gt; *) fun ann bps a b.
a -&gt; DebugF uni fun ann bps b -&gt; DebugF uni fun ann bps a
forall (uni :: * -&gt; *) fun ann bps a b.
(a -&gt; b) -&gt; DebugF uni fun ann bps a -&gt; DebugF uni fun ann bps b
&lt;$ :: forall a b.
a -&gt; DebugF uni fun ann bps b -&gt; DebugF uni fun ann bps a
$c&lt;$ :: forall (uni :: * -&gt; *) fun ann bps a b.
a -&gt; DebugF uni fun ann bps b -&gt; DebugF uni fun ann bps a
fmap :: forall a b.
(a -&gt; b) -&gt; DebugF uni fun ann bps a -&gt; DebugF uni fun ann bps b
$cfmap :: forall (uni :: * -&gt; *) fun ann bps a b.
(a -&gt; b) -&gt; DebugF uni fun ann bps a -&gt; DebugF uni fun ann bps b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | The monad that the driver operates in</span><span>
</span><span id="line-83"></span><span class="hs-keyword">type</span><span> </span><span id="Driving"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Driving"><span class="hs-identifier hs-var">Driving</span></a></span></span><span> </span><span id="local-6989586621680899739"><span class="annot"><a href="#local-6989586621680899739"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680899738"><span class="annot"><a href="#local-6989586621680899738"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621680899737"><span class="annot"><a href="#local-6989586621680899737"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span id="local-6989586621680899736"><span class="annot"><a href="#local-6989586621680899736"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span id="local-6989586621680899735"><span class="annot"><a href="#local-6989586621680899735"><span class="hs-identifier hs-type">bps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#CekState"><span class="hs-identifier hs-type">CekState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899738"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899737"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899736"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680899739"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-comment">-- ^ the state of the debugger</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier hs-type">MonadFree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#DebugF"><span class="hs-identifier hs-type">DebugF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899738"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899737"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899736"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899735"><span class="hs-identifier hs-type">bps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680899739"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-comment">-- ^ the effects of the driver</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Breakpointable"><span class="hs-identifier hs-type">Breakpointable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899736"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899735"><span class="hs-identifier hs-type">bps</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Entrypoint of the driver</span><span>
</span><span id="line-90"></span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#runDriver"><span class="hs-identifier hs-type">runDriver</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680899981"><span class="annot"><a href="#local-6989586621680899981"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621680899980"><span class="annot"><a href="#local-6989586621680899980"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span id="local-6989586621680899984"><span class="annot"><a href="#local-6989586621680899984"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span id="local-6989586621680899983"><span class="annot"><a href="#local-6989586621680899983"><span class="hs-identifier hs-type">bps</span></a></span></span><span> </span><span id="local-6989586621680899979"><span class="annot"><a href="#local-6989586621680899979"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-91"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Breakpointable"><span class="hs-identifier hs-type">Breakpointable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899984"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899983"><span class="hs-identifier hs-type">bps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier hs-type">MonadFree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#DebugF"><span class="hs-identifier hs-type">DebugF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899981"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899980"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899984"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899983"><span class="hs-identifier hs-type">bps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680899979"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#NTerm"><span class="hs-identifier hs-type">NTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899981"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899980"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899984"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899979"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span id="runDriver"><span class="annot"><span class="annottext">runDriver :: forall (uni :: * -&gt; *) fun ann bps (m :: * -&gt; *).
(Breakpointable ann bps, MonadFree (DebugF uni fun ann bps) m) =&gt;
NTerm uni fun ann -&gt; m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#runDriver"><span class="hs-identifier hs-var hs-var">runDriver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bps.
Driving m uni fun ann bps =&gt;
m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#driver"><span class="hs-identifier hs-var">driver</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NTerm uni fun ann -&gt; CekState uni fun ann
</span><a href="#local-6989586621680899713"><span class="hs-identifier hs-var">initState</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>      </span><span class="annot"><a href="#local-6989586621680899713"><span class="hs-identifier hs-type">initState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#NTerm"><span class="hs-identifier hs-type">NTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899981"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899980"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899984"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#CekState"><span class="hs-identifier hs-type">CekState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899981"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899980"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899984"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-96"></span><span>      </span><span id="local-6989586621680899713"><span class="annot"><span class="annottext">initState :: NTerm uni fun ann -&gt; CekState uni fun ann
</span><a href="#local-6989586621680899713"><span class="hs-identifier hs-var hs-var">initState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann.
NTerm uni fun ann -&gt; CekState uni fun ann
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#Starting"><span class="hs-identifier hs-var">Starting</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | The driver action. The driver repeatedly:</span><span>
</span><span id="line-99"></span><span class="hs-comment">---</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- 1) waits for a `Cmd`</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- 2) runs one or more CEK steps</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- 3) informs the client for CEK updates&amp;logs</span><span>
</span><span id="line-103"></span><span class="hs-comment">---</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- The driver computation exits when it reaches a CEK `Terminating` state.</span><span>
</span><span id="line-105"></span><span id="local-6989586621680899946"><span id="local-6989586621680899947"><span id="local-6989586621680899948"><span id="local-6989586621680899949"><span id="local-6989586621680899950"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#driver"><span class="hs-identifier hs-type">driver</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Driving"><span class="hs-identifier hs-type">Driving</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899950"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899949"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899948"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899947"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899946"><span class="hs-identifier hs-type">bps</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899950"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-106"></span><span id="driver"><span class="annot"><span class="annottext">driver :: forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bps.
Driving m uni fun ann bps =&gt;
m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#driver"><span class="hs-identifier hs-var hs-var">driver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bps.
Driving m uni fun ann bps =&gt;
m (Cmd bps)
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#inputF"><span class="hs-identifier hs-var">inputF</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-comment">-- Condition immediately satisfied</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">Cmd bps
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Step"><span class="hs-identifier hs-var">Step</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bp.
Driving m uni fun ann bp =&gt;
(CekState uni fun ann -&gt; Bool) -&gt; m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#multiStepUntil"><span class="hs-identifier hs-var">multiStepUntil</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Continue"><span class="hs-identifier hs-type">Continue</span></a></span><span> </span><span id="local-6989586621680899676"><span class="annot"><span class="annottext">bps
</span><a href="#local-6989586621680899676"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bp.
Driving m uni fun ann bp =&gt;
(CekState uni fun ann -&gt; Bool) -&gt; m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#multiStepUntil"><span class="hs-identifier hs-var">multiStepUntil</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ann bps. Breakpointable ann bps =&gt; ann -&gt; bps -&gt; Bool
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#hasBreakpoints"><span class="hs-operator hs-var">`hasBreakpoints`</span></a></span><span> </span><span class="annot"><span class="annottext">bps
</span><a href="#local-6989586621680899676"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann. CekState uni fun ann -&gt; Maybe ann
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#cekStateAnn"><span class="hs-identifier hs-var">cekStateAnn</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Next"><span class="hs-identifier hs-type">Next</span></a></span><span> </span><span id="local-6989586621680899673"><span class="annot"><span class="annottext">bps
</span><a href="#local-6989586621680899673"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-113"></span><span>        </span><span id="local-6989586621680899672"><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899672"><span class="hs-identifier hs-var">startState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-114"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bp.
Driving m uni fun ann bp =&gt;
(CekState uni fun ann -&gt; Bool) -&gt; m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#multiStepUntil"><span class="hs-identifier hs-var">multiStepUntil</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680899670"><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899670"><span class="hs-identifier hs-var">curState</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>            </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ann bps. Breakpointable ann bps =&gt; ann -&gt; bps -&gt; Bool
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#hasBreakpoints"><span class="hs-operator hs-var">`hasBreakpoints`</span></a></span><span> </span><span class="annot"><span class="annottext">bps
</span><a href="#local-6989586621680899673"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann. CekState uni fun ann -&gt; Maybe ann
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#cekStateAnn"><span class="hs-identifier hs-var">cekStateAnn</span></a></span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899670"><span class="hs-identifier hs-var">curState</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">||</span></a></span><span>
</span><span id="line-116"></span><span>            </span><span class="hs-comment">-- has activation record length been restored?</span><span>
</span><span id="line-117"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680899662"><span class="annot"><span class="annottext">leCtx :: CekState uni fun ann -&gt; CekState uni fun ann -&gt; Bool
</span><a href="#local-6989586621680899662"><span class="hs-identifier hs-var hs-var">leCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall state (uni :: * -&gt; *) fun ann ctxLen a.
(state ~ CekState uni fun ann, ctxLen ~ Maybe Word) =&gt;
(ctxLen -&gt; ctxLen -&gt; a) -&gt; state -&gt; state -&gt; a
</span><a href="#local-6989586621680899661"><span class="hs-identifier hs-var">onCtxLen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(&lt;)</span></a></span><span>
</span><span id="line-118"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899670"><span class="hs-identifier hs-var">curState</span></a></span><span> </span><span class="annot"><span class="annottext">forall {uni :: * -&gt; *} {fun} {ann}.
CekState uni fun ann -&gt; CekState uni fun ann -&gt; Bool
</span><a href="#local-6989586621680899662"><span class="hs-operator hs-var">`leCtx`</span></a></span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899672"><span class="hs-identifier hs-var">startState</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Finish"><span class="hs-identifier hs-type">Finish</span></a></span><span> </span><span id="local-6989586621680899659"><span class="annot"><span class="annottext">bps
</span><a href="#local-6989586621680899659"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-121"></span><span>        </span><span id="local-6989586621680899658"><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899658"><span class="hs-identifier hs-var">startState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bp.
Driving m uni fun ann bp =&gt;
(CekState uni fun ann -&gt; Bool) -&gt; m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#multiStepUntil"><span class="hs-identifier hs-var">multiStepUntil</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680899657"><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899657"><span class="hs-identifier hs-var">curState</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-123"></span><span>            </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ann bps. Breakpointable ann bps =&gt; ann -&gt; bps -&gt; Bool
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#hasBreakpoints"><span class="hs-operator hs-var">`hasBreakpoints`</span></a></span><span> </span><span class="annot"><span class="annottext">bps
</span><a href="#local-6989586621680899659"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann. CekState uni fun ann -&gt; Maybe ann
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#cekStateAnn"><span class="hs-identifier hs-var">cekStateAnn</span></a></span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899657"><span class="hs-identifier hs-var">curState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">||</span></a></span><span>
</span><span id="line-124"></span><span>            </span><span class="hs-comment">-- has activation record length become smaller?</span><span>
</span><span id="line-125"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680899652"><span class="annot"><span class="annottext">ltCtx :: CekState uni fun ann -&gt; CekState uni fun ann -&gt; Bool
</span><a href="#local-6989586621680899652"><span class="hs-identifier hs-var hs-var">ltCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall state (uni :: * -&gt; *) fun ann ctxLen a.
(state ~ CekState uni fun ann, ctxLen ~ Maybe Word) =&gt;
(ctxLen -&gt; ctxLen -&gt; a) -&gt; state -&gt; state -&gt; a
</span><a href="#local-6989586621680899661"><span class="hs-identifier hs-var">onCtxLen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(&lt;=)</span></a></span><span>
</span><span id="line-126"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899657"><span class="hs-identifier hs-var">curState</span></a></span><span> </span><span class="annot"><span class="annottext">forall {uni :: * -&gt; *} {fun} {ann}.
CekState uni fun ann -&gt; CekState uni fun ann -&gt; Bool
</span><a href="#local-6989586621680899652"><span class="hs-operator hs-var">`ltCtx`</span></a></span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899658"><span class="hs-identifier hs-var">startState</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-comment">-- | Comparison on states' contexts</span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621680899899"><span id="local-6989586621680899900"><span id="local-6989586621680899901"><span id="local-6989586621680899902"><span id="local-6989586621680899903"><span id="local-6989586621680899904"><span class="annot"><a href="#local-6989586621680899661"><span class="hs-identifier hs-type">onCtxLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680899904"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#CekState"><span class="hs-identifier hs-type">CekState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899903"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899902"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899901"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-130"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680899900"><span class="hs-identifier hs-type">ctxLen</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="hs-comment">-- `Maybe` because ctx can be missing if terminating</span><span>
</span><span id="line-131"></span><span>               </span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680899900"><span class="hs-identifier hs-type">ctxLen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899900"><span class="hs-identifier hs-type">ctxLen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899904"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899904"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899899"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621680899661"><span class="annot"><span class="annottext">onCtxLen :: forall state (uni :: * -&gt; *) fun ann ctxLen a.
(state ~ CekState uni fun ann, ctxLen ~ Maybe Word) =&gt;
(ctxLen -&gt; ctxLen -&gt; a) -&gt; state -&gt; state -&gt; a
</span><a href="#local-6989586621680899661"><span class="hs-identifier hs-var hs-var">onCtxLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">preview</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann.
Traversal' (CekState uni fun ann) (Context uni fun ann)
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#cekStateContext"><span class="hs-identifier hs-var">cekStateContext</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann. Context uni fun ann -&gt; Word
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#lenContext"><span class="hs-identifier hs-var">lenContext</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | Do one or more cek steps until Terminating state is reached or condition on 'CekState' is met.</span><span>
</span><span id="line-137"></span><span id="local-6989586621680899921"><span id="local-6989586621680899922"><span id="local-6989586621680899923"><span id="local-6989586621680899924"><span id="local-6989586621680899925"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#multiStepUntil"><span class="hs-identifier hs-type">multiStepUntil</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Driving"><span class="hs-identifier hs-type">Driving</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899925"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899924"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899923"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899922"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899921"><span class="hs-identifier hs-type">bp</span></a></span><span>
</span><span id="line-138"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#CekState"><span class="hs-identifier hs-type">CekState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899924"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899923"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899922"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899925"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-139"></span><span id="multiStepUntil"><span class="annot"><span class="annottext">multiStepUntil :: forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bp.
Driving m uni fun ann bp =&gt;
(CekState uni fun ann -&gt; Bool) -&gt; m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#multiStepUntil"><span class="hs-identifier hs-var hs-var">multiStepUntil</span></a></span></span><span> </span><span id="local-6989586621680899600"><span class="annot"><span class="annottext">CekState uni fun ann -&gt; Bool
</span><a href="#local-6989586621680899600"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bps.
Driving m uni fun ann bps =&gt;
String -&gt; m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#logF"><span class="hs-identifier hs-var">logF</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Driver is going to do a single step&quot;</span></span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621680899598"><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899598"><span class="hs-identifier hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bps.
Driving m uni fun ann bps =&gt;
CekState uni fun ann -&gt; m (CekState uni fun ann)
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#stepF"><span class="hs-identifier hs-var">stepF</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899598"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#Terminating"><span class="hs-identifier hs-type">Terminating</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-144"></span><span>            </span><span class="hs-comment">-- don't recurse to driver, but EXIT the driver</span><span>
</span><span id="line-145"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bps.
Driving m uni fun ann bps =&gt;
CekState uni fun ann -&gt; m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#updateClientF"><span class="hs-identifier hs-var">updateClientF</span></a></span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899598"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- update state</span><span>
</span><span id="line-147"></span><span>            </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">local</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899598"><span class="hs-identifier hs-var">newState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-148"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann -&gt; Bool
</span><a href="#local-6989586621680899600"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899598"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-149"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-150"></span><span>                    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bps.
Driving m uni fun ann bps =&gt;
CekState uni fun ann -&gt; m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#updateClientF"><span class="hs-identifier hs-var">updateClientF</span></a></span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899598"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-151"></span><span>                    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bps.
Driving m uni fun ann bps =&gt;
m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#driver"><span class="hs-identifier hs-var">driver</span></a></span><span> </span><span class="hs-comment">-- tail recurse</span><span>
</span><span id="line-152"></span><span>                </span><span class="hs-keyword">else</span><span>
</span><span id="line-153"></span><span>                    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bp.
Driving m uni fun ann bp =&gt;
(CekState uni fun ann -&gt; Bool) -&gt; m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#multiStepUntil"><span class="hs-identifier hs-var">multiStepUntil</span></a></span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann -&gt; Bool
</span><a href="#local-6989586621680899600"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-comment">-- tail recurse</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- * boilerplate &quot;suspension actions&quot;</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- Being in 'Driving' monad here is too constraining, but it does not matter.</span><span>
</span><span id="line-157"></span><span id="local-6989586621680899928"><span id="local-6989586621680899929"><span id="local-6989586621680899930"><span id="local-6989586621680899931"><span id="local-6989586621680899932"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#inputF"><span class="hs-identifier hs-type">inputF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Driving"><span class="hs-identifier hs-type">Driving</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899932"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899931"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899930"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899929"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899928"><span class="hs-identifier hs-type">bps</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899932"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Cmd"><span class="hs-identifier hs-type">Cmd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899928"><span class="hs-identifier hs-type">bps</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-158"></span><span id="inputF"><span class="annot"><span class="annottext">inputF :: forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bps.
Driving m uni fun ann bps =&gt;
m (Cmd bps)
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#inputF"><span class="hs-identifier hs-var hs-var">inputF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann bps a.
(Cmd bps -&gt; a) -&gt; DebugF uni fun ann bps a
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#InputF"><span class="hs-identifier hs-var">InputF</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-159"></span><span id="local-6989586621680899851"><span id="local-6989586621680899852"><span id="local-6989586621680899853"><span id="local-6989586621680899854"><span id="local-6989586621680899855"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#logF"><span class="hs-identifier hs-type">logF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Driving"><span class="hs-identifier hs-type">Driving</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899854"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899853"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899852"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899851"><span class="hs-identifier hs-type">bps</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-160"></span><span id="logF"><span class="annot"><span class="annottext">logF :: forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bps.
Driving m uni fun ann bps =&gt;
String -&gt; m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#logF"><span class="hs-identifier hs-var hs-var">logF</span></a></span></span><span> </span><span id="local-6989586621680899582"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680899582"><span class="hs-identifier hs-var">text</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann bps a.
String -&gt; a -&gt; DebugF uni fun ann bps a
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#LogF"><span class="hs-identifier hs-var">LogF</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680899582"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span id="local-6989586621680899838"><span id="local-6989586621680899839"><span id="local-6989586621680899840"><span id="local-6989586621680899841"><span id="local-6989586621680899842"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#updateClientF"><span class="hs-identifier hs-type">updateClientF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Driving"><span class="hs-identifier hs-type">Driving</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899842"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899841"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899840"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899839"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899838"><span class="hs-identifier hs-type">bps</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#CekState"><span class="hs-identifier hs-type">CekState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899841"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899840"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899839"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899842"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-162"></span><span id="updateClientF"><span class="annot"><span class="annottext">updateClientF :: forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bps.
Driving m uni fun ann bps =&gt;
CekState uni fun ann -&gt; m ()
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#updateClientF"><span class="hs-identifier hs-var hs-var">updateClientF</span></a></span></span><span> </span><span id="local-6989586621680899577"><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899577"><span class="hs-identifier hs-var">dState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann bps a.
CekState uni fun ann -&gt; a -&gt; DebugF uni fun ann bps a
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#UpdateClientF"><span class="hs-identifier hs-var">UpdateClientF</span></a></span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899577"><span class="hs-identifier hs-var">dState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span id="local-6989586621680899846"><span id="local-6989586621680899847"><span id="local-6989586621680899848"><span id="local-6989586621680899849"><span id="local-6989586621680899850"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#stepF"><span class="hs-identifier hs-type">stepF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#Driving"><span class="hs-identifier hs-type">Driving</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899850"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899849"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899848"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899847"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899846"><span class="hs-identifier hs-type">bps</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#CekState"><span class="hs-identifier hs-type">CekState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899849"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899848"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899847"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680899850"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Internal.html#CekState"><span class="hs-identifier hs-type">CekState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899849"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899848"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680899847"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-164"></span><span id="stepF"><span class="annot"><span class="annottext">stepF :: forall (m :: * -&gt; *) (uni :: * -&gt; *) fun ann bps.
Driving m uni fun ann bps =&gt;
CekState uni fun ann -&gt; m (CekState uni fun ann)
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#stepF"><span class="hs-identifier hs-var hs-var">stepF</span></a></span></span><span> </span><span id="local-6989586621680899572"><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899572"><span class="hs-identifier hs-var">yieldState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun ann bps a.
CekState uni fun ann
-&gt; (CekState uni fun ann -&gt; a) -&gt; DebugF uni fun ann bps a
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Debug.Driver.html#StepF"><span class="hs-identifier hs-var">StepF</span></a></span><span> </span><span class="annot"><span class="annottext">CekState uni fun ann
</span><a href="#local-6989586621680899572"><span class="hs-identifier hs-var">yieldState</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-165"></span></pre></body></html>