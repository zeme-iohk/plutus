<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Foundation.Check.Main</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : Foundation maintainers</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- An application to check that integrate with the .cabal test-suite</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification  #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE Rank2Types                 #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE GADTs                      #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings          #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables        #-}</span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Foundation.Check.Main</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#defaultMain"><span class="hs-identifier">defaultMain</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier">Basement.Imports</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier">Basement.IntegralConv</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier">Basement.Cast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier">cast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier">Basement.Bounded</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier">Basement.Types.OffsetSize</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier">Basement.Terminal.ANSI</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ANSI</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier">Basement.Terminal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Terminal</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foundation.Collection.html"><span class="hs-identifier">Foundation.Collection</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foundation.Numerical.html"><span class="hs-identifier">Foundation.Numerical</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foundation.IO.Terminal.html"><span class="hs-identifier">Foundation.IO.Terminal</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foundation.Check.html"><span class="hs-identifier">Foundation.Check</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.html#iterateProperty"><span class="hs-identifier">iterateProperty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foundation.Check.Gen.html"><span class="hs-identifier">Foundation.Check.Gen</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foundation.Check.Property.html"><span class="hs-identifier">Foundation.Check.Property</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foundation.Check.Config.html"><span class="hs-identifier">Foundation.Check.Config</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foundation.Check.Types.html"><span class="hs-identifier">Foundation.Check.Types</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foundation.List.DList.html"><span class="hs-identifier">Foundation.List.DList</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foundation.Random.html"><span class="hs-identifier">Foundation.Random</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foundation.Monad.html"><span class="hs-identifier">Foundation.Monad</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Foundation.Monad.State.html"><span class="hs-identifier">Foundation.Monad.State</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">catMaybes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="annot"><a href="Foundation.Check.Main.html#nbFail"><span class="hs-identifier hs-type">nbFail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#TestResult"><span class="hs-identifier hs-type">TestResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#HasFailures"><span class="hs-identifier hs-type">HasFailures</span></a></span><span>
</span><span id="line-40"></span><span id="nbFail"><span class="annot"><span class="annottext">nbFail :: TestResult -&gt; CountOf TestResult
</span><a href="Foundation.Check.Main.html#nbFail"><span class="hs-identifier hs-var hs-var">nbFail</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.Types.html#PropertyResult"><span class="hs-identifier hs-type">PropertyResult</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.Types.html#PropertyFailed"><span class="hs-identifier hs-type">PropertyFailed</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><span class="hs-number">1</span></span><span>
</span><span id="line-41"></span><span class="annot"><a href="Foundation.Check.Main.html#nbFail"><span class="hs-identifier hs-var">nbFail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.Types.html#PropertyResult"><span class="hs-identifier hs-type">PropertyResult</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PropertyResult
</span><a href="Foundation.Check.Types.html#PropertySuccess"><span class="hs-identifier hs-var">PropertySuccess</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><span class="hs-number">0</span></span><span>
</span><span id="line-42"></span><span class="annot"><a href="Foundation.Check.Main.html#nbFail"><span class="hs-identifier hs-var">nbFail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.Types.html#GroupResult"><span class="hs-identifier hs-type">GroupResult</span></a></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679166584"><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166584"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TestResult]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166584"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="annot"><a href="Foundation.Check.Main.html#nbTests"><span class="hs-identifier hs-type">nbTests</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#TestResult"><span class="hs-identifier hs-type">TestResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">CountOf</span></a></span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#TestResult"><span class="hs-identifier hs-type">TestResult</span></a></span><span>
</span><span id="line-45"></span><span id="nbTests"><span class="annot"><span class="annottext">nbTests :: TestResult -&gt; CountOf TestResult
</span><a href="Foundation.Check.Main.html#nbTests"><span class="hs-identifier hs-var hs-var">nbTests</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.Types.html#PropertyResult"><span class="hs-identifier hs-type">PropertyResult</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679166582"><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166582"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">PropertyResult
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166582"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-46"></span><span class="annot"><a href="Foundation.Check.Main.html#nbTests"><span class="hs-identifier hs-var">nbTests</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.Types.html#GroupResult"><span class="hs-identifier hs-type">GroupResult</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679166581"><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166581"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">[TestResult]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166581"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">data</span><span> </span><span id="TestState"><span class="annot"><a href="Foundation.Check.Main.html#TestState"><span class="hs-identifier hs-var">TestState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TestState"><span class="annot"><a href="Foundation.Check.Main.html#TestState"><span class="hs-identifier hs-var">TestState</span></a></span></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="config"><span class="annot"><span class="annottext">TestState -&gt; Config
</span><a href="Foundation.Check.Main.html#config"><span class="hs-identifier hs-var hs-var">config</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Foundation.Check.Config.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="getSeed"><span class="annot"><span class="annottext">TestState -&gt; Word64
</span><a href="Foundation.Check.Main.html#getSeed"><span class="hs-identifier hs-var hs-var">getSeed</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Foundation.Check.Config.html#Seed"><span class="hs-identifier hs-type">Seed</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="indent"><span class="annot"><span class="annottext">TestState -&gt; CountOf Char
</span><a href="Foundation.Check.Main.html#indent"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">CountOf</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="testPassed"><span class="annot"><span class="annottext">TestState -&gt; Word
</span><a href="Foundation.Check.Main.html#testPassed"><span class="hs-identifier hs-var hs-var">testPassed</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Word</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="testFailed"><span class="annot"><span class="annottext">TestState -&gt; Word
</span><a href="Foundation.Check.Main.html#testFailed"><span class="hs-identifier hs-var hs-var">testFailed</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Word</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="testPath"><span class="annot"><span class="annottext">TestState -&gt; DList String
</span><a href="Foundation.Check.Main.html#testPath"><span class="hs-identifier hs-var hs-var">testPath</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Foundation.List.DList.html#DList"><span class="hs-identifier hs-type">DList</span></a></span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><a href="Foundation.Check.Main.html#newState"><span class="hs-identifier hs-type">newState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foundation.Check.Config.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Config.html#Seed"><span class="hs-identifier hs-type">Seed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#TestState"><span class="hs-identifier hs-type">TestState</span></a></span><span>
</span><span id="line-58"></span><span id="newState"><span class="annot"><span class="annottext">newState :: Config -&gt; Word64 -&gt; TestState
</span><a href="Foundation.Check.Main.html#newState"><span class="hs-identifier hs-var hs-var">newState</span></a></span></span><span> </span><span id="local-6989586621679166571"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679166571"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679166570"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166570"><span class="hs-identifier hs-var">initSeed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#TestState"><span class="hs-identifier hs-type">TestState</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">testPath :: DList String
</span><a href="Foundation.Check.Main.html#testPath"><span class="hs-identifier hs-var">testPath</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">testPassed :: Word
</span><a href="Foundation.Check.Main.html#testPassed"><span class="hs-identifier hs-var">testPassed</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">testFailed :: Word
</span><a href="Foundation.Check.Main.html#testFailed"><span class="hs-identifier hs-var">testFailed</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">indent :: CountOf Char
</span><a href="Foundation.Check.Main.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CountOf Char
</span><span class="hs-number">0</span></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">getSeed :: Word64
</span><a href="Foundation.Check.Main.html#getSeed"><span class="hs-identifier hs-var">getSeed</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166570"><span class="hs-identifier hs-var">initSeed</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">config :: Config
</span><a href="Foundation.Check.Main.html#config"><span class="hs-identifier hs-var">config</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679166571"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="annot"><a href="Foundation.Check.Main.html#filterTestMatching"><span class="hs-identifier hs-type">filterTestMatching</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foundation.Check.Config.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span>
</span><span id="line-68"></span><span id="filterTestMatching"><span class="annot"><span class="annottext">filterTestMatching :: Config -&gt; Test -&gt; Maybe Test
</span><a href="Foundation.Check.Main.html#filterTestMatching"><span class="hs-identifier hs-var hs-var">filterTestMatching</span></a></span></span><span> </span><span id="local-6989586621679166568"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679166568"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679166567"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166567"><span class="hs-identifier hs-var">testRoot</span></a></span></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall c. Collection c =&gt; c -&gt; Bool
</span><a href="Foundation.Collection.Collection.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; [String]
</span><a href="Foundation.Check.Config.html#testNameMatch"><span class="hs-identifier hs-var">testNameMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679166568"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166567"><span class="hs-identifier hs-var">testRoot</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Test -&gt; Maybe Test
</span><a href="#local-6989586621679166564"><span class="hs-identifier hs-var">testFilter</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166567"><span class="hs-identifier hs-var">testRoot</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>    </span><span id="local-6989586621679166563"><span class="annot"><span class="annottext">match :: [String] -&gt; String -&gt; Bool
</span><a href="#local-6989586621679166563"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679166562"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166562"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679166561"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166561"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall col. (Collection col, Element col ~ Bool) =&gt; col -&gt; Bool
</span><a href="Foundation.Collection.Collection.html#or"><span class="hs-identifier hs-var">or</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. (Sequential c, Eq (Element c)) =&gt; c -&gt; c -&gt; Bool
</span><a href="Foundation.Collection.Sequential.html#isInfixOf"><span class="hs-identifier hs-var">isInfixOf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166557"><span class="hs-identifier hs-var">currentTestName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; [String]
</span><a href="Foundation.Check.Config.html#testNameMatch"><span class="hs-identifier hs-var">testNameMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679166568"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679166557"><span class="annot"><span class="annottext">currentTestName :: String
</span><a href="#local-6989586621679166557"><span class="hs-identifier hs-var hs-var">currentTestName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="Foundation.Check.Types.html#fqTestName"><span class="hs-identifier hs-var">fqTestName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166561"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166562"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621679166564"><span class="annot"><span class="annottext">testFilter :: [String] -&gt; Test -&gt; Maybe Test
</span><a href="#local-6989586621679166564"><span class="hs-identifier hs-var hs-var">testFilter</span></a></span></span><span> </span><span id="local-6989586621679166554"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166554"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679166553"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166553"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-76"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166553"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-77"></span><span>            </span><span class="annot"><a href="Foundation.Check.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span> </span><span id="local-6989586621679166551"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166551"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679166550"><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166550"><span class="hs-identifier hs-var">l</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-78"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679166549"><span class="annot"><span class="annottext">filtered :: [Test]
</span><a href="#local-6989586621679166549"><span class="hs-identifier hs-var hs-var">filtered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [Maybe a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">catMaybes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Test -&gt; Maybe Test
</span><a href="#local-6989586621679166564"><span class="hs-identifier hs-var">testFilter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166551"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166554"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166550"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-79"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall c. Collection c =&gt; c -&gt; Bool
</span><a href="Foundation.Collection.Collection.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166549"><span class="hs-identifier hs-var">filtered</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [Test] -&gt; Test
</span><a href="Foundation.Check.Types.html#Group"><span class="hs-identifier hs-var">Group</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166551"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166549"><span class="hs-identifier hs-var">filtered</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>            </span><span class="annot"><a href="Foundation.Check.Types.html#CheckPlan"><span class="hs-identifier hs-type">CheckPlan</span></a></span><span> </span><span id="local-6989586621679166547"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166547"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Check ()
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-81"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String -&gt; Bool
</span><a href="#local-6989586621679166563"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166554"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166547"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166553"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-82"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-83"></span><span>            </span><span class="annot"><a href="Foundation.Check.Types.html#Unit"><span class="hs-identifier hs-type">Unit</span></a></span><span> </span><span id="local-6989586621679166545"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166545"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-84"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String -&gt; Bool
</span><a href="#local-6989586621679166563"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166554"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166545"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166553"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-85"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-86"></span><span>            </span><span class="annot"><a href="Foundation.Check.Types.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span id="local-6989586621679166542"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166542"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">prop
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-87"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String -&gt; Bool
</span><a href="#local-6989586621679166563"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166554"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166542"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166553"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-88"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | Run tests</span><span>
</span><span id="line-91"></span><span class="annot"><a href="Foundation.Check.Main.html#defaultMain"><span class="hs-identifier hs-type">defaultMain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span id="defaultMain"><span class="annot"><span class="annottext">defaultMain :: Test -&gt; IO ()
</span><a href="Foundation.Check.Main.html#defaultMain"><span class="hs-identifier hs-var hs-var">defaultMain</span></a></span></span><span> </span><span id="local-6989586621679166541"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166541"><span class="hs-identifier hs-var">allTestRoot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="annottext">IO ()
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">Terminal.initialize</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">-- parse arguments</span><span>
</span><span id="line-96"></span><span>    </span><span id="local-6989586621679166539"><span class="annot"><span class="annottext">Either String Config
</span><a href="#local-6989586621679166539"><span class="hs-identifier hs-var">ecfg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Config -&gt; Either String Config
</span><a href="Foundation.Check.Config.html#parseArgs"><span class="hs-identifier hs-var">parseArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="Foundation.Check.Config.html#defaultConfig"><span class="hs-identifier hs-var">defaultConfig</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO [String]
</span><a href="Foundation.IO.Terminal.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679166535"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679166535"><span class="hs-identifier hs-var">cfg</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String Config
</span><a href="#local-6989586621679166539"><span class="hs-identifier hs-var">ecfg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-98"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679166534"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166534"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-99"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Foundation.IO.Terminal.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166534"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-100"></span><span>                </span><span class="annot"><span class="annottext">forall (col :: * -&gt; *) (m :: * -&gt; *) a b.
(Mappable col, Applicative m, Monad m) =&gt;
(a -&gt; m b) -&gt; col a -&gt; m ()
</span><a href="Foundation.Collection.Mappable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Foundation.IO.Terminal.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="Foundation.Check.Config.html#configHelp"><span class="hs-identifier hs-var">configHelp</span></a></span><span>
</span><span id="line-101"></span><span>                </span><span class="annot"><span class="annottext">forall a. IO a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">exitFailure</span></a></span><span>
</span><span id="line-102"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679166529"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679166529"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679166529"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-comment">-- use the user defined seed or generate a new seed</span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679166528"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166528"><span class="hs-identifier hs-var">seed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadRandom m =&gt; m Word64
</span><a href="Foundation.Random.Class.html#getRandomWord64"><span class="hs-identifier hs-var">getRandomWord64</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; Maybe Word64
</span><a href="Foundation.Check.Config.html#udfSeed"><span class="hs-identifier hs-var">udfSeed</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679166535"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679166524"><span class="annot"><span class="annottext">testState :: TestState
</span><a href="#local-6989586621679166524"><span class="hs-identifier hs-var hs-var">testState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config -&gt; Word64 -&gt; TestState
</span><a href="Foundation.Check.Main.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679166535"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166528"><span class="hs-identifier hs-var">seed</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; Bool
</span><a href="Foundation.Check.Config.html#helpRequested"><span class="hs-identifier hs-var">helpRequested</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679166535"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (col :: * -&gt; *) (m :: * -&gt; *) a b.
(Mappable col, Applicative m, Monad m) =&gt;
(a -&gt; m b) -&gt; col a -&gt; m ()
</span><a href="Foundation.Collection.Mappable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Foundation.IO.Terminal.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="Foundation.Check.Config.html#configHelp"><span class="hs-identifier hs-var">configHelp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IO a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">exitSuccess</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; Bool
</span><a href="Foundation.Check.Config.html#listTests"><span class="hs-identifier hs-var">listTests</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679166535"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679166519"><span class="hs-identifier hs-var">printTestName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IO a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">exitSuccess</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Foundation.IO.Terminal.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nSeed: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166528"><span class="hs-identifier hs-var">seed</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Config -&gt; Test -&gt; Maybe Test
</span><a href="Foundation.Check.Main.html#filterTestMatching"><span class="hs-identifier hs-var">filterTestMatching</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679166535"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166541"><span class="hs-identifier hs-var">allTestRoot</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><span class="annottext">Maybe Test
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Foundation.IO.Terminal.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;no tests to run&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IO a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">exitSuccess</span></a></span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679166517"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166517"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-117"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestResult
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679166516"><span class="annot"><span class="annottext">TestState
</span><a href="#local-6989586621679166516"><span class="hs-identifier hs-var">cfg'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><a href="Foundation.Monad.State.html#runStateT"><span class="hs-identifier hs-var">runStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. CheckMain a -&gt; StateT TestState IO a
</span><a href="Foundation.Check.Main.html#runCheckMain"><span class="hs-identifier hs-var">runCheckMain</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Test -&gt; CheckMain TestResult
</span><a href="Foundation.Check.Main.html#test"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166517"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestState
</span><a href="#local-6989586621679166524"><span class="hs-identifier hs-var">testState</span></a></span><span>
</span><span id="line-118"></span><span>            </span><span class="annot"><span class="annottext">forall {b}. TestState -&gt; IO b
</span><a href="#local-6989586621679166512"><span class="hs-identifier hs-var">summary</span></a></span><span> </span><span class="annot"><span class="annottext">TestState
</span><a href="#local-6989586621679166516"><span class="hs-identifier hs-var">cfg'</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-comment">-- display a summary of the result and use the right exit code</span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621679166512"><span class="annot"><span class="annottext">summary :: TestState -&gt; IO b
</span><a href="#local-6989586621679166512"><span class="hs-identifier hs-var hs-var">summary</span></a></span></span><span> </span><span id="local-6989586621679166488"><span class="annot"><span class="annottext">TestState
</span><a href="#local-6989586621679166488"><span class="hs-identifier hs-var">cfg</span></a></span></span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679166487"><span class="hs-identifier hs-var">kos</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Foundation.IO.Terminal.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#red"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679166487"><span class="hs-identifier hs-var">kos</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; out of &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679166484"><span class="hs-identifier hs-var">tot</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#reset"><span class="hs-identifier hs-var">reset</span></a></span><span>
</span><span id="line-125"></span><span>            </span><span class="annot"><span class="annottext">forall a. IO a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">exitFailure</span></a></span><span>
</span><span id="line-126"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-127"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Foundation.IO.Terminal.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#green"><span class="hs-identifier hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Succeed &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679166481"><span class="hs-identifier hs-var">oks</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; test(s)&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#reset"><span class="hs-identifier hs-var">reset</span></a></span><span>
</span><span id="line-128"></span><span>            </span><span class="annot"><span class="annottext">forall a. IO a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">exitSuccess</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>        </span><span id="local-6989586621679166481"><span class="annot"><span class="annottext">oks :: Word
</span><a href="#local-6989586621679166481"><span class="hs-identifier hs-var hs-var">oks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; Word
</span><a href="Foundation.Check.Main.html#testPassed"><span class="hs-identifier hs-var">testPassed</span></a></span><span> </span><span class="annot"><span class="annottext">TestState
</span><a href="#local-6989586621679166488"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-131"></span><span>        </span><span id="local-6989586621679166487"><span class="annot"><span class="annottext">kos :: Word
</span><a href="#local-6989586621679166487"><span class="hs-identifier hs-var hs-var">kos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; Word
</span><a href="Foundation.Check.Main.html#testFailed"><span class="hs-identifier hs-var">testFailed</span></a></span><span> </span><span class="annot"><span class="annottext">TestState
</span><a href="#local-6989586621679166488"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span id="local-6989586621679166484"><span class="annot"><span class="annottext">tot :: Word
</span><a href="#local-6989586621679166484"><span class="hs-identifier hs-var hs-var">tot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679166481"><span class="hs-identifier hs-var">oks</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../basement/html/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679166487"><span class="hs-identifier hs-var">kos</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-comment">-- print all the tests recursively</span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679166519"><span class="annot"><span class="annottext">printTestName :: IO ()
</span><a href="#local-6989586621679166519"><span class="hs-identifier hs-var hs-var">printTestName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (col :: * -&gt; *) (m :: * -&gt; *) a b.
(Mappable col, Applicative m, Monad m) =&gt;
(a -&gt; m b) -&gt; col a -&gt; m ()
</span><a href="Foundation.Collection.Mappable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679166479"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166479"><span class="hs-identifier hs-var">tst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Foundation.IO.Terminal.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; String
</span><a href="Foundation.Check.Types.html#fqTestName"><span class="hs-identifier hs-var">fqTestName</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166479"><span class="hs-identifier hs-var">tst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Test, [String])] -&gt; [Test] -&gt; [String] -&gt; Test -&gt; [[String]]
</span><a href="#local-6989586621679166478"><span class="hs-identifier hs-var">testCases</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166541"><span class="hs-identifier hs-var">allTestRoot</span></a></span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-137"></span><span>        </span><span id="local-6989586621679166478"><span class="annot"><span class="annottext">testCases :: [(Test, [String])] -&gt; [Test] -&gt; [String] -&gt; Test -&gt; [[String]]
</span><a href="#local-6989586621679166478"><span class="hs-identifier hs-var hs-var">testCases</span></a></span></span><span> </span><span id="local-6989586621679166474"><span class="annot"><span class="annottext">[(Test, [String])]
</span><a href="#local-6989586621679166474"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679166473"><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166473"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679166472"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166472"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span id="local-6989586621679166471"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166471"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-138"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166471"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-139"></span><span>                </span><span class="annot"><a href="Foundation.Check.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span> </span><span id="local-6989586621679166470"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166470"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679166469"><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166469"><span class="hs-identifier hs-var">l</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Test, [String])] -&gt; [String] -&gt; [Test] -&gt; [[String]]
</span><a href="#local-6989586621679166468"><span class="hs-identifier hs-var">tToList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679166467"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166467"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166467"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166472"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166473"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(Test, [String])]
</span><a href="#local-6989586621679166474"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166470"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166472"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166469"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-140"></span><span>                </span><span class="annot"><a href="Foundation.Check.Types.html#CheckPlan"><span class="hs-identifier hs-type">CheckPlan</span></a></span><span> </span><span id="local-6989586621679166466"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166466"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Check ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166466"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166472"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Test, [String])] -&gt; [String] -&gt; [Test] -&gt; [[String]]
</span><a href="#local-6989586621679166468"><span class="hs-identifier hs-var">tToList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Test, [String])]
</span><a href="#local-6989586621679166474"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166472"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166473"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-141"></span><span>                </span><span class="annot"><a href="Foundation.Check.Types.html#Unit"><span class="hs-identifier hs-type">Unit</span></a></span><span> </span><span id="local-6989586621679166465"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166465"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166465"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166472"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Test, [String])] -&gt; [String] -&gt; [Test] -&gt; [[String]]
</span><a href="#local-6989586621679166468"><span class="hs-identifier hs-var">tToList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Test, [String])]
</span><a href="#local-6989586621679166474"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166472"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166473"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-142"></span><span>                </span><span class="annot"><a href="Foundation.Check.Types.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span id="local-6989586621679166463"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166463"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">prop
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166463"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166472"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Test, [String])] -&gt; [String] -&gt; [Test] -&gt; [[String]]
</span><a href="#local-6989586621679166468"><span class="hs-identifier hs-var">tToList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Test, [String])]
</span><a href="#local-6989586621679166474"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166472"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166473"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>        </span><span id="local-6989586621679166468"><span class="annot"><span class="annottext">tToList :: [(Test, [String])] -&gt; [String] -&gt; [Test] -&gt; [[String]]
</span><a href="#local-6989586621679166468"><span class="hs-identifier hs-var hs-var">tToList</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><a href="#local-6989586621679166468"><span class="hs-identifier hs-var">tToList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679166462"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166462"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679166461"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166461"><span class="hs-identifier hs-var">pre</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679166460"><span class="annot"><span class="annottext">[(Test, [String])]
</span><a href="#local-6989586621679166460"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Test, [String])] -&gt; [Test] -&gt; [String] -&gt; Test -&gt; [[String]]
</span><a href="#local-6989586621679166478"><span class="hs-identifier hs-var">testCases</span></a></span><span> </span><span class="annot"><span class="annottext">[(Test, [String])]
</span><a href="#local-6989586621679166460"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166461"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166462"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><a href="#local-6989586621679166468"><span class="hs-identifier hs-var">tToList</span></a></span><span> </span><span id="local-6989586621679166459"><span class="annot"><span class="annottext">[(Test, [String])]
</span><a href="#local-6989586621679166459"><span class="hs-identifier hs-var">acc</span></a></span></span><span>          </span><span id="local-6989586621679166458"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166458"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679166457"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166457"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679166456"><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166456"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Test, [String])] -&gt; [Test] -&gt; [String] -&gt; Test -&gt; [[String]]
</span><a href="#local-6989586621679166478"><span class="hs-identifier hs-var">testCases</span></a></span><span> </span><span class="annot"><span class="annottext">[(Test, [String])]
</span><a href="#local-6989586621679166459"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166456"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679166458"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679166457"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- | internal check monad for facilitating the tests traversal</span><span>
</span><span id="line-149"></span><span class="hs-keyword">newtype</span><span> </span><span id="CheckMain"><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-var">CheckMain</span></a></span></span><span> </span><span id="local-6989586621679166932"><span class="annot"><a href="#local-6989586621679166932"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CheckMain"><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-var">CheckMain</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runCheckMain"><span class="annot"><span class="annottext">forall a. CheckMain a -&gt; StateT TestState IO a
</span><a href="Foundation.Check.Main.html#runCheckMain"><span class="hs-identifier hs-var hs-var">runCheckMain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foundation.Monad.State.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#TestState"><span class="hs-identifier hs-type">TestState</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679166932"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679166448"><span id="local-6989586621679166453"><span class="annot"><span class="annottext">forall a b. a -&gt; CheckMain b -&gt; CheckMain a
forall a b. (a -&gt; b) -&gt; CheckMain a -&gt; CheckMain b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: forall a b. a -&gt; CheckMain b -&gt; CheckMain a
$c&lt;$ :: forall a b. a -&gt; CheckMain b -&gt; CheckMain a
fmap :: forall a b. (a -&gt; b) -&gt; CheckMain a -&gt; CheckMain b
$cfmap :: forall a b. (a -&gt; b) -&gt; CheckMain a -&gt; CheckMain b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679166424"><span id="local-6989586621679166428"><span id="local-6989586621679166432"><span id="local-6989586621679166436"><span id="local-6989586621679166441"><span class="annot"><span class="annottext">Functor CheckMain
forall a. a -&gt; CheckMain a
forall a b. CheckMain a -&gt; CheckMain b -&gt; CheckMain a
forall a b. CheckMain a -&gt; CheckMain b -&gt; CheckMain b
forall a b. CheckMain (a -&gt; b) -&gt; CheckMain a -&gt; CheckMain b
forall a b c.
(a -&gt; b -&gt; c) -&gt; CheckMain a -&gt; CheckMain b -&gt; CheckMain c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: forall a b. CheckMain a -&gt; CheckMain b -&gt; CheckMain a
$c&lt;* :: forall a b. CheckMain a -&gt; CheckMain b -&gt; CheckMain a
*&gt; :: forall a b. CheckMain a -&gt; CheckMain b -&gt; CheckMain b
$c*&gt; :: forall a b. CheckMain a -&gt; CheckMain b -&gt; CheckMain b
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; CheckMain a -&gt; CheckMain b -&gt; CheckMain c
$cliftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; CheckMain a -&gt; CheckMain b -&gt; CheckMain c
&lt;*&gt; :: forall a b. CheckMain (a -&gt; b) -&gt; CheckMain a -&gt; CheckMain b
$c&lt;*&gt; :: forall a b. CheckMain (a -&gt; b) -&gt; CheckMain a -&gt; CheckMain b
pure :: forall a. a -&gt; CheckMain a
$cpure :: forall a. a -&gt; CheckMain a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></a></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679166408"><span id="local-6989586621679166412"><span id="local-6989586621679166417"><span class="annot"><span class="annottext">Applicative CheckMain
forall a. a -&gt; CheckMain a
forall a b. CheckMain a -&gt; CheckMain b -&gt; CheckMain b
forall a b. CheckMain a -&gt; (a -&gt; CheckMain b) -&gt; CheckMain b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: forall a. a -&gt; CheckMain a
$creturn :: forall a. a -&gt; CheckMain a
&gt;&gt; :: forall a b. CheckMain a -&gt; CheckMain b -&gt; CheckMain b
$c&gt;&gt; :: forall a b. CheckMain a -&gt; CheckMain b -&gt; CheckMain b
&gt;&gt;= :: forall a b. CheckMain a -&gt; (a -&gt; CheckMain b) -&gt; CheckMain b
$c&gt;&gt;= :: forall a b. CheckMain a -&gt; (a -&gt; CheckMain b) -&gt; CheckMain b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679166401"><span class="annot"><span class="annottext">Monad CheckMain
forall a. IO a -&gt; CheckMain a
forall (m :: * -&gt; *).
Monad m -&gt; (forall a. IO a -&gt; m a) -&gt; MonadIO m
liftIO :: forall a. IO a -&gt; CheckMain a
$cliftIO :: forall a. IO a -&gt; CheckMain a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadIO</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Foundation.Monad.State.html#MonadState"><span class="hs-identifier hs-type">MonadState</span></a></span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="State"><span class="annot"><a href="Foundation.Monad.State.html#State"><span class="hs-identifier hs-var">State</span></a></span></span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#TestState"><span class="hs-identifier hs-type">TestState</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621679166387"><span class="annot"><span class="annottext">withState :: forall a. (State CheckMain -&gt; (a, State CheckMain)) -&gt; CheckMain a
</span><a href="Foundation.Monad.State.html#withState"><span class="hs-identifier hs-var hs-var hs-var hs-var">withState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. StateT TestState IO a -&gt; CheckMain a
</span><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-var">CheckMain</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
MonadState m =&gt;
(State m -&gt; (a, State m)) -&gt; m a
</span><a href="Foundation.Monad.State.html#withState"><span class="hs-identifier hs-var">withState</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><a href="Foundation.Check.Main.html#onDisplayOption"><span class="hs-identifier hs-type">onDisplayOption</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foundation.Check.Config.html#DisplayOption"><span class="hs-identifier hs-type">DisplayOption</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span id="onDisplayOption"><span class="annot"><span class="annottext">onDisplayOption :: DisplayOption -&gt; CheckMain () -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#onDisplayOption"><span class="hs-identifier hs-var hs-var">onDisplayOption</span></a></span></span><span> </span><span id="local-6989586621679166383"><span class="annot"><span class="annottext">DisplayOption
</span><a href="#local-6989586621679166383"><span class="hs-identifier hs-var">opt</span></a></span></span><span> </span><span id="local-6989586621679166382"><span class="annot"><span class="annottext">CheckMain ()
</span><a href="#local-6989586621679166382"><span class="hs-identifier hs-var">chk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679166381"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679166381"><span class="hs-identifier hs-var">on</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(&lt;=)</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayOption
</span><a href="#local-6989586621679166383"><span class="hs-identifier hs-var">opt</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; DisplayOption
</span><a href="Foundation.Check.Config.html#displayOptions"><span class="hs-identifier hs-var">displayOptions</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestState -&gt; Config
</span><a href="Foundation.Check.Main.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadState m =&gt; m (State m)
</span><a href="Foundation.Monad.State.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679166381"><span class="hs-identifier hs-var">on</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CheckMain ()
</span><a href="#local-6989586621679166382"><span class="hs-identifier hs-var">chk</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Foundation.Check.Main.html#whenErrorOnly"><span class="hs-identifier hs-type">whenErrorOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span id="whenErrorOnly"><span class="annot"><span class="annottext">whenErrorOnly :: CheckMain () -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#whenErrorOnly"><span class="hs-identifier hs-var hs-var">whenErrorOnly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DisplayOption -&gt; CheckMain () -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#onDisplayOption"><span class="hs-identifier hs-var">onDisplayOption</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayOption
</span><a href="Foundation.Check.Config.html#DisplayTerminalErrorOnly"><span class="hs-identifier hs-var">DisplayTerminalErrorOnly</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="annot"><a href="Foundation.Check.Main.html#whenGroupOnly"><span class="hs-identifier hs-type">whenGroupOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span id="whenGroupOnly"><span class="annot"><span class="annottext">whenGroupOnly :: CheckMain () -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#whenGroupOnly"><span class="hs-identifier hs-var hs-var">whenGroupOnly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DisplayOption -&gt; CheckMain () -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#onDisplayOption"><span class="hs-identifier hs-var">onDisplayOption</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayOption
</span><a href="Foundation.Check.Config.html#DisplayGroupOnly"><span class="hs-identifier hs-var">DisplayGroupOnly</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="annot"><a href="Foundation.Check.Main.html#whenVerbose"><span class="hs-identifier hs-type">whenVerbose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span id="whenVerbose"><span class="annot"><span class="annottext">whenVerbose :: CheckMain () -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#whenVerbose"><span class="hs-identifier hs-var hs-var">whenVerbose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DisplayOption -&gt; CheckMain () -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#onDisplayOption"><span class="hs-identifier hs-var">onDisplayOption</span></a></span><span> </span><span class="annot"><span class="annottext">DisplayOption
</span><a href="Foundation.Check.Config.html#DisplayTerminalVerbose"><span class="hs-identifier hs-var">DisplayTerminalVerbose</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Foundation.Check.Main.html#passed"><span class="hs-identifier hs-type">passed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span id="passed"><span class="annot"><span class="annottext">passed :: CheckMain ()
</span><a href="Foundation.Check.Main.html#passed"><span class="hs-identifier hs-var hs-var">passed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
MonadState m =&gt;
(State m -&gt; (a, State m)) -&gt; m a
</span><a href="Foundation.Monad.State.html#withState"><span class="hs-identifier hs-var">withState</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679166370"><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166370"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166370"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">testPassed :: Word
</span><a href="Foundation.Check.Main.html#testPassed"><span class="hs-identifier hs-var">testPassed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; Word
</span><a href="Foundation.Check.Main.html#testPassed"><span class="hs-identifier hs-var">testPassed</span></a></span><span> </span><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166370"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../basement/html/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Foundation.Check.Main.html#failed"><span class="hs-identifier hs-type">failed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span id="failed"><span class="annot"><span class="annottext">failed :: CheckMain ()
</span><a href="Foundation.Check.Main.html#failed"><span class="hs-identifier hs-var hs-var">failed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
MonadState m =&gt;
(State m -&gt; (a, State m)) -&gt; m a
</span><a href="Foundation.Monad.State.html#withState"><span class="hs-identifier hs-var">withState</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679166368"><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166368"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166368"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">testFailed :: Word
</span><a href="Foundation.Check.Main.html#testFailed"><span class="hs-identifier hs-var">testFailed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; Word
</span><a href="Foundation.Check.Main.html#testFailed"><span class="hs-identifier hs-var">testFailed</span></a></span><span> </span><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166368"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../basement/html/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Foundation.Check.Main.html#test"><span class="hs-identifier hs-type">test</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#TestResult"><span class="hs-identifier hs-type">TestResult</span></a></span><span>
</span><span id="line-177"></span><span id="test"><span class="annot"><span class="annottext">test :: Test -&gt; CheckMain TestResult
</span><a href="Foundation.Check.Main.html#test"><span class="hs-identifier hs-var hs-var">test</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span> </span><span id="local-6989586621679166367"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166367"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679166366"><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166366"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Test] -&gt; CheckMain TestResult
</span><a href="Foundation.Check.Main.html#pushGroup"><span class="hs-identifier hs-var">pushGroup</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166367"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166366"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-178"></span><span class="annot"><a href="Foundation.Check.Main.html#test"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.Types.html#Unit"><span class="hs-identifier hs-type">Unit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Foundation.Check.Main.html#test"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.Types.html#CheckPlan"><span class="hs-identifier hs-type">CheckPlan</span></a></span><span> </span><span id="local-6989586621679166363"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166363"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679166362"><span class="annot"><span class="annottext">Check ()
</span><a href="#local-6989586621679166362"><span class="hs-identifier hs-var">plan</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Check () -&gt; CheckMain TestResult
</span><a href="Foundation.Check.Main.html#testCheckPlan"><span class="hs-identifier hs-var">testCheckPlan</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166363"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Check ()
</span><a href="#local-6989586621679166362"><span class="hs-identifier hs-var">plan</span></a></span><span>
</span><span id="line-181"></span><span class="annot"><a href="Foundation.Check.Main.html#test"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.Types.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span id="local-6989586621679166352"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166352"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679166351"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679166351"><span class="hs-identifier hs-var">prop</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679166350"><span class="annot"><span class="annottext">TestResult
</span><a href="#local-6989586621679166350"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; CheckMain TestResult
</span><a href="Foundation.Check.Main.html#testProperty"><span class="hs-identifier hs-var">testProperty</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166352"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. IsProperty p =&gt; p -&gt; Property
</span><a href="Foundation.Check.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679166351"><span class="hs-identifier hs-var">prop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestResult
</span><a href="#local-6989586621679166350"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.Types.html#PropertyResult"><span class="hs-identifier hs-type">PropertyResult</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679166347"><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166347"><span class="hs-identifier hs-var">nb</span></a></span></span><span> </span><span class="annot"><span class="annottext">PropertyResult
</span><a href="Foundation.Check.Types.html#PropertySuccess"><span class="hs-identifier hs-var">PropertySuccess</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckMain () -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#whenVerbose"><span class="hs-identifier hs-var">whenVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; CountOf TestResult -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#displayPropertySucceed"><span class="hs-identifier hs-var">displayPropertySucceed</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166352"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166347"><span class="hs-identifier hs-var">nb</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.Types.html#PropertyResult"><span class="hs-identifier hs-type">PropertyResult</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679166345"><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166345"><span class="hs-identifier hs-var">nb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Foundation.Check.Types.html#PropertyFailed"><span class="hs-identifier hs-type">PropertyFailed</span></a></span><span> </span><span id="local-6989586621679166344"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166344"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckMain () -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#whenErrorOnly"><span class="hs-identifier hs-var">whenErrorOnly</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; CountOf TestResult -&gt; String -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#displayPropertyFailed"><span class="hs-identifier hs-var">displayPropertyFailed</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166352"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166345"><span class="hs-identifier hs-var">nb</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166344"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><a href="Foundation.Check.Types.html#GroupResult"><span class="hs-identifier hs-type">GroupResult</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;internal error: should not happen&quot;</span></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">TestResult
</span><a href="#local-6989586621679166350"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Foundation.Check.Main.html#displayCurrent"><span class="hs-identifier hs-type">displayCurrent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span id="displayCurrent"><span class="annot"><span class="annottext">displayCurrent :: String -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#displayCurrent"><span class="hs-identifier hs-var hs-var">displayCurrent</span></a></span></span><span> </span><span id="local-6989586621679166340"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166340"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679166339"><span class="annot"><span class="annottext">CountOf Char
</span><a href="#local-6989586621679166339"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; CountOf Char
</span><a href="Foundation.Check.Main.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadState m =&gt; m (State m)
</span><a href="Foundation.Monad.State.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Foundation.IO.Terminal.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. Sequential c =&gt; CountOf (Element c) -&gt; Element c -&gt; c
</span><a href="Foundation.Collection.Sequential.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">CountOf Char
</span><a href="#local-6989586621679166339"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166340"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="annot"><a href="Foundation.Check.Main.html#displayPropertySucceed"><span class="hs-identifier hs-type">displayPropertySucceed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">CountOf</span></a></span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#TestResult"><span class="hs-identifier hs-type">TestResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span id="displayPropertySucceed"><span class="annot"><span class="annottext">displayPropertySucceed :: String -&gt; CountOf TestResult -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#displayPropertySucceed"><span class="hs-identifier hs-var hs-var">displayPropertySucceed</span></a></span></span><span> </span><span id="local-6989586621679166336"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166336"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">CountOf</span></a></span><span> </span><span id="local-6989586621679166334"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679166334"><span class="hs-identifier hs-var">nb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621679166333"><span class="annot"><span class="annottext">CountOf Char
</span><a href="#local-6989586621679166333"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; CountOf Char
</span><a href="Foundation.Check.Main.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadState m =&gt; m (State m)
</span><a href="Foundation.Monad.State.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Foundation.IO.Terminal.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall c. Sequential c =&gt; CountOf (Element c) -&gt; Element c -&gt; c
</span><a href="Foundation.Collection.Sequential.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">CountOf Char
</span><a href="#local-6989586621679166333"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#successString"><span class="hs-identifier hs-var">successString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166336"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; (&quot;</span></span><span>
</span><span id="line-201"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679166334"><span class="hs-identifier hs-var">nb</span></a></span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679166334"><span class="hs-identifier hs-var">nb</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; test)&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; tests)&quot;</span></span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Foundation.Check.Main.html#unicodeEnabled"><span class="hs-identifier hs-type">unicodeEnabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-206"></span><span id="unicodeEnabled"><span class="annot"><span class="annottext">unicodeEnabled :: Bool
</span><a href="Foundation.Check.Main.html#unicodeEnabled"><span class="hs-identifier hs-var hs-var">unicodeEnabled</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="annot"><a href="Foundation.Check.Main.html#successString"><span class="hs-identifier hs-type">successString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-209"></span><span id="successString"><span class="annot"><span class="annottext">successString :: String
</span><a href="Foundation.Check.Main.html#successString"><span class="hs-identifier hs-var hs-var">successString</span></a></span></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Foundation.Check.Main.html#unicodeEnabled"><span class="hs-identifier hs-var">unicodeEnabled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#green"><span class="hs-identifier hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &#10003; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#reset"><span class="hs-identifier hs-var">reset</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#green"><span class="hs-identifier hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[SUCCESS] &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#reset"><span class="hs-identifier hs-var">reset</span></a></span><span>
</span><span id="line-212"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#successString"><span class="hs-pragma hs-type">successString</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="annot"><a href="Foundation.Check.Main.html#failureString"><span class="hs-identifier hs-type">failureString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-215"></span><span id="failureString"><span class="annot"><span class="annottext">failureString :: String
</span><a href="Foundation.Check.Main.html#failureString"><span class="hs-identifier hs-var hs-var">failureString</span></a></span></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="Foundation.Check.Main.html#unicodeEnabled"><span class="hs-identifier hs-var">unicodeEnabled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#red"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &#10007; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#reset"><span class="hs-identifier hs-var">reset</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#red"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[ ERROR ] &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#reset"><span class="hs-identifier hs-var">reset</span></a></span><span>
</span><span id="line-218"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#failureString"><span class="hs-pragma hs-type">failureString</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="annot"><a href="Foundation.Check.Main.html#reset"><span class="hs-identifier hs-type">reset</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#green"><span class="hs-identifier hs-type">green</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#red"><span class="hs-identifier hs-type">red</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">ANSI.Escape</span></a></span><span>
</span><span id="line-221"></span><span id="reset"><span class="annot"><span class="annottext">reset :: String
</span><a href="Foundation.Check.Main.html#reset"><span class="hs-identifier hs-var hs-var">reset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">ANSI.sgrReset</span></a></span><span>
</span><span id="line-222"></span><span id="green"><span class="annot"><span class="annottext">green :: String
</span><a href="Foundation.Check.Main.html#green"><span class="hs-identifier hs-var hs-var">green</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ColorComponent -&gt; Bool -&gt; String
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">ANSI.sgrForeground</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (n :: Nat).
(KnownNat n, NatWithinBound Word64 n) =&gt;
Word64 -&gt; Zn64 n
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">zn64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-223"></span><span id="red"><span class="annot"><span class="annottext">red :: String
</span><a href="Foundation.Check.Main.html#red"><span class="hs-identifier hs-var hs-var">red</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ColorComponent -&gt; Bool -&gt; String
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">ANSI.sgrForeground</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (n :: Nat).
(KnownNat n, NatWithinBound Word64 n) =&gt;
Word64 -&gt; Zn64 n
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">zn64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="annot"><a href="Foundation.Check.Main.html#displayPropertyFailed"><span class="hs-identifier hs-type">displayPropertyFailed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">CountOf</span></a></span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#TestResult"><span class="hs-identifier hs-type">TestResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span id="displayPropertyFailed"><span class="annot"><span class="annottext">displayPropertyFailed :: String -&gt; CountOf TestResult -&gt; String -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#displayPropertyFailed"><span class="hs-identifier hs-var hs-var">displayPropertyFailed</span></a></span></span><span> </span><span id="local-6989586621679166325"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166325"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">CountOf</span></a></span><span> </span><span id="local-6989586621679166324"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679166324"><span class="hs-identifier hs-var">nb</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679166323"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166323"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621679166322"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166322"><span class="hs-identifier hs-var">seed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; Word64
</span><a href="Foundation.Check.Main.html#getSeed"><span class="hs-identifier hs-var">getSeed</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadState m =&gt; m (State m)
</span><a href="Foundation.Monad.State.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679166321"><span class="annot"><span class="annottext">CountOf Char
</span><a href="#local-6989586621679166321"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; CountOf Char
</span><a href="Foundation.Check.Main.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadState m =&gt; m (State m)
</span><a href="Foundation.Monad.State.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Foundation.IO.Terminal.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-231"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall c. Sequential c =&gt; CountOf (Element c) -&gt; Element c -&gt; c
</span><a href="Foundation.Collection.Sequential.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">CountOf Char
</span><a href="#local-6989586621679166321"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-232"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Foundation.Check.Main.html#failureString"><span class="hs-identifier hs-var">failureString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166325"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-233"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; failed after &quot;</span></span><span>
</span><span id="line-234"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679166324"><span class="hs-identifier hs-var">nb</span></a></span><span>
</span><span id="line-235"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679166324"><span class="hs-identifier hs-var">nb</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; test&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; tests:&quot;</span></span><span>
</span><span id="line-236"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-237"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Foundation.IO.Terminal.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. Sequential c =&gt; CountOf (Element c) -&gt; Element c -&gt; c
</span><a href="Foundation.Collection.Sequential.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">CountOf Char
</span><a href="#local-6989586621679166321"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;   use param: --seed &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166322"><span class="hs-identifier hs-var">seed</span></a></span><span>
</span><span id="line-238"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Foundation.IO.Terminal.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166323"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="annot"><a href="Foundation.Check.Main.html#pushGroup"><span class="hs-identifier hs-type">pushGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Foundation.Check.Types.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#TestResult"><span class="hs-identifier hs-type">TestResult</span></a></span><span>
</span><span id="line-241"></span><span id="pushGroup"><span class="annot"><span class="annottext">pushGroup :: String -&gt; [Test] -&gt; CheckMain TestResult
</span><a href="Foundation.Check.Main.html#pushGroup"><span class="hs-identifier hs-var hs-var">pushGroup</span></a></span></span><span> </span><span id="local-6989586621679166320"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166320"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679166319"><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166319"><span class="hs-identifier hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><span class="annottext">CheckMain () -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#whenGroupOnly"><span class="hs-identifier hs-var">whenGroupOnly</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Test] -&gt; Bool
</span><a href="Foundation.Check.Types.html#groupHasSubGroup"><span class="hs-identifier hs-var">groupHasSubGroup</span></a></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166319"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#displayCurrent"><span class="hs-identifier hs-var">displayCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166320"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
MonadState m =&gt;
(State m -&gt; (a, State m)) -&gt; m a
</span><a href="Foundation.Monad.State.html#withState"><span class="hs-identifier hs-var">withState</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679166317"><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166317"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166317"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">testPath :: DList String
</span><a href="Foundation.Check.Main.html#testPath"><span class="hs-identifier hs-var">testPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList String -&gt; Element (DList String) -&gt; DList String
</span><a href="#local-6989586621679166316"><span class="hs-identifier hs-var">push</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestState -&gt; DList String
</span><a href="Foundation.Check.Main.html#testPath"><span class="hs-identifier hs-var">testPath</span></a></span><span> </span><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166317"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166320"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">indent :: CountOf Char
</span><a href="Foundation.Check.Main.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; CountOf Char
</span><a href="Foundation.Check.Main.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166317"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../basement/html/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">CountOf Char
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621679166315"><span class="annot"><span class="annottext">[TestResult]
</span><a href="#local-6989586621679166315"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (collection :: * -&gt; *) (m :: * -&gt; *) a b.
(Mappable collection, Applicative m, Monad m) =&gt;
(a -&gt; m b) -&gt; collection a -&gt; m (collection b)
</span><a href="Foundation.Collection.Mappable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Test -&gt; CheckMain TestResult
</span><a href="Foundation.Check.Main.html#test"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166319"><span class="hs-identifier hs-var">list</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
MonadState m =&gt;
(State m -&gt; (a, State m)) -&gt; m a
</span><a href="Foundation.Monad.State.html#withState"><span class="hs-identifier hs-var">withState</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679166313"><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166313"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166313"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">testPath :: DList String
</span><a href="Foundation.Check.Main.html#testPath"><span class="hs-identifier hs-var">testPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList String -&gt; DList String
</span><a href="#local-6989586621679166312"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestState -&gt; DList String
</span><a href="Foundation.Check.Main.html#testPath"><span class="hs-identifier hs-var">testPath</span></a></span><span> </span><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166313"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">indent :: CountOf Char
</span><a href="Foundation.Check.Main.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; CountOf Char
</span><a href="Foundation.Check.Main.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">State CheckMain
</span><a href="#local-6989586621679166313"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. CountOf a -&gt; CountOf a -&gt; CountOf a
</span><a href="../../../../basement/html/src"><span class="hs-operator hs-var">`sizeSub`</span></a></span><span> </span><span class="annot"><span class="annottext">CountOf Char
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679166310"><span class="annot"><span class="annottext">totFail :: Element [CountOf TestResult]
</span><a href="#local-6989586621679166310"><span class="hs-identifier hs-var hs-var">totFail</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CountOf TestResult] -&gt; Element [CountOf TestResult]
</span><a href="#local-6989586621679166309"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">TestResult -&gt; CountOf TestResult
</span><a href="Foundation.Check.Main.html#nbFail"><span class="hs-identifier hs-var">nbFail</span></a></span><span> </span><span class="annot"><span class="annottext">[TestResult]
</span><a href="#local-6989586621679166315"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-247"></span><span>        </span><span id="local-6989586621679166308"><span class="annot"><span class="annottext">tot :: Element [CountOf TestResult]
</span><a href="#local-6989586621679166308"><span class="hs-identifier hs-var hs-var">tot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CountOf TestResult] -&gt; Element [CountOf TestResult]
</span><a href="#local-6989586621679166309"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">TestResult -&gt; CountOf TestResult
</span><a href="Foundation.Check.Main.html#nbTests"><span class="hs-identifier hs-var">nbTests</span></a></span><span> </span><span class="annot"><span class="annottext">[TestResult]
</span><a href="#local-6989586621679166315"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><span class="annottext">CheckMain () -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#whenGroupOnly"><span class="hs-identifier hs-var">whenGroupOnly</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Test] -&gt; Bool
</span><a href="Foundation.Check.Types.html#groupHasSubGroup"><span class="hs-identifier hs-var">groupHasSubGroup</span></a></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679166319"><span class="hs-identifier hs-var">list</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Element [CountOf TestResult]
</span><a href="#local-6989586621679166310"><span class="hs-identifier hs-var">totFail</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-249"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679166307"><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166307"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166307"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; CountOf TestResult -&gt; String -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#displayPropertyFailed"><span class="hs-identifier hs-var">displayPropertyFailed</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166320"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166307"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-251"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; CountOf TestResult -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#displayPropertySucceed"><span class="hs-identifier hs-var">displayPropertySucceed</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166320"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Element [CountOf TestResult]
</span><a href="#local-6989586621679166308"><span class="hs-identifier hs-var">tot</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
-&gt; CountOf TestResult
-&gt; CountOf TestResult
-&gt; [TestResult]
-&gt; TestResult
</span><a href="Foundation.Check.Types.html#GroupResult"><span class="hs-identifier hs-var">GroupResult</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166320"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Element [CountOf TestResult]
</span><a href="#local-6989586621679166310"><span class="hs-identifier hs-var">totFail</span></a></span><span> </span><span class="annot"><span class="annottext">Element [CountOf TestResult]
</span><a href="#local-6989586621679166308"><span class="hs-identifier hs-var">tot</span></a></span><span> </span><span class="annot"><span class="annottext">[TestResult]
</span><a href="#local-6989586621679166315"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621679166309"><span class="annot"><span class="annottext">sum :: [CountOf TestResult] -&gt; Element [CountOf TestResult]
</span><a href="#local-6989586621679166309"><span class="hs-identifier hs-var hs-var">sum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall collection a.
Foldable collection =&gt;
(a -&gt; Element collection -&gt; a) -&gt; a -&gt; collection -&gt; a
</span><a href="Foundation.Collection.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../basement/html/src"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="annot"><span class="annottext">Element [CountOf TestResult]
</span><span class="hs-number">0</span></span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621679166316"><span class="annot"><span class="annottext">push :: DList String -&gt; Element (DList String) -&gt; DList String
</span><a href="#local-6989586621679166316"><span class="hs-identifier hs-var hs-var">push</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c. Sequential c =&gt; c -&gt; Element c -&gt; c
</span><a href="Foundation.Collection.Sequential.html#snoc"><span class="hs-identifier hs-var">snoc</span></a></span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621679166312"><span class="annot"><span class="annottext">pop :: DList String -&gt; DList String
</span><a href="#local-6989586621679166312"><span class="hs-identifier hs-var hs-var">pop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. Sequential c =&gt; c -&gt; Maybe (c, Element c)
</span><a href="Foundation.Collection.Sequential.html#unsnoc"><span class="hs-identifier hs-var">unsnoc</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="annot"><a href="Foundation.Check.Main.html#testCheckPlan"><span class="hs-identifier hs-type">testCheckPlan</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#TestResult"><span class="hs-identifier hs-type">TestResult</span></a></span><span>
</span><span id="line-259"></span><span id="testCheckPlan"><span class="annot"><span class="annottext">testCheckPlan :: String -&gt; Check () -&gt; CheckMain TestResult
</span><a href="Foundation.Check.Main.html#testCheckPlan"><span class="hs-identifier hs-var hs-var">testCheckPlan</span></a></span></span><span> </span><span id="local-6989586621679166293"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166293"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679166292"><span class="annot"><span class="annottext">Check ()
</span><a href="#local-6989586621679166292"><span class="hs-identifier hs-var">actions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679166291"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166291"><span class="hs-identifier hs-var">seed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; Word64
</span><a href="Foundation.Check.Main.html#getSeed"><span class="hs-identifier hs-var">getSeed</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadState m =&gt; m (State m)
</span><a href="Foundation.Monad.State.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621679166290"><span class="annot"><span class="annottext">DList String
</span><a href="#local-6989586621679166290"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; DList String
</span><a href="Foundation.Check.Main.html#testPath"><span class="hs-identifier hs-var">testPath</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadState m =&gt; m (State m)
</span><a href="Foundation.Monad.State.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621679166289"><span class="annot"><span class="annottext">GenParams
</span><a href="#local-6989586621679166289"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Config -&gt; GenParams
</span><a href="Foundation.Check.Config.html#getGenParams"><span class="hs-identifier hs-var">getGenParams</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestState -&gt; Config
</span><a href="Foundation.Check.Main.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadState m =&gt; m (State m)
</span><a href="Foundation.Monad.State.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679166287"><span class="annot"><span class="annottext">rngIt :: Word64 -&gt; GenRng
</span><a href="#local-6989586621679166287"><span class="hs-identifier hs-var hs-var">rngIt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; [String] -&gt; Word64 -&gt; GenRng
</span><a href="Foundation.Check.Gen.html#genRng"><span class="hs-identifier hs-var">genRng</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166291"><span class="hs-identifier hs-var">seed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166293"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">DList String
</span><a href="#local-6989586621679166290"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679166285"><span class="annot"><span class="annottext">planState :: PlanState
</span><a href="#local-6989586621679166285"><span class="hs-identifier hs-var hs-var">planState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#PlanState"><span class="hs-identifier hs-type">PlanState</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">planRng :: Word64 -&gt; GenRng
</span><a href="Foundation.Check.Types.html#planRng"><span class="hs-identifier hs-var">planRng</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GenRng
</span><a href="#local-6989586621679166287"><span class="hs-identifier hs-var">rngIt</span></a></span><span>
</span><span id="line-266"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">planValidations :: CountOf TestResult
</span><a href="Foundation.Check.Types.html#planValidations"><span class="hs-identifier hs-var">planValidations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><span class="hs-number">0</span></span><span>
</span><span id="line-267"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">planParams :: GenParams
</span><a href="Foundation.Check.Types.html#planParams"><span class="hs-identifier hs-var">planParams</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenParams
</span><a href="#local-6989586621679166289"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-268"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">planFailures :: [TestResult]
</span><a href="Foundation.Check.Types.html#planFailures"><span class="hs-identifier hs-var">planFailures</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-269"></span><span>                              </span><span class="hs-special">}</span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621679166279"><span class="annot"><span class="annottext">PlanState
</span><a href="#local-6989586621679166279"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><a href="Foundation.Monad.State.html#runStateT"><span class="hs-identifier hs-var">runStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Check a -&gt; StateT PlanState IO a
</span><a href="Foundation.Check.Types.html#runCheck"><span class="hs-identifier hs-var">runCheck</span></a></span><span> </span><span class="annot"><span class="annottext">Check ()
</span><a href="#local-6989586621679166292"><span class="hs-identifier hs-var">actions</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanState
</span><a href="#local-6989586621679166285"><span class="hs-identifier hs-var">planState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679166277"><span class="annot"><span class="annottext">fails :: [TestResult]
</span><a href="#local-6989586621679166277"><span class="hs-identifier hs-var hs-var">fails</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanState -&gt; [TestResult]
</span><a href="Foundation.Check.Types.html#planFailures"><span class="hs-identifier hs-var">planFailures</span></a></span><span> </span><span class="annot"><span class="annottext">PlanState
</span><a href="#local-6989586621679166279"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall c. Collection c =&gt; c -&gt; Bool
</span><a href="Foundation.Collection.Collection.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[TestResult]
</span><a href="#local-6989586621679166277"><span class="hs-identifier hs-var">fails</span></a></span><span>
</span><span id="line-273"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; CountOf TestResult
-&gt; CountOf TestResult
-&gt; [TestResult]
-&gt; TestResult
</span><a href="Foundation.Check.Types.html#GroupResult"><span class="hs-identifier hs-var">GroupResult</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166293"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanState -&gt; CountOf TestResult
</span><a href="Foundation.Check.Types.html#planValidations"><span class="hs-identifier hs-var">planValidations</span></a></span><span> </span><span class="annot"><span class="annottext">PlanState
</span><a href="#local-6989586621679166279"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-275"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#displayCurrent"><span class="hs-identifier hs-var">displayCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166293"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-276"></span><span>            </span><span class="annot"><span class="annottext">forall (col :: * -&gt; *) (m :: * -&gt; *) a b.
(Mappable col, Applicative m, Monad m) =&gt;
col a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="Foundation.Collection.Mappable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="annot"><span class="annottext">[TestResult]
</span><a href="#local-6989586621679166277"><span class="hs-identifier hs-var">fails</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679166275"><span class="annot"><span class="annottext">TestResult
</span><a href="#local-6989586621679166275"><span class="hs-identifier hs-var">fail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestResult
</span><a href="#local-6989586621679166275"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-277"></span><span>                </span><span class="annot"><a href="Foundation.Check.Types.html#PropertyResult"><span class="hs-identifier hs-type">PropertyResult</span></a></span><span> </span><span id="local-6989586621679166274"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166274"><span class="hs-identifier hs-var">name'</span></a></span></span><span> </span><span id="local-6989586621679166273"><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166273"><span class="hs-identifier hs-var">nb</span></a></span></span><span> </span><span id="local-6989586621679166272"><span class="annot"><span class="annottext">PropertyResult
</span><a href="#local-6989586621679166272"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-278"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PropertyResult
</span><a href="#local-6989586621679166272"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-279"></span><span>                        </span><span class="annot"><span class="annottext">PropertyResult
</span><a href="Foundation.Check.Types.html#PropertySuccess"><span class="hs-identifier hs-var">PropertySuccess</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckMain () -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#whenVerbose"><span class="hs-identifier hs-var">whenVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; CountOf TestResult -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#displayPropertySucceed"><span class="hs-identifier hs-var">displayPropertySucceed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166293"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166274"><span class="hs-identifier hs-var">name'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166273"><span class="hs-identifier hs-var">nb</span></a></span><span>
</span><span id="line-280"></span><span>                        </span><span class="annot"><a href="Foundation.Check.Types.html#PropertyFailed"><span class="hs-identifier hs-type">PropertyFailed</span></a></span><span> </span><span id="local-6989586621679166271"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166271"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckMain () -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#whenErrorOnly"><span class="hs-identifier hs-var">whenErrorOnly</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; CountOf TestResult -&gt; String -&gt; CheckMain ()
</span><a href="Foundation.Check.Main.html#displayPropertyFailed"><span class="hs-identifier hs-var">displayPropertyFailed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166293"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166274"><span class="hs-identifier hs-var">name'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166273"><span class="hs-identifier hs-var">nb</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166271"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-281"></span><span>                </span><span class="annot"><span class="annottext">TestResult
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;should not happen&quot;</span></span><span>
</span><span id="line-282"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; CountOf TestResult
-&gt; CountOf TestResult
-&gt; [TestResult]
-&gt; TestResult
</span><a href="Foundation.Check.Types.html#GroupResult"><span class="hs-identifier hs-var">GroupResult</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166293"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Collection c =&gt; c -&gt; CountOf (Element c)
</span><a href="Foundation.Collection.Collection.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[TestResult]
</span><a href="#local-6989586621679166277"><span class="hs-identifier hs-var">fails</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanState -&gt; CountOf TestResult
</span><a href="Foundation.Check.Types.html#planValidations"><span class="hs-identifier hs-var">planValidations</span></a></span><span> </span><span class="annot"><span class="annottext">PlanState
</span><a href="#local-6989586621679166279"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TestResult]
</span><a href="#local-6989586621679166277"><span class="hs-identifier hs-var">fails</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><a href="Foundation.Check.Main.html#testProperty"><span class="hs-identifier hs-type">testProperty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Foundation.Check.Main.html#CheckMain"><span class="hs-identifier hs-type">CheckMain</span></a></span><span> </span><span class="annot"><a href="Foundation.Check.Types.html#TestResult"><span class="hs-identifier hs-type">TestResult</span></a></span><span>
</span><span id="line-285"></span><span id="testProperty"><span class="annot"><span class="annottext">testProperty :: String -&gt; Property -&gt; CheckMain TestResult
</span><a href="Foundation.Check.Main.html#testProperty"><span class="hs-identifier hs-var hs-var">testProperty</span></a></span></span><span> </span><span id="local-6989586621679166269"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166269"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679166268"><span class="annot"><span class="annottext">Property
</span><a href="#local-6989586621679166268"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621679166267"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166267"><span class="hs-identifier hs-var">seed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; Word64
</span><a href="Foundation.Check.Main.html#getSeed"><span class="hs-identifier hs-var">getSeed</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadState m =&gt; m (State m)
</span><a href="Foundation.Monad.State.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621679166266"><span class="annot"><span class="annottext">DList String
</span><a href="#local-6989586621679166266"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestState -&gt; DList String
</span><a href="Foundation.Check.Main.html#testPath"><span class="hs-identifier hs-var">testPath</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadState m =&gt; m (State m)
</span><a href="Foundation.Monad.State.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679166265"><span class="annot"><span class="annottext">rngIt :: Word64 -&gt; GenRng
</span><a href="#local-6989586621679166265"><span class="hs-identifier hs-var hs-var">rngIt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; [String] -&gt; Word64 -&gt; GenRng
</span><a href="Foundation.Check.Gen.html#genRng"><span class="hs-identifier hs-var">genRng</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166267"><span class="hs-identifier hs-var">seed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166269"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">DList String
</span><a href="#local-6989586621679166266"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span>    </span><span id="local-6989586621679166264"><span class="annot"><span class="annottext">GenParams
</span><a href="#local-6989586621679166264"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Config -&gt; GenParams
</span><a href="Foundation.Check.Config.html#getGenParams"><span class="hs-identifier hs-var">getGenParams</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestState -&gt; Config
</span><a href="Foundation.Check.Main.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadState m =&gt; m (State m)
</span><a href="Foundation.Monad.State.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621679166263"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166263"><span class="hs-identifier hs-var">maxTests</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Config -&gt; Word64
</span><a href="Foundation.Check.Config.html#numTests"><span class="hs-identifier hs-var">numTests</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestState -&gt; Config
</span><a href="Foundation.Check.Main.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadState m =&gt; m (State m)
</span><a href="Foundation.Monad.State.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679166261"><span class="annot"><span class="annottext">PropertyResult
</span><a href="#local-6989586621679166261"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679166260"><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166260"><span class="hs-identifier hs-var">nb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
-&gt; GenParams
-&gt; (Word64 -&gt; GenRng)
-&gt; Property
-&gt; IO (PropertyResult, CountOf TestResult)
</span><a href="Foundation.Check.html#iterateProperty"><span class="hs-identifier hs-var">iterateProperty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ty. Int -&gt; CountOf ty
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">CountOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. IntegralDownsize a b =&gt; a -&gt; b
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">integralDownsize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall source destination.
Cast source destination =&gt;
source -&gt; destination
</span><a href="../../../../basement/html/src"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166263"><span class="hs-identifier hs-var">maxTests</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenParams
</span><a href="#local-6989586621679166264"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GenRng
</span><a href="#local-6989586621679166265"><span class="hs-identifier hs-var">rngIt</span></a></span><span> </span><span class="annot"><span class="annottext">Property
</span><a href="#local-6989586621679166268"><span class="hs-identifier hs-var">prop</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PropertyResult
</span><a href="#local-6989586621679166261"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><a href="Foundation.Check.Types.html#PropertyFailed"><span class="hs-identifier hs-type">PropertyFailed</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckMain ()
</span><a href="Foundation.Check.Main.html#failed"><span class="hs-identifier hs-var">failed</span></a></span><span>
</span><span id="line-296"></span><span>        </span><span class="annot"><span class="annottext">PropertyResult
</span><a href="Foundation.Check.Types.html#PropertySuccess"><span class="hs-identifier hs-var">PropertySuccess</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckMain ()
</span><a href="Foundation.Check.Main.html#passed"><span class="hs-identifier hs-var">passed</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; CountOf TestResult -&gt; PropertyResult -&gt; TestResult
</span><a href="Foundation.Check.Types.html#PropertyResult"><span class="hs-identifier hs-var">PropertyResult</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166269"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">CountOf TestResult
</span><a href="#local-6989586621679166260"><span class="hs-identifier hs-var">nb</span></a></span><span> </span><span class="annot"><span class="annottext">PropertyResult
</span><a href="#local-6989586621679166261"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span></pre></body></html>