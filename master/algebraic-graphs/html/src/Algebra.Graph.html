<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module     : Algebra.Graph</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright  : (c) Andrey Mokhov 2016-2022</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License    : MIT (see the file LICENSE)</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer : andrey.mokhov@gmail.com</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability  : experimental</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- __Alga__ is a library for algebraic construction and manipulation of graphs</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- in Haskell. See &lt;https://github.com/snowleopard/alga-paper this paper&gt; for the</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- motivation behind the library, the underlying theory, and implementation details.</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- This module defines the core data type 'Graph' and associated algorithms.</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- For graphs that are known to be /non-empty/ at compile time, see</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- &quot;Algebra.Graph.NonEmpty&quot;. 'Graph' is an instance of type classes defined in</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- modules &quot;Algebra.Graph.Class&quot; and &quot;Algebra.Graph.HigherKinded.Class&quot;, which</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- can be used for polymorphic graph construction and manipulation.</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algebra.Graph</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Algebraic data type for graphs</span></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier">Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Basic graph construction primitives</span></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#empty"><span class="hs-identifier">empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertex"><span class="hs-identifier">vertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edge"><span class="hs-identifier">edge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#overlay"><span class="hs-identifier">overlay</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#connect"><span class="hs-identifier">connect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertices"><span class="hs-identifier">vertices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edges"><span class="hs-identifier">edges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#overlays"><span class="hs-identifier">overlays</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#connects"><span class="hs-identifier">connects</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph folding</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#foldg"><span class="hs-identifier">foldg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#buildg"><span class="hs-identifier">buildg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Relations on graphs</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#isSubgraphOf"><span class="hs-identifier">isSubgraphOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#%3D%3D%3D"><span class="hs-operator">(===)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph properties</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#isEmpty"><span class="hs-identifier">isEmpty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#size"><span class="hs-identifier">size</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#hasVertex"><span class="hs-identifier">hasVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#hasEdge"><span class="hs-identifier">hasEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertexCount"><span class="hs-identifier">vertexCount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeCount"><span class="hs-identifier">edgeCount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertexList"><span class="hs-identifier">vertexList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#edgeList"><span class="hs-identifier">edgeList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertexSet"><span class="hs-identifier">vertexSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeSet"><span class="hs-identifier">edgeSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#adjacencyList"><span class="hs-identifier">adjacencyList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Standard families of graphs</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#path"><span class="hs-identifier">path</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#circuit"><span class="hs-identifier">circuit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#clique"><span class="hs-identifier">clique</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#biclique"><span class="hs-identifier">biclique</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#star"><span class="hs-identifier">star</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#stars"><span class="hs-identifier">stars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#tree"><span class="hs-identifier">tree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#forest"><span class="hs-identifier">forest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#mesh"><span class="hs-identifier">mesh</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#torus"><span class="hs-identifier">torus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#deBruijn"><span class="hs-identifier">deBruijn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph transformation</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#removeVertex"><span class="hs-identifier">removeVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#removeEdge"><span class="hs-identifier">removeEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#replaceVertex"><span class="hs-identifier">replaceVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#mergeVertices"><span class="hs-identifier">mergeVertices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#splitVertex"><span class="hs-identifier">splitVertex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#transpose"><span class="hs-identifier">transpose</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#induce"><span class="hs-identifier">induce</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#induceJust"><span class="hs-identifier">induceJust</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#simplify"><span class="hs-identifier">simplify</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#sparsify"><span class="hs-identifier">sparsify</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#sparsifyKL"><span class="hs-identifier">sparsifyKL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph composition</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#compose"><span class="hs-identifier">compose</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#box"><span class="hs-identifier">box</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Context</span></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#Context"><span class="hs-identifier">Context</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.html#context"><span class="hs-identifier">context</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Alternative</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">MonadPlus</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">runState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">get</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">put</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">toList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.String</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Tree</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Algebra.Graph.Internal.html"><span class="hs-identifier">Algebra.Graph.Internal</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Applicative</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Algebra.Graph.AdjacencyMap.html"><span class="hs-identifier">Algebra.Graph.AdjacencyMap</span></a></span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AM</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Algebra.Graph.AdjacencyIntMap.html"><span class="hs-identifier">Algebra.Graph.AdjacencyIntMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AIM</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Graph</span></a></span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">KL</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.IntSet</span></a></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IntSet</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span>                      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Tree</span></a></span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tree</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Exts</span></a></span><span>                      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Exts</span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">{-| The 'Graph' data type is a deep embedding of the core graph construction
primitives 'empty', 'vertex', 'overlay' and 'connect'. We define a 'Num'
instance as a convenient notation for working with graphs:

@
0           == 'vertex' 0
1 + 2       == 'overlay' ('vertex' 1) ('vertex' 2)
1 * 2       == 'connect' ('vertex' 1) ('vertex' 2)
1 + 2 * 3   == 'overlay' ('vertex' 1) ('connect' ('vertex' 2) ('vertex' 3))
1 * (2 + 3) == 'connect' ('vertex' 1) ('overlay' ('vertex' 2) ('vertex' 3))
@

__Note:__ the 'Num' instance does not satisfy several &quot;customary laws&quot; of 'Num',
which dictate that 'fromInteger' @0@ and 'fromInteger' @1@ should act as
additive and multiplicative identities, and 'negate' as additive inverse.
Nevertheless, overloading 'fromInteger', '+' and '*' is very convenient when
working with algebraic graphs; we hope that in future Haskell's Prelude will
provide a more fine-grained class hierarchy for algebraic structures, which we
would be able to utilise without violating any laws.

The 'Eq' instance is currently implemented using the 'AM.AdjacencyMap' as the
/canonical graph representation/ and satisfies all axioms of algebraic graphs:

    * 'overlay' is commutative and associative:

        &gt;       x + y == y + x
        &gt; x + (y + z) == (x + y) + z

    * 'connect' is associative and has 'empty' as the identity:

        &gt;   x * empty == x
        &gt;   empty * x == x
        &gt; x * (y * z) == (x * y) * z

    * 'connect' distributes over 'overlay':

        &gt; x * (y + z) == x * y + x * z
        &gt; (x + y) * z == x * z + y * z

    * 'connect' can be decomposed:

        &gt; x * y * z == x * y + x * z + y * z

The following useful theorems can be proved from the above set of axioms.

    * 'overlay' has 'empty' as the identity and is idempotent:

        &gt;   x + empty == x
        &gt;   empty + x == x
        &gt;       x + x == x

    * Absorption and saturation of 'connect':

        &gt; x * y + x + y == x * y
        &gt;     x * x * x == x * x

When specifying the time and memory complexity of graph algorithms, /n/ will
denote the number of vertices in the graph, /m/ will denote the number of
edges in the graph, and /s/ will denote the /size/ of the corresponding
'Graph' expression. For example, if @g@ is a 'Graph' then /n/, /m/ and /s/ can
be computed as follows:

@n == 'vertexCount' g
m == 'edgeCount' g
s == 'size' g@

Note that 'size' counts all leaves of the expression:

@'vertexCount' 'empty'           == 0
'size'        'empty'           == 1
'vertexCount' ('vertex' x)      == 1
'size'        ('vertex' x)      == 1
'vertexCount' ('empty' + 'empty') == 0
'size'        ('empty' + 'empty') == 2@

Converting a 'Graph' to the corresponding 'AM.AdjacencyMap' takes /O(s + m * log(m))/
time and /O(s + m)/ memory. This is also the complexity of the graph equality
test, because it is currently implemented by converting graph expressions to
canonical representations based on adjacency maps.

The total order on graphs is defined using /size-lexicographic/ comparison:

* Compare the number of vertices. In case of a tie, continue.
* Compare the sets of vertices. In case of a tie, continue.
* Compare the number of edges. In case of a tie, continue.
* Compare the sets of edges.

Here are a few examples:

@'vertex' 1 &lt; 'vertex' 2
'vertex' 3 &lt; 'edge' 1 2
'vertex' 1 &lt; 'edge' 1 1
'edge' 1 1 &lt; 'edge' 1 2
'edge' 1 2 &lt; 'edge' 1 1 + 'edge' 2 2
'edge' 1 2 &lt; 'edge' 1 3@

Note that the resulting order refines the 'isSubgraphOf' relation and is
compatible with 'overlay' and 'connect' operations:

@'isSubgraphOf' x y ==&gt; x &lt;= y@

@'empty' &lt;= x
x     &lt;= x + y
x + y &lt;= x * y@

Deforestation (fusion) is implemented for some functions in this module. This
means that when a function tagged as a \&quot;good producer\&quot; is composed with a
function tagged as a \&quot;good consumer\&quot;, the intermediate structure will not be
built.
-}</span><span>
</span><span id="line-183"></span><span id="local-6989586621679116448"><span id="local-6989586621679116449"></span></span><span class="hs-keyword">data</span><span> </span><span id="Graph"><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-var">Graph</span></a></span></span><span> </span><span id="local-6989586621679116899"><span class="annot"><a href="#local-6989586621679116899"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Empty"><span class="annot"><a href="Algebra.Graph.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span></span><span>
</span><span id="line-184"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="Vertex"><span class="annot"><a href="Algebra.Graph.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679116899"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-185"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="Overlay"><span class="annot"><a href="Algebra.Graph.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="Connect"><span class="annot"><a href="Algebra.Graph.html#Connect"><span class="hs-identifier hs-var">Connect</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>             </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679116430"><span id="local-6989586621679116432"><span id="local-6989586621679116442"><span class="annot"><span class="annottext">Int -&gt; Graph a -&gt; ShowS
forall a. Show a =&gt; Int -&gt; Graph a -&gt; ShowS
forall a. Show a =&gt; [Graph a] -&gt; ShowS
forall a. Show a =&gt; Graph a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Graph a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [Graph a] -&gt; ShowS
show :: Graph a -&gt; String
$cshow :: forall a. Show a =&gt; Graph a -&gt; String
showsPrec :: Int -&gt; Graph a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Graph a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (Graph a) x -&gt; Graph a
forall a x. Graph a -&gt; Rep (Graph a) x
$cto :: forall a x. Rep (Graph a) x -&gt; Graph a
$cfrom :: forall a x. Graph a -&gt; Rep (Graph a) x
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">{- Note [Functions for rewrite rules]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

This module contains several functions whose only purpose is to guide GHC
rewrite rules. The names of all such functions are suffixed with &quot;R&quot; so that it
is easier to distinguish them from others.

Why do we need them?

These functions are annotated with carefully chosen GHC pragmas that control
inlining, which would be impossible or unreliable if we used standard functions
instead. For example, the function 'eqR' has the following annotations:

    INLINE [2] eqR
    RULES &quot;eqR/Int&quot; eqR = eqIntR

The above tells GHC to rewrite 'eqR' to faster 'eqIntR' if possible (if the
types match), and -- importantly -- not to inline 'eqR' too early, before the
rewrite rule had a chance to fire.

We could have written the following rule instead:

    RULES &quot;eqIntR&quot; (==) = eqIntR

But that would have to rely on appropriate inlining behaviour of (==) which is
not under our control. We therefore choose the safe and more explicit path of
creating our own intermediate functions for guiding rewrite rules when needed.
-}</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">-- | 'fmap' is a good consumer and producer.</span><span>
</span><span id="line-219"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679116422"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679116419"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; Graph a -&gt; Graph b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></a></span></span><span> </span><span id="local-6989586621679116418"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679116418"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679116417"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116417"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116417"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679116418"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-pragma hs-type">fmap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679116880"><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116880"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116880"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621679116406"><span class="annot"><span class="annottext">rnf :: Graph a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="Algebra.Graph.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span>  </span><span id="local-6989586621679116404"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116404"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116404"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span> </span><span id="local-6989586621679116403"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116403"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116402"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116402"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116403"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">seq :: forall a b. a -&gt; b -&gt; b
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">`seq`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116402"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Connect"><span class="hs-identifier hs-type">Connect</span></a></span><span> </span><span id="local-6989586621679116401"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116401"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116400"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116400"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116401"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">seq :: forall a b. a -&gt; b -&gt; b
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">`seq`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116400"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- | __Note:__ this does not satisfy the usual ring laws; see 'Graph' for more</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- details.</span><span>
</span><span id="line-231"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679116397"><span id="local-6989586621679116875"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116875"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116875"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621679116389"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; Integer -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromInteger</span></a></span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621679116388"><span class="annot"><span class="annottext">+ :: Graph a -&gt; Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(+)</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621679116386"><span class="annot"><span class="annottext">* :: Graph a -&gt; Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(*)</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#Connect"><span class="hs-identifier hs-var">Connect</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621679116384"><span class="annot"><span class="annottext">signum :: Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621679116381"><span class="annot"><span class="annottext">abs :: Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621679116378"><span class="annot"><span class="annottext">negate :: Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679116869"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">IsString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116869"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">IsString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116869"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-240"></span><span>    </span><span id="local-6989586621679116372"><span class="annot"><span class="annottext">fromString :: String -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsString a =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromString</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- | `==` is a good consumer of both arguments.</span><span>
</span><span id="line-243"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679116369"><span id="local-6989586621679116867"><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116867"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116867"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621679116366"><span class="annot"><span class="annottext">== :: Graph a -&gt; Graph a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(==)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#eqR"><span class="hs-identifier hs-var">eqR</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- | 'compare' is a good consumer of both arguments.</span><span>
</span><span id="line-247"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679116350"><span id="local-6989586621679116352"><span id="local-6989586621679116354"><span id="local-6989586621679116356"><span id="local-6989586621679116358"><span id="local-6989586621679116360"><span id="local-6989586621679116865"><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116865"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116865"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621679116347"><span class="annot"><span class="annottext">compare :: Graph a -&gt; Graph a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Ordering
</span><a href="Algebra.Graph.html#ordR"><span class="hs-identifier hs-var">ordR</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- TODO: Find a more efficient equality check. Note that assuming the Strong</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- Exponential Time Hypothesis (SETH), it is impossible to compare two algebraic</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- graphs in O(s^1.99), i.e. a quadratic algorithm is the best one can hope for.</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- Check if two graphs are equal by converting them to their adjacency maps.</span><span>
</span><span id="line-255"></span><span id="local-6989586621679116344"><span class="annot"><a href="Algebra.Graph.html#eqR"><span class="hs-identifier hs-type">eqR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116344"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116344"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116344"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-256"></span><span id="eqR"><span class="annot"><span class="annottext">eqR :: forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#eqR"><span class="hs-identifier hs-var hs-var">eqR</span></a></span></span><span> </span><span id="local-6989586621679116336"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116336"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116335"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116335"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-var">toAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116336"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-var">toAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116335"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-257"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.html#eqR"><span class="hs-pragma hs-type">eqR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-258"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;eqR/Int&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.html#eqR"><span class="hs-pragma hs-type">eqR</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.html#eqIntR"><span class="hs-pragma hs-type">eqIntR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- Like 'eqR' but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-261"></span><span class="annot"><a href="Algebra.Graph.html#eqIntR"><span class="hs-identifier hs-type">eqIntR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-262"></span><span id="eqIntR"><span class="annot"><span class="annottext">eqIntR :: Graph Int -&gt; Graph Int -&gt; Bool
</span><a href="Algebra.Graph.html#eqIntR"><span class="hs-identifier hs-var hs-var">eqIntR</span></a></span></span><span> </span><span id="local-6989586621679116332"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679116332"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116331"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679116331"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph Int -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">toAdjacencyIntMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679116332"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">toAdjacencyIntMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679116331"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-263"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#eqIntR"><span class="hs-pragma hs-type">eqIntR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- TODO: Find a more efficient comparison.</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- Compare two graphs by converting them to their adjacency maps.</span><span>
</span><span id="line-267"></span><span id="local-6989586621679116329"><span class="annot"><a href="Algebra.Graph.html#ordR"><span class="hs-identifier hs-type">ordR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116329"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116329"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116329"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ordering</span></a></span></span><span>
</span><span id="line-268"></span><span id="ordR"><span class="annot"><span class="annottext">ordR :: forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Ordering
</span><a href="Algebra.Graph.html#ordR"><span class="hs-identifier hs-var hs-var">ordR</span></a></span></span><span> </span><span id="local-6989586621679116323"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116323"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116322"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116322"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-var">toAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116323"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-var">toAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116322"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.html#ordR"><span class="hs-pragma hs-type">ordR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-270"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;ordR/Int&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.html#ordR"><span class="hs-pragma hs-type">ordR</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.html#ordIntR"><span class="hs-pragma hs-type">ordIntR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- Like 'ordR' but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-273"></span><span class="annot"><a href="Algebra.Graph.html#ordIntR"><span class="hs-identifier hs-type">ordIntR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ordering</span></a></span><span>
</span><span id="line-274"></span><span id="ordIntR"><span class="annot"><span class="annottext">ordIntR :: Graph Int -&gt; Graph Int -&gt; Ordering
</span><a href="Algebra.Graph.html#ordIntR"><span class="hs-identifier hs-var hs-var">ordIntR</span></a></span></span><span> </span><span id="local-6989586621679116320"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679116320"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116319"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679116319"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph Int -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">toAdjacencyIntMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679116320"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph Int -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">toAdjacencyIntMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679116319"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#ordIntR"><span class="hs-pragma hs-type">ordIntR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">-- TODO: It should be a good consumer of its second argument too.</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- | `&lt;*&gt;` is a good consumer of its first argument and a good producer.</span><span>
</span><span id="line-279"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679116309"><span id="local-6989586621679116311"><span id="local-6989586621679116313"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679116307"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679116306"><span class="annot"><span class="annottext">Graph (a -&gt; b)
</span><a href="#local-6989586621679116306"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679116305"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. Graph (a -&gt; b) -&gt; Graph a -&gt; Graph b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></a></span></span><span> </span><span id="local-6989586621679116304"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116304"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679116303"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116303"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116302"><span class="annot"><span class="annottext">b -&gt; r
</span><a href="#local-6989586621679116302"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116301"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116301"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116300"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116300"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116303"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679116299"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679116299"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116303"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; r
</span><a href="#local-6989586621679116302"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679116299"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116301"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116300"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116304"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116301"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116300"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Graph (a -&gt; b)
</span><a href="#local-6989586621679116306"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;*&gt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">-- | `&gt;&gt;=` is a good consumer and producer.</span><span>
</span><span id="line-285"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679116294"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621679116290"><span class="annot"><span class="annottext">return :: forall a. a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621679116289"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116289"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679116288"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. Graph a -&gt; (a -&gt; Graph b) -&gt; Graph b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></a></span></span><span> </span><span id="local-6989586621679116287"><span class="annot"><span class="annottext">a -&gt; Graph b
</span><a href="#local-6989586621679116287"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679116286"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116286"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116285"><span class="annot"><span class="annottext">b -&gt; r
</span><a href="#local-6989586621679116285"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116284"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116284"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116283"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116283"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116286"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="Algebra.Graph.html#composeR"><span class="hs-identifier hs-var">composeR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116286"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; r
</span><a href="#local-6989586621679116285"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116284"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116283"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; Graph b
</span><a href="#local-6989586621679116287"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116284"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116283"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116289"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&gt;&gt;=</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679116274"><span id="local-6989586621679116276"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Alternative</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621679116272"><span class="annot"><span class="annottext">empty :: forall a. Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621679116270"><span class="annot"><span class="annottext">&lt;|&gt; :: forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;|&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">MonadPlus</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-295"></span><span>    </span><span id="local-6989586621679116260"><span class="annot"><span class="annottext">mzero :: forall a. Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mzero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span id="local-6989586621679116258"><span class="annot"><span class="annottext">mplus :: forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mplus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-comment">-- | Defined via 'overlay'.</span><span>
</span><span id="line-299"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679116252"><span id="local-6989586621679116254"><span id="local-6989586621679116820"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116820"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621679116250"><span class="annot"><span class="annottext">&lt;&gt; :: Graph a -&gt; Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- | Defined via 'overlay' and 'empty'.</span><span>
</span><span id="line-303"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679116243"><span id="local-6989586621679116245"><span id="local-6989586621679116818"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116818"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-304"></span><span>    </span><span id="local-6989586621679116241"><span class="annot"><span class="annottext">mempty :: Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-comment">-- | Construct the /empty graph/. An alias for the constructor 'Empty'.</span><span>
</span><span id="line-307"></span><span class="hs-comment">--</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- 'isEmpty'     empty == True</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- 'hasVertex' x empty == False</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- 'vertexCount' empty == 0</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- 'edgeCount'   empty == 0</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- 'size'        empty == 1</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-315"></span><span id="local-6989586621679116240"><span class="annot"><a href="Algebra.Graph.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116240"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-316"></span><span id="empty"><span class="annot"><span class="annottext">empty :: forall a. Graph a
</span><a href="Algebra.Graph.html#empty"><span class="hs-identifier hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-317"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#empty"><span class="hs-pragma hs-type">empty</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- | Construct the graph comprising /a single isolated vertex/. An alias for the</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- constructor 'Vertex'.</span><span>
</span><span id="line-321"></span><span class="hs-comment">--</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- 'isEmpty'     (vertex x) == False</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- 'hasVertex' x (vertex y) == (x == y)</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- 'vertexCount' (vertex x) == 1</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- 'edgeCount'   (vertex x) == 0</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- 'size'        (vertex x) == 1</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-329"></span><span id="local-6989586621679116887"><span class="annot"><a href="Algebra.Graph.html#vertex"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679116887"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116887"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-330"></span><span id="vertex"><span class="annot"><span class="annottext">vertex :: forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#vertex"><span class="hs-identifier hs-var hs-var">vertex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span>
</span><span id="line-331"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertex"><span class="hs-pragma hs-type">vertex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">-- | Construct the graph comprising /a single edge/.</span><span>
</span><span id="line-334"></span><span class="hs-comment">--</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- edge x y               == 'connect' ('vertex' x) ('vertex' y)</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- 'hasEdge' x y (edge x y) == True</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- 'edgeCount'   (edge x y) == 1</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- 'vertexCount' (edge 1 1) == 1</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- 'vertexCount' (edge 1 2) == 2</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-342"></span><span id="local-6989586621679116817"><span class="annot"><a href="Algebra.Graph.html#edge"><span class="hs-identifier hs-type">edge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679116817"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116817"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116817"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-343"></span><span id="edge"><span class="annot"><span class="annottext">edge :: forall a. a -&gt; a -&gt; Graph a
</span><a href="Algebra.Graph.html#edge"><span class="hs-identifier hs-var hs-var">edge</span></a></span></span><span> </span><span id="local-6989586621679116239"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116239"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116238"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116238"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#connect"><span class="hs-identifier hs-var">connect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116239"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116238"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edge"><span class="hs-pragma hs-type">edge</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- | /Overlay/ two graphs. An alias for the constructor 'Overlay'. This is a</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- commutative, associative and idempotent operation with the identity 'empty'.</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- Complexity: /O(1)/ time and memory, /O(s1 + s2)/ size.</span><span>
</span><span id="line-349"></span><span class="hs-comment">--</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- 'isEmpty'     (overlay x y) == 'isEmpty'   x   &amp;&amp; 'isEmpty'   y</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- 'hasVertex' z (overlay x y) == 'hasVertex' z x || 'hasVertex' z y</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- 'vertexCount' (overlay x y) &gt;= 'vertexCount' x</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- 'vertexCount' (overlay x y) &lt;= 'vertexCount' x + 'vertexCount' y</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- 'edgeCount'   (overlay x y) &gt;= 'edgeCount' x</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- 'edgeCount'   (overlay x y) &lt;= 'edgeCount' x   + 'edgeCount' y</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- 'size'        (overlay x y) == 'size' x        + 'size' y</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- 'vertexCount' (overlay 1 2) == 2</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- 'edgeCount'   (overlay 1 2) == 0</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-361"></span><span id="local-6989586621679116237"><span class="annot"><a href="Algebra.Graph.html#overlay"><span class="hs-identifier hs-type">overlay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116237"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116237"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116237"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-362"></span><span id="overlay"><span class="annot"><span class="annottext">overlay :: forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#overlay"><span class="hs-identifier hs-var hs-var">overlay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span><span>
</span><span id="line-363"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#overlay"><span class="hs-pragma hs-type">overlay</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-comment">-- | /Connect/ two graphs. An alias for the constructor 'Connect'. This is an</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- associative operation with the identity 'empty', which distributes over</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- 'overlay' and obeys the decomposition axiom.</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- Complexity: /O(1)/ time and memory, /O(s1 + s2)/ size. Note that the number</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- of edges in the resulting graph is quadratic with respect to the number of</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- vertices of the arguments: /m = O(m1 + m2 + n1 * n2)/.</span><span>
</span><span id="line-371"></span><span class="hs-comment">--</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- 'isEmpty'     (connect x y) == 'isEmpty'   x   &amp;&amp; 'isEmpty'   y</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- 'hasVertex' z (connect x y) == 'hasVertex' z x || 'hasVertex' z y</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- 'vertexCount' (connect x y) &gt;= 'vertexCount' x</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- 'vertexCount' (connect x y) &lt;= 'vertexCount' x + 'vertexCount' y</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- 'edgeCount'   (connect x y) &gt;= 'edgeCount' x</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- 'edgeCount'   (connect x y) &gt;= 'edgeCount' y</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- 'edgeCount'   (connect x y) &gt;= 'vertexCount' x * 'vertexCount' y</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- 'edgeCount'   (connect x y) &lt;= 'vertexCount' x * 'vertexCount' y + 'edgeCount' x + 'edgeCount' y</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- 'size'        (connect x y) == 'size' x        + 'size' y</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- 'vertexCount' (connect 1 2) == 2</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- 'edgeCount'   (connect 1 2) == 1</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-385"></span><span id="local-6989586621679116236"><span class="annot"><a href="Algebra.Graph.html#connect"><span class="hs-identifier hs-type">connect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116236"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116236"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116236"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-386"></span><span id="connect"><span class="annot"><span class="annottext">connect :: forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#connect"><span class="hs-identifier hs-var hs-var">connect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#Connect"><span class="hs-identifier hs-var">Connect</span></a></span><span>
</span><span id="line-387"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#connect"><span class="hs-pragma hs-type">connect</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-comment">-- TODO: Simplify the definition to `overlays . map vertex` while preserving</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- goodness properties (which is not trivial since overlays is only a good</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- consumer of lists and not of lists of graphs).</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- | Construct the graph comprising a given list of isolated vertices.</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-395"></span><span class="hs-comment">--</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- Good consumer of lists and producer of graphs.</span><span>
</span><span id="line-397"></span><span class="hs-comment">--</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- vertices []            == 'empty'</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- vertices [x]           == 'vertex' x</span><span>
</span><span id="line-401"></span><span class="hs-comment">-- vertices               == 'overlays' . map 'vertex'</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- 'hasVertex' x . vertices == 'elem' x</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- 'vertexCount' . vertices == 'length' . 'Data.List.nub'</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- 'vertexSet'   . vertices == Set.'Set.fromList'</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-406"></span><span id="local-6989586621679116815"><span class="annot"><a href="Algebra.Graph.html#vertices"><span class="hs-identifier hs-type">vertices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116815"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116815"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-407"></span><span id="vertices"><span class="annot"><span class="annottext">vertices :: forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#vertices"><span class="hs-identifier hs-var hs-var">vertices</span></a></span></span><span> </span><span id="local-6989586621679116235"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116235"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679116234"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116234"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116233"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116233"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116232"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116232"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall c a. c -&gt; (c -&gt; c -&gt; c) -&gt; (a -&gt; c) -&gt; [a] -&gt; c
</span><a href="Algebra.Graph.html#combineR"><span class="hs-identifier hs-var">combineR</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116234"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116232"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116233"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116235"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-408"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertices"><span class="hs-pragma hs-type">vertices</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="hs-comment">-- | Construct the graph from a list of edges.</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-413"></span><span class="hs-comment">--</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- Good consumer of lists and producer of graphs.</span><span>
</span><span id="line-415"></span><span class="hs-comment">--</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- edges []          == 'empty'</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- edges [(x,y)]     == 'edge' x y</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- edges             == 'overlays' . 'map' ('uncurry' 'edge')</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- 'edgeCount' . edges == 'length' . 'Data.List.nub'</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-422"></span><span id="local-6989586621679116810"><span class="annot"><a href="Algebra.Graph.html#edges"><span class="hs-identifier hs-type">edges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116810"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679116810"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116810"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-423"></span><span id="edges"><span class="annot"><span class="annottext">edges :: forall a. [(a, a)] -&gt; Graph a
</span><a href="Algebra.Graph.html#edges"><span class="hs-identifier hs-var hs-var">edges</span></a></span></span><span> </span><span id="local-6989586621679116230"><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679116230"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679116229"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116229"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116228"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116228"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116227"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116227"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116226"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116226"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall c a. c -&gt; (c -&gt; c -&gt; c) -&gt; (a -&gt; c) -&gt; [a] -&gt; c
</span><a href="Algebra.Graph.html#combineR"><span class="hs-identifier hs-var">combineR</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116229"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116227"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679116225"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116225"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679116224"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116224"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116226"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116228"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116225"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116228"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116224"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679116230"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-424"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edges"><span class="hs-pragma hs-type">edges</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="hs-comment">-- | Overlay a given list of graphs.</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- Complexity: /O(L)/ time and memory, and /O(S)/ size, where /L/ is the length</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- of the given list, and /S/ is the sum of sizes of the graphs in the list.</span><span>
</span><span id="line-429"></span><span class="hs-comment">--</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- Good consumer of lists and producer of graphs.</span><span>
</span><span id="line-431"></span><span class="hs-comment">--</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- overlays []        == 'empty'</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- overlays [x]       == x</span><span>
</span><span id="line-435"></span><span class="hs-comment">-- overlays [x,y]     == 'overlay' x y</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- overlays           == 'foldr' 'overlay' 'empty'</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- 'isEmpty' . overlays == 'all' 'isEmpty'</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-439"></span><span id="local-6989586621679116223"><span class="annot"><a href="Algebra.Graph.html#overlays"><span class="hs-identifier hs-type">overlays</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116223"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116223"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-440"></span><span id="overlays"><span class="annot"><span class="annottext">overlays :: forall a. [Graph a] -&gt; Graph a
</span><a href="Algebra.Graph.html#overlays"><span class="hs-identifier hs-var hs-var">overlays</span></a></span></span><span> </span><span id="local-6989586621679116222"><span class="annot"><span class="annottext">[Graph a]
</span><a href="#local-6989586621679116222"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679116221"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116221"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116220"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116220"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116219"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116219"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116218"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116218"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall c a. c -&gt; (c -&gt; c -&gt; c) -&gt; (a -&gt; c) -&gt; [a] -&gt; c
</span><a href="Algebra.Graph.html#combineR"><span class="hs-identifier hs-var">combineR</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116221"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116219"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116221"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116220"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116219"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116218"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Graph a]
</span><a href="#local-6989586621679116222"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-441"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#overlays"><span class="hs-pragma hs-type">overlays</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-comment">-- | Connect a given list of graphs.</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- Complexity: /O(L)/ time and memory, and /O(S)/ size, where /L/ is the length</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- of the given list, and /S/ is the sum of sizes of the graphs in the list.</span><span>
</span><span id="line-446"></span><span class="hs-comment">--</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- Good consumer of lists and producer of graphs.</span><span>
</span><span id="line-448"></span><span class="hs-comment">--</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- connects []        == 'empty'</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- connects [x]       == x</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- connects [x,y]     == 'connect' x y</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- connects           == 'foldr' 'connect' 'empty'</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- 'isEmpty' . connects == 'all' 'isEmpty'</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-456"></span><span id="local-6989586621679116217"><span class="annot"><a href="Algebra.Graph.html#connects"><span class="hs-identifier hs-type">connects</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116217"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116217"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-457"></span><span id="connects"><span class="annot"><span class="annottext">connects :: forall a. [Graph a] -&gt; Graph a
</span><a href="Algebra.Graph.html#connects"><span class="hs-identifier hs-var hs-var">connects</span></a></span></span><span> </span><span id="local-6989586621679116216"><span class="annot"><span class="annottext">[Graph a]
</span><a href="#local-6989586621679116216"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679116215"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116215"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116214"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116214"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116213"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116213"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116212"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116212"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall c a. c -&gt; (c -&gt; c -&gt; c) -&gt; (a -&gt; c) -&gt; [a] -&gt; c
</span><a href="Algebra.Graph.html#combineR"><span class="hs-identifier hs-var">combineR</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116215"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116212"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116215"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116214"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116213"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116212"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Graph a]
</span><a href="#local-6989586621679116216"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-458"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#connects"><span class="hs-pragma hs-type">connects</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="hs-comment">-- Safe version of foldr with a map (the composition is optimized)</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- This is a good consumer of lists.</span><span>
</span><span id="line-462"></span><span id="local-6989586621679116811"><span id="local-6989586621679116812"><span class="annot"><a href="Algebra.Graph.html#combineR"><span class="hs-identifier hs-type">combineR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679116812"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116812"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116812"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116812"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116811"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116812"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116811"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116812"><span class="hs-identifier hs-type">c</span></a></span></span></span><span>
</span><span id="line-463"></span><span id="combineR"><span class="annot"><span class="annottext">combineR :: forall c a. c -&gt; (c -&gt; c -&gt; c) -&gt; (a -&gt; c) -&gt; [a] -&gt; c
</span><a href="Algebra.Graph.html#combineR"><span class="hs-identifier hs-var hs-var">combineR</span></a></span></span><span> </span><span id="local-6989586621679116211"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679116211"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116210"><span class="annot"><span class="annottext">c -&gt; c -&gt; c
</span><a href="#local-6989586621679116210"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116209"><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621679116209"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679116211"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; Maybe a
</span><a href="Algebra.Graph.Internal.html#foldr1Safe"><span class="hs-identifier hs-var">foldr1Safe</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; c -&gt; c
</span><a href="#local-6989586621679116210"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621679116209"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-464"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#combineR"><span class="hs-pragma hs-type">combineR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="hs-comment">-- | Generalised 'Graph' folding: recursively collapse a 'Graph' by applying</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- the provided functions to the leaves and internal nodes of the expression.</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- The order of arguments is: empty, vertex, overlay and connect.</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- Complexity: /O(s)/ applications of the given functions. As an example, the</span><span>
</span><span id="line-470"></span><span class="hs-comment">-- complexity of 'size' is /O(s)/, since 'const' and '+' have constant costs.</span><span>
</span><span id="line-471"></span><span class="hs-comment">--</span><span>
</span><span id="line-472"></span><span class="hs-comment">-- Good consumer.</span><span>
</span><span id="line-473"></span><span class="hs-comment">--</span><span>
</span><span id="line-474"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-475"></span><span class="hs-comment">-- foldg 'empty' 'vertex'        'overlay' 'connect'        == id</span><span>
</span><span id="line-476"></span><span class="hs-comment">-- foldg 'empty' 'vertex'        'overlay' ('flip' 'connect') == 'transpose'</span><span>
</span><span id="line-477"></span><span class="hs-comment">-- foldg 1     ('const' 1)     (+)     (+)            == 'size'</span><span>
</span><span id="line-478"></span><span class="hs-comment">-- foldg True  ('const' False) (&amp;&amp;)    (&amp;&amp;)           == 'isEmpty'</span><span>
</span><span id="line-479"></span><span class="hs-comment">-- foldg False (== x)        (||)    (||)           == 'hasVertex' x</span><span>
</span><span id="line-480"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-481"></span><span id="local-6989586621679116838"><span id="local-6989586621679116839"><span class="annot"><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-type">foldg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679116839"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116838"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116839"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116839"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116839"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116839"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116839"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116839"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116839"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116838"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116839"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-482"></span><span id="foldg"><span class="annot"><span class="annottext">foldg :: forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var hs-var">foldg</span></a></span></span><span> </span><span id="local-6989586621679116207"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679116207"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116206"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679116206"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116205"><span class="annot"><span class="annottext">b -&gt; b -&gt; b
</span><a href="#local-6989586621679116205"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116204"><span class="annot"><span class="annottext">b -&gt; b -&gt; b
</span><a href="#local-6989586621679116204"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph a -&gt; b
</span><a href="#local-6989586621679116203"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-484"></span><span>    </span><span id="local-6989586621679116203"><span class="annot"><span class="annottext">go :: Graph a -&gt; b
</span><a href="#local-6989586621679116203"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="Algebra.Graph.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679116207"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-485"></span><span>    </span><span class="annot"><a href="#local-6989586621679116203"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span>  </span><span id="local-6989586621679116202"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116202"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679116206"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116202"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-486"></span><span>    </span><span class="annot"><a href="#local-6989586621679116203"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span> </span><span id="local-6989586621679116201"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116201"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116200"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116200"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
</span><a href="#local-6989586621679116205"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph a -&gt; b
</span><a href="#local-6989586621679116203"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116201"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph a -&gt; b
</span><a href="#local-6989586621679116203"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116200"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>    </span><span class="annot"><a href="#local-6989586621679116203"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Connect"><span class="hs-identifier hs-type">Connect</span></a></span><span> </span><span id="local-6989586621679116199"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116199"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116198"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116198"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
</span><a href="#local-6989586621679116204"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph a -&gt; b
</span><a href="#local-6989586621679116203"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116199"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph a -&gt; b
</span><a href="#local-6989586621679116203"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116198"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.html#foldg"><span class="hs-pragma hs-type">foldg</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="annot"><span class="hs-pragma">&quot;foldg/Empty&quot;</span></span><span>   </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679116197"><span class="annot"><a href="#local-6989586621679116197"><span class="hs-pragma hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116196"><span class="annot"><a href="#local-6989586621679116196"><span class="hs-pragma hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116195"><span class="annot"><a href="#local-6989586621679116195"><span class="hs-pragma hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116194"><span class="annot"><a href="#local-6989586621679116194"><span class="hs-pragma hs-var">c</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-493"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#foldg"><span class="hs-pragma hs-type">foldg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116197"><span class="hs-pragma hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116196"><span class="hs-pragma hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116195"><span class="hs-pragma hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116194"><span class="hs-pragma hs-type">c</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.html#Empty"><span class="hs-pragma hs-type">Empty</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="#local-6989586621679116197"><span class="hs-pragma hs-type">e</span></a></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="annot"><span class="hs-pragma">&quot;foldg/Vertex&quot;</span></span><span>  </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679116193"><span class="annot"><a href="#local-6989586621679116193"><span class="hs-pragma hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116192"><span class="annot"><a href="#local-6989586621679116192"><span class="hs-pragma hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116191"><span class="annot"><a href="#local-6989586621679116191"><span class="hs-pragma hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116190"><span class="annot"><a href="#local-6989586621679116190"><span class="hs-pragma hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679116189"><span class="annot"><a href="#local-6989586621679116189"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#foldg"><span class="hs-pragma hs-type">foldg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116193"><span class="hs-pragma hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116192"><span class="hs-pragma hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116191"><span class="hs-pragma hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116190"><span class="hs-pragma hs-type">c</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.html#Vertex"><span class="hs-pragma hs-type">Vertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116189"><span class="hs-pragma hs-type">x</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="#local-6989586621679116192"><span class="hs-pragma hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116189"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="annot"><span class="hs-pragma">&quot;foldg/Overlay&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679116188"><span class="annot"><a href="#local-6989586621679116188"><span class="hs-pragma hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116187"><span class="annot"><a href="#local-6989586621679116187"><span class="hs-pragma hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116186"><span class="annot"><a href="#local-6989586621679116186"><span class="hs-pragma hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116185"><span class="annot"><a href="#local-6989586621679116185"><span class="hs-pragma hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679116184"><span class="annot"><a href="#local-6989586621679116184"><span class="hs-pragma hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116183"><span class="annot"><a href="#local-6989586621679116183"><span class="hs-pragma hs-var">y</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-499"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#foldg"><span class="hs-pragma hs-type">foldg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116188"><span class="hs-pragma hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116187"><span class="hs-pragma hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116186"><span class="hs-pragma hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116185"><span class="hs-pragma hs-type">c</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.html#Overlay"><span class="hs-pragma hs-type">Overlay</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116184"><span class="hs-pragma hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116183"><span class="hs-pragma hs-type">y</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="#local-6989586621679116186"><span class="hs-pragma hs-type">o</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.html#foldg"><span class="hs-pragma hs-type">foldg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116188"><span class="hs-pragma hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116187"><span class="hs-pragma hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116186"><span class="hs-pragma hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116185"><span class="hs-pragma hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116184"><span class="hs-pragma hs-type">x</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.html#foldg"><span class="hs-pragma hs-type">foldg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116188"><span class="hs-pragma hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116187"><span class="hs-pragma hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116186"><span class="hs-pragma hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116185"><span class="hs-pragma hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116183"><span class="hs-pragma hs-type">y</span></a></span><span class="hs-pragma">)</span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span class="annot"><span class="hs-pragma">&quot;foldg/Connect&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679116182"><span class="annot"><a href="#local-6989586621679116182"><span class="hs-pragma hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116181"><span class="annot"><a href="#local-6989586621679116181"><span class="hs-pragma hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116180"><span class="annot"><a href="#local-6989586621679116180"><span class="hs-pragma hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116179"><span class="annot"><a href="#local-6989586621679116179"><span class="hs-pragma hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679116178"><span class="annot"><a href="#local-6989586621679116178"><span class="hs-pragma hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116177"><span class="annot"><a href="#local-6989586621679116177"><span class="hs-pragma hs-var">y</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-502"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#foldg"><span class="hs-pragma hs-type">foldg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116182"><span class="hs-pragma hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116181"><span class="hs-pragma hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116180"><span class="hs-pragma hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116179"><span class="hs-pragma hs-type">c</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.html#Connect"><span class="hs-pragma hs-type">Connect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116178"><span class="hs-pragma hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116177"><span class="hs-pragma hs-type">y</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="#local-6989586621679116179"><span class="hs-pragma hs-type">c</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.html#foldg"><span class="hs-pragma hs-type">foldg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116182"><span class="hs-pragma hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116181"><span class="hs-pragma hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116180"><span class="hs-pragma hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116179"><span class="hs-pragma hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116178"><span class="hs-pragma hs-type">x</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.html#foldg"><span class="hs-pragma hs-type">foldg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116182"><span class="hs-pragma hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116181"><span class="hs-pragma hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116180"><span class="hs-pragma hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116179"><span class="hs-pragma hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116177"><span class="hs-pragma hs-type">y</span></a></span><span class="hs-pragma">)</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="hs-pragma">#-}</span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span class="hs-comment">-- | Build a graph given an interpretation of the four graph construction</span><span>
</span><span id="line-507"></span><span class="hs-comment">-- primitives 'empty', 'vertex', 'overlay' and 'connect', in this order. See</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- examples for further clarification.</span><span>
</span><span id="line-509"></span><span class="hs-comment">--</span><span>
</span><span id="line-510"></span><span class="hs-comment">-- Functions expressed with 'buildg' are good producers.</span><span>
</span><span id="line-511"></span><span class="hs-comment">--</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- buildg f                                                   == f 'empty' 'vertex' 'overlay' 'connect'</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- buildg (\\e _ _ _ -&gt; e)                                     == 'empty'</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- buildg (\\_ v _ _ -&gt; v x)                                   == 'vertex' x</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- buildg (\\e v o c -&gt; o ('foldg' e v o c x) ('foldg' e v o c y)) == 'overlay' x y</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- buildg (\\e v o c -&gt; c ('foldg' e v o c x) ('foldg' e v o c y)) == 'connect' x y</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- buildg (\\e v o _ -&gt; 'foldr' o e ('map' v xs))                  == 'vertices' xs</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- buildg (\\e v o c -&gt; 'foldg' e v o ('flip' c) g)                == 'transpose' g</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- 'foldg' e v o c (buildg f)                                   == f e v o c</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-522"></span><span id="local-6989586621679116844"><span class="annot"><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-type">buildg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679116845"><span class="annot"><a href="#local-6989586621679116845"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679116845"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116844"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116845"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116845"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116845"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116845"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116845"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116845"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116845"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116845"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116844"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-523"></span><span id="buildg"><span class="annot"><span class="annottext">buildg :: forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var hs-var">buildg</span></a></span></span><span> </span><span id="local-6989586621679116176"><span class="annot"><span class="annottext">forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r
</span><a href="#local-6989586621679116176"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r
</span><a href="#local-6989586621679116176"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#Connect"><span class="hs-identifier hs-var">Connect</span></a></span><span>
</span><span id="line-524"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.html#buildg"><span class="hs-pragma hs-type">buildg</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span class="hs-comment">-- | The 'isSubgraphOf' function takes two graphs and returns 'True' if the</span><span>
</span><span id="line-527"></span><span class="hs-comment">-- first graph is a /subgraph/ of the second.</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- Complexity: /O(s + m * log(m))/ time. Note that the number of edges /m/ of a</span><span>
</span><span id="line-529"></span><span class="hs-comment">-- graph can be quadratic with respect to the expression size /s/.</span><span>
</span><span id="line-530"></span><span class="hs-comment">--</span><span>
</span><span id="line-531"></span><span class="hs-comment">-- Good consumer of both arguments.</span><span>
</span><span id="line-532"></span><span class="hs-comment">--</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- isSubgraphOf 'empty'         x             ==  True</span><span>
</span><span id="line-535"></span><span class="hs-comment">-- isSubgraphOf ('vertex' x)    'empty'         ==  False</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- isSubgraphOf x             ('overlay' x y) ==  True</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- isSubgraphOf ('overlay' x y) ('connect' x y) ==  True</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- isSubgraphOf ('path' xs)     ('circuit' xs)  ==  True</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- isSubgraphOf x y                         ==&gt; x &lt;= y</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-541"></span><span id="local-6989586621679116175"><span class="annot"><a href="Algebra.Graph.html#isSubgraphOf"><span class="hs-identifier hs-type">isSubgraphOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116175"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116175"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116175"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-542"></span><span id="isSubgraphOf"><span class="annot"><span class="annottext">isSubgraphOf :: forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#isSubgraphOf"><span class="hs-identifier hs-var hs-var">isSubgraphOf</span></a></span></span><span> </span><span id="local-6989586621679116170"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116170"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116169"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116169"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; AdjacencyMap a -&gt; AdjacencyMap a -&gt; Bool
</span><a href="Algebra.Graph.AdjacencyMap.html#isSubgraphOf"><span class="hs-identifier hs-var">AM.isSubgraphOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-var">toAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116170"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-var">toAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116169"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.html#isSubgraphOf"><span class="hs-pragma hs-type">isSubgraphOf</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-544"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;isSubgraphOf/Int&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.html#isSubgraphOf"><span class="hs-pragma hs-type">isSubgraphOf</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.html#isSubgraphOfIntR"><span class="hs-pragma hs-type">isSubgraphOfIntR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span class="hs-comment">-- Like 'isSubgraphOf' but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-547"></span><span class="annot"><a href="Algebra.Graph.html#isSubgraphOfIntR"><span class="hs-identifier hs-type">isSubgraphOfIntR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-548"></span><span id="isSubgraphOfIntR"><span class="annot"><span class="annottext">isSubgraphOfIntR :: Graph Int -&gt; Graph Int -&gt; Bool
</span><a href="Algebra.Graph.html#isSubgraphOfIntR"><span class="hs-identifier hs-var hs-var">isSubgraphOfIntR</span></a></span></span><span> </span><span id="local-6989586621679116166"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679116166"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116165"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679116165"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AdjacencyIntMap -&gt; AdjacencyIntMap -&gt; Bool
</span><a href="Algebra.Graph.AdjacencyIntMap.html#isSubgraphOf"><span class="hs-identifier hs-var">AIM.isSubgraphOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph Int -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">toAdjacencyIntMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679116166"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph Int -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">toAdjacencyIntMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679116165"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#isSubgraphOfIntR"><span class="hs-pragma hs-type">isSubgraphOfIntR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="hs-comment">-- | Structural equality on graph expressions.</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- Complexity: /O(s)/ time.</span><span>
</span><span id="line-553"></span><span class="hs-comment">--</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-555"></span><span class="hs-comment">--     x === x         == True</span><span>
</span><span id="line-556"></span><span class="hs-comment">--     x === x + 'empty' == False</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- x + y === x + y     == True</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- 1 + 2 === 2 + 1     == False</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- x + y === x * y     == False</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-561"></span><span id="local-6989586621679116792"><span class="annot"><a href="Algebra.Graph.html#%3D%3D%3D"><span class="hs-operator hs-type">(===)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116792"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116792"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116792"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-562"></span><span class="annot"><span class="annottext">Graph a
</span><a href="Algebra.Graph.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>           </span><span id="%3D%3D%3D"><span class="annot"><span class="annottext">=== :: forall a. Eq a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#%3D%3D%3D"><span class="hs-operator hs-var hs-var">===</span></a></span></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="Algebra.Graph.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-563"></span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span>  </span><span id="local-6989586621679116157"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116157"><span class="hs-identifier hs-var">x1</span></a></span></span><span>   </span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Algebra.Graph.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span>  </span><span id="local-6989586621679116156"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116156"><span class="hs-identifier hs-var">x2</span></a></span></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116157"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span>  </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116156"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-564"></span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span> </span><span id="local-6989586621679116155"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116155"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679116154"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116154"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Algebra.Graph.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span> </span><span id="local-6989586621679116153"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116153"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679116152"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116152"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116155"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116153"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116154"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116152"><span class="hs-identifier hs-var">y2</span></a></span><span>
</span><span id="line-565"></span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Connect"><span class="hs-identifier hs-type">Connect</span></a></span><span> </span><span id="local-6989586621679116150"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116150"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679116149"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116149"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Algebra.Graph.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Connect"><span class="hs-identifier hs-type">Connect</span></a></span><span> </span><span id="local-6989586621679116148"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116148"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679116147"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116147"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116150"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116148"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116149"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116147"><span class="hs-identifier hs-var">y2</span></a></span><span>
</span><span id="line-566"></span><span class="annot"><span class="annottext">Graph a
</span><span class="hs-identifier">_</span></span><span>               </span><span class="annot"><a href="Algebra.Graph.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-567"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">===</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Bool</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="Algebra.Graph.html#%3D%3D%3D"><span class="hs-operator hs-type">===</span></a></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span class="hs-comment">-- | Check if a graph is empty.</span><span>
</span><span id="line-572"></span><span class="hs-comment">-- Complexity: /O(s)/ time.</span><span>
</span><span id="line-573"></span><span class="hs-comment">--</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- Good consumer.</span><span>
</span><span id="line-575"></span><span class="hs-comment">--</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- isEmpty 'empty'                       == True</span><span>
</span><span id="line-578"></span><span class="hs-comment">-- isEmpty ('overlay' 'empty' 'empty')       == True</span><span>
</span><span id="line-579"></span><span class="hs-comment">-- isEmpty ('vertex' x)                  == False</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- isEmpty ('removeVertex' x $ 'vertex' x) == True</span><span>
</span><span id="line-581"></span><span class="hs-comment">-- isEmpty ('removeEdge' x y $ 'edge' x y) == False</span><span>
</span><span id="line-582"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-583"></span><span id="local-6989586621679116790"><span class="annot"><a href="Algebra.Graph.html#isEmpty"><span class="hs-identifier hs-type">isEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116790"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-584"></span><span id="isEmpty"><span class="annot"><span class="annottext">isEmpty :: forall a. Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#isEmpty"><span class="hs-identifier hs-var hs-var">isEmpty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(&amp;&amp;)</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(&amp;&amp;)</span></a></span><span>
</span><span id="line-585"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#isEmpty"><span class="hs-pragma hs-type">isEmpty</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="hs-comment">-- | The /size/ of a graph, i.e. the number of leaves of the expression</span><span>
</span><span id="line-588"></span><span class="hs-comment">-- including 'empty' leaves.</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- Complexity: /O(s)/ time.</span><span>
</span><span id="line-590"></span><span class="hs-comment">--</span><span>
</span><span id="line-591"></span><span class="hs-comment">-- Good consumer.</span><span>
</span><span id="line-592"></span><span class="hs-comment">--</span><span>
</span><span id="line-593"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-594"></span><span class="hs-comment">-- size 'empty'         == 1</span><span>
</span><span id="line-595"></span><span class="hs-comment">-- size ('vertex' x)    == 1</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- size ('overlay' x y) == size x + size y</span><span>
</span><span id="line-597"></span><span class="hs-comment">-- size ('connect' x y) == size x + size y</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- size x             &gt;= 1</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- size x             &gt;= 'vertexCount' x</span><span>
</span><span id="line-600"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-601"></span><span id="local-6989586621679116789"><span class="annot"><a href="Algebra.Graph.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116789"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-602"></span><span id="size"><span class="annot"><span class="annottext">size :: forall a. Graph a -&gt; Int
</span><a href="Algebra.Graph.html#size"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(+)</span></a></span><span>
</span><span id="line-603"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#size"><span class="hs-pragma hs-type">size</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span class="hs-comment">-- | Check if a graph contains a given vertex.</span><span>
</span><span id="line-606"></span><span class="hs-comment">-- Complexity: /O(s)/ time.</span><span>
</span><span id="line-607"></span><span class="hs-comment">--</span><span>
</span><span id="line-608"></span><span class="hs-comment">-- Good consumer.</span><span>
</span><span id="line-609"></span><span class="hs-comment">--</span><span>
</span><span id="line-610"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-611"></span><span class="hs-comment">-- hasVertex x 'empty'            == False</span><span>
</span><span id="line-612"></span><span class="hs-comment">-- hasVertex x ('vertex' y)       == (x == y)</span><span>
</span><span id="line-613"></span><span class="hs-comment">-- hasVertex x . 'removeVertex' x == 'const' False</span><span>
</span><span id="line-614"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-615"></span><span id="local-6989586621679116788"><span class="annot"><a href="Algebra.Graph.html#hasVertex"><span class="hs-identifier hs-type">hasVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116788"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116788"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116788"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-616"></span><span id="hasVertex"><span class="annot"><span class="annottext">hasVertex :: forall a. Eq a =&gt; a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#hasVertex"><span class="hs-identifier hs-var hs-var">hasVertex</span></a></span></span><span> </span><span id="local-6989586621679116140"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116140"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116140"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(||)</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(||)</span></a></span><span>
</span><span id="line-617"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#hasVertex"><span class="hs-pragma hs-type">hasVertex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-618"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#hasVertex"><span class="hs-pragma hs-type">hasVertex</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Bool</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="hs-comment">{- Note [The implementation of hasEdge]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

We fold a graph into a function of type Int -&gt; Int where the Int stands for the
number of vertices of the specified edge that have been matched so far. The edge
belongs to the graph if we reach the number 2. Note that this algorithm can be
generalised to algebraic graphs of higher dimensions, e.g. we can similarly find
3-edges (triangles), 4-edges (tetrahedra), and k-edges in O(s) time.

The four graph constructors are interpreted as follows:

  * Empty       : the matching number is unchanged;
  * Vertex x    : if x matches the next vertex, the number is incremented;
  * Overlay x y : pick the best match in the two subexpressions;
  * Connect x y : match the subexpressions one after another.

Note that in the last two cases we can (and do) short-circuit the computation as
soon as the edge is fully matched in one of the subexpressions.
-}</span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span class="hs-comment">-- | Check if a graph contains a given edge.</span><span>
</span><span id="line-641"></span><span class="hs-comment">-- Complexity: /O(s)/ time.</span><span>
</span><span id="line-642"></span><span class="hs-comment">--</span><span>
</span><span id="line-643"></span><span class="hs-comment">-- Good consumer.</span><span>
</span><span id="line-644"></span><span class="hs-comment">--</span><span>
</span><span id="line-645"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-646"></span><span class="hs-comment">-- hasEdge x y 'empty'            == False</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- hasEdge x y ('vertex' z)       == False</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- hasEdge x y ('edge' x y)       == True</span><span>
</span><span id="line-649"></span><span class="hs-comment">-- hasEdge x y . 'removeEdge' x y == 'const' False</span><span>
</span><span id="line-650"></span><span class="hs-comment">-- hasEdge x y                  == 'elem' (x,y) . 'edgeList'</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-652"></span><span id="local-6989586621679116786"><span class="annot"><a href="Algebra.Graph.html#hasEdge"><span class="hs-identifier hs-type">hasEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116786"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116786"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116786"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116786"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-653"></span><span id="hasEdge"><span class="annot"><span class="annottext">hasEdge :: forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#hasEdge"><span class="hs-identifier hs-var hs-var">hasEdge</span></a></span></span><span> </span><span id="local-6989586621679116121"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116121"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679116120"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116120"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679116119"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116119"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Int
</span><a href="#local-6989586621679116118"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {t}. (Eq a, Num a) =&gt; (t -&gt; a) -&gt; (t -&gt; Int) -&gt; t -&gt; Int
</span><a href="#local-6989586621679116117"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall {t} {a} {t}.
(Eq t, Num t, Num a) =&gt;
(t -&gt; t) -&gt; (t -&gt; a) -&gt; t -&gt; a
</span><a href="#local-6989586621679116116"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679116119"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-654"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-655"></span><span>    </span><span id="local-6989586621679116118"><span class="annot"><span class="annottext">v :: a -&gt; Int -&gt; Int
</span><a href="#local-6989586621679116118"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116115"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116115"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116115"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116121"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-656"></span><span>    </span><span class="annot"><a href="#local-6989586621679116118"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span id="local-6989586621679116114"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116114"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116114"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116120"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-657"></span><span>    </span><span id="local-6989586621679116117"><span class="annot"><span class="annottext">o :: (t -&gt; a) -&gt; (t -&gt; Int) -&gt; t -&gt; Int
</span><a href="#local-6989586621679116117"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116103"><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679116103"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116102"><span class="annot"><span class="annottext">t -&gt; Int
</span><a href="#local-6989586621679116102"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679116101"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679116101"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679116103"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679116101"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-658"></span><span>        </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t -&gt; Int
</span><a href="#local-6989586621679116102"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679116101"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-659"></span><span>        </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">t -&gt; Int
</span><a href="#local-6989586621679116102"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679116101"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-660"></span><span>        </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-661"></span><span>    </span><span id="local-6989586621679116116"><span class="annot"><span class="annottext">c :: (t -&gt; t) -&gt; (t -&gt; a) -&gt; t -&gt; a
</span><a href="#local-6989586621679116116"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679116094"><span class="annot"><span class="annottext">t -&gt; t
</span><a href="#local-6989586621679116094"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116093"><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679116093"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679116092"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679116092"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t -&gt; t
</span><a href="#local-6989586621679116094"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679116092"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679116091"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679116091"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t -&gt; a
</span><a href="#local-6989586621679116093"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679116091"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-662"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#hasEdge"><span class="hs-pragma hs-type">hasEdge</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-663"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#hasEdge"><span class="hs-pragma hs-type">hasEdge</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Bool</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-664"></span><span>
</span><span id="line-665"></span><span class="hs-comment">-- | The number of vertices in a graph.</span><span>
</span><span id="line-666"></span><span class="hs-comment">-- Complexity: /O(s * log(n))/ time.</span><span>
</span><span id="line-667"></span><span class="hs-comment">--</span><span>
</span><span id="line-668"></span><span class="hs-comment">-- Good consumer.</span><span>
</span><span id="line-669"></span><span class="hs-comment">--</span><span>
</span><span id="line-670"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-671"></span><span class="hs-comment">-- vertexCount 'empty'             ==  0</span><span>
</span><span id="line-672"></span><span class="hs-comment">-- vertexCount ('vertex' x)        ==  1</span><span>
</span><span id="line-673"></span><span class="hs-comment">-- vertexCount                   ==  'length' . 'vertexList'</span><span>
</span><span id="line-674"></span><span class="hs-comment">-- vertexCount x \&lt; vertexCount y ==&gt; x \&lt; y</span><span>
</span><span id="line-675"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-676"></span><span id="local-6989586621679116779"><span class="annot"><a href="Algebra.Graph.html#vertexCount"><span class="hs-identifier hs-type">vertexCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116779"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116779"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-677"></span><span id="vertexCount"><span class="annot"><span class="annottext">vertexCount :: forall a. Ord a =&gt; Graph a -&gt; Int
</span><a href="Algebra.Graph.html#vertexCount"><span class="hs-identifier hs-var hs-var">vertexCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; Int
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.size</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Set a
</span><a href="Algebra.Graph.html#vertexSet"><span class="hs-identifier hs-var">vertexSet</span></a></span><span>
</span><span id="line-678"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertexCount"><span class="hs-pragma hs-type">vertexCount</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-679"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;vertexCount/Int&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertexCount"><span class="hs-pragma hs-type">vertexCount</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertexIntCountR"><span class="hs-pragma hs-type">vertexIntCountR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span class="hs-comment">-- Like 'vertexCount' but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-682"></span><span class="annot"><a href="Algebra.Graph.html#vertexIntCountR"><span class="hs-identifier hs-type">vertexIntCountR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-683"></span><span id="vertexIntCountR"><span class="annot"><span class="annottext">vertexIntCountR :: Graph Int -&gt; Int
</span><a href="Algebra.Graph.html#vertexIntCountR"><span class="hs-identifier hs-var hs-var">vertexIntCountR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; Int
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">IntSet.size</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int -&gt; IntSet
</span><a href="Algebra.Graph.html#vertexIntSetR"><span class="hs-identifier hs-var">vertexIntSetR</span></a></span><span>
</span><span id="line-684"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertexIntCountR"><span class="hs-pragma hs-type">vertexIntCountR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span class="hs-comment">-- | The number of edges in a graph.</span><span>
</span><span id="line-687"></span><span class="hs-comment">-- Complexity: /O(s + m * log(m))/ time. Note that the number of edges /m/ of a</span><span>
</span><span id="line-688"></span><span class="hs-comment">-- graph can be quadratic with respect to the expression size /s/.</span><span>
</span><span id="line-689"></span><span class="hs-comment">--</span><span>
</span><span id="line-690"></span><span class="hs-comment">-- Good consumer.</span><span>
</span><span id="line-691"></span><span class="hs-comment">--</span><span>
</span><span id="line-692"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-693"></span><span class="hs-comment">-- edgeCount 'empty'      == 0</span><span>
</span><span id="line-694"></span><span class="hs-comment">-- edgeCount ('vertex' x) == 0</span><span>
</span><span id="line-695"></span><span class="hs-comment">-- edgeCount ('edge' x y) == 1</span><span>
</span><span id="line-696"></span><span class="hs-comment">-- edgeCount            == 'length' . 'edgeList'</span><span>
</span><span id="line-697"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-698"></span><span id="local-6989586621679116084"><span class="annot"><a href="Algebra.Graph.html#edgeCount"><span class="hs-identifier hs-type">edgeCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116084"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116084"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-699"></span><span id="edgeCount"><span class="annot"><span class="annottext">edgeCount :: forall a. Ord a =&gt; Graph a -&gt; Int
</span><a href="Algebra.Graph.html#edgeCount"><span class="hs-identifier hs-var hs-var">edgeCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. AdjacencyMap a -&gt; Int
</span><a href="Algebra.Graph.AdjacencyMap.html#edgeCount"><span class="hs-identifier hs-var">AM.edgeCount</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-var">toAdjacencyMap</span></a></span><span>
</span><span id="line-700"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeCount"><span class="hs-pragma hs-type">edgeCount</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-701"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;edgeCount/Int&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeCount"><span class="hs-pragma hs-type">edgeCount</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeCountIntR"><span class="hs-pragma hs-type">edgeCountIntR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span class="hs-comment">-- Like 'edgeCount' but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-704"></span><span class="annot"><a href="Algebra.Graph.html#edgeCountIntR"><span class="hs-identifier hs-type">edgeCountIntR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-705"></span><span id="edgeCountIntR"><span class="annot"><span class="annottext">edgeCountIntR :: Graph Int -&gt; Int
</span><a href="Algebra.Graph.html#edgeCountIntR"><span class="hs-identifier hs-var hs-var">edgeCountIntR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AdjacencyIntMap -&gt; Int
</span><a href="Algebra.Graph.AdjacencyIntMap.html#edgeCount"><span class="hs-identifier hs-var">AIM.edgeCount</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">toAdjacencyIntMap</span></a></span><span>
</span><span id="line-706"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeCountIntR"><span class="hs-pragma hs-type">edgeCountIntR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-707"></span><span>
</span><span id="line-708"></span><span class="hs-comment">-- | The sorted list of vertices of a given graph.</span><span>
</span><span id="line-709"></span><span class="hs-comment">-- Complexity: /O(s * log(n))/ time and /O(n)/ memory.</span><span>
</span><span id="line-710"></span><span class="hs-comment">--</span><span>
</span><span id="line-711"></span><span class="hs-comment">-- Good consumer of graphs and producer of lists.</span><span>
</span><span id="line-712"></span><span class="hs-comment">--</span><span>
</span><span id="line-713"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-714"></span><span class="hs-comment">-- vertexList 'empty'      == []</span><span>
</span><span id="line-715"></span><span class="hs-comment">-- vertexList ('vertex' x) == [x]</span><span>
</span><span id="line-716"></span><span class="hs-comment">-- vertexList . 'vertices' == 'Data.List.nub' . 'Data.List.sort'</span><span>
</span><span id="line-717"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-718"></span><span id="local-6989586621679116771"><span class="annot"><a href="Algebra.Graph.html#vertexList"><span class="hs-identifier hs-type">vertexList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116771"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116771"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116771"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-719"></span><span id="vertexList"><span class="annot"><span class="annottext">vertexList :: forall a. Ord a =&gt; Graph a -&gt; [a]
</span><a href="Algebra.Graph.html#vertexList"><span class="hs-identifier hs-var hs-var">vertexList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Set a
</span><a href="Algebra.Graph.html#vertexSet"><span class="hs-identifier hs-var">vertexSet</span></a></span><span>
</span><span id="line-720"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertexList"><span class="hs-pragma hs-type">vertexList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-721"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;vertexList/Int&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertexList"><span class="hs-pragma hs-type">vertexList</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertexIntListR"><span class="hs-pragma hs-type">vertexIntListR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span class="hs-comment">-- Like 'vertexList' but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-724"></span><span class="annot"><a href="Algebra.Graph.html#vertexIntListR"><span class="hs-identifier hs-type">vertexIntListR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-725"></span><span id="vertexIntListR"><span class="annot"><span class="annottext">vertexIntListR :: Graph Int -&gt; [Int]
</span><a href="Algebra.Graph.html#vertexIntListR"><span class="hs-identifier hs-var hs-var">vertexIntListR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; [Int]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">IntSet.toList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int -&gt; IntSet
</span><a href="Algebra.Graph.html#vertexIntSetR"><span class="hs-identifier hs-var">vertexIntSetR</span></a></span><span>
</span><span id="line-726"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertexIntListR"><span class="hs-pragma hs-type">vertexIntListR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span class="hs-comment">-- | The sorted list of edges of a graph.</span><span>
</span><span id="line-729"></span><span class="hs-comment">-- Complexity: /O(s + m * log(m))/ time and /O(m)/ memory. Note that the number of</span><span>
</span><span id="line-730"></span><span class="hs-comment">-- edges /m/ of a graph can be quadratic with respect to the expression size /s/.</span><span>
</span><span id="line-731"></span><span class="hs-comment">--</span><span>
</span><span id="line-732"></span><span class="hs-comment">-- Good consumer of graphs and producer of lists.</span><span>
</span><span id="line-733"></span><span class="hs-comment">--</span><span>
</span><span id="line-734"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- edgeList 'empty'          == []</span><span>
</span><span id="line-736"></span><span class="hs-comment">-- edgeList ('vertex' x)     == []</span><span>
</span><span id="line-737"></span><span class="hs-comment">-- edgeList ('edge' x y)     == [(x,y)]</span><span>
</span><span id="line-738"></span><span class="hs-comment">-- edgeList ('star' 2 [3,1]) == [(2,1), (2,3)]</span><span>
</span><span id="line-739"></span><span class="hs-comment">-- edgeList . 'edges'        == 'Data.List.nub' . 'Data.List.sort'</span><span>
</span><span id="line-740"></span><span class="hs-comment">-- edgeList . 'transpose'    == 'Data.List.sort' . 'map' 'Data.Tuple.swap' . edgeList</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-742"></span><span id="local-6989586621679116768"><span class="annot"><a href="Algebra.Graph.html#edgeList"><span class="hs-identifier hs-type">edgeList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116768"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116768"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116768"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679116768"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-743"></span><span id="edgeList"><span class="annot"><span class="annottext">edgeList :: forall a. Ord a =&gt; Graph a -&gt; [(a, a)]
</span><a href="Algebra.Graph.html#edgeList"><span class="hs-identifier hs-var hs-var">edgeList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. AdjacencyMap a -&gt; [(a, a)]
</span><a href="Algebra.Graph.AdjacencyMap.html#edgeList"><span class="hs-identifier hs-var">AM.edgeList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-var">toAdjacencyMap</span></a></span><span>
</span><span id="line-744"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeList"><span class="hs-pragma hs-type">edgeList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-745"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;edgeList/Int&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeList"><span class="hs-pragma hs-type">edgeList</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeIntListR"><span class="hs-pragma hs-type">edgeIntListR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-746"></span><span>
</span><span id="line-747"></span><span class="hs-comment">-- Like 'edgeList' but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-748"></span><span class="annot"><a href="Algebra.Graph.html#edgeIntListR"><span class="hs-identifier hs-type">edgeIntListR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-749"></span><span id="edgeIntListR"><span class="annot"><span class="annottext">edgeIntListR :: Graph Int -&gt; [Edge]
</span><a href="Algebra.Graph.html#edgeIntListR"><span class="hs-identifier hs-var hs-var">edgeIntListR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AdjacencyIntMap -&gt; [Edge]
</span><a href="Algebra.Graph.AdjacencyIntMap.html#edgeList"><span class="hs-identifier hs-var">AIM.edgeList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">toAdjacencyIntMap</span></a></span><span>
</span><span id="line-750"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeIntListR"><span class="hs-pragma hs-type">edgeIntListR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-751"></span><span>
</span><span id="line-752"></span><span class="hs-comment">-- | The set of vertices of a given graph.</span><span>
</span><span id="line-753"></span><span class="hs-comment">-- Complexity: /O(s * log(n))/ time and /O(n)/ memory.</span><span>
</span><span id="line-754"></span><span class="hs-comment">--</span><span>
</span><span id="line-755"></span><span class="hs-comment">-- Good consumer.</span><span>
</span><span id="line-756"></span><span class="hs-comment">--</span><span>
</span><span id="line-757"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-758"></span><span class="hs-comment">-- vertexSet 'empty'      == Set.'Set.empty'</span><span>
</span><span id="line-759"></span><span class="hs-comment">-- vertexSet . 'vertex'   == Set.'Set.singleton'</span><span>
</span><span id="line-760"></span><span class="hs-comment">-- vertexSet . 'vertices' == Set.'Set.fromList'</span><span>
</span><span id="line-761"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-762"></span><span id="local-6989586621679116775"><span class="annot"><a href="Algebra.Graph.html#vertexSet"><span class="hs-identifier hs-type">vertexSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116775"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116775"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116775"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-763"></span><span id="vertexSet"><span class="annot"><span class="annottext">vertexSet :: forall a. Ord a =&gt; Graph a -&gt; Set a
</span><a href="Algebra.Graph.html#vertexSet"><span class="hs-identifier hs-var hs-var">vertexSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span>
</span><span id="line-764"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertexSet"><span class="hs-pragma hs-type">vertexSet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span class="hs-comment">-- Like 'vertexSet' but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-767"></span><span class="annot"><a href="Algebra.Graph.html#vertexIntSetR"><span class="hs-identifier hs-type">vertexIntSetR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">IntSet.IntSet</span></a></span><span>
</span><span id="line-768"></span><span id="vertexIntSetR"><span class="annot"><span class="annottext">vertexIntSetR :: Graph Int -&gt; IntSet
</span><a href="Algebra.Graph.html#vertexIntSetR"><span class="hs-identifier hs-var hs-var">vertexIntSetR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">IntSet.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntSet
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">IntSet.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; IntSet -&gt; IntSet
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">IntSet.union</span></a></span><span> </span><span class="annot"><span class="annottext">IntSet -&gt; IntSet -&gt; IntSet
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">IntSet.union</span></a></span><span>
</span><span id="line-769"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#vertexIntSetR"><span class="hs-pragma hs-type">vertexIntSetR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-770"></span><span>
</span><span id="line-771"></span><span class="hs-comment">-- | The set of edges of a given graph.</span><span>
</span><span id="line-772"></span><span class="hs-comment">-- Complexity: /O(s * log(m))/ time and /O(m)/ memory.</span><span>
</span><span id="line-773"></span><span class="hs-comment">--</span><span>
</span><span id="line-774"></span><span class="hs-comment">-- Good consumer.</span><span>
</span><span id="line-775"></span><span class="hs-comment">--</span><span>
</span><span id="line-776"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-777"></span><span class="hs-comment">-- edgeSet 'empty'      == Set.'Set.empty'</span><span>
</span><span id="line-778"></span><span class="hs-comment">-- edgeSet ('vertex' x) == Set.'Set.empty'</span><span>
</span><span id="line-779"></span><span class="hs-comment">-- edgeSet ('edge' x y) == Set.'Set.singleton' (x,y)</span><span>
</span><span id="line-780"></span><span class="hs-comment">-- edgeSet . 'edges'    == Set.'Set.fromList'</span><span>
</span><span id="line-781"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-782"></span><span id="local-6989586621679116761"><span class="annot"><a href="Algebra.Graph.html#edgeSet"><span class="hs-identifier hs-type">edgeSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116761"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116761"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116761"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679116761"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-783"></span><span id="edgeSet"><span class="annot"><span class="annottext">edgeSet :: forall a. Ord a =&gt; Graph a -&gt; Set (a, a)
</span><a href="Algebra.Graph.html#edgeSet"><span class="hs-identifier hs-var hs-var">edgeSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; AdjacencyMap a -&gt; Set (a, a)
</span><a href="Algebra.Graph.AdjacencyMap.html#edgeSet"><span class="hs-identifier hs-var">AM.edgeSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-var">toAdjacencyMap</span></a></span><span>
</span><span id="line-784"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeSet"><span class="hs-pragma hs-type">edgeSet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-785"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;edgeSet/Int&quot;</span></span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeSet"><span class="hs-pragma hs-type">edgeSet</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeIntSetR"><span class="hs-pragma hs-type">edgeIntSetR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-786"></span><span>
</span><span id="line-787"></span><span class="hs-comment">-- Like 'edgeSet' but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-788"></span><span class="annot"><a href="Algebra.Graph.html#edgeIntSetR"><span class="hs-identifier hs-type">edgeIntSetR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-789"></span><span id="edgeIntSetR"><span class="annot"><span class="annottext">edgeIntSetR :: Graph Int -&gt; Set Edge
</span><a href="Algebra.Graph.html#edgeIntSetR"><span class="hs-identifier hs-var hs-var">edgeIntSetR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AdjacencyIntMap -&gt; Set Edge
</span><a href="Algebra.Graph.AdjacencyIntMap.html#edgeSet"><span class="hs-identifier hs-var">AIM.edgeSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var">toAdjacencyIntMap</span></a></span><span>
</span><span id="line-790"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#edgeIntSetR"><span class="hs-pragma hs-type">edgeIntSetR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-791"></span><span>
</span><span id="line-792"></span><span class="hs-comment">-- | The sorted /adjacency list/ of a graph.</span><span>
</span><span id="line-793"></span><span class="hs-comment">-- Complexity: /O(n + m)/ time and memory.</span><span>
</span><span id="line-794"></span><span class="hs-comment">--</span><span>
</span><span id="line-795"></span><span class="hs-comment">-- Good consumer.</span><span>
</span><span id="line-796"></span><span class="hs-comment">--</span><span>
</span><span id="line-797"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-798"></span><span class="hs-comment">-- adjacencyList 'empty'          == []</span><span>
</span><span id="line-799"></span><span class="hs-comment">-- adjacencyList ('vertex' x)     == [(x, [])]</span><span>
</span><span id="line-800"></span><span class="hs-comment">-- adjacencyList ('edge' 1 2)     == [(1, [2]), (2, [])]</span><span>
</span><span id="line-801"></span><span class="hs-comment">-- adjacencyList ('star' 2 [3,1]) == [(1, []), (2, [1,3]), (3, [])]</span><span>
</span><span id="line-802"></span><span class="hs-comment">-- 'stars' . adjacencyList        == id</span><span>
</span><span id="line-803"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-804"></span><span id="local-6989586621679116758"><span class="annot"><a href="Algebra.Graph.html#adjacencyList"><span class="hs-identifier hs-type">adjacencyList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116758"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116758"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116758"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116758"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-805"></span><span id="adjacencyList"><span class="annot"><span class="annottext">adjacencyList :: forall a. Ord a =&gt; Graph a -&gt; [(a, [a])]
</span><a href="Algebra.Graph.html#adjacencyList"><span class="hs-identifier hs-var hs-var">adjacencyList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. AdjacencyMap a -&gt; [(a, [a])]
</span><a href="Algebra.Graph.AdjacencyMap.html#adjacencyList"><span class="hs-identifier hs-var">AM.adjacencyList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-var">toAdjacencyMap</span></a></span><span>
</span><span id="line-806"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#adjacencyList"><span class="hs-pragma hs-type">adjacencyList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-807"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#adjacencyList"><span class="hs-pragma hs-type">adjacencyList</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span class="hs-pragma">]</span><span class="hs-pragma">)</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-808"></span><span>
</span><span id="line-809"></span><span class="hs-comment">-- TODO: This is a very inefficient implementation. Find a way to construct an</span><span>
</span><span id="line-810"></span><span class="hs-comment">-- adjacency map directly, without building intermediate representations for all</span><span>
</span><span id="line-811"></span><span class="hs-comment">-- subgraphs.</span><span>
</span><span id="line-812"></span><span class="hs-comment">-- Convert a graph to 'AM.AdjacencyMap'.</span><span>
</span><span id="line-813"></span><span id="local-6989586621679116861"><span class="annot"><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-type">toAdjacencyMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116861"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116861"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.AdjacencyMap.html#AdjacencyMap"><span class="hs-identifier hs-type">AM.AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116861"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-814"></span><span id="toAdjacencyMap"><span class="annot"><span class="annottext">toAdjacencyMap :: forall a. Ord a =&gt; Graph a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-var hs-var">toAdjacencyMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. AdjacencyMap a
</span><a href="Algebra.Graph.AdjacencyMap.html#empty"><span class="hs-identifier hs-var">AM.empty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.AdjacencyMap.html#vertex"><span class="hs-identifier hs-var">AM.vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall a.
Ord a =&gt;
AdjacencyMap a -&gt; AdjacencyMap a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.AdjacencyMap.html#overlay"><span class="hs-identifier hs-var">AM.overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall a.
Ord a =&gt;
AdjacencyMap a -&gt; AdjacencyMap a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.AdjacencyMap.html#connect"><span class="hs-identifier hs-var">AM.connect</span></a></span><span>
</span><span id="line-815"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-pragma hs-type">toAdjacencyMap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-816"></span><span>
</span><span id="line-817"></span><span class="hs-comment">-- Like @toAdjacencyMap@ but specialised for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-818"></span><span class="annot"><a href="Algebra.Graph.html#toAdjacencyIntMap"><span class="hs-identifier hs-type">toAdjacencyIntMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.AdjacencyIntMap.html#AdjacencyIntMap"><span class="hs-identifier hs-type">AIM.AdjacencyIntMap</span></a></span><span>
</span><span id="line-819"></span><span id="toAdjacencyIntMap"><span class="annot"><span class="annottext">toAdjacencyIntMap :: Graph Int -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.html#toAdjacencyIntMap"><span class="hs-identifier hs-var hs-var">toAdjacencyIntMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyIntMap
</span><a href="Algebra.Graph.AdjacencyIntMap.html#empty"><span class="hs-identifier hs-var">AIM.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.AdjacencyIntMap.html#vertex"><span class="hs-identifier hs-var">AIM.vertex</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyIntMap -&gt; AdjacencyIntMap -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.AdjacencyIntMap.html#overlay"><span class="hs-identifier hs-var">AIM.overlay</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyIntMap -&gt; AdjacencyIntMap -&gt; AdjacencyIntMap
</span><a href="Algebra.Graph.AdjacencyIntMap.html#connect"><span class="hs-identifier hs-var">AIM.connect</span></a></span><span>
</span><span id="line-820"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#toAdjacencyIntMap"><span class="hs-pragma hs-type">toAdjacencyIntMap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span class="hs-comment">-- TODO: Make path a good consumer of lists, that is, express it with 'foldr'.</span><span>
</span><span id="line-823"></span><span class="hs-comment">-- This is not straightforward if we want to preserve efficiency.</span><span>
</span><span id="line-824"></span><span class="hs-comment">-- | The /path/ on a list of vertices.</span><span>
</span><span id="line-825"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-826"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-827"></span><span class="hs-comment">--</span><span>
</span><span id="line-828"></span><span class="hs-comment">-- Good producer.</span><span>
</span><span id="line-829"></span><span class="hs-comment">--</span><span>
</span><span id="line-830"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-831"></span><span class="hs-comment">-- path []        == 'empty'</span><span>
</span><span id="line-832"></span><span class="hs-comment">-- path [x]       == 'vertex' x</span><span>
</span><span id="line-833"></span><span class="hs-comment">-- path [x,y]     == 'edge' x y</span><span>
</span><span id="line-834"></span><span class="hs-comment">-- path . 'reverse' == 'transpose' . path</span><span>
</span><span id="line-835"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-836"></span><span id="local-6989586621679116038"><span class="annot"><a href="Algebra.Graph.html#path"><span class="hs-identifier hs-type">path</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116038"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116038"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-837"></span><span id="path"><span class="annot"><span class="annottext">path :: forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#path"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679116037"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116037"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679116036"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116036"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116035"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116035"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116034"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116034"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116033"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116033"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116037"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-838"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116036"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-839"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679116032"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116032"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116035"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116032"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-840"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679116031"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116031"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116036"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116035"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116034"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116033"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [(a, a)] -&gt; Graph a
</span><a href="Algebra.Graph.html#edges"><span class="hs-identifier hs-var">edges</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116037"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116031"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-841"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#path"><span class="hs-pragma hs-type">path</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-842"></span><span>
</span><span id="line-843"></span><span class="hs-comment">-- TODO: Make circuit a good consumer of lists, that is, express it with 'foldr'.</span><span>
</span><span id="line-844"></span><span class="hs-comment">-- This is not straightforward if we want to preserve efficiency.</span><span>
</span><span id="line-845"></span><span class="hs-comment">-- | The /circuit/ on a list of vertices.</span><span>
</span><span id="line-846"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-847"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-848"></span><span class="hs-comment">--</span><span>
</span><span id="line-849"></span><span class="hs-comment">-- Good producer.</span><span>
</span><span id="line-850"></span><span class="hs-comment">--</span><span>
</span><span id="line-851"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-852"></span><span class="hs-comment">-- circuit []        == 'empty'</span><span>
</span><span id="line-853"></span><span class="hs-comment">-- circuit [x]       == 'edge' x x</span><span>
</span><span id="line-854"></span><span class="hs-comment">-- circuit [x,y]     == 'edges' [(x,y), (y,x)]</span><span>
</span><span id="line-855"></span><span class="hs-comment">-- circuit . 'reverse' == 'transpose' . circuit</span><span>
</span><span id="line-856"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-857"></span><span id="local-6989586621679116030"><span class="annot"><a href="Algebra.Graph.html#circuit"><span class="hs-identifier hs-type">circuit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116030"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116030"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-858"></span><span id="circuit"><span class="annot"><span class="annottext">circuit :: forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#circuit"><span class="hs-identifier hs-var hs-var">circuit</span></a></span></span><span> </span><span id="local-6989586621679116029"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116029"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679116028"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116028"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116027"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116027"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116026"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116025"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116029"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-859"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116028"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-860"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679116024"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116024"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679116023"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116023"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116028"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116027"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116026"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116025"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#path"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116024"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116023"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116024"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-861"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#circuit"><span class="hs-pragma hs-type">circuit</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-862"></span><span>
</span><span id="line-863"></span><span class="hs-comment">-- | The /clique/ on a list of vertices.</span><span>
</span><span id="line-864"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-865"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-866"></span><span class="hs-comment">--</span><span>
</span><span id="line-867"></span><span class="hs-comment">-- Good consumer of lists and producer of graphs.</span><span>
</span><span id="line-868"></span><span class="hs-comment">--</span><span>
</span><span id="line-869"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-870"></span><span class="hs-comment">-- clique []         == 'empty'</span><span>
</span><span id="line-871"></span><span class="hs-comment">-- clique [x]        == 'vertex' x</span><span>
</span><span id="line-872"></span><span class="hs-comment">-- clique [x,y]      == 'edge' x y</span><span>
</span><span id="line-873"></span><span class="hs-comment">-- clique [x,y,z]    == 'edges' [(x,y), (x,z), (y,z)]</span><span>
</span><span id="line-874"></span><span class="hs-comment">-- clique (xs ++ ys) == 'connect' (clique xs) (clique ys)</span><span>
</span><span id="line-875"></span><span class="hs-comment">-- clique . 'reverse'  == 'transpose' . clique</span><span>
</span><span id="line-876"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-877"></span><span id="local-6989586621679116022"><span class="annot"><a href="Algebra.Graph.html#clique"><span class="hs-identifier hs-type">clique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116022"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116022"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-878"></span><span id="clique"><span class="annot"><span class="annottext">clique :: forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#clique"><span class="hs-identifier hs-var hs-var">clique</span></a></span></span><span> </span><span id="local-6989586621679116021"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116021"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679116020"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116020"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116019"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116019"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679116018"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116018"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall c a. c -&gt; (c -&gt; c -&gt; c) -&gt; (a -&gt; c) -&gt; [a] -&gt; c
</span><a href="Algebra.Graph.html#combineR"><span class="hs-identifier hs-var">combineR</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116020"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116018"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116019"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116021"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-879"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#clique"><span class="hs-pragma hs-type">clique</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-880"></span><span>
</span><span id="line-881"></span><span class="hs-comment">-- | The /biclique/ on two lists of vertices.</span><span>
</span><span id="line-882"></span><span class="hs-comment">-- Complexity: /O(L1 + L2)/ time, memory and size, where /L1/ and /L2/ are the</span><span>
</span><span id="line-883"></span><span class="hs-comment">-- lengths of the given lists.</span><span>
</span><span id="line-884"></span><span class="hs-comment">--</span><span>
</span><span id="line-885"></span><span class="hs-comment">-- Good consumer of both arguments and producer of graphs.</span><span>
</span><span id="line-886"></span><span class="hs-comment">--</span><span>
</span><span id="line-887"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-888"></span><span class="hs-comment">-- biclique []      []      == 'empty'</span><span>
</span><span id="line-889"></span><span class="hs-comment">-- biclique [x]     []      == 'vertex' x</span><span>
</span><span id="line-890"></span><span class="hs-comment">-- biclique []      [y]     == 'vertex' y</span><span>
</span><span id="line-891"></span><span class="hs-comment">-- biclique [x1,x2] [y1,y2] == 'edges' [(x1,y1), (x1,y2), (x2,y1), (x2,y2)]</span><span>
</span><span id="line-892"></span><span class="hs-comment">-- biclique xs      ys      == 'connect' ('vertices' xs) ('vertices' ys)</span><span>
</span><span id="line-893"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-894"></span><span id="local-6989586621679116742"><span class="annot"><a href="Algebra.Graph.html#biclique"><span class="hs-identifier hs-type">biclique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116742"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116742"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116742"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-895"></span><span id="biclique"><span class="annot"><span class="annottext">biclique :: forall a. [a] -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#biclique"><span class="hs-identifier hs-var hs-var">biclique</span></a></span></span><span> </span><span id="local-6989586621679116017"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116017"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679116016"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116016"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679116015"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116015"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116014"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116014"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116013"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116013"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116012"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116012"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; Maybe a
</span><a href="Algebra.Graph.Internal.html#foldr1Safe"><span class="hs-identifier hs-var">foldr1Safe</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116013"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116014"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116017"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-896"></span><span>    </span><span class="annot"><span class="annottext">Maybe r
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116015"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116014"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116013"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116012"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116016"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-897"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679116011"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116011"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; Maybe a
</span><a href="Algebra.Graph.Internal.html#foldr1Safe"><span class="hs-identifier hs-var">foldr1Safe</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116013"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116014"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116016"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-898"></span><span>        </span><span class="annot"><span class="annottext">Maybe r
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116011"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-899"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679116010"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116010"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116012"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116011"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116010"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-900"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#biclique"><span class="hs-pragma hs-type">biclique</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-901"></span><span>
</span><span id="line-902"></span><span class="hs-comment">-- | The /star/ formed by a centre vertex connected to a list of leaves.</span><span>
</span><span id="line-903"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-904"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-905"></span><span class="hs-comment">--</span><span>
</span><span id="line-906"></span><span class="hs-comment">-- Good consumer of lists and good producer of graphs.</span><span>
</span><span id="line-907"></span><span class="hs-comment">--</span><span>
</span><span id="line-908"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-909"></span><span class="hs-comment">-- star x []    == 'vertex' x</span><span>
</span><span id="line-910"></span><span class="hs-comment">-- star x [y]   == 'edge' x y</span><span>
</span><span id="line-911"></span><span class="hs-comment">-- star x [y,z] == 'edges' [(x,y), (x,z)]</span><span>
</span><span id="line-912"></span><span class="hs-comment">-- star x ys    == 'connect' ('vertex' x) ('vertices' ys)</span><span>
</span><span id="line-913"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-914"></span><span id="local-6989586621679116739"><span class="annot"><a href="Algebra.Graph.html#star"><span class="hs-identifier hs-type">star</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679116739"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116739"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116739"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-915"></span><span id="star"><span class="annot"><span class="annottext">star :: forall a. a -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#star"><span class="hs-identifier hs-var hs-var">star</span></a></span></span><span> </span><span id="local-6989586621679116009"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116009"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679116008"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116008"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679116007"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116007"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116006"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116006"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679116005"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116005"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; Maybe a
</span><a href="Algebra.Graph.Internal.html#foldr1Safe"><span class="hs-identifier hs-var">foldr1Safe</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116006"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116007"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679116008"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-916"></span><span>    </span><span class="annot"><span class="annottext">Maybe r
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116007"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116009"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-917"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679116004"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116004"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116005"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116007"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116009"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116004"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-918"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#star"><span class="hs-pragma hs-type">star</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span class="hs-comment">-- | The /stars/ formed by overlaying a list of 'star's. An inverse of</span><span>
</span><span id="line-921"></span><span class="hs-comment">-- 'adjacencyList'.</span><span>
</span><span id="line-922"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the total size of the</span><span>
</span><span id="line-923"></span><span class="hs-comment">-- input.</span><span>
</span><span id="line-924"></span><span class="hs-comment">--</span><span>
</span><span id="line-925"></span><span class="hs-comment">-- Good consumer of lists and producer of graphs.</span><span>
</span><span id="line-926"></span><span class="hs-comment">--</span><span>
</span><span id="line-927"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-928"></span><span class="hs-comment">-- stars []                      == 'empty'</span><span>
</span><span id="line-929"></span><span class="hs-comment">-- stars [(x, [])]               == 'vertex' x</span><span>
</span><span id="line-930"></span><span class="hs-comment">-- stars [(x, [y])]              == 'edge' x y</span><span>
</span><span id="line-931"></span><span class="hs-comment">-- stars [(x, ys)]               == 'star' x ys</span><span>
</span><span id="line-932"></span><span class="hs-comment">-- stars                         == 'overlays' . 'map' ('uncurry' 'star')</span><span>
</span><span id="line-933"></span><span class="hs-comment">-- stars . 'adjacencyList'         == id</span><span>
</span><span id="line-934"></span><span class="hs-comment">-- 'overlay' (stars xs) (stars ys) == stars (xs ++ ys)</span><span>
</span><span id="line-935"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-936"></span><span id="local-6989586621679116736"><span class="annot"><a href="Algebra.Graph.html#stars"><span class="hs-identifier hs-type">stars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116736"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116736"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116736"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-937"></span><span id="stars"><span class="annot"><span class="annottext">stars :: forall a. [(a, [a])] -&gt; Graph a
</span><a href="Algebra.Graph.html#stars"><span class="hs-identifier hs-var hs-var">stars</span></a></span></span><span> </span><span id="local-6989586621679116003"><span class="annot"><span class="annottext">[(a, [a])]
</span><a href="#local-6989586621679116003"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679116002"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116002"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679116001"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116001"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679116000"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116000"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679115999"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115999"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall c a. c -&gt; (c -&gt; c -&gt; c) -&gt; (a -&gt; c) -&gt; [a] -&gt; c
</span><a href="Algebra.Graph.html#combineR"><span class="hs-identifier hs-var">combineR</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116002"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116000"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679116002"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679116001"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679116000"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115999"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#star"><span class="hs-identifier hs-var">star</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, [a])]
</span><a href="#local-6989586621679116003"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-938"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#stars"><span class="hs-pragma hs-type">stars</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-939"></span><span>
</span><span id="line-940"></span><span class="hs-comment">-- | The /tree graph/ constructed from a given 'Tree.Tree' data structure.</span><span>
</span><span id="line-941"></span><span class="hs-comment">-- Complexity: /O(T)/ time, memory and size, where /T/ is the size of the</span><span>
</span><span id="line-942"></span><span class="hs-comment">-- given tree (i.e. the number of vertices in the tree).</span><span>
</span><span id="line-943"></span><span class="hs-comment">--</span><span>
</span><span id="line-944"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-945"></span><span class="hs-comment">-- tree (Node x [])                                         == 'vertex' x</span><span>
</span><span id="line-946"></span><span class="hs-comment">-- tree (Node x [Node y [Node z []]])                       == 'path' [x,y,z]</span><span>
</span><span id="line-947"></span><span class="hs-comment">-- tree (Node x [Node y [], Node z []])                     == 'star' x [y,z]</span><span>
</span><span id="line-948"></span><span class="hs-comment">-- tree (Node 1 [Node 2 [], Node 3 [Node 4 [], Node 5 []]]) == 'edges' [(1,2), (1,3), (3,4), (3,5)]</span><span>
</span><span id="line-949"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-950"></span><span id="local-6989586621679116730"><span class="annot"><a href="Algebra.Graph.html#tree"><span class="hs-identifier hs-type">tree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Tree.Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116730"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116730"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-951"></span><span id="tree"><span class="annot"><span class="annottext">tree :: forall a. Tree a -&gt; Graph a
</span><a href="Algebra.Graph.html#tree"><span class="hs-identifier hs-var hs-var">tree</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679115994"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115994"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115994"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-952"></span><span class="annot"><a href="Algebra.Graph.html#tree"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679115993"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115993"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679115992"><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679115992"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#star"><span class="hs-identifier hs-var">star</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115993"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Tree a -&gt; a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">rootLabel</span></a></span><span> </span><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679115992"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-953"></span><span>         </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#overlay"><span class="hs-operator hs-var">`overlay`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Forest a -&gt; Graph a
</span><a href="Algebra.Graph.html#forest"><span class="hs-identifier hs-var">forest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Tree a -&gt; [Tree a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">subForest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679115992"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-954"></span><span>
</span><span id="line-955"></span><span class="hs-comment">-- | The /forest graph/ constructed from a given 'Tree.Forest' data structure.</span><span>
</span><span id="line-956"></span><span class="hs-comment">-- Complexity: /O(F)/ time, memory and size, where /F/ is the size of the</span><span>
</span><span id="line-957"></span><span class="hs-comment">-- given forest (i.e. the number of vertices in the forest).</span><span>
</span><span id="line-958"></span><span class="hs-comment">--</span><span>
</span><span id="line-959"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-960"></span><span class="hs-comment">-- forest []                                                  == 'empty'</span><span>
</span><span id="line-961"></span><span class="hs-comment">-- forest [x]                                                 == 'tree' x</span><span>
</span><span id="line-962"></span><span class="hs-comment">-- forest [Node 1 [Node 2 [], Node 3 []], Node 4 [Node 5 []]] == 'edges' [(1,2), (1,3), (4,5)]</span><span>
</span><span id="line-963"></span><span class="hs-comment">-- forest                                                     == 'overlays' . 'map' 'tree'</span><span>
</span><span id="line-964"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-965"></span><span id="local-6989586621679116726"><span class="annot"><a href="Algebra.Graph.html#forest"><span class="hs-identifier hs-type">forest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Tree.Forest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116726"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116726"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-966"></span><span id="forest"><span class="annot"><span class="annottext">forest :: forall a. Forest a -&gt; Graph a
</span><a href="Algebra.Graph.html#forest"><span class="hs-identifier hs-var hs-var">forest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [Graph a] -&gt; Graph a
</span><a href="Algebra.Graph.html#overlays"><span class="hs-identifier hs-var">overlays</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Tree a -&gt; Graph a
</span><a href="Algebra.Graph.html#tree"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-967"></span><span>
</span><span id="line-968"></span><span class="hs-comment">-- | Construct a /mesh graph/ from two lists of vertices.</span><span>
</span><span id="line-969"></span><span class="hs-comment">-- Complexity: /O(L1 * L2)/ time, memory and size, where /L1/ and /L2/ are the</span><span>
</span><span id="line-970"></span><span class="hs-comment">-- lengths of the given lists.</span><span>
</span><span id="line-971"></span><span class="hs-comment">--</span><span>
</span><span id="line-972"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-973"></span><span class="hs-comment">-- mesh xs     []   == 'empty'</span><span>
</span><span id="line-974"></span><span class="hs-comment">-- mesh []     ys   == 'empty'</span><span>
</span><span id="line-975"></span><span class="hs-comment">-- mesh [x]    [y]  == 'vertex' (x, y)</span><span>
</span><span id="line-976"></span><span class="hs-comment">-- mesh xs     ys   == 'box' ('path' xs) ('path' ys)</span><span>
</span><span id="line-977"></span><span class="hs-comment">-- mesh [1..3] &quot;ab&quot; == 'edges' [ ((1,\'a\'),(1,\'b\')), ((1,\'a\'),(2,\'a\')), ((1,\'b\'),(2,\'b\')), ((2,\'a\'),(2,\'b\'))</span><span>
</span><span id="line-978"></span><span class="hs-comment">--                           , ((2,\'a\'),(3,\'a\')), ((2,\'b\'),(3,\'b\')), ((3,\'a\'),(3,\'b\')) ]</span><span>
</span><span id="line-979"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-980"></span><span id="local-6989586621679116718"><span id="local-6989586621679116719"><span class="annot"><a href="Algebra.Graph.html#mesh"><span class="hs-identifier hs-type">mesh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116719"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116718"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116719"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679116718"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-981"></span><span id="mesh"><span class="annot"><span class="annottext">mesh :: forall a b. [a] -&gt; [b] -&gt; Graph (a, b)
</span><a href="Algebra.Graph.html#mesh"><span class="hs-identifier hs-var hs-var">mesh</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="annottext">[b]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-982"></span><span class="annot"><a href="Algebra.Graph.html#mesh"><span class="hs-identifier hs-var">mesh</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-983"></span><span class="annot"><a href="Algebra.Graph.html#mesh"><span class="hs-identifier hs-var">mesh</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679115987"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115987"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679115986"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115986"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115987"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115986"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-984"></span><span class="annot"><a href="Algebra.Graph.html#mesh"><span class="hs-identifier hs-var">mesh</span></a></span><span> </span><span id="local-6989586621679115985"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115985"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span id="local-6989586621679115984"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679115984"><span class="hs-identifier hs-var">ys</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [(a, [a])] -&gt; Graph a
</span><a href="Algebra.Graph.html#stars"><span class="hs-identifier hs-var">stars</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-985"></span><span>       </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115983"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115982"><span class="hs-identifier hs-var">b1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115983"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115981"><span class="hs-identifier hs-var">b2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115980"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115982"><span class="hs-identifier hs-var">b1</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679115983"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115983"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679115980"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115980"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679115979"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679115982"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115982"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679115981"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115981"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(b, b)]
</span><a href="#local-6989586621679115978"><span class="hs-identifier hs-var">iy</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-986"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115977"><span class="hs-identifier hs-var">lx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115976"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115977"><span class="hs-identifier hs-var">lx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115975"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679115976"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115976"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679115975"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115975"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(b, b)]
</span><a href="#local-6989586621679115978"><span class="hs-identifier hs-var">iy</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-987"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115974"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115973"><span class="hs-identifier hs-var">ly</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115972"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115973"><span class="hs-identifier hs-var">ly</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679115974"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115974"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679115972"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115972"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679115979"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-988"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-989"></span><span>    </span><span id="local-6989586621679115977"><span class="annot"><span class="annottext">lx :: a
</span><a href="#local-6989586621679115977"><span class="hs-identifier hs-var hs-var">lx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115985"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-990"></span><span>    </span><span id="local-6989586621679115973"><span class="annot"><span class="annottext">ly :: b
</span><a href="#local-6989586621679115973"><span class="hs-identifier hs-var hs-var">ly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679115984"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-991"></span><span>    </span><span id="local-6989586621679115979"><span class="annot"><span class="annottext">ix :: [(a, a)]
</span><a href="#local-6989586621679115979"><span class="hs-identifier hs-var hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">init</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [(a, a)]
</span><a href="Algebra.Graph.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115985"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-992"></span><span>    </span><span id="local-6989586621679115978"><span class="annot"><span class="annottext">iy :: [(b, b)]
</span><a href="#local-6989586621679115978"><span class="hs-identifier hs-var hs-var">iy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">init</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [(a, a)]
</span><a href="Algebra.Graph.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679115984"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-993"></span><span>
</span><span id="line-994"></span><span class="hs-comment">-- | Construct a /torus graph/ from two lists of vertices.</span><span>
</span><span id="line-995"></span><span class="hs-comment">-- Complexity: /O(L1 * L2)/ time, memory and size, where /L1/ and /L2/ are the</span><span>
</span><span id="line-996"></span><span class="hs-comment">-- lengths of the given lists.</span><span>
</span><span id="line-997"></span><span class="hs-comment">--</span><span>
</span><span id="line-998"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-999"></span><span class="hs-comment">-- torus xs    []   == 'empty'</span><span>
</span><span id="line-1000"></span><span class="hs-comment">-- torus []    ys   == 'empty'</span><span>
</span><span id="line-1001"></span><span class="hs-comment">-- torus [x]   [y]  == 'edge' (x,y) (x,y)</span><span>
</span><span id="line-1002"></span><span class="hs-comment">-- torus xs    ys   == 'box' ('circuit' xs) ('circuit' ys)</span><span>
</span><span id="line-1003"></span><span class="hs-comment">-- torus [1,2] &quot;ab&quot; == 'edges' [ ((1,\'a\'),(1,\'b\')), ((1,\'a\'),(2,\'a\')), ((1,\'b\'),(1,\'a\')), ((1,\'b\'),(2,\'b\'))</span><span>
</span><span id="line-1004"></span><span class="hs-comment">--                           , ((2,\'a\'),(1,\'a\')), ((2,\'a\'),(2,\'b\')), ((2,\'b\'),(1,\'b\')), ((2,\'b\'),(2,\'a\')) ]</span><span>
</span><span id="line-1005"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1006"></span><span id="local-6989586621679115967"><span id="local-6989586621679115968"><span class="annot"><a href="Algebra.Graph.html#torus"><span class="hs-identifier hs-type">torus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679115968"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679115967"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679115968"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679115967"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1007"></span><span id="torus"><span class="annot"><span class="annottext">torus :: forall a b. [a] -&gt; [b] -&gt; Graph (a, b)
</span><a href="Algebra.Graph.html#torus"><span class="hs-identifier hs-var hs-var">torus</span></a></span></span><span> </span><span id="local-6989586621679115966"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115966"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679115965"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679115965"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [(a, [a])] -&gt; Graph a
</span><a href="Algebra.Graph.html#stars"><span class="hs-identifier hs-var">stars</span></a></span><span>
</span><span id="line-1008"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115964"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115963"><span class="hs-identifier hs-var">b1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115964"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115962"><span class="hs-identifier hs-var">b2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115961"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115963"><span class="hs-identifier hs-var">b1</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679115964"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115964"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679115961"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115961"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [(a, a)]
</span><a href="Algebra.Graph.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115966"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679115963"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115963"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679115962"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115962"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [(a, a)]
</span><a href="Algebra.Graph.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679115965"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1009"></span><span>
</span><span id="line-1010"></span><span class="hs-comment">-- | Auxiliary function for 'mesh' and 'torus'</span><span>
</span><span id="line-1011"></span><span id="local-6989586621679116713"><span class="annot"><a href="Algebra.Graph.html#pairs"><span class="hs-identifier hs-type">pairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116713"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116713"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679116713"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-1012"></span><span id="pairs"><span class="annot"><span class="annottext">pairs :: forall a. [a] -&gt; [(a, a)]
</span><a href="Algebra.Graph.html#pairs"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1013"></span><span class="annot"><a href="Algebra.Graph.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span id="local-6989586621679115960"><span class="annot"><span class="annottext">as :: [a]
</span><a href="#local-6989586621679115960"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679115959"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115959"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679115958"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115958"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115960"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115958"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115959"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1014"></span><span>
</span><span id="line-1015"></span><span class="hs-comment">-- | Construct a /De Bruijn graph/ of a given non-negative dimension using symbols</span><span>
</span><span id="line-1016"></span><span class="hs-comment">-- from a given alphabet.</span><span>
</span><span id="line-1017"></span><span class="hs-comment">-- Complexity: /O(A^(D + 1))/ time, memory and size, where /A/ is the size of the</span><span>
</span><span id="line-1018"></span><span class="hs-comment">-- alphabet and /D/ is the dimension of the graph.</span><span>
</span><span id="line-1019"></span><span class="hs-comment">--</span><span>
</span><span id="line-1020"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1021"></span><span class="hs-comment">--           deBruijn 0 xs               == 'edge' [] []</span><span>
</span><span id="line-1022"></span><span class="hs-comment">-- n &gt; 0 ==&gt; deBruijn n []               == 'empty'</span><span>
</span><span id="line-1023"></span><span class="hs-comment">--           deBruijn 1 [0,1]            == 'edges' [ ([0],[0]), ([0],[1]), ([1],[0]), ([1],[1]) ]</span><span>
</span><span id="line-1024"></span><span class="hs-comment">--           deBruijn 2 &quot;0&quot;              == 'edge' &quot;00&quot; &quot;00&quot;</span><span>
</span><span id="line-1025"></span><span class="hs-comment">--           deBruijn 2 &quot;01&quot;             == 'edges' [ (&quot;00&quot;,&quot;00&quot;), (&quot;00&quot;,&quot;01&quot;), (&quot;01&quot;,&quot;10&quot;), (&quot;01&quot;,&quot;11&quot;)</span><span>
</span><span id="line-1026"></span><span class="hs-comment">--                                                , (&quot;10&quot;,&quot;00&quot;), (&quot;10&quot;,&quot;01&quot;), (&quot;11&quot;,&quot;10&quot;), (&quot;11&quot;,&quot;11&quot;) ]</span><span>
</span><span id="line-1027"></span><span class="hs-comment">--           'transpose'   (deBruijn n xs) == 'fmap' 'reverse' $ deBruijn n xs</span><span>
</span><span id="line-1028"></span><span class="hs-comment">--           'vertexCount' (deBruijn n xs) == ('length' $ 'Data.List.nub' xs)^n</span><span>
</span><span id="line-1029"></span><span class="hs-comment">-- n &gt; 0 ==&gt; 'edgeCount'   (deBruijn n xs) == ('length' $ 'Data.List.nub' xs)^(n + 1)</span><span>
</span><span id="line-1030"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1031"></span><span id="local-6989586621679116709"><span class="annot"><a href="Algebra.Graph.html#deBruijn"><span class="hs-identifier hs-type">deBruijn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116709"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116709"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1032"></span><span id="deBruijn"><span class="annot"><span class="annottext">deBruijn :: forall a. Int -&gt; [a] -&gt; Graph [a]
</span><a href="Algebra.Graph.html#deBruijn"><span class="hs-identifier hs-var hs-var">deBruijn</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>   </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; Graph a
</span><a href="Algebra.Graph.html#edge"><span class="hs-identifier hs-var">edge</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1033"></span><span class="annot"><a href="Algebra.Graph.html#deBruijn"><span class="hs-identifier hs-var">deBruijn</span></a></span><span> </span><span id="local-6989586621679115947"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115947"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679115946"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115946"><span class="hs-identifier hs-var">alphabet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph (Either [a] [a])
</span><a href="#local-6989586621679115945"><span class="hs-identifier hs-var">skeleton</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Either [a] [a] -&gt; Graph [a]
</span><a href="#local-6989586621679115944"><span class="hs-identifier hs-var">expand</span></a></span><span>
</span><span id="line-1034"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1035"></span><span>    </span><span id="local-6989586621679115943"><span class="annot"><span class="annottext">overlaps :: [[a]]
</span><a href="#local-6989586621679115943"><span class="hs-identifier hs-var hs-var">overlaps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115946"><span class="hs-identifier hs-var">alphabet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115947"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1036"></span><span>    </span><span id="local-6989586621679115945"><span class="annot"><span class="annottext">skeleton :: Graph (Either [a] [a])
</span><a href="#local-6989586621679115945"><span class="hs-identifier hs-var hs-var">skeleton</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [(a, a)] -&gt; Graph a
</span><a href="Algebra.Graph.html#edges"><span class="hs-identifier hs-var">edges</span></a></span><span>    </span><span class="hs-special">[</span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115941"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115941"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679115941"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115941"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679115943"><span class="hs-identifier hs-var">overlaps</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1037"></span><span>    </span><span id="local-6989586621679115944"><span class="annot"><span class="annottext">expand :: Either [a] [a] -&gt; Graph [a]
</span><a href="#local-6989586621679115944"><span class="hs-identifier hs-var hs-var">expand</span></a></span></span><span> </span><span id="local-6989586621679115940"><span class="annot"><span class="annottext">Either [a] [a]
</span><a href="#local-6989586621679115940"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115938"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115938"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either [a] [a]
</span><a href="#local-6989586621679115940"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679115938"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115938"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115946"><span class="hs-identifier hs-var">alphabet</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1038"></span><span>
</span><span id="line-1039"></span><span class="hs-comment">-- | Remove a vertex from a given graph.</span><span>
</span><span id="line-1040"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-1041"></span><span class="hs-comment">--</span><span>
</span><span id="line-1042"></span><span class="hs-comment">-- Good consumer and producer.</span><span>
</span><span id="line-1043"></span><span class="hs-comment">--</span><span>
</span><span id="line-1044"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1045"></span><span class="hs-comment">-- removeVertex x ('vertex' x)       == 'empty'</span><span>
</span><span id="line-1046"></span><span class="hs-comment">-- removeVertex 1 ('vertex' 2)       == 'vertex' 2</span><span>
</span><span id="line-1047"></span><span class="hs-comment">-- removeVertex x ('edge' x x)       == 'empty'</span><span>
</span><span id="line-1048"></span><span class="hs-comment">-- removeVertex 1 ('edge' 1 2)       == 'vertex' 2</span><span>
</span><span id="line-1049"></span><span class="hs-comment">-- removeVertex x . removeVertex x == removeVertex x</span><span>
</span><span id="line-1050"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1051"></span><span id="local-6989586621679116698"><span class="annot"><a href="Algebra.Graph.html#removeVertex"><span class="hs-identifier hs-type">removeVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116698"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116698"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116698"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116698"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1052"></span><span id="removeVertex"><span class="annot"><span class="annottext">removeVertex :: forall a. Eq a =&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#removeVertex"><span class="hs-identifier hs-var hs-var">removeVertex</span></a></span></span><span> </span><span id="local-6989586621679115935"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115935"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#induce"><span class="hs-identifier hs-var">induce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115935"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1053"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#removeVertex"><span class="hs-pragma hs-type">removeVertex</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1054"></span><span>
</span><span id="line-1055"></span><span class="hs-comment">-- | Remove an edge from a given graph.</span><span>
</span><span id="line-1056"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-1057"></span><span class="hs-comment">--</span><span>
</span><span id="line-1058"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1059"></span><span class="hs-comment">-- removeEdge x y ('edge' x y)       == 'vertices' [x,y]</span><span>
</span><span id="line-1060"></span><span class="hs-comment">-- removeEdge x y . removeEdge x y == removeEdge x y</span><span>
</span><span id="line-1061"></span><span class="hs-comment">-- removeEdge x y . 'removeVertex' x == 'removeVertex' x</span><span>
</span><span id="line-1062"></span><span class="hs-comment">-- removeEdge 1 1 (1 * 1 * 2 * 2)  == 1 * 2 * 2</span><span>
</span><span id="line-1063"></span><span class="hs-comment">-- removeEdge 1 2 (1 * 1 * 2 * 2)  == 1 * 1 + 2 * 2</span><span>
</span><span id="line-1064"></span><span class="hs-comment">-- 'size' (removeEdge x y z)         &lt;= 3 * 'size' z</span><span>
</span><span id="line-1065"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1066"></span><span id="local-6989586621679116695"><span class="annot"><a href="Algebra.Graph.html#removeEdge"><span class="hs-identifier hs-type">removeEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116695"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116695"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116695"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116695"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116695"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1067"></span><span id="removeEdge"><span class="annot"><span class="annottext">removeEdge :: forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#removeEdge"><span class="hs-identifier hs-var hs-var">removeEdge</span></a></span></span><span> </span><span id="local-6989586621679115929"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115929"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679115928"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115928"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
Eq a =&gt;
a -&gt; (a -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#filterContext"><span class="hs-identifier hs-var">filterContext</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115929"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115929"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115928"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1068"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#removeEdge"><span class="hs-pragma hs-type">removeEdge</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1069"></span><span>
</span><span id="line-1070"></span><span class="hs-comment">-- TODO: Export</span><span>
</span><span id="line-1071"></span><span class="hs-comment">-- Filter vertices in a subgraph context.</span><span>
</span><span id="line-1072"></span><span id="local-6989586621679116693"><span class="annot"><a href="Algebra.Graph.html#filterContext"><span class="hs-identifier hs-type">filterContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116693"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116693"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116693"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116693"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116693"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116693"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1073"></span><span id="filterContext"><span class="annot"><span class="annottext">filterContext :: forall a.
Eq a =&gt;
a -&gt; (a -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#filterContext"><span class="hs-identifier hs-var hs-var">filterContext</span></a></span></span><span> </span><span id="local-6989586621679115923"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115923"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679115922"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679115922"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679115921"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679115921"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679115920"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115920"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115920"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Context a -&gt; Graph a
</span><a href="#local-6989586621679115918"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Graph a -&gt; Maybe (Context a)
</span><a href="Algebra.Graph.html#context"><span class="hs-identifier hs-var">context</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115923"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115920"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1074"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1075"></span><span>    </span><span id="local-6989586621679115918"><span class="annot"><span class="annottext">go :: Context a -&gt; Graph a
</span><a href="#local-6989586621679115918"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span id="local-6989586621679115916"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115916"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621679115915"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115915"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#induce"><span class="hs-identifier hs-var">induce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115923"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115920"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#overlay"><span class="hs-operator hs-var">`overlay`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#star"><span class="hs-identifier hs-var">star</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115923"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679115922"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115916"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1076"></span><span>                                        </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#overlay"><span class="hs-operator hs-var">`overlay`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#star"><span class="hs-identifier hs-var">star</span></a></span><span>            </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115923"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679115921"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115915"><span class="hs-identifier hs-var">os</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1077"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#filterContext"><span class="hs-pragma hs-type">filterContext</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Bool</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Bool</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1078"></span><span>
</span><span id="line-1079"></span><span class="hs-comment">-- | The function @'replaceVertex' x y@ replaces vertex @x@ with vertex @y@ in a</span><span>
</span><span id="line-1080"></span><span class="hs-comment">-- given 'Graph'. If @y@ already exists, @x@ and @y@ will be merged.</span><span>
</span><span id="line-1081"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-1082"></span><span class="hs-comment">--</span><span>
</span><span id="line-1083"></span><span class="hs-comment">-- Good consumer and producer.</span><span>
</span><span id="line-1084"></span><span class="hs-comment">--</span><span>
</span><span id="line-1085"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1086"></span><span class="hs-comment">-- replaceVertex x x            == id</span><span>
</span><span id="line-1087"></span><span class="hs-comment">-- replaceVertex x y ('vertex' x) == 'vertex' y</span><span>
</span><span id="line-1088"></span><span class="hs-comment">-- replaceVertex x y            == 'mergeVertices' (== x) y</span><span>
</span><span id="line-1089"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1090"></span><span id="local-6989586621679115914"><span class="annot"><a href="Algebra.Graph.html#replaceVertex"><span class="hs-identifier hs-type">replaceVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115914"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679115914"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679115914"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115914"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115914"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1091"></span><span id="replaceVertex"><span class="annot"><span class="annottext">replaceVertex :: forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#replaceVertex"><span class="hs-identifier hs-var hs-var">replaceVertex</span></a></span></span><span> </span><span id="local-6989586621679115910"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115910"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679115909"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115909"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679115908"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115908"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115908"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115910"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115909"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115908"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1092"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#replaceVertex"><span class="hs-pragma hs-type">replaceVertex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1093"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#replaceVertex"><span class="hs-pragma hs-type">replaceVertex</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1094"></span><span>
</span><span id="line-1095"></span><span class="hs-comment">-- | Merge vertices satisfying a given predicate into a given vertex.</span><span>
</span><span id="line-1096"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size, assuming that the predicate takes</span><span>
</span><span id="line-1097"></span><span class="hs-comment">-- constant time.</span><span>
</span><span id="line-1098"></span><span class="hs-comment">--</span><span>
</span><span id="line-1099"></span><span class="hs-comment">-- Good consumer and producer.</span><span>
</span><span id="line-1100"></span><span class="hs-comment">--</span><span>
</span><span id="line-1101"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1102"></span><span class="hs-comment">-- mergeVertices ('const' False) x    == id</span><span>
</span><span id="line-1103"></span><span class="hs-comment">-- mergeVertices (== x) y           == 'replaceVertex' x y</span><span>
</span><span id="line-1104"></span><span class="hs-comment">-- mergeVertices 'even' 1 (0 * 2)     == 1 * 1</span><span>
</span><span id="line-1105"></span><span class="hs-comment">-- mergeVertices 'odd'  1 (3 + 4 * 5) == 4 * 1</span><span>
</span><span id="line-1106"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1107"></span><span id="local-6989586621679116686"><span class="annot"><a href="Algebra.Graph.html#mergeVertices"><span class="hs-identifier hs-type">mergeVertices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116686"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116686"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116686"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116686"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1108"></span><span id="mergeVertices"><span class="annot"><span class="annottext">mergeVertices :: forall a. (a -&gt; Bool) -&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#mergeVertices"><span class="hs-identifier hs-var hs-var">mergeVertices</span></a></span></span><span> </span><span id="local-6989586621679115906"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679115906"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679115905"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115905"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679115904"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115904"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679115906"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115904"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115905"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115904"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1109"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#mergeVertices"><span class="hs-pragma hs-type">mergeVertices</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1110"></span><span>
</span><span id="line-1111"></span><span class="hs-comment">-- | Split a vertex into a list of vertices with the same connectivity.</span><span>
</span><span id="line-1112"></span><span class="hs-comment">-- Complexity: /O(s + k * L)/ time, memory and size, where /k/ is the number of</span><span>
</span><span id="line-1113"></span><span class="hs-comment">-- occurrences of the vertex in the expression and /L/ is the length of the</span><span>
</span><span id="line-1114"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-1115"></span><span class="hs-comment">--</span><span>
</span><span id="line-1116"></span><span class="hs-comment">-- Good consumer of lists and producer of graphs.</span><span>
</span><span id="line-1117"></span><span class="hs-comment">--</span><span>
</span><span id="line-1118"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1119"></span><span class="hs-comment">-- splitVertex x []                  == 'removeVertex' x</span><span>
</span><span id="line-1120"></span><span class="hs-comment">-- splitVertex x [x]                 == id</span><span>
</span><span id="line-1121"></span><span class="hs-comment">-- splitVertex x [y]                 == 'replaceVertex' x y</span><span>
</span><span id="line-1122"></span><span class="hs-comment">-- splitVertex 1 [0,1] $ 1 * (2 + 3) == (0 + 1) * (2 + 3)</span><span>
</span><span id="line-1123"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1124"></span><span id="local-6989586621679116684"><span class="annot"><a href="Algebra.Graph.html#splitVertex"><span class="hs-identifier hs-type">splitVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116684"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116684"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116684"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116684"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116684"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1125"></span><span id="splitVertex"><span class="annot"><span class="annottext">splitVertex :: forall a. Eq a =&gt; a -&gt; [a] -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#splitVertex"><span class="hs-identifier hs-var hs-var">splitVertex</span></a></span></span><span> </span><span id="local-6989586621679115902"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115902"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679115901"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115901"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span id="local-6989586621679115900"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115900"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679115898"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679115898"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679115897"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679115897"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679115896"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115896"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679115895"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115895"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1126"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679115894"><span class="annot"><span class="annottext">split :: a -&gt; r
</span><a href="#local-6989586621679115894"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621679115893"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115893"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115902"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115893"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679115898"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679115897"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115896"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115895"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115901"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679115897"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115893"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1127"></span><span>    </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679115898"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679115894"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115896"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115895"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115900"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1128"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#splitVertex"><span class="hs-pragma hs-type">splitVertex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1129"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#splitVertex"><span class="hs-pragma hs-type">splitVertex</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1130"></span><span>
</span><span id="line-1131"></span><span class="hs-comment">-- | Transpose a given graph.</span><span>
</span><span id="line-1132"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-1133"></span><span class="hs-comment">--</span><span>
</span><span id="line-1134"></span><span class="hs-comment">-- Good consumer and producer.</span><span>
</span><span id="line-1135"></span><span class="hs-comment">--</span><span>
</span><span id="line-1136"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1137"></span><span class="hs-comment">-- transpose 'empty'       == 'empty'</span><span>
</span><span id="line-1138"></span><span class="hs-comment">-- transpose ('vertex' x)  == 'vertex' x</span><span>
</span><span id="line-1139"></span><span class="hs-comment">-- transpose ('edge' x y)  == 'edge' y x</span><span>
</span><span id="line-1140"></span><span class="hs-comment">-- transpose . transpose == id</span><span>
</span><span id="line-1141"></span><span class="hs-comment">-- transpose ('box' x y)   == 'box' (transpose x) (transpose y)</span><span>
</span><span id="line-1142"></span><span class="hs-comment">-- 'edgeList' . transpose  == 'Data.List.sort' . 'map' 'Data.Tuple.swap' . 'edgeList'</span><span>
</span><span id="line-1143"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1144"></span><span id="local-6989586621679116688"><span class="annot"><a href="Algebra.Graph.html#transpose"><span class="hs-identifier hs-type">transpose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116688"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116688"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1145"></span><span id="transpose"><span class="annot"><span class="annottext">transpose :: forall a. Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#transpose"><span class="hs-identifier hs-var hs-var">transpose</span></a></span></span><span> </span><span id="local-6989586621679115892"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115892"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679115891"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679115891"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679115890"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679115890"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679115889"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115889"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679115888"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115888"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679115891"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679115890"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115889"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115888"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115892"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1146"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#transpose"><span class="hs-pragma hs-type">transpose</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1147"></span><span>
</span><span id="line-1148"></span><span class="hs-comment">-- | Construct the /induced subgraph/ of a given graph by removing the</span><span>
</span><span id="line-1149"></span><span class="hs-comment">-- vertices that do not satisfy a given predicate.</span><span>
</span><span id="line-1150"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size, assuming that the predicate takes</span><span>
</span><span id="line-1151"></span><span class="hs-comment">-- constant time.</span><span>
</span><span id="line-1152"></span><span class="hs-comment">--</span><span>
</span><span id="line-1153"></span><span class="hs-comment">-- Good consumer and producer.</span><span>
</span><span id="line-1154"></span><span class="hs-comment">--</span><span>
</span><span id="line-1155"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1156"></span><span class="hs-comment">-- induce ('const' True ) x      == x</span><span>
</span><span id="line-1157"></span><span class="hs-comment">-- induce ('const' False) x      == 'empty'</span><span>
</span><span id="line-1158"></span><span class="hs-comment">-- induce (/= x)               == 'removeVertex' x</span><span>
</span><span id="line-1159"></span><span class="hs-comment">-- induce p . induce q         == induce (\\x -&gt; p x &amp;&amp; q x)</span><span>
</span><span id="line-1160"></span><span class="hs-comment">-- 'isSubgraphOf' (induce p x) x == True</span><span>
</span><span id="line-1161"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1162"></span><span id="local-6989586621679116696"><span class="annot"><a href="Algebra.Graph.html#induce"><span class="hs-identifier hs-type">induce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116696"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116696"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116696"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1163"></span><span id="induce"><span class="annot"><span class="annottext">induce :: forall a. (a -&gt; Bool) -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#induce"><span class="hs-identifier hs-var hs-var">induce</span></a></span></span><span> </span><span id="local-6989586621679115885"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679115885"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph (Maybe a) -&gt; Graph a
</span><a href="Algebra.Graph.html#induceJust"><span class="hs-identifier hs-var">induceJust</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679115884"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115884"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679115885"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115884"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115884"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1164"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#induce"><span class="hs-pragma hs-type">induce</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1165"></span><span>
</span><span id="line-1166"></span><span class="hs-comment">-- | Construct the /induced subgraph/ of a given graph by removing the vertices</span><span>
</span><span id="line-1167"></span><span class="hs-comment">-- that are 'Nothing'.</span><span>
</span><span id="line-1168"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-1169"></span><span class="hs-comment">--</span><span>
</span><span id="line-1170"></span><span class="hs-comment">-- Good consumer and producer.</span><span>
</span><span id="line-1171"></span><span class="hs-comment">--</span><span>
</span><span id="line-1172"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1173"></span><span class="hs-comment">-- induceJust ('vertex' 'Nothing')                               == 'empty'</span><span>
</span><span id="line-1174"></span><span class="hs-comment">-- induceJust ('edge' ('Just' x) 'Nothing')                        == 'vertex' x</span><span>
</span><span id="line-1175"></span><span class="hs-comment">-- induceJust . 'fmap' 'Just'                                    == 'id'</span><span>
</span><span id="line-1176"></span><span class="hs-comment">-- induceJust . 'fmap' (\\x -&gt; if p x then 'Just' x else 'Nothing') == 'induce' p</span><span>
</span><span id="line-1177"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1178"></span><span id="local-6989586621679116675"><span class="annot"><a href="Algebra.Graph.html#induceJust"><span class="hs-identifier hs-type">induceJust</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116675"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116675"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1179"></span><span id="induceJust"><span class="annot"><span class="annottext">induceJust :: forall a. Graph (Maybe a) -&gt; Graph a
</span><a href="Algebra.Graph.html#induceJust"><span class="hs-identifier hs-var hs-var">induceJust</span></a></span></span><span> </span><span id="local-6989586621679115883"><span class="annot"><span class="annottext">Graph (Maybe a)
</span><a href="#local-6989586621679115883"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679115880"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679115880"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679115879"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679115879"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679115878"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115878"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679115877"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115877"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679115880"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1180"></span><span>    </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679115879"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {t}. (t -&gt; t -&gt; t) -&gt; Maybe t -&gt; Maybe t -&gt; Maybe t
</span><a href="#local-6989586621679115876"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115878"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {t}. (t -&gt; t -&gt; t) -&gt; Maybe t -&gt; Maybe t -&gt; Maybe t
</span><a href="#local-6989586621679115876"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115877"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Graph (Maybe a)
</span><a href="#local-6989586621679115883"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1181"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1182"></span><span>    </span><span id="local-6989586621679115876"><span class="annot"><span class="annottext">k :: (t -&gt; t -&gt; t) -&gt; Maybe t -&gt; Maybe t -&gt; Maybe t
</span><a href="#local-6989586621679115876"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679115875"><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679115875"><span class="hs-identifier hs-var">x</span></a></span></span><span>        </span><span class="annot"><span class="annottext">Maybe t
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679115875"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-comment">-- Constant folding to get rid of Empty leaves</span><span>
</span><span id="line-1183"></span><span>    </span><span class="annot"><a href="#local-6989586621679115876"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe t
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span id="local-6989586621679115874"><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679115874"><span class="hs-identifier hs-var">y</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679115874"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1184"></span><span>    </span><span class="annot"><a href="#local-6989586621679115876"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span id="local-6989586621679115873"><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><a href="#local-6989586621679115873"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679115872"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115872"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679115871"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115871"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><a href="#local-6989586621679115873"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115872"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115871"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1185"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#induceJust"><span class="hs-pragma hs-type">induceJust</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1186"></span><span>
</span><span id="line-1187"></span><span class="hs-comment">-- NB: This is not a good producer since it requires an Eq instance on the</span><span>
</span><span id="line-1188"></span><span class="hs-comment">-- produced structure.</span><span>
</span><span id="line-1189"></span><span class="hs-comment">-- | Simplify a graph expression. Semantically, this is the identity function,</span><span>
</span><span id="line-1190"></span><span class="hs-comment">-- but it simplifies a given expression according to the laws of the algebra.</span><span>
</span><span id="line-1191"></span><span class="hs-comment">-- The function does not compute the simplest possible expression,</span><span>
</span><span id="line-1192"></span><span class="hs-comment">-- but uses heuristics to obtain useful simplifications in reasonable time.</span><span>
</span><span id="line-1193"></span><span class="hs-comment">-- Complexity: the function performs /O(s)/ graph comparisons. It is guaranteed</span><span>
</span><span id="line-1194"></span><span class="hs-comment">-- that the size of the result does not exceed the size of the given expression.</span><span>
</span><span id="line-1195"></span><span class="hs-comment">--</span><span>
</span><span id="line-1196"></span><span class="hs-comment">-- Good consumer.</span><span>
</span><span id="line-1197"></span><span class="hs-comment">--</span><span>
</span><span id="line-1198"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1199"></span><span class="hs-comment">-- simplify              == id</span><span>
</span><span id="line-1200"></span><span class="hs-comment">-- 'size' (simplify x)     &lt;= 'size' x</span><span>
</span><span id="line-1201"></span><span class="hs-comment">-- simplify 'empty'       '===' 'empty'</span><span>
</span><span id="line-1202"></span><span class="hs-comment">-- simplify 1           '===' 1</span><span>
</span><span id="line-1203"></span><span class="hs-comment">-- simplify (1 + 1)     '===' 1</span><span>
</span><span id="line-1204"></span><span class="hs-comment">-- simplify (1 + 2 + 1) '===' 1 + 2</span><span>
</span><span id="line-1205"></span><span class="hs-comment">-- simplify (1 * 1 * 1) '===' 1 * 1</span><span>
</span><span id="line-1206"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1207"></span><span id="local-6989586621679116671"><span class="annot"><a href="Algebra.Graph.html#simplify"><span class="hs-identifier hs-type">simplify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116671"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116671"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116671"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1208"></span><span id="simplify"><span class="annot"><span class="annottext">simplify :: forall a. Ord a =&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#simplify"><span class="hs-identifier hs-var hs-var">simplify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall g. Eq g =&gt; (g -&gt; g -&gt; g) -&gt; g -&gt; g -&gt; g
</span><a href="Algebra.Graph.html#simple"><span class="hs-identifier hs-var">simple</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall g. Eq g =&gt; (g -&gt; g -&gt; g) -&gt; g -&gt; g -&gt; g
</span><a href="Algebra.Graph.html#simple"><span class="hs-identifier hs-var">simple</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#Connect"><span class="hs-identifier hs-var">Connect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1209"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#simplify"><span class="hs-pragma hs-type">simplify</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1210"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#simplify"><span class="hs-pragma hs-type">simplify</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1211"></span><span>
</span><span id="line-1212"></span><span id="local-6989586621679116669"><span class="annot"><a href="Algebra.Graph.html#simple"><span class="hs-identifier hs-type">simple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116669"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116669"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116669"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116669"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116669"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116669"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679116669"><span class="hs-identifier hs-type">g</span></a></span></span><span>
</span><span id="line-1213"></span><span id="simple"><span class="annot"><span class="annottext">simple :: forall g. Eq g =&gt; (g -&gt; g -&gt; g) -&gt; g -&gt; g -&gt; g
</span><a href="Algebra.Graph.html#simple"><span class="hs-identifier hs-var hs-var">simple</span></a></span></span><span> </span><span id="local-6989586621679115863"><span class="annot"><span class="annottext">g -&gt; g -&gt; g
</span><a href="#local-6989586621679115863"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679115862"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679115862"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679115861"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679115861"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-1214"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679115862"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679115860"><span class="hs-identifier hs-var">z</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679115862"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1215"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679115861"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679115860"><span class="hs-identifier hs-var">z</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679115861"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1216"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679115860"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1217"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1218"></span><span>    </span><span id="local-6989586621679115860"><span class="annot"><span class="annottext">z :: g
</span><a href="#local-6989586621679115860"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g -&gt; g -&gt; g
</span><a href="#local-6989586621679115863"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679115862"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679115861"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1219"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#simple"><span class="hs-pragma hs-type">simple</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1220"></span><span>
</span><span id="line-1221"></span><span class="hs-comment">-- | Left-to-right /relational composition/ of graphs: vertices @x@ and @z@ are</span><span>
</span><span id="line-1222"></span><span class="hs-comment">-- connected in the resulting graph if there is a vertex @y@, such that @x@ is</span><span>
</span><span id="line-1223"></span><span class="hs-comment">-- connected to @y@ in the first graph, and @y@ is connected to @z@ in the</span><span>
</span><span id="line-1224"></span><span class="hs-comment">-- second graph. There are no isolated vertices in the result. This operation is</span><span>
</span><span id="line-1225"></span><span class="hs-comment">-- associative, has 'empty' and single-'vertex' graphs as /annihilating zeroes/,</span><span>
</span><span id="line-1226"></span><span class="hs-comment">-- and distributes over 'overlay'.</span><span>
</span><span id="line-1227"></span><span class="hs-comment">-- Complexity: /O(n * m * log(n))/ time, /O(n + m)/ memory, and /O(m1 + m2)/</span><span>
</span><span id="line-1228"></span><span class="hs-comment">-- size, where /n/ and /m/ stand for the number of vertices and edges in the</span><span>
</span><span id="line-1229"></span><span class="hs-comment">-- resulting graph, while /m1/ and /m2/ are the number of edges in the original</span><span>
</span><span id="line-1230"></span><span class="hs-comment">-- graphs. Note that the number of edges in the resulting graph may be</span><span>
</span><span id="line-1231"></span><span class="hs-comment">-- quadratic, i.e. /m = O(m1 * m2)/, but the algebraic representation requires</span><span>
</span><span id="line-1232"></span><span class="hs-comment">-- only /O(m1 + m2)/ operations to list them.</span><span>
</span><span id="line-1233"></span><span class="hs-comment">--</span><span>
</span><span id="line-1234"></span><span class="hs-comment">-- Good consumer of both arguments and good producer.</span><span>
</span><span id="line-1235"></span><span class="hs-comment">--</span><span>
</span><span id="line-1236"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1237"></span><span class="hs-comment">-- compose 'empty'            x                == 'empty'</span><span>
</span><span id="line-1238"></span><span class="hs-comment">-- compose x                'empty'            == 'empty'</span><span>
</span><span id="line-1239"></span><span class="hs-comment">-- compose ('vertex' x)       y                == 'empty'</span><span>
</span><span id="line-1240"></span><span class="hs-comment">-- compose x                ('vertex' y)       == 'empty'</span><span>
</span><span id="line-1241"></span><span class="hs-comment">-- compose x                (compose y z)    == compose (compose x y) z</span><span>
</span><span id="line-1242"></span><span class="hs-comment">-- compose x                ('overlay' y z)    == 'overlay' (compose x y) (compose x z)</span><span>
</span><span id="line-1243"></span><span class="hs-comment">-- compose ('overlay' x y)    z                == 'overlay' (compose x z) (compose y z)</span><span>
</span><span id="line-1244"></span><span class="hs-comment">-- compose ('edge' x y)       ('edge' y z)       == 'edge' x z</span><span>
</span><span id="line-1245"></span><span class="hs-comment">-- compose ('path'    [1..5]) ('path'    [1..5]) == 'edges' [(1,3), (2,4), (3,5)]</span><span>
</span><span id="line-1246"></span><span class="hs-comment">-- compose ('circuit' [1..5]) ('circuit' [1..5]) == 'circuit' [1,3,5,2,4]</span><span>
</span><span id="line-1247"></span><span class="hs-comment">-- 'size' (compose x y)                        &lt;= 'edgeCount' x + 'edgeCount' y + 1</span><span>
</span><span id="line-1248"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1249"></span><span id="local-6989586621679115859"><span class="annot"><a href="Algebra.Graph.html#compose"><span class="hs-identifier hs-type">compose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115859"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1250"></span><span id="compose"><span class="annot"><span class="annottext">compose :: forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#compose"><span class="hs-identifier hs-var hs-var">compose</span></a></span></span><span> </span><span id="local-6989586621679115855"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115855"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679115854"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115854"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall r. r -&gt; (a -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; (r -&gt; r -&gt; r) -&gt; r)
-&gt; Graph a
</span><a href="Algebra.Graph.html#buildg"><span class="hs-identifier hs-var">buildg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679115848"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679115848"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679115847"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679115847"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679115846"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115846"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679115845"><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115845"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679115848"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1251"></span><span>  </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; Maybe a
</span><a href="Algebra.Graph.Internal.html#foldr1Safe"><span class="hs-identifier hs-var">foldr1Safe</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115846"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-1252"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679115848"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679115847"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115846"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
</span><a href="#local-6989586621679115845"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#biclique"><span class="hs-identifier hs-var">biclique</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115844"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115843"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1253"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679115842"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115842"><span class="hs-identifier hs-var">ve</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. AdjacencyMap a -&gt; Set a
</span><a href="Algebra.Graph.AdjacencyMap.html#vertexSet"><span class="hs-identifier hs-var">AM.vertexSet</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a
</span><a href="#local-6989586621679115839"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-operator hs-var">`Set.union`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. AdjacencyMap a -&gt; Set a
</span><a href="Algebra.Graph.AdjacencyMap.html#vertexSet"><span class="hs-identifier hs-var">AM.vertexSet</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a
</span><a href="#local-6989586621679115838"><span class="hs-identifier hs-var">my</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1254"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679115844"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621679115844"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; AdjacencyMap a -&gt; Set a
</span><a href="Algebra.Graph.AdjacencyMap.html#postSet"><span class="hs-identifier hs-var">AM.postSet</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115842"><span class="hs-identifier hs-var">ve</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a
</span><a href="#local-6989586621679115839"><span class="hs-identifier hs-var">mx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115844"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1255"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679115843"><span class="annot"><span class="annottext">ys :: [a]
</span><a href="#local-6989586621679115843"><span class="hs-identifier hs-var hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; AdjacencyMap a -&gt; Set a
</span><a href="Algebra.Graph.AdjacencyMap.html#postSet"><span class="hs-identifier hs-var">AM.postSet</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115842"><span class="hs-identifier hs-var">ve</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap a
</span><a href="#local-6989586621679115838"><span class="hs-identifier hs-var">my</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115843"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1256"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1257"></span><span>    </span><span id="local-6989586621679115839"><span class="annot"><span class="annottext">mx :: AdjacencyMap a
</span><a href="#local-6989586621679115839"><span class="hs-identifier hs-var hs-var">mx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-var">toAdjacencyMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115855"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1258"></span><span>    </span><span id="local-6989586621679115838"><span class="annot"><span class="annottext">my :: AdjacencyMap a
</span><a href="#local-6989586621679115838"><span class="hs-identifier hs-var hs-var">my</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; AdjacencyMap a
</span><a href="Algebra.Graph.html#toAdjacencyMap"><span class="hs-identifier hs-var">toAdjacencyMap</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115854"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1259"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#compose"><span class="hs-pragma hs-type">compose</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1260"></span><span>
</span><span id="line-1261"></span><span class="hs-comment">-- | Compute the /Cartesian product/ of graphs.</span><span>
</span><span id="line-1262"></span><span class="hs-comment">-- Complexity: /O(s1 * s2)/ time, memory and size, where /s1/ and /s2/ are the</span><span>
</span><span id="line-1263"></span><span class="hs-comment">-- sizes of the given graphs.</span><span>
</span><span id="line-1264"></span><span class="hs-comment">--</span><span>
</span><span id="line-1265"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1266"></span><span class="hs-comment">-- box ('path' [0,1]) ('path' &quot;ab&quot;) == 'edges' [ ((0,\'a\'), (0,\'b\'))</span><span>
</span><span id="line-1267"></span><span class="hs-comment">--                                       , ((0,\'a\'), (1,\'a\'))</span><span>
</span><span id="line-1268"></span><span class="hs-comment">--                                       , ((0,\'b\'), (1,\'b\'))</span><span>
</span><span id="line-1269"></span><span class="hs-comment">--                                       , ((1,\'a\'), (1,\'b\')) ]</span><span>
</span><span id="line-1270"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1271"></span><span class="hs-comment">-- Up to isomorphism between the resulting vertex types, this operation is</span><span>
</span><span id="line-1272"></span><span class="hs-comment">-- /commutative/, /associative/, /distributes/ over 'overlay', has singleton</span><span>
</span><span id="line-1273"></span><span class="hs-comment">-- graphs as /identities/ and 'empty' as the /annihilating zero/. Below @~~@</span><span>
</span><span id="line-1274"></span><span class="hs-comment">-- stands for equality up to an isomorphism, e.g. @(x,@ @()) ~~ x@.</span><span>
</span><span id="line-1275"></span><span class="hs-comment">--</span><span>
</span><span id="line-1276"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1277"></span><span class="hs-comment">-- box x y               ~~ box y x</span><span>
</span><span id="line-1278"></span><span class="hs-comment">-- box x (box y z)       ~~ box (box x y) z</span><span>
</span><span id="line-1279"></span><span class="hs-comment">-- box x ('overlay' y z)   == 'overlay' (box x y) (box x z)</span><span>
</span><span id="line-1280"></span><span class="hs-comment">-- box x ('vertex' ())     ~~ x</span><span>
</span><span id="line-1281"></span><span class="hs-comment">-- box x 'empty'           ~~ 'empty'</span><span>
</span><span id="line-1282"></span><span class="hs-comment">-- 'transpose'   (box x y) == box ('transpose' x) ('transpose' y)</span><span>
</span><span id="line-1283"></span><span class="hs-comment">-- 'vertexCount' (box x y) == 'vertexCount' x * 'vertexCount' y</span><span>
</span><span id="line-1284"></span><span class="hs-comment">-- 'edgeCount'   (box x y) &lt;= 'vertexCount' x * 'edgeCount' y + 'edgeCount' x * 'vertexCount' y</span><span>
</span><span id="line-1285"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1286"></span><span id="local-6989586621679116662"><span id="local-6989586621679116663"><span class="annot"><a href="Algebra.Graph.html#box"><span class="hs-identifier hs-type">box</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116663"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116662"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116663"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679116662"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1287"></span><span id="box"><span class="annot"><span class="annottext">box :: forall a b. Graph a -&gt; Graph b -&gt; Graph (a, b)
</span><a href="Algebra.Graph.html#box"><span class="hs-identifier hs-var hs-var">box</span></a></span></span><span> </span><span id="local-6989586621679115834"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115834"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679115833"><span class="annot"><span class="annottext">Graph b
</span><a href="#local-6989586621679115833"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph (b -&gt; (a, b))
</span><a href="#local-6989586621679115832"><span class="hs-identifier hs-var">fx</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Graph b
</span><a href="#local-6989586621679115833"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph (a -&gt; (a, b))
</span><a href="#local-6989586621679115831"><span class="hs-identifier hs-var">fy</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115834"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1288"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1289"></span><span>    </span><span id="local-6989586621679115832"><span class="annot"><span class="annottext">fx :: Graph (b -&gt; (a, b))
</span><a href="#local-6989586621679115832"><span class="hs-identifier hs-var hs-var">fx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span>      </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115834"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1290"></span><span>    </span><span id="local-6989586621679115831"><span class="annot"><span class="annottext">fy :: Graph (a -&gt; (a, b))
</span><a href="#local-6989586621679115831"><span class="hs-identifier hs-var hs-var">fy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">Graph b
</span><a href="#local-6989586621679115833"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1291"></span><span>
</span><span id="line-1292"></span><span class="hs-comment">-- | /Sparsify/ a graph by adding intermediate 'Left' @Int@ vertices between the</span><span>
</span><span id="line-1293"></span><span class="hs-comment">-- original vertices (wrapping the latter in 'Right') such that the resulting</span><span>
</span><span id="line-1294"></span><span class="hs-comment">-- graph is /sparse/, i.e. contains only /O(s)/ edges, but preserves the</span><span>
</span><span id="line-1295"></span><span class="hs-comment">-- reachability relation between the original vertices. Sparsification is useful</span><span>
</span><span id="line-1296"></span><span class="hs-comment">-- when working with dense graphs, as it can reduce the number of edges from</span><span>
</span><span id="line-1297"></span><span class="hs-comment">-- /O(n^2)/ down to /O(n)/ by replacing cliques, bicliques and similar densely</span><span>
</span><span id="line-1298"></span><span class="hs-comment">-- connected structures by sparse subgraphs built out of intermediate vertices.</span><span>
</span><span id="line-1299"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-1300"></span><span class="hs-comment">--</span><span>
</span><span id="line-1301"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1302"></span><span class="hs-comment">-- 'Data.List.sort' . 'Algebra.Graph.ToGraph.reachable' x       == 'Data.List.sort' . 'Data.Either.rights' . 'Algebra.Graph.ToGraph.reachable' (sparsify x) . 'Data.Either.Right'</span><span>
</span><span id="line-1303"></span><span class="hs-comment">-- 'vertexCount' (sparsify x) &lt;= 'vertexCount' x + 'size' x + 1</span><span>
</span><span id="line-1304"></span><span class="hs-comment">-- 'edgeCount'   (sparsify x) &lt;= 3 * 'size' x</span><span>
</span><span id="line-1305"></span><span class="hs-comment">-- 'size'        (sparsify x) &lt;= 3 * 'size' x</span><span>
</span><span id="line-1306"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1307"></span><span id="local-6989586621679116659"><span class="annot"><a href="Algebra.Graph.html#sparsify"><span class="hs-identifier hs-type">sparsify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116659"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116659"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1308"></span><span id="sparsify"><span class="annot"><span class="annottext">sparsify :: forall a. Graph a -&gt; Graph (Either Int a)
</span><a href="Algebra.Graph.html#sparsify"><span class="hs-identifier hs-var hs-var">sparsify</span></a></span></span><span> </span><span id="local-6989586621679115823"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115823"><span class="hs-identifier hs-var">graph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Graph (Either Int a)
</span><a href="#local-6989586621679115822"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1309"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1310"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679115822"><span class="annot"><span class="annottext">Graph (Either Int a)
</span><a href="#local-6989586621679115822"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679115821"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115821"><span class="hs-identifier hs-var">end</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s a. State s a -&gt; s -&gt; (a, s)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {b}.
Monad m =&gt;
a -&gt; a -&gt; m (Graph (Either a b))
</span><a href="#local-6989586621679115820"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {b} {a}.
Monad m =&gt;
b -&gt; a -&gt; a -&gt; m (Graph (Either a b))
</span><a href="#local-6989586621679115819"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *} {t} {t} {a}.
Applicative f =&gt;
(t -&gt; t -&gt; f (Graph a))
-&gt; (t -&gt; t -&gt; f (Graph a)) -&gt; t -&gt; t -&gt; f (Graph a)
</span><a href="#local-6989586621679115818"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {t} {t} {a} {t}.
(Monad m, Num t) =&gt;
(t -&gt; t -&gt; StateT t m (Graph a))
-&gt; (t -&gt; t -&gt; StateT t m (Graph a))
-&gt; t
-&gt; t
-&gt; StateT t m (Graph a)
</span><a href="#local-6989586621679115817"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115823"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115821"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1311"></span><span>    </span><span id="local-6989586621679115820"><span class="annot"><span class="annottext">e :: a -&gt; a -&gt; m (Graph (Either a b))
</span><a href="#local-6989586621679115820"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span>     </span><span id="local-6989586621679115814"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115814"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679115813"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115813"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#path"><span class="hs-identifier hs-var">path</span></a></span><span>   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115814"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span>          </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115813"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1312"></span><span>    </span><span id="local-6989586621679115819"><span class="annot"><span class="annottext">v :: b -&gt; a -&gt; a -&gt; m (Graph (Either a b))
</span><a href="#local-6989586621679115819"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679115810"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115810"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span id="local-6989586621679115809"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115809"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679115808"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115808"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#clique"><span class="hs-identifier hs-var">clique</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115809"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115810"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679115808"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1313"></span><span>    </span><span id="local-6989586621679115818"><span class="annot"><span class="annottext">o :: (t -&gt; t -&gt; f (Graph a))
-&gt; (t -&gt; t -&gt; f (Graph a)) -&gt; t -&gt; t -&gt; f (Graph a)
</span><a href="#local-6989586621679115818"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679115802"><span class="annot"><span class="annottext">t -&gt; t -&gt; f (Graph a)
</span><a href="#local-6989586621679115802"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679115801"><span class="annot"><span class="annottext">t -&gt; t -&gt; f (Graph a)
</span><a href="#local-6989586621679115801"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679115800"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115800"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679115799"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115799"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115800"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; f (Graph a)
</span><a href="#local-6989586621679115802"><span class="hs-operator hs-var">`x`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115799"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115800"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; f (Graph a)
</span><a href="#local-6989586621679115801"><span class="hs-operator hs-var">`y`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115799"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1314"></span><span>    </span><span id="local-6989586621679115817"><span class="annot"><span class="annottext">c :: (t -&gt; t -&gt; StateT t m (Graph a))
-&gt; (t -&gt; t -&gt; StateT t m (Graph a))
-&gt; t
-&gt; t
-&gt; StateT t m (Graph a)
</span><a href="#local-6989586621679115817"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679115781"><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m (Graph a)
</span><a href="#local-6989586621679115781"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679115780"><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m (Graph a)
</span><a href="#local-6989586621679115780"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679115779"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115779"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679115778"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115778"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1315"></span><span>        </span><span id="local-6989586621679115777"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115777"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-1316"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1317"></span><span>        </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115779"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m (Graph a)
</span><a href="#local-6989586621679115781"><span class="hs-operator hs-var">`x`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m (Graph a)
</span><a href="#local-6989586621679115780"><span class="hs-operator hs-var">`y`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115778"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1318"></span><span>
</span><span id="line-1319"></span><span class="hs-comment">-- | Sparsify a graph whose vertices are integers in the range @[1..n]@, where</span><span>
</span><span id="line-1320"></span><span class="hs-comment">-- @n@ is the first argument of the function, producing an array-based graph</span><span>
</span><span id="line-1321"></span><span class="hs-comment">-- representation from &quot;Data.Graph&quot; (introduced by King and Launchbury, hence</span><span>
</span><span id="line-1322"></span><span class="hs-comment">-- the name of the function). In the resulting graph, vertices @[1..n]@</span><span>
</span><span id="line-1323"></span><span class="hs-comment">-- correspond to the original vertices, and all vertices greater than @n@ are</span><span>
</span><span id="line-1324"></span><span class="hs-comment">-- introduced by the sparsification procedure.</span><span>
</span><span id="line-1325"></span><span class="hs-comment">--</span><span>
</span><span id="line-1326"></span><span class="hs-comment">-- Complexity: /O(s)/ time and memory. Note that thanks to sparsification, the</span><span>
</span><span id="line-1327"></span><span class="hs-comment">-- resulting graph has a linear number of edges with respect to the size of the</span><span>
</span><span id="line-1328"></span><span class="hs-comment">-- original algebraic representation even though the latter can potentially</span><span>
</span><span id="line-1329"></span><span class="hs-comment">-- contain a quadratic /O(s^2)/ number of edges.</span><span>
</span><span id="line-1330"></span><span class="hs-comment">--</span><span>
</span><span id="line-1331"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1332"></span><span class="hs-comment">-- 'Data.List.sort' . 'Algebra.Graph.ToGraph.reachable' x                 == 'Data.List.sort' . 'filter' (&lt;= n) . 'Data.Graph.reachable' (sparsifyKL n x)</span><span>
</span><span id="line-1333"></span><span class="hs-comment">-- 'length' ('Data.Graph.vertices' $ sparsifyKL n x) &lt;= 'vertexCount' x + 'size' x + 1</span><span>
</span><span id="line-1334"></span><span class="hs-comment">-- 'length' ('Data.Graph.edges'    $ sparsifyKL n x) &lt;= 3 * 'size' x</span><span>
</span><span id="line-1335"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1336"></span><span class="annot"><a href="Algebra.Graph.html#sparsifyKL"><span class="hs-identifier hs-type">sparsifyKL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">KL.Graph</span></a></span><span>
</span><span id="line-1337"></span><span id="sparsifyKL"><span class="annot"><span class="annottext">sparsifyKL :: Int -&gt; Graph Int -&gt; Graph
</span><a href="Algebra.Graph.html#sparsifyKL"><span class="hs-identifier hs-var hs-var">sparsifyKL</span></a></span></span><span> </span><span id="local-6989586621679115776"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115776"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679115775"><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679115775"><span class="hs-identifier hs-var">graph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Edge -&gt; [Edge] -&gt; Graph
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">KL.buildG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115773"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115776"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115776"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Exts.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">List Edge
</span><a href="#local-6989586621679115772"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Internal.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">KL.Edge</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1338"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1339"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679115772"><span class="annot"><span class="annottext">List Edge
</span><a href="#local-6989586621679115772"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679115773"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115773"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s a. State s a -&gt; s -&gt; (a, s)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a} {p} {p}.
(Monad m, IsList a) =&gt;
p -&gt; p -&gt; m a
</span><a href="#local-6989586621679115771"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {b} {m :: * -&gt; *}.
(Item a ~ (b, b), Monad m, IsList a) =&gt;
b -&gt; b -&gt; b -&gt; m a
</span><a href="#local-6989586621679115770"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *} {b} {t} {t}.
(Applicative f, Semigroup b) =&gt;
(t -&gt; t -&gt; f b) -&gt; (t -&gt; t -&gt; f b) -&gt; t -&gt; t -&gt; f b
</span><a href="#local-6989586621679115769"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall {b} {t} {m :: * -&gt; *}.
(Item b ~ (t, t), Monad m, Num t, Semigroup b, IsList b) =&gt;
(t -&gt; t -&gt; StateT t m b)
-&gt; (t -&gt; t -&gt; StateT t m b) -&gt; t -&gt; t -&gt; StateT t m b
</span><a href="#local-6989586621679115768"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Graph Int
</span><a href="#local-6989586621679115775"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115776"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115776"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115776"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-1340"></span><span>    </span><span id="local-6989586621679115771"><span class="annot"><span class="annottext">e :: p -&gt; p -&gt; m a
</span><a href="#local-6989586621679115771"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span>     </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; [Item l] -&gt; l
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Exts.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1341"></span><span>    </span><span id="local-6989586621679115770"><span class="annot"><span class="annottext">v :: b -&gt; b -&gt; b -&gt; m a
</span><a href="#local-6989586621679115770"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679115757"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115757"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span id="local-6989586621679115756"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115756"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679115755"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115755"><span class="hs-identifier hs-var">t</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; [Item l] -&gt; l
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Exts.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115756"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115757"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115757"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115755"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1342"></span><span>    </span><span id="local-6989586621679115769"><span class="annot"><span class="annottext">o :: (t -&gt; t -&gt; f b) -&gt; (t -&gt; t -&gt; f b) -&gt; t -&gt; t -&gt; f b
</span><a href="#local-6989586621679115769"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679115748"><span class="annot"><span class="annottext">t -&gt; t -&gt; f b
</span><a href="#local-6989586621679115748"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679115747"><span class="annot"><span class="annottext">t -&gt; t -&gt; f b
</span><a href="#local-6989586621679115747"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679115746"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115746"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679115745"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115745"><span class="hs-identifier hs-var">t</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(&lt;&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115746"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; f b
</span><a href="#local-6989586621679115748"><span class="hs-operator hs-var">`x`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115745"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115746"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; f b
</span><a href="#local-6989586621679115747"><span class="hs-operator hs-var">`y`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115745"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1343"></span><span>    </span><span id="local-6989586621679115768"><span class="annot"><span class="annottext">c :: (t -&gt; t -&gt; StateT t m b)
-&gt; (t -&gt; t -&gt; StateT t m b) -&gt; t -&gt; t -&gt; StateT t m b
</span><a href="#local-6989586621679115768"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679115723"><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m b
</span><a href="#local-6989586621679115723"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679115722"><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m b
</span><a href="#local-6989586621679115722"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679115721"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115721"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679115720"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115720"><span class="hs-identifier hs-var">t</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1344"></span><span>        </span><span id="local-6989586621679115719"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115719"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-1345"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115719"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1346"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679115718"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115718"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679115717"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115717"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; [Item l] -&gt; l
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Exts.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115721"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115719"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115719"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115720"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115718"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679115717"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115721"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m b
</span><a href="#local-6989586621679115723"><span class="hs-operator hs-var">`x`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115719"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115719"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; StateT t m b
</span><a href="#local-6989586621679115722"><span class="hs-operator hs-var">`y`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679115720"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1347"></span><span>
</span><span id="line-1348"></span><span class="hs-comment">{- Note [The rules of foldg]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The rules for foldg work very similarly to GHC's mapFB rules; see a note below
this line: http://hackage.haskell.org/package/base/docs/src/GHC.Base.html#mapFB.

* The expressions are first inlined to allow the compiler to apply the main rule
  &quot;foldg/buildg&quot; that states that the composition of a good producer (expressed
  via 'buildg') and a good consumer (expressed via 'foldg') can be fused to
  avoid the construction of an intermediate structure.

* If this inlining is made blindly, it can lead to unneeded operations. They are
  optimised via the &quot;foldg/id&quot; rule.

* 'composeR' is here to allow further optimisation. As a high-order function, it
  benefits from inlining in the final phase.

* The &quot;composeR/composeR&quot; rule optimises compositions of 'composeR' chains.
-}</span><span>
</span><span id="line-1367"></span><span>
</span><span id="line-1368"></span><span id="local-6989586621679115714"><span id="local-6989586621679115715"><span id="local-6989586621679115716"><span class="annot"><a href="Algebra.Graph.html#composeR"><span class="hs-identifier hs-type">composeR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679115716"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679115715"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679115714"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679115716"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679115714"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679115715"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-1369"></span><span id="composeR"><span class="annot"><span class="annottext">composeR :: forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="Algebra.Graph.html#composeR"><span class="hs-identifier hs-var hs-var">composeR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">(.)</span></a></span><span>
</span><span id="line-1370"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.html#composeR"><span class="hs-pragma hs-type">composeR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1371"></span><span>
</span><span id="line-1372"></span><span class="hs-comment">-- Rewrite rules for algebraic graph fusion.</span><span>
</span><span id="line-1373"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1374"></span><span>
</span><span id="line-1375"></span><span class="hs-pragma">-- Fuse a 'foldg' followed by a 'buildg':</span><span>
</span><span id="line-1376"></span><span id="local-6989586621679115713"><span class="annot"><span class="hs-pragma">&quot;foldg/buildg&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679115712"><span class="annot"><a href="#local-6989586621679115712"><span class="hs-pragma hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679115711"><span class="annot"><a href="#local-6989586621679115711"><span class="hs-pragma hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679115710"><span class="annot"><a href="#local-6989586621679115710"><span class="hs-pragma hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679115709"><span class="annot"><a href="#local-6989586621679115709"><span class="hs-pragma hs-var">c</span></a></span></span><span> </span><span class="hs-pragma">(</span><span id="local-6989586621679115708"><span class="annot"><a href="#local-6989586621679115708"><span class="hs-pragma hs-var">g</span></a></span></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679115707"><span class="annot"><a href="#local-6989586621679115707"><span class="hs-pragma hs-type">b</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="#local-6989586621679115707"><span class="hs-pragma hs-type">b</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621679115713"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679115707"><span class="hs-pragma hs-type">b</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621679115707"><span class="hs-pragma hs-type">b</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679115707"><span class="hs-pragma hs-type">b</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679115707"><span class="hs-pragma hs-type">b</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621679115707"><span class="hs-pragma hs-type">b</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679115707"><span class="hs-pragma hs-type">b</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679115707"><span class="hs-pragma hs-type">b</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679115707"><span class="hs-pragma hs-type">b</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">.</span><span>
</span><span id="line-1377"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#foldg"><span class="hs-pragma hs-type">foldg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115712"><span class="hs-pragma hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115711"><span class="hs-pragma hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115710"><span class="hs-pragma hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115709"><span class="hs-pragma hs-type">c</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.html#buildg"><span class="hs-pragma hs-type">buildg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115708"><span class="hs-pragma hs-type">g</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="#local-6989586621679115708"><span class="hs-pragma hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115712"><span class="hs-pragma hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115711"><span class="hs-pragma hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115710"><span class="hs-pragma hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115709"><span class="hs-pragma hs-type">c</span></a></span></span><span>
</span><span id="line-1378"></span><span>
</span><span id="line-1379"></span><span class="hs-pragma">-- Fuse 'composeR' chains (see the definition of the bind operator).</span><span>
</span><span id="line-1380"></span><span class="annot"><span class="hs-pragma">&quot;composeR/composeR&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679115706"><span class="annot"><a href="#local-6989586621679115706"><span class="hs-pragma hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679115705"><span class="annot"><a href="#local-6989586621679115705"><span class="hs-pragma hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679115704"><span class="annot"><a href="#local-6989586621679115704"><span class="hs-pragma hs-var">g</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-1381"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#composeR"><span class="hs-pragma hs-type">composeR</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Algebra.Graph.html#composeR"><span class="hs-pragma hs-type">composeR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115706"><span class="hs-pragma hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115705"><span class="hs-pragma hs-type">f</span></a></span><span class="hs-pragma">)</span><span> </span><span class="annot"><a href="#local-6989586621679115704"><span class="hs-pragma hs-type">g</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Algebra.Graph.html#composeR"><span class="hs-pragma hs-type">composeR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115706"><span class="hs-pragma hs-type">c</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621679115705"><span class="hs-pragma hs-type">f</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-pragma hs-type">.</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679115704"><span class="hs-pragma hs-type">g</span></a></span><span class="hs-pragma">)</span><span>
</span><span id="line-1382"></span><span>
</span><span id="line-1383"></span><span class="hs-pragma">-- Rewrite identity (which can appear in the inlining of 'buildg') to a more</span><span>
</span><span id="line-1384"></span><span class="hs-pragma">-- efficient one.</span><span>
</span><span id="line-1385"></span><span class="annot"><span class="hs-pragma">&quot;foldg/id&quot;</span></span><span>
</span><span id="line-1386"></span><span>    </span><span class="annot"><a href="Algebra.Graph.html#foldg"><span class="hs-pragma hs-type">foldg</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.html#Empty"><span class="hs-pragma hs-type">Empty</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.html#Vertex"><span class="hs-pragma hs-type">Vertex</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.html#Overlay"><span class="hs-pragma hs-type">Overlay</span></a></span><span> </span><span class="annot"><a href="Algebra.Graph.html#Connect"><span class="hs-pragma hs-type">Connect</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-pragma hs-type">id</span></a></span><span>
</span><span id="line-1387"></span><span>
</span><span id="line-1388"></span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1389"></span><span>
</span><span id="line-1390"></span><span class="hs-comment">-- 'Focus' on a specified subgraph.</span><span>
</span><span id="line-1391"></span><span id="local-6989586621679116614"><span class="annot"><a href="Algebra.Graph.html#focus"><span class="hs-identifier hs-type">focus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116614"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116614"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Internal.html#Focus"><span class="hs-identifier hs-type">Focus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116614"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1392"></span><span id="focus"><span class="annot"><span class="annottext">focus :: forall a. (a -&gt; Bool) -&gt; Graph a -&gt; Focus a
</span><a href="Algebra.Graph.html#focus"><span class="hs-identifier hs-var hs-var">focus</span></a></span></span><span> </span><span id="local-6989586621679115702"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679115702"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Focus a
</span><a href="Algebra.Graph.Internal.html#emptyFocus"><span class="hs-identifier hs-var">emptyFocus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; a -&gt; Focus a
</span><a href="Algebra.Graph.Internal.html#vertexFocus"><span class="hs-identifier hs-var">vertexFocus</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679115702"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Focus a -&gt; Focus a -&gt; Focus a
</span><a href="Algebra.Graph.Internal.html#overlayFoci"><span class="hs-identifier hs-var">overlayFoci</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Focus a -&gt; Focus a -&gt; Focus a
</span><a href="Algebra.Graph.Internal.html#connectFoci"><span class="hs-identifier hs-var">connectFoci</span></a></span><span>
</span><span id="line-1393"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#focus"><span class="hs-pragma hs-type">focus</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1394"></span><span>
</span><span id="line-1395"></span><span class="hs-comment">-- | The 'Context' of a subgraph comprises its 'inputs' and 'outputs', i.e. all</span><span>
</span><span id="line-1396"></span><span class="hs-comment">-- the vertices that are connected to the subgraph's vertices. Note that inputs</span><span>
</span><span id="line-1397"></span><span class="hs-comment">-- and outputs can belong to the subgraph itself. In general, there are no</span><span>
</span><span id="line-1398"></span><span class="hs-comment">-- guarantees on the order of vertices in 'inputs' and 'outputs'; furthermore,</span><span>
</span><span id="line-1399"></span><span class="hs-comment">-- there may be repetitions.</span><span>
</span><span id="line-1400"></span><span class="hs-keyword">data</span><span> </span><span id="Context"><span class="annot"><a href="Algebra.Graph.html#Context"><span class="hs-identifier hs-var">Context</span></a></span></span><span> </span><span id="local-6989586621679116608"><span class="annot"><a href="#local-6989586621679116608"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Context"><span class="annot"><a href="Algebra.Graph.html#Context"><span class="hs-identifier hs-var">Context</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="inputs"><span class="annot"><span class="annottext">forall a. Context a -&gt; [a]
</span><a href="Algebra.Graph.html#inputs"><span class="hs-identifier hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116608"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="outputs"><span class="annot"><span class="annottext">forall a. Context a -&gt; [a]
</span><a href="Algebra.Graph.html#outputs"><span class="hs-identifier hs-var hs-var">outputs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679116608"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1401"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679115689"><span id="local-6989586621679115694"><span class="annot"><span class="annottext">Context a -&gt; Context a -&gt; Bool
forall a. Eq a =&gt; Context a -&gt; Context a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Context a -&gt; Context a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Context a -&gt; Context a -&gt; Bool
== :: Context a -&gt; Context a -&gt; Bool
$c== :: forall a. Eq a =&gt; Context a -&gt; Context a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679115679"><span id="local-6989586621679115681"><span id="local-6989586621679115687"><span class="annot"><span class="annottext">Int -&gt; Context a -&gt; ShowS
forall a. Show a =&gt; Int -&gt; Context a -&gt; ShowS
forall a. Show a =&gt; [Context a] -&gt; ShowS
forall a. Show a =&gt; Context a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Context a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [Context a] -&gt; ShowS
show :: Context a -&gt; String
$cshow :: forall a. Show a =&gt; Context a -&gt; String
showsPrec :: Int -&gt; Context a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Context a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1402"></span><span>
</span><span id="line-1403"></span><span class="hs-comment">-- | Extract the 'Context' of a subgraph specified by a given predicate. Returns</span><span>
</span><span id="line-1404"></span><span class="hs-comment">-- @Nothing@ if the specified subgraph is empty.</span><span>
</span><span id="line-1405"></span><span class="hs-comment">--</span><span>
</span><span id="line-1406"></span><span class="hs-comment">-- Good consumer.</span><span>
</span><span id="line-1407"></span><span class="hs-comment">--</span><span>
</span><span id="line-1408"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1409"></span><span class="hs-comment">-- context ('const' False) x                   == Nothing</span><span>
</span><span id="line-1410"></span><span class="hs-comment">-- context (== 1)        ('edge' 1 2)          == Just ('Context' [   ] [2  ])</span><span>
</span><span id="line-1411"></span><span class="hs-comment">-- context (== 2)        ('edge' 1 2)          == Just ('Context' [1  ] [   ])</span><span>
</span><span id="line-1412"></span><span class="hs-comment">-- context ('const' True ) ('edge' 1 2)          == Just ('Context' [1  ] [2  ])</span><span>
</span><span id="line-1413"></span><span class="hs-comment">-- context (== 4)        (3 * 1 * 4 * 1 * 5) == Just ('Context' [3,1] [1,5])</span><span>
</span><span id="line-1414"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1415"></span><span id="local-6989586621679116689"><span class="annot"><a href="Algebra.Graph.html#context"><span class="hs-identifier hs-type">context</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679116689"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116689"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116689"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1416"></span><span id="context"><span class="annot"><span class="annottext">context :: forall a. (a -&gt; Bool) -&gt; Graph a -&gt; Maybe (Context a)
</span><a href="Algebra.Graph.html#context"><span class="hs-identifier hs-var hs-var">context</span></a></span></span><span> </span><span id="local-6989586621679115675"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679115675"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679115674"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115674"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Focus a -&gt; Bool
</span><a href="Algebra.Graph.Internal.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Focus a
</span><a href="#local-6989586621679115672"><span class="hs-identifier hs-var">f</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; Context a
</span><a href="Algebra.Graph.html#Context"><span class="hs-identifier hs-var">Context</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Focus a -&gt; List a
</span><a href="Algebra.Graph.Internal.html#is"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">Focus a
</span><a href="#local-6989586621679115672"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Focus a -&gt; List a
</span><a href="Algebra.Graph.Internal.html#os"><span class="hs-identifier hs-var">os</span></a></span><span> </span><span class="annot"><span class="annottext">Focus a
</span><a href="#local-6989586621679115672"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1417"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1418"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1419"></span><span>    </span><span id="local-6989586621679115672"><span class="annot"><span class="annottext">f :: Focus a
</span><a href="#local-6989586621679115672"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Graph a -&gt; Focus a
</span><a href="Algebra.Graph.html#focus"><span class="hs-identifier hs-var">focus</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679115675"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679115674"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1420"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.html#context"><span class="hs-pragma hs-type">context</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1421"></span></pre></body></html>