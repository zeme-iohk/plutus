<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PolyKinds    #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Barbies.Internal.DistributiveT</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier">DistributiveT</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute%27"><span class="hs-identifier">tdistribute'</span></a></span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tcotraverse"><span class="hs-identifier">tcotraverse</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdecompose"><span class="hs-identifier">tdecompose</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#trecompose"><span class="hs-identifier">trecompose</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#gtdistributeDefault"><span class="hs-identifier">gtdistributeDefault</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#CanDeriveDistributiveT"><span class="hs-identifier">CanDeriveDistributiveT</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Barbies.Generics.Distributive.html"><span class="hs-identifier">Barbies.Generics.Distributive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Barbies.Generics.Distributive.html#GDistributive"><span class="hs-identifier">GDistributive</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Barbies.Internal.FunctorT.html"><span class="hs-identifier">Barbies.Internal.FunctorT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Barbies.Internal.FunctorT.html#FunctorT"><span class="hs-identifier">FunctorT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Applicative.Backwards</span></a></span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Backwards</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.Except</span></a></span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">ExceptT</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">runExceptT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.Identity</span></a></span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">IdentityT</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.Maybe</span></a></span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">MaybeT</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.RWS.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lazy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">RWST</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.RWS.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">RWST</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.Reader</span></a></span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">ReaderT</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.State.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lazy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">StateT</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">StateT</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.Writer.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lazy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">WriterT</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.Writer.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">WriterT</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Functor.Compose</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Compose</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Functor.Identity</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Identity</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Data.Functor.Reverse</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Reverse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Generics.GenericN.html"><span class="hs-identifier">Data.Generics.GenericN</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../distributive/html/src"><span class="hs-identifier">Data.Distributive</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | A 'FunctorT' where the effects can be distributed to the fields:</span><span>
</span><span id="line-42"></span><span class="hs-comment">--  `tdistribute` turns an effectful way of building a transformer-type</span><span>
</span><span id="line-43"></span><span class="hs-comment">--  into a pure transformer-type with effectful ways of computing the</span><span>
</span><span id="line-44"></span><span class="hs-comment">--  values of its fields.</span><span>
</span><span id="line-45"></span><span class="hs-comment">--</span><span>
</span><span id="line-46"></span><span class="hs-comment">--  This class is the categorical dual of `Barbies.Internal.TraversableT.TraversableT`,</span><span>
</span><span id="line-47"></span><span class="hs-comment">--  with `tdistribute` the dual of `Barbies.Internal.TraversableT.tsequence`</span><span>
</span><span id="line-48"></span><span class="hs-comment">--  and `tcotraverse` the dual of `Barbies.Internal.TraversableT.ttraverse`. As such,</span><span>
</span><span id="line-49"></span><span class="hs-comment">--  instances need to satisfy these laws:</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- 'tdistribute' . h = 'tmap' ('Compose' . h . 'getCompose') . 'tdistribute'    -- naturality</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- 'tdistribute' . 'Data.Functor.Identity' = 'tmap' ('Compose' . 'Data.Functor.Identity')                 -- identity</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- 'tdistribute' . 'Compose' = 'fmap' ('Compose' . 'Compose' . 'fmap' 'getCompose' . 'getCompose') . 'tdistribute' . 'fmap' 'distribute' -- composition</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-56"></span><span class="hs-comment">--</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- By specializing @f@ to @((-&gt;) a)@ and @g@ to 'Identity', we can define a function that</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- decomposes a function on distributive transformers into a collection of simpler functions:</span><span>
</span><span id="line-59"></span><span class="hs-comment">--</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- 'tdecompose' :: 'DistributiveT' b =&gt; (a -&gt; b 'Identity') -&gt; b ((-&gt;) a)</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- 'tdecompose' = 'tmap' ('fmap' 'runIdentity' . 'getCompose') . 'tdistribute'</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-64"></span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- Lawful instances of the class can then be characterized as those that satisfy:</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- 'trecompose' . 'tdecompose' = 'id'</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- 'tdecompose' . 'trecompose' = 'id'</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-71"></span><span class="hs-comment">--</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- This means intuitively that instances need to have a fixed shape (i.e. no sum-types can be involved).</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- Typically, this means record types, as long as they don't contain fields where the functor argument is not applied.</span><span>
</span><span id="line-74"></span><span class="hs-comment">--</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- There is a default implementation of 'tdistribute' based on</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- 'Generic'.  Intuitively, it works on product types where the shape</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- of a pure value is uniquely defined and every field is covered by</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- the argument @f@.</span><span>
</span><span id="line-80"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Barbies.Internal.FunctorT.html#FunctorT"><span class="hs-identifier hs-type">FunctorT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080834"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="DistributiveT"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-var">DistributiveT</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080835"><span id="local-6989586621679080834"><span class="annot"><a href="#local-6989586621679080834"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080835"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>  </span><span id="tdistribute"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-identifier hs-type">tdistribute</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679080781"><span id="local-6989586621679080782"><span id="local-6989586621679080783"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080783"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080783"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080834"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080782"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080781"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080834"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080783"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080782"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080781"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="tdistribute"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-identifier hs-type">tdistribute</span></a></span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679080831"><span class="annot"><a href="#local-6989586621679080831"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679080830"><span class="annot"><a href="#local-6989586621679080830"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679080829"><span class="annot"><a href="#local-6989586621679080829"><span class="hs-identifier hs-type">x</span></a></span></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-operator">.</span><span>  </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#CanDeriveDistributiveT"><span class="hs-identifier hs-type">CanDeriveDistributiveT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080834"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080831"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080830"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080829"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080831"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080834"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080830"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080829"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080834"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080831"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080830"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080829"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679080504"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-identifier hs-var hs-var">tdistribute</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} (t :: (* -&gt; *) -&gt; i -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *)
       (x :: i).
CanDeriveDistributiveT t f g x =&gt;
f (t g x) -&gt; t (Compose f g) x
</span><a href="Barbies.Internal.DistributiveT.html#gtdistributeDefault"><span class="hs-identifier hs-var">gtdistributeDefault</span></a></span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | A version of `tdistribute` with @g@ specialized to `Identity`.</span><span>
</span><span id="line-91"></span><span id="local-6989586621679080808"><span id="local-6989586621679080810"><span id="local-6989586621679080811"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute%27"><span class="hs-identifier hs-type">tdistribute'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080811"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080810"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080810"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080811"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080808"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080811"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080810"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080808"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-92"></span><span id="tdistribute%27"><span class="annot"><span class="annottext">tdistribute' :: forall {i} (t :: (* -&gt; *) -&gt; i -&gt; *) (f :: * -&gt; *) (x :: i).
(DistributiveT t, Functor f) =&gt;
f (t Identity x) -&gt; t f x
</span><a href="Barbies.Internal.DistributiveT.html#tdistribute%27"><span class="hs-identifier hs-var hs-var">tdistribute'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k k' (t :: (k -&gt; *) -&gt; k' -&gt; *) (f :: k -&gt; *) (g :: k -&gt; *)
       (x :: k').
FunctorT t =&gt;
(forall (a :: k). f a -&gt; g a) -&gt; t f x -&gt; t g x
</span><a href="Barbies.Internal.FunctorT.html#tmap"><span class="hs-identifier hs-var">tmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Identity a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">runIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k1} {k2} (f :: k1 -&gt; *) (g :: k2 -&gt; k1) (a :: k2).
Compose f g a -&gt; f (g a)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">getCompose</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall i (t :: (* -&gt; *) -&gt; i -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *)
       (x :: i).
(DistributiveT t, Functor f) =&gt;
f (t g x) -&gt; t (Compose f g) x
</span><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-identifier hs-var">tdistribute</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- | Dual of `Barbies.Internal.TraversableT.ttraverse`</span><span>
</span><span id="line-95"></span><span id="local-6989586621679080775"><span id="local-6989586621679080777"><span id="local-6989586621679080778"><span id="local-6989586621679080779"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tcotraverse"><span class="hs-identifier hs-type">tcotraverse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080779"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080778"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679080776"><span class="annot"><a href="#local-6989586621679080776"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679080778"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080777"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080776"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080778"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080776"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080778"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080779"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080777"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080775"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080779"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080778"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080775"><span class="hs-identifier hs-type">x</span></a></span></span></span></span></span><span>
</span><span id="line-96"></span><span id="tcotraverse"><span class="annot"><span class="annottext">tcotraverse :: forall {i} (t :: (* -&gt; *) -&gt; i -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *)
       (x :: i).
(DistributiveT t, Functor f) =&gt;
(forall a. f (g a) -&gt; f a) -&gt; f (t g x) -&gt; t f x
</span><a href="Barbies.Internal.DistributiveT.html#tcotraverse"><span class="hs-identifier hs-var hs-var">tcotraverse</span></a></span></span><span> </span><span id="local-6989586621679080483"><span class="annot"><span class="annottext">forall a. f (g a) -&gt; f a
</span><a href="#local-6989586621679080483"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k k' (t :: (k -&gt; *) -&gt; k' -&gt; *) (f :: k -&gt; *) (g :: k -&gt; *)
       (x :: k').
FunctorT t =&gt;
(forall (a :: k). f a -&gt; g a) -&gt; t f x -&gt; t g x
</span><a href="Barbies.Internal.FunctorT.html#tmap"><span class="hs-identifier hs-var">tmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. f (g a) -&gt; f a
</span><a href="#local-6989586621679080483"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k1} {k2} (f :: k1 -&gt; *) (g :: k2 -&gt; k1) (a :: k2).
Compose f g a -&gt; f (g a)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">getCompose</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall i (t :: (* -&gt; *) -&gt; i -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *)
       (x :: i).
(DistributiveT t, Functor f) =&gt;
f (t g x) -&gt; t (Compose f g) x
</span><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-identifier hs-var">tdistribute</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Decompose a function returning a distributive transformer, into</span><span>
</span><span id="line-99"></span><span class="hs-comment">--   a collection of simpler functions.</span><span>
</span><span id="line-100"></span><span id="local-6989586621679080765"><span id="local-6989586621679080766"><span id="local-6989586621679080767"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdecompose"><span class="hs-identifier hs-type">tdecompose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080767"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080766"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080767"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080765"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080767"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080766"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080765"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-101"></span><span id="tdecompose"><span class="annot"><span class="annottext">tdecompose :: forall {i} (t :: (* -&gt; *) -&gt; i -&gt; *) a (x :: i).
DistributiveT t =&gt;
(a -&gt; t Identity x) -&gt; t ((-&gt;) a) x
</span><a href="Barbies.Internal.DistributiveT.html#tdecompose"><span class="hs-identifier hs-var hs-var">tdecompose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {i} (t :: (* -&gt; *) -&gt; i -&gt; *) (f :: * -&gt; *) (x :: i).
(DistributiveT t, Functor f) =&gt;
f (t Identity x) -&gt; t f x
</span><a href="Barbies.Internal.DistributiveT.html#tdistribute%27"><span class="hs-identifier hs-var">tdistribute'</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- | Recompose a decomposed function.</span><span>
</span><span id="line-104"></span><span id="local-6989586621679080757"><span id="local-6989586621679080758"><span id="local-6989586621679080759"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#trecompose"><span class="hs-identifier hs-type">trecompose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Barbies.Internal.FunctorT.html#FunctorT"><span class="hs-identifier hs-type">FunctorT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080759"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080759"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080758"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080757"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080758"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080759"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080757"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-105"></span><span id="trecompose"><span class="annot"><span class="annottext">trecompose :: forall {k'} (t :: (* -&gt; *) -&gt; k' -&gt; *) a (x :: k').
FunctorT t =&gt;
t ((-&gt;) a) x -&gt; a -&gt; t Identity x
</span><a href="Barbies.Internal.DistributiveT.html#trecompose"><span class="hs-identifier hs-var hs-var">trecompose</span></a></span></span><span> </span><span id="local-6989586621679080476"><span class="annot"><span class="annottext">t ((-&gt;) a) x
</span><a href="#local-6989586621679080476"><span class="hs-identifier hs-var">bfs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080475"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080475"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k k' (t :: (k -&gt; *) -&gt; k' -&gt; *) (f :: k -&gt; *) (g :: k -&gt; *)
       (x :: k').
FunctorT t =&gt;
(forall (a :: k). f a -&gt; g a) -&gt; t f x -&gt; t g x
</span><a href="Barbies.Internal.FunctorT.html#tmap"><span class="hs-identifier hs-var">tmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Identity a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Identity</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679080475"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t ((-&gt;) a) x
</span><a href="#local-6989586621679080476"><span class="hs-identifier hs-var">bfs</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | @'CanDeriveDistributiveT' T f g x@ is in practice a predicate about @T@ only.</span><span>
</span><span id="line-108"></span><span class="hs-comment">--   Intuitively, it says the the following holds  for any arbitrary @f@:</span><span>
</span><span id="line-109"></span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span class="hs-comment">--     * There is an instance of @'Generic' (B f x)@.</span><span>
</span><span id="line-111"></span><span class="hs-comment">--</span><span>
</span><span id="line-112"></span><span class="hs-comment">--     * @(B f x)@ has only one constructor, and doesn't contain &quot;naked&quot; fields</span><span>
</span><span id="line-113"></span><span class="hs-comment">--       (that is, not covered by `f`). In particular, @x@ needs to occur under @f@.</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">--     * @B f x@ can contain fields of type @b f y@ as long as there exists a</span><span>
</span><span id="line-116"></span><span class="hs-comment">--       @'DistributiveT' b@ instance. In particular, recursive usages of @B f x@</span><span>
</span><span id="line-117"></span><span class="hs-comment">--       are allowed.</span><span>
</span><span id="line-118"></span><span class="hs-comment">--</span><span>
</span><span id="line-119"></span><span class="hs-comment">--     * @B f x@ can also contain usages of @b f y@ under a @'Distributive' h@.</span><span>
</span><span id="line-120"></span><span class="hs-comment">--       For example, one could use @a -&gt; (B f x)@ as a field of @B f x@.</span><span>
</span><span id="line-121"></span><span class="hs-keyword">type</span><span> </span><span id="CanDeriveDistributiveT"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#CanDeriveDistributiveT"><span class="hs-identifier hs-var">CanDeriveDistributiveT</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080473"><span class="annot"><a href="#local-6989586621679080473"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080472"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679080471"><span class="annot"><a href="#local-6989586621679080471"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679080470"><span class="annot"><a href="#local-6989586621679080470"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679080469"><span class="annot"><a href="#local-6989586621679080469"><span class="hs-identifier hs-type">x</span></a></span></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.Generics.GenericN.html#GenericP"><span class="hs-identifier hs-type">GenericP</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080473"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080470"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080469"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Generics.GenericN.html#GenericP"><span class="hs-identifier hs-type">GenericP</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080473"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080471"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080470"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080469"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Barbies.Generics.Distributive.html#GDistributive"><span class="hs-identifier hs-type">GDistributive</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="#local-6989586621679080471"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.GenericN.html#RepP"><span class="hs-identifier hs-type">RepP</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080473"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080470"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080469"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.GenericN.html#RepP"><span class="hs-identifier hs-type">RepP</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080473"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080471"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080470"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080469"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | Default implementation of 'tdistribute' based on 'Generic'.</span><span>
</span><span id="line-128"></span><span id="local-6989586621679080813"><span id="local-6989586621679080814"><span id="local-6989586621679080815"><span id="local-6989586621679080816"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#gtdistributeDefault"><span class="hs-identifier hs-type">gtdistributeDefault</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#CanDeriveDistributiveT"><span class="hs-identifier hs-type">CanDeriveDistributiveT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080816"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080815"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080814"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080813"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080815"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080816"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080814"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080813"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679080816"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080815"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080814"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080813"><span class="hs-identifier hs-type">x</span></a></span></span></span></span></span><span>
</span><span id="line-132"></span><span id="gtdistributeDefault"><span class="annot"><span class="annottext">gtdistributeDefault :: forall {i} (t :: (* -&gt; *) -&gt; i -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *)
       (x :: i).
CanDeriveDistributiveT t f g x =&gt;
f (t g x) -&gt; t (Compose f g) x
</span><a href="Barbies.Internal.DistributiveT.html#gtdistributeDefault"><span class="hs-identifier hs-var hs-var">gtdistributeDefault</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (n :: Nat) a x. GenericP n a =&gt; Proxy n -&gt; RepP n a x -&gt; a
</span><a href="Data.Generics.GenericN.html#toP"><span class="hs-identifier hs-var">toP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (n :: Nat) (f :: * -&gt; *) (repbg :: k -&gt; *)
       (repbfg :: k -&gt; *) (x :: k).
GDistributive n f repbg repbfg =&gt;
Proxy n -&gt; f (repbg x) -&gt; repbfg x
</span><a href="Barbies.Generics.Distributive.html#gdistribute"><span class="hs-identifier hs-var">gdistribute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (n :: Nat) a x. GenericP n a =&gt; Proxy n -&gt; a -&gt; RepP n a x
</span><a href="Data.Generics.GenericN.html#fromP"><span class="hs-identifier hs-var">fromP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#gtdistributeDefault"><span class="hs-pragma hs-type">gtdistributeDefault</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- Generic derivation: Special cases for FunctorT</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- -----------------------------------------------------------</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-keyword">type</span><span> </span><span id="P"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#P"><span class="hs-identifier hs-var">P</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Generics.GenericN.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679080711"><span id="local-6989586621679080712"><span id="local-6989586621679080714"><span id="local-6989586621679080715"><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080715"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080714"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Barbies.Generics.Distributive.html#GDistributive"><span class="hs-identifier hs-type">GDistributive</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="#local-6989586621679080715"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.GenericN.html#Rec"><span class="hs-identifier hs-type">Rec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080714"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="#local-6989586621679080712"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080711"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080714"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080712"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080711"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.GenericN.html#Rec"><span class="hs-identifier hs-type">Rec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080714"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080715"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080712"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080711"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080714"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080715"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080712"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080711"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>  </span><span id="local-6989586621679080443"><span class="annot"><span class="annottext">gdistribute :: forall (x :: k).
Proxy 1
-&gt; f (Rec (t (P 1 g) x) (t g x) x)
-&gt; Rec (t (P 1 (Compose f g)) x) (t (Compose f g) x) x
</span><a href="#local-6989586621679080443"><span class="hs-identifier hs-var hs-var hs-var hs-var">gdistribute</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy 1
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} p a (x :: k). K1 R a x -&gt; Rec p a x
</span><a href="Data.Generics.GenericN.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall k i c (p :: k). c -&gt; K1 i c p
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">K1</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall i (t :: (* -&gt; *) -&gt; i -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *)
       (x :: i).
(DistributiveT t, Functor f) =&gt;
f (t g x) -&gt; t (Compose f g) x
</span><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-identifier hs-var">tdistribute</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k i c (p :: k). K1 i c p -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unK1</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} p a (x :: k). Rec p a x -&gt; K1 R a x
</span><a href="Data.Generics.GenericN.html#unRec"><span class="hs-identifier hs-var">unRec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Generics.Distributive.html#gdistribute"><span class="hs-pragma hs-type">gdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679080682"><span id="local-6989586621679080683"><span id="local-6989586621679080685"><span id="local-6989586621679080686"><span id="local-6989586621679080687"><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080687"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../distributive/html/src"><span class="hs-identifier hs-type">Distributive</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080686"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080685"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><a href="Barbies.Generics.Distributive.html#GDistributive"><span class="hs-identifier hs-type">GDistributive</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="#local-6989586621679080687"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.GenericN.html#Rec"><span class="hs-identifier hs-type">Rec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080686"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080685"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="#local-6989586621679080683"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080682"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080686"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080685"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080683"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080682"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.GenericN.html#Rec"><span class="hs-identifier hs-type">Rec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080686"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080685"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080687"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080683"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080682"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080686"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679080685"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080687"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080683"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679080682"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679080423"><span class="annot"><span class="annottext">gdistribute :: forall (x :: k).
Proxy 1
-&gt; f (Rec (h (t (P 1 g) x)) (h (t g x)) x)
-&gt; Rec (h (t (P 1 (Compose f g)) x)) (h (t (Compose f g) x)) x
</span><a href="#local-6989586621679080423"><span class="hs-identifier hs-var hs-var hs-var hs-var">gdistribute</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy 1
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} p a (x :: k). K1 R a x -&gt; Rec p a x
</span><a href="Data.Generics.GenericN.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall k i c (p :: k). c -&gt; K1 i c p
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">K1</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall i (t :: (* -&gt; *) -&gt; i -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *)
       (x :: i).
(DistributiveT t, Functor f) =&gt;
f (t g x) -&gt; t (Compose f g) x
</span><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-identifier hs-var">tdistribute</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (g :: * -&gt; *) (f :: * -&gt; *) a.
(Distributive g, Functor f) =&gt;
f (g a) -&gt; g (f a)
</span><a href="../../../../distributive/html/src"><span class="hs-identifier hs-var">distribute</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k i c (p :: k). K1 i c p -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unK1</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} p a (x :: k). Rec p a x -&gt; K1 R a x
</span><a href="Data.Generics.GenericN.html#unRec"><span class="hs-identifier hs-var">unRec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Generics.Distributive.html#gdistribute"><span class="hs-pragma hs-type">gdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- --------------------------------</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- Instances for base types</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- --------------------------------</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679080675"><span class="annot"><a href="../../../../distributive/html/src"><span class="hs-identifier hs-type">Distributive</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080675"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Compose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080675"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621679080408"><span class="annot"><span class="annottext">tdistribute :: forall (f :: * -&gt; *) (g :: * -&gt; *) x.
Functor f =&gt;
f (Compose f g x) -&gt; Compose f (Compose f g) x
</span><a href="#local-6989586621679080408"><span class="hs-identifier hs-var hs-var hs-var hs-var">tdistribute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (g :: * -&gt; *) (f :: * -&gt; *) a.
(Distributive g, Functor f) =&gt;
f (g a) -&gt; g (f a)
</span><a href="../../../../distributive/html/src"><span class="hs-identifier hs-var">distribute</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k1} {k2} (f :: k1 -&gt; *) (g :: k2 -&gt; k1) (a :: k2).
Compose f g a -&gt; f (g a)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">getCompose</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-pragma hs-type">tdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- -- --------------------------------</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- -- Instances for transformers types</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- -- --------------------------------</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">Backwards</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621679080399"><span class="annot"><span class="annottext">tdistribute :: forall (f :: * -&gt; *) (g :: * -&gt; *) x.
Functor f =&gt;
f (Backwards g x) -&gt; Backwards (Compose f g) x
</span><a href="#local-6989586621679080399"><span class="hs-identifier hs-var hs-var hs-var hs-var">tdistribute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k). f a -&gt; Backwards f a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Backwards</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k). Backwards f a -&gt; f a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">forwards</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-pragma hs-type">tdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">Reverse</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679080389"><span class="annot"><span class="annottext">tdistribute :: forall (f :: * -&gt; *) (g :: * -&gt; *) x.
Functor f =&gt;
f (Reverse g x) -&gt; Reverse (Compose f g) x
</span><a href="#local-6989586621679080389"><span class="hs-identifier hs-var hs-var hs-var hs-var">tdistribute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k). f a -&gt; Reverse f a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Reverse</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k). Reverse f a -&gt; f a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">getReverse</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-pragma hs-type">tdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679080642"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080642"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679080379"><span class="annot"><span class="annottext">tdistribute :: forall (f :: * -&gt; *) (g :: * -&gt; *) x.
Functor f =&gt;
f (ExceptT e g x) -&gt; ExceptT e (Compose f g) x
</span><a href="#local-6989586621679080379"><span class="hs-identifier hs-var hs-var hs-var hs-var">tdistribute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">ExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-pragma hs-type">tdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">IdentityT</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679080370"><span class="annot"><span class="annottext">tdistribute :: forall (f :: * -&gt; *) (g :: * -&gt; *) x.
Functor f =&gt;
f (IdentityT g x) -&gt; IdentityT (Compose f g) x
</span><a href="#local-6989586621679080370"><span class="hs-identifier hs-var hs-var hs-var hs-var">tdistribute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k). f a -&gt; IdentityT f a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">IdentityT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (a :: k). IdentityT f a -&gt; f a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runIdentityT</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-pragma hs-type">tdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">MaybeT</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679080360"><span class="annot"><span class="annottext">tdistribute :: forall (f :: * -&gt; *) (g :: * -&gt; *) x.
Functor f =&gt;
f (MaybeT g x) -&gt; MaybeT (Compose f g) x
</span><a href="#local-6989586621679080360"><span class="hs-identifier hs-var hs-var hs-var hs-var">tdistribute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. m (Maybe a) -&gt; MaybeT m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">MaybeT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MaybeT m a -&gt; m (Maybe a)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runMaybeT</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-pragma hs-type">tdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679080607"><span id="local-6989586621679080608"><span id="local-6989586621679080609"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">Lazy.RWST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080609"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080608"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080607"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621679080350"><span class="annot"><span class="annottext">tdistribute :: forall (f :: * -&gt; *) (g :: * -&gt; *) x.
Functor f =&gt;
f (RWST r w s g x) -&gt; RWST r w s (Compose f g) x
</span><a href="#local-6989586621679080350"><span class="hs-identifier hs-var hs-var hs-var hs-var">tdistribute</span></a></span></span><span> </span><span id="local-6989586621679080349"><span class="annot"><span class="annottext">f (RWST r w s g x)
</span><a href="#local-6989586621679080349"><span class="hs-identifier hs-var">fh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r w s (m :: * -&gt; *) a.
(r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Lazy.RWST</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080347"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080347"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679080346"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080346"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080345"><span class="annot"><span class="annottext">RWST r w s g x
</span><a href="#local-6989586621679080345"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall r w s (m :: * -&gt; *) a.
RWST r w s m a -&gt; r -&gt; s -&gt; m (a, s, w)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Lazy.runRWST</span></a></span><span> </span><span class="annot"><span class="annottext">RWST r w s g x
</span><a href="#local-6989586621679080345"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080347"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080346"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f (RWST r w s g x)
</span><a href="#local-6989586621679080349"><span class="hs-identifier hs-var">fh</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-pragma hs-type">tdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679080587"><span id="local-6989586621679080588"><span id="local-6989586621679080589"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">Strict.RWST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080589"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080588"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080587"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>  </span><span id="local-6989586621679080336"><span class="annot"><span class="annottext">tdistribute :: forall (f :: * -&gt; *) (g :: * -&gt; *) x.
Functor f =&gt;
f (RWST r w s g x) -&gt; RWST r w s (Compose f g) x
</span><a href="#local-6989586621679080336"><span class="hs-identifier hs-var hs-var hs-var hs-var">tdistribute</span></a></span></span><span> </span><span id="local-6989586621679080335"><span class="annot"><span class="annottext">f (RWST r w s g x)
</span><a href="#local-6989586621679080335"><span class="hs-identifier hs-var">fh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r w s (m :: * -&gt; *) a.
(r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Strict.RWST</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080333"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080333"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679080332"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080332"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080331"><span class="annot"><span class="annottext">RWST r w s g x
</span><a href="#local-6989586621679080331"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall r w s (m :: * -&gt; *) a.
RWST r w s m a -&gt; r -&gt; s -&gt; m (a, s, w)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Strict.runRWST</span></a></span><span> </span><span class="annot"><span class="annottext">RWST r w s g x
</span><a href="#local-6989586621679080331"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080333"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080332"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f (RWST r w s g x)
</span><a href="#local-6989586621679080335"><span class="hs-identifier hs-var">fh</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-pragma hs-type">tdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679080571"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080571"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>  </span><span id="local-6989586621679080322"><span class="annot"><span class="annottext">tdistribute :: forall (f :: * -&gt; *) (g :: * -&gt; *) x.
Functor f =&gt;
f (ReaderT r g x) -&gt; ReaderT r (Compose f g) x
</span><a href="#local-6989586621679080322"><span class="hs-identifier hs-var hs-var hs-var hs-var">tdistribute</span></a></span></span><span> </span><span id="local-6989586621679080321"><span class="annot"><span class="annottext">f (ReaderT r g x)
</span><a href="#local-6989586621679080321"><span class="hs-identifier hs-var">fh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; ReaderT r m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">ReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080319"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080319"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080318"><span class="annot"><span class="annottext">ReaderT r g x
</span><a href="#local-6989586621679080318"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT r g x
</span><a href="#local-6989586621679080318"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679080319"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f (ReaderT r g x)
</span><a href="#local-6989586621679080321"><span class="hs-identifier hs-var">fh</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-pragma hs-type">tdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679080559"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">Lazy.StateT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080559"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679080309"><span class="annot"><span class="annottext">tdistribute :: forall (f :: * -&gt; *) (g :: * -&gt; *) x.
Functor f =&gt;
f (StateT s g x) -&gt; StateT s (Compose f g) x
</span><a href="#local-6989586621679080309"><span class="hs-identifier hs-var hs-var hs-var hs-var">tdistribute</span></a></span></span><span> </span><span id="local-6989586621679080308"><span class="annot"><span class="annottext">f (StateT s g x)
</span><a href="#local-6989586621679080308"><span class="hs-identifier hs-var">fh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Lazy.StateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080306"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080306"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080305"><span class="annot"><span class="annottext">StateT s g x
</span><a href="#local-6989586621679080305"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Lazy.runStateT</span></a></span><span> </span><span class="annot"><span class="annottext">StateT s g x
</span><a href="#local-6989586621679080305"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080306"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f (StateT s g x)
</span><a href="#local-6989586621679080308"><span class="hs-identifier hs-var">fh</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-pragma hs-type">tdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679080547"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">Strict.StateT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080547"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621679080296"><span class="annot"><span class="annottext">tdistribute :: forall (f :: * -&gt; *) (g :: * -&gt; *) x.
Functor f =&gt;
f (StateT s g x) -&gt; StateT s (Compose f g) x
</span><a href="#local-6989586621679080296"><span class="hs-identifier hs-var hs-var hs-var hs-var">tdistribute</span></a></span></span><span> </span><span id="local-6989586621679080295"><span class="annot"><span class="annottext">f (StateT s g x)
</span><a href="#local-6989586621679080295"><span class="hs-identifier hs-var">fh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Strict.StateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080293"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080293"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679080292"><span class="annot"><span class="annottext">StateT s g x
</span><a href="#local-6989586621679080292"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Strict.runStateT</span></a></span><span> </span><span class="annot"><span class="annottext">StateT s g x
</span><a href="#local-6989586621679080292"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679080293"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f (StateT s g x)
</span><a href="#local-6989586621679080295"><span class="hs-identifier hs-var">fh</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-pragma hs-type">tdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679080535"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">Lazy.WriterT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080535"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679080283"><span class="annot"><span class="annottext">tdistribute :: forall (f :: * -&gt; *) (g :: * -&gt; *) x.
Functor f =&gt;
f (WriterT w g x) -&gt; WriterT w (Compose f g) x
</span><a href="#local-6989586621679080283"><span class="hs-identifier hs-var hs-var hs-var hs-var">tdistribute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) a. m (a, w) -&gt; WriterT w m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Lazy.WriterT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Lazy.runWriterT</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-pragma hs-type">tdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679080523"><span class="annot"><a href="Barbies.Internal.DistributiveT.html#DistributiveT"><span class="hs-identifier hs-type">DistributiveT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">Strict.WriterT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080523"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>  </span><span id="local-6989586621679080273"><span class="annot"><span class="annottext">tdistribute :: forall (f :: * -&gt; *) (g :: * -&gt; *) x.
Functor f =&gt;
f (WriterT w g x) -&gt; WriterT w (Compose f g) x
</span><a href="#local-6989586621679080273"><span class="hs-identifier hs-var hs-var hs-var hs-var">tdistribute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) a. m (a, w) -&gt; WriterT w m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Strict.WriterT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Compose</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">Strict.runWriterT</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Barbies.Internal.DistributiveT.html#tdistribute"><span class="hs-pragma hs-type">tdistribute</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-219"></span></pre></body></html>